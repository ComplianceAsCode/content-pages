
<html>
<head>
<title>ocp4 SRG Mapping</title>
<style type="text/css">
table
{
    border-collapse:collapse;
}
table, th, td
{
    border: 2px solid #dcdcdc;
    border-left: none;
    border-right: none;
    vertical-align: top;
    padding: 2px;
    font-family: verdana,arial,sans-serif;
    font-size:11px;
}
pre {
    white-space: pre-wrap;
    white-space: -moz-pre-wrap !important;
    word-wrap:break-word;
}
table tr:nth-child(2n+2) { background-color: #f4f4f4; }
thead
{
    display: table-header-group;
    font-weight: bold;
    background-color: #dedede;
}
</style>
</head>
<body>
    <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: center;">
      <th></th>
      <th>IA Control</th>
      <th>CCI</th>
      <th>SRGID</th>
      <th>STIGID</th>
      <th>SRG Requirement</th>
      <th>Requirement</th>
      <th>SRG VulDiscussion</th>
      <th>Vul Discussion</th>
      <th>Status</th>
      <th>SRG Check</th>
      <th>Check</th>
      <th>SRG Fix</th>
      <th>Fix</th>
      <th>Severity</th>
      <th>Mitigation</th>
      <th>Artifact Description</th>
      <th>Status Justification</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>CCI-001414</td>
      <td>SRG-APP-000039-CTR-000110</td>
      <td>CCE-86070-0</td>
      <td>The container platform must enforce approved authorizations for controlling the flow of information between interconnected systems and services based on organization-defined information flow control policies.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce approved authorizations for controlling<br>the flow of information between interconnected systems and services<br>based on organization-defined information flow control policies.</td>
      <td>Controlling information flow between the container platform components and container user services instantiated by the container platform must enforce organization-defined information flow policies. Example methods for information flow control are: using labels for containers to segregate services; user permissions and roles to limit what user services are available to each user; controlling the user the services are able to execute as; and limiting inter-container network traffic and the resources containers can consume.</td>
      <td>OpenShift provides several layers of protection to control the flow of<br>information between the container platform components and user services. Each<br>user project is given a separate namespace and OpenShift enforces RBAC<br>policies controlling which projects and services users have access to. In<br>addition, NetworkPolicies are used to control the flow of requests to and<br>from externally integrated services to services hosted on the container<br>platform. It is important to define a default Network Policy that will be<br>applied automatically to new projects to prevent unintended requests. These<br>policies can be updated by the project's administrator (with the appropriate<br>RBAC permissions) to apply a policy that is appropriate to the service(s)<br>within the project namespace.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if organization-defined information flow controls are implemented. <br><br>If information flow controls are not implemented, this is a finding.</td>
      <td></td>
      <td></td>
      <td>Configure a default network policy as necessary to protect the flow of<br>information by performing the following steps.<br><br>1. Create a bootstrap project template (if not already created)<br><br>&gt; oc adm create-bootstrap-project-template -o yaml &gt; template.yaml<br><br>2. Edit the template and add NetworkPolicy object definitions before<br>the parameters section. For example, the following section defines two<br>policies one to allow requests from the same namespace, the other to<br>allow from the openshift ingress routing service.<br><br>- apiVersion: networking.k8s.io/v1<br>&nbsp;&nbsp;kind: NetworkPolicy<br>&nbsp;&nbsp;metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: allow-from-same-namespace<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;podSelector:<br>&nbsp;&nbsp;&nbsp;&nbsp;ingress:<br>&nbsp;&nbsp;&nbsp;&nbsp;- from:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- podSelector: {}<br>- apiVersion: networking.k8s.io/v1<br>&nbsp;&nbsp;kind: NetworkPolicy<br>&nbsp;&nbsp;metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: allow-from-openshift-ingress<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;ingress:<br>&nbsp;&nbsp;&nbsp;&nbsp;- from:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- namespaceSelector:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matchLabels:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network.openshift.io/policy-group: ingress<br>&nbsp;&nbsp;&nbsp;&nbsp;podSelector: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;policyTypes:<br>&nbsp;&nbsp;&nbsp;&nbsp;- Ingress<br>parameters:<br><br>3. Apply the project template to the cluster by running the following<br>command:<br><br>&gt; oc create -f template.yaml -n openshift-config<br><br>4. Set the default cluster project request template<br><br>&gt; oc patch project.config.openshift.io/cluster --type=merge \<br>-p '{spec":{"projectRequestTemplate":{"name": " "}}}'<br><br>For additional information regarding network policies, see<br>https://docs.openshift.com/container-platform/latest/networking/network_policy/about-network-policy.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>CCI-002617</td>
      <td>SRG-APP-000454-CTR-001110,SRG-APP-000454-CTR-001115</td>
      <td>CCE-86480-1</td>
      <td>The container platform must remove old components after updated versions have been installed.</td>
      <td>The container platform registry must remove old container images after updating versions have been made available.</td>
      <td>Previous versions of container platform components that are not removed from the container platform after updates have been installed may be exploited by adversaries by causing older components to execute which contain vulnerabilities. When these components are deleted, the likelihood of this happening is removed.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review container platform registry documentation and configuration to determine if organization-defined images contains latest approved vendor software image version. <br><br>If organization-defined images do not contain the latest approved vendor software image version, this is a finding. <br><br>Review container platform registry documentation and configuration to determine if organization-defined images are removed after updated versions have been installed. <br><br>If organization-defined images are not removed after updated versions have been installed, this is a finding. <br><br>Review container platform runtime documentation and configuration to determine if organization-define images are executing latest image version from the container platform registry. <br><br>If container platform runtime is not executing latest organization-defined images from the container platform registry, this is a finding.</td>
      <td>Ensure that the imagepruner is configured and is not in a suspended state.<br>&gt; oc get imagepruners.imageregistry.operator.openshift.io/cluster -o jsonpath='{.spec}{"<br>"}'<br>Review the settings and if suspend is set to true, this is a finding.</td>
      <td></td>
      <td>Enable the image pruner automate the pruning of images from the cluster.<br>&gt; oc patch imagepruners.imageregistry.operator.openshift.io/cluster --type=merge -p '{"spec":{"suspend":false}}'<br>For additional details on configuring the image pruner operator see the following document<br>https://docs.openshift.com/container-platform/latest/applications/pruning-objects.html#pruning-images_pruning-objects</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>CCI-000015</td>
      <td>SRG-APP-000023-CTR-000055</td>
      <td>CCE-84088-4</td>
      <td>The container platform must use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a centralized user management solution to<br>support account management functions.</td>
      <td>A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.<br><br>Anti-replay is a cryptographically based mechanism; thus, it must use FIPS-approved algorithms. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. Note that the anti-replay service is implicit when data contains monotonically increasing sequence numbers and data integrity is assured. Use of DoD PKI is inherently compliant with this requirement for user and device access. Use of Transport Layer Security (TLS), including application protocols such as HTTPS and DNSSEC, that use TLS/SSL as the underlying security protocol is also compliant.<br><br>Configure the information system to use the hash message authentication code (HMAC) algorithm for authentication services to Kerberos, SSH, web management tool, and any other access method.</td>
      <td>OpenShift supports several different types of identity providers.<br>In order to add users and grant access to OpenShift, an identity provider<br>needs to be configured. Some of the identity provider types, such as<br>HTPassword, only provide simple user management and are not intended<br>for production. Other types are public services, like GitHub. These<br>provider types may not be appropriate as they are managed by public<br>service providers and therefore are unable to enforce the organizations<br>account management requirements.<br><br>After a new install, the default authentication uses kubeadmin as the<br>default cluster-admin account.&nbsp;&nbsp;This default account needs to be disabled,<br>and another user account should be given cluster-admin rights.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts. <br><br>If the container platform is not configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts, this is a finding.</td>
      <td>Verify that the authentication operator is configure to use either an<br>LDAP or a OpenIDConnect or an approved identity provider:<br><br>&gt; oc get oauth cluster -o<br>jsonpath="{.spec.identityProviders[*].type}{'<br>'}"<br><br>If the output doesn't list an IdP, this is a finding.</td>
      <td></td>
      <td>Configure OpenShift to use an appropriate Identity Provider. Do not use<br>HTPasswd. Use either LDAP(AD), OpenIDConnect or an approved identity<br>provider.<br><br>Steps to configure LDAP provider:<br><br>&nbsp;&nbsp;1. Create Secret for BIND DN password<br><br>&nbsp;&nbsp;&gt; oc create secret generic ldap-secret --from-literal=bindPassword=&nbsp;&nbsp;\<br>&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;2. Create config map for LDAP Trust CA<br><br>&nbsp;&nbsp;&gt; oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n \<br>&nbsp;&nbsp;openshift-config<br><br>&nbsp;&nbsp;3. Create LDAP Auth Config Resource YAML<br><br>&nbsp;&nbsp;Using your preferred text editor, create a file named ldapidp.yaml using<br>&nbsp;&nbsp;the example content (replacing config values as appropriate):<br><br>&nbsp;&nbsp;apiVersion: config.openshift.io/v1 kind: OAuth metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: cluster<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;identityProviders:<br>&nbsp;&nbsp;&nbsp;&nbsp;- name: ldapidp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mappingMethod: claim<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: LDAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldap:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preferredUsername:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- uid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindDN: ""<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindPassword:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ldap-secret<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ca-config-map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url: "ldaps://ldap.example.com/ou=users,dc=acme,dc=com?uid"<br><br>&nbsp;&nbsp;&nbsp;&nbsp;4. Apply LDAP config to cluster<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&gt; oc apply -f ldapidp.yaml<br><br>&nbsp;&nbsp;&nbsp;&nbsp;For more information on configuring an<br>&nbsp;&nbsp;&nbsp;&nbsp;LDAP provider refer to the documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp;https://docs.openshift.com/container-platform/4.8/authentication/identity_providers/configuring-ldap-identity-provider.html<br><br>Steps to configure OpenID provider:<br><br>&nbsp;&nbsp;1. Create Secret for Client Secret<br><br>&nbsp;&nbsp;&gt; oc create secret generic&nbsp;&nbsp; \<br>&nbsp;&nbsp;--from-literal=clientSecret=&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;2. Create config map for OpenID Trust CA<br><br>&nbsp;&nbsp;&gt; oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca \<br>&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;3. Create OpenID Auth Config Resource YAML<br><br>&nbsp;&nbsp;Using your preferred text editor, create a file named oidcidp.yaml using<br>&nbsp;&nbsp;the example content (replacing config values as appropriate):<br><br>&nbsp;&nbsp;apiVersion: config.openshift.io/v1 kind: OAuth metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: cluster<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;identityProviders:<br>&nbsp;&nbsp;&nbsp;&nbsp;- name: ldapidp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mappingMethod: claim<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: LDAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldap:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preferredUsername:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- uid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindDN: ""<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindPassword:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ldap-secret<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ca-config-map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ldaps://ldap.example.com/ou=users,dc=acme,dc=com?uid"<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;4. Apply OpenID config to cluster<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&gt; oc apply -f ldapidp.yaml<br><br>&nbsp;&nbsp;&nbsp;&nbsp;For more information on configuring an<br>&nbsp;&nbsp;&nbsp;&nbsp;OpenID provider refer to the documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp;https://docs.openshift.com/container-platform/latest/authentication/identity_providers/configuring-oidc-identity-provider.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>CCI-000015</td>
      <td>SRG-APP-000023-CTR-000055</td>
      <td>CCE-84209-6</td>
      <td>The container platform must use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a centralized user management solution to<br>support account management functions.</td>
      <td>A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.<br><br>Anti-replay is a cryptographically based mechanism; thus, it must use FIPS-approved algorithms. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. Note that the anti-replay service is implicit when data contains monotonically increasing sequence numbers and data integrity is assured. Use of DoD PKI is inherently compliant with this requirement for user and device access. Use of Transport Layer Security (TLS), including application protocols such as HTTPS and DNSSEC, that use TLS/SSL as the underlying security protocol is also compliant.<br><br>Configure the information system to use the hash message authentication code (HMAC) algorithm for authentication services to Kerberos, SSH, web management tool, and any other access method.</td>
      <td>OpenShift supports several different types of identity providers.<br>In order to add users and grant access to OpenShift, an identity provider<br>needs to be configured. Some of the identity provider types, such as<br>HTPassword, only provide simple user management and are not intended<br>for production. Other types are public services, like GitHub. These<br>provider types may not be appropriate as they are managed by public<br>service providers and therefore are unable to enforce the organizations<br>account management requirements.<br><br>After a new install, the default authentication uses kubeadmin as the<br>default cluster-admin account.&nbsp;&nbsp;This default account needs to be disabled,<br>and another user account should be given cluster-admin rights.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts. <br><br>If the container platform is not configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts, this is a finding.</td>
      <td>Run the following command to list the identity providers configured:<br>&gt; oc get oauth cluster -o<br>jsonpath="{.spec.identityProviders[*].type}{'<br>'}"<br><br>If any of the IDP providers' type is HTPasswd, this is a finding.</td>
      <td></td>
      <td>Configure OpenShift to use an appropriate Identity Provider. Do not use<br>HTPasswd. Use either LDAP(AD), OpenIDConnect or an approved identity<br>provider.<br><br>Steps to configure LDAP provider:<br><br>&nbsp;&nbsp;1. Create Secret for BIND DN password<br><br>&nbsp;&nbsp;&gt; oc create secret generic ldap-secret --from-literal=bindPassword=&nbsp;&nbsp;\<br>&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;2. Create config map for LDAP Trust CA<br><br>&nbsp;&nbsp;&gt; oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n \<br>&nbsp;&nbsp;openshift-config<br><br>&nbsp;&nbsp;3. Create LDAP Auth Config Resource YAML<br><br>&nbsp;&nbsp;Using your preferred text editor, create a file named ldapidp.yaml using<br>&nbsp;&nbsp;the example content (replacing config values as appropriate):<br><br>&nbsp;&nbsp;apiVersion: config.openshift.io/v1 kind: OAuth metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: cluster<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;identityProviders:<br>&nbsp;&nbsp;&nbsp;&nbsp;- name: ldapidp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mappingMethod: claim<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: LDAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldap:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preferredUsername:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- uid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindDN: ""<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindPassword:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ldap-secret<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ca-config-map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url: "ldaps://ldap.example.com/ou=users,dc=acme,dc=com?uid"<br><br>&nbsp;&nbsp;&nbsp;&nbsp;4. Apply LDAP config to cluster<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&gt; oc apply -f ldapidp.yaml<br><br>&nbsp;&nbsp;&nbsp;&nbsp;For more information on configuring an<br>&nbsp;&nbsp;&nbsp;&nbsp;LDAP provider refer to the documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp;https://docs.openshift.com/container-platform/4.8/authentication/identity_providers/configuring-ldap-identity-provider.html<br><br>Steps to configure OpenID provider:<br><br>&nbsp;&nbsp;1. Create Secret for Client Secret<br><br>&nbsp;&nbsp;&gt; oc create secret generic&nbsp;&nbsp; \<br>&nbsp;&nbsp;--from-literal=clientSecret=&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;2. Create config map for OpenID Trust CA<br><br>&nbsp;&nbsp;&gt; oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca \<br>&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;3. Create OpenID Auth Config Resource YAML<br><br>&nbsp;&nbsp;Using your preferred text editor, create a file named oidcidp.yaml using<br>&nbsp;&nbsp;the example content (replacing config values as appropriate):<br><br>&nbsp;&nbsp;apiVersion: config.openshift.io/v1 kind: OAuth metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: cluster<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;identityProviders:<br>&nbsp;&nbsp;&nbsp;&nbsp;- name: ldapidp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mappingMethod: claim<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: LDAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldap:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preferredUsername:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- uid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindDN: ""<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindPassword:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ldap-secret<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ca-config-map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ldaps://ldap.example.com/ou=users,dc=acme,dc=com?uid"<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;4. Apply OpenID config to cluster<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&gt; oc apply -f ldapidp.yaml<br><br>&nbsp;&nbsp;&nbsp;&nbsp;For more information on configuring an<br>&nbsp;&nbsp;&nbsp;&nbsp;OpenID provider refer to the documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp;https://docs.openshift.com/container-platform/4.8/authentication/identity_providers/configuring-oidc-identity-provider.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>CCI-000015</td>
      <td>SRG-APP-000023-CTR-000055</td>
      <td>CCE-90387-2</td>
      <td>The container platform must use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a centralized user management solution to<br>support account management functions.</td>
      <td>A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.<br><br>Anti-replay is a cryptographically based mechanism; thus, it must use FIPS-approved algorithms. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. Note that the anti-replay service is implicit when data contains monotonically increasing sequence numbers and data integrity is assured. Use of DoD PKI is inherently compliant with this requirement for user and device access. Use of Transport Layer Security (TLS), including application protocols such as HTTPS and DNSSEC, that use TLS/SSL as the underlying security protocol is also compliant.<br><br>Configure the information system to use the hash message authentication code (HMAC) algorithm for authentication services to Kerberos, SSH, web management tool, and any other access method.</td>
      <td>OpenShift supports several different types of identity providers.<br>In order to add users and grant access to OpenShift, an identity provider<br>needs to be configured. Some of the identity provider types, such as<br>HTPassword, only provide simple user management and are not intended<br>for production. Other types are public services, like GitHub. These<br>provider types may not be appropriate as they are managed by public<br>service providers and therefore are unable to enforce the organizations<br>account management requirements.<br><br>After a new install, the default authentication uses kubeadmin as the<br>default cluster-admin account.&nbsp;&nbsp;This default account needs to be disabled,<br>and another user account should be given cluster-admin rights.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts. <br><br>If the container platform is not configured to use FIPS-validated SHA-1 or higher hash function to provide replay-resistant authentication mechanisms for network access to privileged accounts, this is a finding.</td>
      <td>Verify that the kubeadmin account is disabled<br><br>&gt; oc get secrets kubeadmin -n kube-system<br><br>If the command returns an error that the secret was not found, this<br>is not a finding. If the command returns a listing that includes the<br>kubeadmin secret, its type, the data count, and age, this is a finding.</td>
      <td></td>
      <td>&gt; oc delete secrets kubeadmin -n kube-system</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>CCI-002238</td>
      <td>SRG-APP-000345-CTR-000785</td>
      <td></td>
      <td>The container platform must automatically lock an account until the locked account is released by an administrator when three unsuccessful login attempts in 15 minutes are exceeded.</td>
      <td>Red Hat OpenShift Container Platform 4 must automatically lock an account until the locked account is released by an administrator when three unsuccessful login attempts in 15 minutes are exceeded.</td>
      <td>By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Determine if the container platform is configured to automatically lock an account until the locked account is released by an administrator when three unsuccessful login attempts in 15 minutes are exceeded. <br><br>If the container platform is not configured to lock the account, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>CCI-002884,CCI-000130,CCI-000172</td>
      <td>SRG-OS-000062-GPOS-00031,SRG-OS-000037-GPOS-00015,SRG-OS-000038-GPOS-00016,SRG-OS-000039-GPOS-00017,SRG-OS-000040-GPOS-00018,SRG-OS-000041-GPOS-00019,SRG-OS-000042-GPOS-00021,SRG-OS-000051-GPOS-00024,SRG-OS-000054-GPOS-00025,SRG-OS-000122-GPOS-00063,SRG-OS-000254-GPOS-00095,SRG-OS-000255-GPOS-00096,SRG-OS-000337-GPOS-00129,SRG-OS-000348-GPOS-00136,SRG-OS-000349-GPOS-00137,SRG-OS-000350-GPOS-00138,SRG-OS-000351-GPOS-00139,SRG-OS-000352-GPOS-00140,SRG-OS-000353-GPOS-00141,SRG-OS-000354-GPOS-00142,SRG-OS-000358-GPOS-00145,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000475-GPOS-00220,SRG-APP-000095-CTR-000170,SRG-APP-000409-CTR-000990,SRG-APP-000508-CTR-001300,SRG-APP-000510-CTR-001310</td>
      <td></td>
      <td>The container runtime must generate audit records for all container execution, shutdown, restart events, and program initiations.</td>
      <td>Red Hat OpenShift Container Platform 4 audit service must be enabled.</td>
      <td>The container runtime must generate audit records that are specific to the security and mission needs of the organization. Without audit record, it would be difficult to establish, correlate, and investigate events relating to an incident.</td>
      <td>Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack. Ensuring the "auditd" service is active ensures audit records generated by the kernel are appropriately recorded.<br><br>Additionally, a properly configured audit subsystem ensures that actions of individual system users can be uniquely traced to those users so they can be held accountable for their actions.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container runtime configuration to validate audit record generation for container execution, shutdown, and restart events. <br><br>If the container runtime does not generate records for container execution, shutdown and restart events, this is a finding.</td>
      <td>Verify the audit service is configured to produce audit records with the following command:<br><br>$ systemctl status auditd.service<br><br>auditd.service - Security Auditing Service<br>Loaded:loaded (/usr/lib/systemd/system/auditd.service; enabled; vendor preset: enabled)<br>Active: active (running) since Tues 2022-05-24 12:56:56 EST; 4 weeks 0 days ago<br><br>If the audit service is not "active" and "running", this is a finding.</td>
      <td></td>
      <td>To enable the auditd service run the following command:<br><br>$ sudo systemctl enable --now auditd</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>CCI-000050</td>
      <td>SRG-APP-000069-CTR-000125</td>
      <td></td>
      <td>The container platform must retain the Standard Mandatory DoD Notice and Consent Banner on the screen until users acknowledge the usage and conditions and take explicit actions to log on for further access.</td>
      <td>Red Hat OpenShift Container Platform 4 must retain the Standard Mandatory DoD Notice and Consent Banner on the screen until users acknowledge the usage and conditions and take explicit actions to log on for further access.</td>
      <td>The banner must be acknowledged by the user prior to allowing the user access to any container platform component. This provides assurance that the user has seen the message and accepted the conditions for access. If the consent banner is not acknowledged by the user, DoD will not be in compliance with system use notifications required by law. <br><br>To establish acceptance of the application usage policy, a click-through banner at application logon is required. The application must prevent further activity until the user executes a positive action to manifest agreement by clicking on a box indicating "OK".</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Log in to the container platform components to determine if the Standard Mandatory DoD Notice and Consent Banner remains on the screen until users acknowledge the usage and conditions and take explicit actions to log on for further access. <br><br>If the Standard Mandatory DoD Notice and Consent Banner does not stay on the screen until the users acknowledge the usage and conditions, this is a finding.</td>
      <td>From a web browser, go to the Openshift web console to login (logout<br>if already logged in). Verify that the DOD notice and consent banner is<br>displayed, and that the user must select 'Ok' before proceeding to the<br>login page.<br><br>If the DOD notice and consent banner is not displayed, or does not have an<br>'Ok' button to acknowledge consent before proceeding, this is a finding.</td>
      <td></td>
      <td>This control is resolved by resolving SRG-APP-000068-CTR-000120</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>CCI-001368</td>
      <td>SRG-APP-000038-CTR-000105</td>
      <td></td>
      <td>The container platform must enforce approved authorizations for controlling the flow of information within the container platform based on organization-defined information flow control policies.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce approved authorizations<br>for controlling the flow of information within Red Hat OpenShift Container<br>Platform 4 based on organization-defined information flow control policies.</td>
      <td>Controlling information flow between the container platform components and container user services instantiated by the container platform must enforce organization-defined information flow policies. Example methods for information flow control are using labels and separate namespace for containers to segregate services; user permissions and roles to limit what user services are available to each user; controlling the user the services are able to execute as; and limiting inter-container network traffic and the resources containers can consume.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to determine if approved authorizations for controlling the flow of information within the container platform based on organization-defined information flow control policies is being enforced. <br><br>If the organization-defined information flow policies are not being enforced, this is a finding.</td>
      <td>Verify that each user namespace has a Network Policy<br><br>1. Get a list of existing projects(namespaces), exclude default, kube-*, openshift-*<br><br>&gt; oc get namespaces -ojson | jq -r '[.items[] | select((.metadata.name | startswith("openshift") | not) and (.metadata.name | startswith("kube-") | not) and .metadata.name != "default") | .metadata.name]'<br><br>2. Get a list of namespaces, excluding default, kube-* and openshift-* that contain<br>a NetworkPolicy object.<br><br>&gt; oc get NetworkPolicy -A -ojson | jq -r '[.items[] | select((.metadata.namespace | startswith("openshift") | not) and (.metadata.namespace | startswith("kube-") | not) and .metadata.namespace != "default") | .metadata.namespace] | unique'<br><br>If the two lists do not match, in other words, if a project does not<br>have any NetworkPolicy definitions, this is a finding.</td>
      <td></td>
      <td>Configure a default network policy as necessary to protect the flow of<br>information by performing the following steps.<br><br>1. Create a networkpolicy.yaml file with the NetworkPolicy object<br>definitions desired. For example, the following section defines two<br>policies one to allow requests from the same namespace, the other to<br>allow from the openshift ingress routing service.<br><br>apiVersion: v1<br>kind: List<br>items:<br>- apiVersion: networking.k8s.io/v1<br>&nbsp;&nbsp;kind: NetworkPolicy<br>&nbsp;&nbsp;metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: allow-from-same-namespace<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;podSelector:<br>&nbsp;&nbsp;&nbsp;&nbsp;ingress:<br>&nbsp;&nbsp;&nbsp;&nbsp;- from:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- podSelector: {}<br>- apiVersion: networking.k8s.io/v1<br>&nbsp;&nbsp;kind: NetworkPolicy<br>&nbsp;&nbsp;metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: allow-from-openshift-ingress<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;ingress:<br>&nbsp;&nbsp;&nbsp;&nbsp;- from:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- namespaceSelector:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matchLabels:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network.openshift.io/policy-group: ingress<br>&nbsp;&nbsp;&nbsp;&nbsp;podSelector: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;policyTypes:<br>&nbsp;&nbsp;&nbsp;&nbsp;- Ingress<br><br>3. Apply the NetworkPolicy object to the appropriate namespaces by<br>running the following command:<br><br>&gt; oc apply -f networkpolicy.yaml -n&nbsp;&nbsp;<br><br>For additional information regarding network policies, see<br>https://docs.openshift.com/container-platform/latest/networking/network_policy/about-network-policy.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>CCI-001368</td>
      <td>SRG-APP-000038-CTR-000105</td>
      <td></td>
      <td>The container platform must enforce approved authorizations for controlling the flow of information within the container platform based on organization-defined information flow control policies.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce approved authorizations<br>for controlling the flow of information within Red Hat OpenShift Container<br>Platform 4 based on organization-defined information flow control policies.</td>
      <td>Controlling information flow between the container platform components and container user services instantiated by the container platform must enforce organization-defined information flow policies. Example methods for information flow control are using labels and separate namespace for containers to segregate services; user permissions and roles to limit what user services are available to each user; controlling the user the services are able to execute as; and limiting inter-container network traffic and the resources containers can consume.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to determine if approved authorizations for controlling the flow of information within the container platform based on organization-defined information flow control policies is being enforced. <br><br>If the organization-defined information flow policies are not being enforced, this is a finding.</td>
      <td>Verify that the CNI supports NetworkPolicies:<br>&gt; oc get network cluster -oyaml -ojsonpath='{.spec.networkType}'<br><br>The result should list a CNI plugin that supports NetworkPolicies,<br>currently the plugins that do support NetworkPolicies are OpenShiftSDN,<br>OVN and Calico.<br><br>If the cluster does not return a CNI that supports NetworkPolicies,<br>this is a finding.</td>
      <td></td>
      <td>Migration to a supported CNI plugin is not automated.<br><br>For additional information regarding network policies, see<br>https://docs.openshift.com/container-platform/latest/networking/network_policy/about-network-policy.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>CCI-001184,CCI-002450,CCI-001350,CCI-000803,CCI-003123,CCI-002890</td>
      <td>SRG-APP-000126-CTR-000275,SRG-APP-000219-CTR-000550,SRG-APP-000411-CTR-000995,SRG-APP-000412-CTR-001000,SRG-APP-000416-CTR-001015,SRG-APP-000514-CTR-001315,SRG-APP-000610-CTR-001385,SRG-APP-000635-CTR-001405</td>
      <td>CCE-85860-5</td>
      <td>Container platform applications and Application Program Interfaces (API) used for nonlocal maintenance sessions must use FIPS-validated keyed-hash message authentication code (HMAC) to protect the integrity of nonlocal maintenance and diagnostic communications.</td>
      <td>Red Hat OpenShift Container Platform 4 must use FIPS validated cryptographic mechanisms to protect the integrity<br>of log information.</td>
      <td>Unapproved mechanisms that are used for authentication to the cryptographic module are not verified, and therefore cannot be relied on to provide confidentiality or integrity, and DoD data may be compromised.<br><br>Nonlocal maintenance and diagnostic activities are activities conducted by individuals communicating through either an external network (e.g., the internet) or an internal network.<br><br>Currently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.<br><br>Separate requirements for configuring applications and protocols used by each product (e.g., SNMPv3, SSHv2, NTP, and other protocols and applications that require server/client authentication) are required to implement this requirement. The SSHv2 protocol suite must be mandated in the product because it includes layer 7 protocols such as SCP and SFTP that can be used for secure file transfers.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Validate that container platform applications and APIs used for nonlocal maintenance sessions are using FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications. <br><br>If the sessions are not using FIPS-validated HMAC, this is a finding.</td>
      <td>OpenShift must be configured at the time of installation.&nbsp;&nbsp;Because FIPS<br>must be enabled before the operating system that your cluster uses boots<br>for the first time, you cannot enable FIPS after you deploy a cluster. If<br>a cluster is installed in FIPS mode, the nodes will indicate FIPS mode<br>and this will propagate into the platform.<br><br>To validate that the OpenShift cluster is running with FIPS enabled on<br>each node run the command:<br><br>&gt; for node in $(oc get node -oname); \<br>do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; \ <br>sysctl crypto.fips_enabled' 2&gt;/dev/null; done<br><br>If any lines of output end in anything other than a 1, this is a finding.</td>
      <td></td>
      <td>Reinstall the OpenShift cluster in FIPS mode. The file install-config.yaml<br>has a top level key that enables FIPS mode for all nodes and the cluster<br>platform layer. If your install-config.yaml was not backed up prior to<br>consumption as part of the installation, you will need to recreate it. An<br>example install-config.yaml with some sections trimmed out for brevity,<br>and the "fips: true" key applied at the top level is shown below:<br><br>apiVersion: v1 baseDomain: example.com controlPlane:<br>&nbsp;&nbsp;name: master platform:<br>&nbsp;&nbsp;&nbsp;&nbsp;aws:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[...]<br>&nbsp;&nbsp;replicas: 3<br>compute: - name: worker<br>&nbsp;&nbsp;platform:<br>&nbsp;&nbsp;&nbsp;&nbsp;aws:<br>&nbsp;&nbsp;replicas: 3<br>metadata:<br>&nbsp;&nbsp;name: fips-cluster<br>networking:<br>&nbsp;&nbsp;[...]<br>platform:<br>&nbsp;&nbsp;aws:<br>&nbsp;&nbsp;&nbsp;&nbsp;[...]<br>sshKey: ssh-ed25519 AAAA...&nbsp;&nbsp;pullSecret: '{"auths": ...}' fips: true<br><br>Once you have saved the install-config.yaml with corresponding<br>correct information for your installation infrastructure, run the<br>installer to create a cluster that uses FIPS Validated / Modules in<br>Process cryptographic libraries. The command to install a cluster and<br>consume the install-config.yaml is: <br>&gt; ./openshift-install create cluster --dir=&nbsp;&nbsp;\<br>--log-level=info <br>Where&nbsp;&nbsp; is the directory that contains install-config.yaml<br><br>Additional Details can be found here:<br>https://docs.openshift.com/container-platform/latest/installing/installing-fips.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>CCI-000770,CCI-001774,CCI-001812,CCI-002235,CCI-001813,CCI-001499,CCI-000213,CCI-000764</td>
      <td>SRG-APP-000033-CTR-000090,SRG-APP-000033-CTR-000095,SRG-APP-000033-CTR-000100,SRG-APP-000133-CTR-000290,SRG-APP-000133-CTR-000295,SRG-APP-000133-CTR-000300,SRG-APP-000133-CTR-000305,SRG-APP-000133-CTR-000310,SRG-APP-000148-CTR-000350,SRG-APP-000153-CTR-000375,SRG-APP-000340-CTR-000770,SRG-APP-000378-CTR-000880,SRG-APP-000378-CTR-000885,SRG-APP-000378-CTR-000890,SRG-APP-000380-CTR-000900,SRG-APP-000386-CTR-000920</td>
      <td>CCE-90678-4</td>
      <td>Least privilege access and need to know must be required to access the container platform registry.</td>
      <td>Least privilege access and need to know must be required to access the OpenShift components.</td>
      <td>The container platform registry is used to store images and is the keeper of truth for trusted images within the platform. To guarantee the images integrity, access to the registry must be limited to those individuals who need to perform tasks to the images such as the update, creation, or deletion of images. Without this control access, images can be deleted that are in use by the container platform causing a denial of service (DoS), and images can be modified or introduced without going through the testing and validation process allowing for the intentional or unintentional introduction of containers with flaws and vulnerabilities.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if least privilege and need-to-know access is being used for container platform registry access. <br><br>If least privilege and need-to-know access is not being used for container platform registry access, this is a finding.</td>
      <td>The administrator must verify that Openshift is configured with the necessary RBAC access controls.<br><br>Review the RBAC configuration.<br><br>As the cluster-admin, view the cluster roles and their associated rule sets by executing the following::<br><br>oc describe clusterrole.rbac<br><br>Now view the current set of cluster role bindings, which shows the users and groups that are bound to various roles by executing the following:<br><br>oc describe clusterrolebinding.rbac<br><br>Local roles and bindings can be determined using the follow commands by executing the following:<br><br>oc describe rolebinding.rbac<br><br>If these results show users with privileged access that do not require that access, this is a finding.</td>
      <td></td>
      <td>If users or groups exist that are bound to roles they must not have, modify the user or group permissions using the following cluster and local role binding commands:<br><br>Remove a User from a Cluster RBAC role by executing the following:<br><br>oc adm policy remove-cluster-role-from-user role username<br><br>Remove a Group from a Cluster RBAC role by executing the following:<br><br>oc adm policy remove-cluster-role-from-group role groupname<br><br>Remove a User from a Local RBAC role by executing the following:<br><br>oc adm policy remove-role-from-user role username<br><br>Remove a Group from a Local RBAC role by executing the following:<br><br>oc adm policy remove-role-from-group role groupname<br><br>NOTE: For additional information. https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td>CCI-000195</td>
      <td>SRG-APP-000170-CTR-000430</td>
      <td></td>
      <td>The container platform must require the change of at least 15 of the total number of characters when passwords are changed.</td>
      <td>Red Hat OpenShift Container Platform 4 must require the change of at least 15 of the total number of characters when passwords are changed.</td>
      <td>If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.<br><br>The number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it requires the change of at least 15 of the total number of characters when passwords are changed. <br><br>If the container platform does not require the change of at least 15 of the total number of characters when passwords are changed, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td>CCI-000205</td>
      <td>SRG-APP-000164-CTR-000400</td>
      <td></td>
      <td>The container platform must enforce a minimum 15-character password length.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce a minimum 15-character password length.</td>
      <td>The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.<br><br>Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.<br><br>Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform enforces a minimum 15-character password length. <br><br>If the container platform does not enforce a 15-character password length, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td>CCI-000015</td>
      <td>SRG-APP-000023-CTR-000055</td>
      <td>CCE-83699-9</td>
      <td>The container platform must use a centralized user management solution to support account management functions.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a centralized user management solution to<br>support account management functions.</td>
      <td>Enterprise environments make application account management challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error.<br><br>A comprehensive application account management process that includes automation helps to ensure accounts designated as requiring attention are consistently and promptly addressed. Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended, or terminated or by disabling accounts located in non-centralized account stores, such as multiple servers. This requirement applies to all account types, including individual/user, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.<br><br>The application must be configured to automatically provide account management functions, and these functions must immediately enforce the organization's current account policy. The automated mechanisms may reside within the application itself or may be offered by the operating system or other infrastructure-providing automated account management capabilities. Automated mechanisms may be comprised of differing technologies, that when placed together, contain an overall automated mechanism supporting an organization's automated account management requirements.<br><br>Account management functions include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include: using email or text messaging to automatically notify account managers when users are terminated or transferred; using the information system to monitor account usage; or using automated telephonic notification to report atypical system account usage.</td>
      <td>OpenShift supports several different types of identity providers.<br>In order to add users and grant access to OpenShift, an identity provider<br>needs to be configured. Some of the identity provider types, such as<br>HTPassword, only provide simple user management and are not intended<br>for production. Other types are public services, like GitHub. These<br>provider types may not be appropriate as they are managed by public<br>service providers and therefore are unable to enforce the organizations<br>account management requirements.<br><br>After a new install, the default authentication uses kubeadmin as the<br>default cluster-admin account.&nbsp;&nbsp;This default account needs to be disabled,<br>and another user account should be given cluster-admin rights.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to determine if it is using a centralized user management system for user management functions. <br><br>If the container platform is not using a centralized user management system for user management functions, this is a finding.</td>
      <td>Verify that the authentication operator is configure to use either an<br>LDAP or a OpenIDConnect or an approved identity provider:<br><br>&gt; oc get oauth cluster -o jsonpath="{.spec.identityProviders}" | jq<br><br>If any of the IDP provides' type is LDAP and any of them use the<br>insecure flag, this is a finding.</td>
      <td></td>
      <td>Configure OpenShift to use an appropriate Identity Provider. Do not use<br>HTPasswd. Use either LDAP(AD), OpenIDConnect or an approved identity<br>provider.<br><br>Steps to configure LDAP provider:<br><br>&nbsp;&nbsp;1. Create Secret for BIND DN password<br><br>&nbsp;&nbsp;&gt; oc create secret generic ldap-secret --from-literal=bindPassword=&nbsp;&nbsp;\<br>&nbsp;&nbsp;-n openshift-config<br><br>&nbsp;&nbsp;2. Create config map for LDAP Trust CA<br><br>&nbsp;&nbsp;&gt; oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n \<br>&nbsp;&nbsp;openshift-config<br><br>&nbsp;&nbsp;3. Create LDAP Auth Config Resource YAML<br><br>&nbsp;&nbsp;Using your preferred text editor, create a file named ldapidp.yaml using<br>&nbsp;&nbsp;the example content (replacing config values as appropriate):<br><br>&nbsp;&nbsp;apiVersion: config.openshift.io/v1 kind: OAuth metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: cluster<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;identityProviders:<br>&nbsp;&nbsp;&nbsp;&nbsp;- name: ldapidp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mappingMethod: claim<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: LDAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldap:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preferredUsername:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- uid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindDN: ""<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindPassword:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ldap-secret<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: ca-config-map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url: "ldaps://ldap.example.com/ou=users,dc=acme,dc=com?uid"<br><br>&nbsp;&nbsp;&nbsp;&nbsp;4. Apply LDAP config to cluster<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&gt; oc apply -f ldapidp.yaml<br><br>&nbsp;&nbsp;&nbsp;&nbsp;For more information on configuring an<br>&nbsp;&nbsp;&nbsp;&nbsp;LDAP provider refer to the documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp;https://docs.openshift.com/container-platform/4.8/authentication/identity_providers/configuring-ldap-identity-provider.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td>CCI-000795</td>
      <td>SRG-APP-000163-CTR-000395</td>
      <td></td>
      <td>The container platform must disable identifiers (individuals, groups, roles, and devices) after 35 days of inactivity.</td>
      <td>Red Hat OpenShift Container Platform 4 must disable identifiers (individuals, groups, roles, and devices) after 35 days of inactivity.</td>
      <td>Inactive identifiers pose a risk to systems and applications. Attackers that are able to exploit an inactive identifier can potentially obtain and maintain undetected access to the application. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.<br><br>Applications need to track periods of inactivity and disable application identifiers after 35 days of inactivity.<br><br>Management of user identifiers is not applicable to shared information system accounts (e.g., guest and anonymous accounts). It is commonly the case that a user account is the name of an information system account associated with an individual.<br><br>To avoid having to build complex user management capabilities directly into their application, wise developers leverage the underlying OS or other user account management infrastructure (AD, LDAP) that is already in place within the organization and meets organizational user account management requirements.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to disable identifiers (individuals, groups, roles, and devices) after 35 days of inactivity. <br><br>If identifiers are not disabled after 35 days of inactivity, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td>CCI-002476</td>
      <td>SRG-APP-000429-CTR-001060</td>
      <td>CCE-83585-0</td>
      <td>The container platform keystore must implement encryption to prevent unauthorized disclosure of information at rest within the container platform.</td>
      <td>TheRed Hat OpenShift Container Platform 4 keystore must implement encryption to prevent unauthorized disclosure of information at rest within the container platform.</td>
      <td>Container platform keystore is used for container deployments for persistent storage of all its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any unauthorized disclosure. Selection of a cryptographic mechanism is based on the need to protect the confidentiality of organizational information. The strength of mechanism is commensurate with the security category and/or classification of the information.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review container platform keystore documentation and configuration to verify encryption levels meet the information sensitivity level. <br><br>If the container platform keystore encryption configuration does not meet system requirements, this is a finding.</td>
      <td>Review the api server encryption by running the following commands:<br><br>&gt; oc edit apiserver<br><br>EXAMPLE OUTPUT<br>spec:<br>&nbsp;&nbsp;encryption:<br>&nbsp;&nbsp;&nbsp;&nbsp;type: aescbc<br><br>If the encryption type is not aescbc then this is a finding.</td>
      <td></td>
      <td>Run the following command:<br>&gt; oc edit apiserver<br><br>Set the encryption field type to aescbc:<br>spec:<br>&nbsp;&nbsp;encryption:<br>&nbsp;&nbsp;&nbsp;&nbsp;type: aescbc<br><br>Additional details about the configuration can be found in the documentation:<br>https://docs.openshift.com/container-platform/latest/security/encrypting-etcd.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>17</th>
      <td></td>
      <td>CCI-000131,CCI-001496,CCI-000132,CCI-001487,CCI-001849,CCI-000140,CCI-000133,CCI-000134</td>
      <td>SRG-OS-000255-GPOS-00096,SRG-OS-000480-GPOS-00227,SRG-APP-000096-CTR-000175,SRG-APP-000097-CTR-000180,SRG-APP-000098-CTR-000185,SRG-APP-000099-CTR-000190,SRG-APP-000100-CTR-000195,SRG-APP-000100-CTR-000200,SRG-APP-000109-CTR-000215,SRG-APP-000290-CTR-000670,SRG-APP-000357-CTR-000800</td>
      <td></td>
      <td>All audit records must generate the event results within the container platform.</td>
      <td>Red Hat OpenShift Container Platform 4 must produce audit records containing information to establish the identity of any individual or process associated with the event.</td>
      <td>Within the container platform, audit data can be generated from any of the deployed container platform components. This audit data is important when there are issues, such as security incidents, that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to know the outcome of the event.</td>
      <td>Without establishing what type of events occurred, the source of events, where events occurred, and the outcome of events, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.<br><br>Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.<br><br>Enriched logging aids in making sense of who, what, and when events occur on a system. Without this, determining root cause of an event will be much more difficult.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records contain the audit event results. <br><br>Generate audit records and review the data to validate that the record does contain the event result. <br><br>If the container platform is not configured to generate audit records with&nbsp;&nbsp;the event result or the audit record does not contain the event result, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 audit system is configured to resolve audit information before writing to disk, with the following command:<br><br>$ sudo grep log_format /etc/audit/auditd.conf<br><br>log_format = ENRICHED<br><br>If the "log_format" option is not "ENRICHED", or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Edit the /etc/audit/auditd.conf file and add or update the "log_format" option:<br><br>log_format = ENRICHED<br><br>The audit daemon must be restarted for changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>18</th>
      <td></td>
      <td>CCI-001496,CCI-001487,CCI-001849,CCI-000140,CCI-000133,CCI-000134</td>
      <td>SRG-OS-000047-GPOS-00023,SRG-APP-000098-CTR-000185,SRG-APP-000099-CTR-000190,SRG-APP-000100-CTR-000195,SRG-APP-000100-CTR-000200,SRG-APP-000109-CTR-000215,SRG-APP-000290-CTR-000670,SRG-APP-000357-CTR-000800,SRG-APP-000400-CTR-000960,SRG-APP-000190-CTR-000500,SRG-APP-000505-CTR-001285</td>
      <td></td>
      <td>All audit records must generate the event results within the container platform.</td>
      <td></td>
      <td>Within the container platform, audit data can be generated from any of the deployed container platform components. This audit data is important when there are issues, such as security incidents, that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to know the outcome of the event.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records contain the audit event results. <br><br>Generate audit records and review the data to validate that the record does contain the event result. <br><br>If the container platform is not configured to generate audit records with&nbsp;&nbsp;the event result or the audit record does not contain the event result, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>19</th>
      <td></td>
      <td>CCI-001496,CCI-001487,CCI-001849,CCI-000140,CCI-000133,CCI-000134</td>
      <td>SRG-OS-000047-GPOS-00023,SRG-APP-000098-CTR-000185,SRG-APP-000099-CTR-000190,SRG-APP-000100-CTR-000195,SRG-APP-000100-CTR-000200,SRG-APP-000109-CTR-000215,SRG-APP-000290-CTR-000670,SRG-APP-000357-CTR-000800</td>
      <td></td>
      <td>All audit records must generate the event results within the container platform.</td>
      <td>The Red Hat OpenShift Container Platform 4 audit system must take appropriate action when the audit files have reached maximum size.</td>
      <td>Within the container platform, audit data can be generated from any of the deployed container platform components. This audit data is important when there are issues, such as security incidents, that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to know the outcome of the event.</td>
      <td>It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records contain the audit event results. <br><br>Generate audit records and review the data to validate that the record does contain the event result. <br><br>If the container platform is not configured to generate audit records with&nbsp;&nbsp;the event result or the audit record does not contain the event result, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 takes the appropriate action when the audit files have reached maximum size with the following command:<br><br>$ sudo grep max_log_file_action /etc/audit/auditd.conf<br><br>max_log_file_action = ROTATE<br><br>If the value of the "max_log_file_action" option is not "ROTATE", "SINGLE", or the line is commented out, ask the system administrator to indicate how the system takes appropriate action when an audit storage volume is full.&nbsp;&nbsp;If there is no evidence of appropriate action, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to rotate the audit log when it reaches maximum size.<br><br>Add or update the following line in "/etc/audit/auditd.conf" file:<br><br>max_log_file_action = ROTATE</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>20</th>
      <td></td>
      <td>CCI-000764</td>
      <td>SRG-APP-000148-CTR-000340</td>
      <td></td>
      <td>The container platform application program interface (API) must uniquely identify and authenticate users.</td>
      <td>Red Hat OpenShift Container Platform 4 application program interface (API) must uniquely identify and authenticate users.</td>
      <td>The container platform requires user accounts to perform container platform tasks. These tasks are often performed through the container platform API. Protecting the API from users who are not authorized or authenticated is essential to keep the container platform stable. Protection of platform and application data and enhances the protections put in place for Denial-of Service (DoS) attacks.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to determine if users are uniquely identified and authenticated before the API is executed. <br><br>If users are not uniquely identified or are not authenticated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/authentication/index.html</td>
      <td>Users of the OpenShift Platform must be uniquely identified and<br>authenticated in order to access the platform's console. Anonymous<br>users are prohibited, and authorization is enforced by the platform's<br>RBAC policies. Refer to<br>https://docs.openshift.com/container-platform/latest/authentication/index.html<br>for more information.</td>
    </tr>
    <tr>
      <th>21</th>
      <td></td>
      <td>CCI-000877</td>
      <td>SRG-APP-000185-CTR-000490</td>
      <td></td>
      <td>The container platform must employ strong authenticators in the establishment of non-local maintenance and diagnostic sessions.</td>
      <td>Red Hat OpenShift Container Platform 4 must employ strong authenticators in the establishment of non-local maintenance and diagnostic sessions.</td>
      <td>If maintenance tools are used by unauthorized personnel, they may accidentally or intentionally damage or compromise the system. The act of managing systems and applications includes the ability to access sensitive application information, such as, system configuration details, diagnostic information, user information, and potentially sensitive application data.<br><br>Non-local maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection. Typically, strong authentication requires authenticators that are resistant to replay attacks and employ multifactor authentication. Strong authenticators include, for example, PKI where certificates are stored on a token protected by a password, passphrase, or biometric.<br><br>This requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system (e.g., the software implementing "ping," "ls," "ipconfig," or the hardware and software implementing the monitoring port of an Ethernet switch).</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to employ strong authenticators in the establishment of non-local maintenance and diagnostic sessions. <br><br>If the container platform is not configured to employ strong authenticators in the establishment of non-local maintenance and diagnostic sessions, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>22</th>
      <td></td>
      <td>CCI-000765</td>
      <td>SRG-APP-000149-CTR-000355</td>
      <td></td>
      <td>The container platform must use multifactor authentication for network access to privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use multifactor authentication for network access to privileged accounts.</td>
      <td>Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased.<br><br>Multifactor authentication requires using two or more factors to achieve authentication.<br><br>Factors include: <br>(i) something a user knows (e.g., password/PIN); <br>(ii) something a user has (e.g., cryptographic identification device, token); or <br>(iii) something a user is (e.g., biometric).<br><br>A privileged account is defined as an information system account with authorizations of a privileged user.<br><br>Network access is defined as access to an information system by a user (or a process acting on behalf of a user) communicating through a network (e.g., local area network, wide area network, or the internet).</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to use multifactor authentication for network access to privileged accounts. <br><br>If the container platform does not use multifactor authentication for network access to privileged accounts, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>23</th>
      <td></td>
      <td>CCI-000018</td>
      <td>SRG-APP-000026-CTR-000070</td>
      <td></td>
      <td>The container platform must automatically audit account creation.</td>
      <td>Red Hat OpenShift Container Platform 4 must automatically audit account creation.</td>
      <td>Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to create a new account. Auditing of account creation is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail documents the creation of application user accounts and, as required, notifies administrators and/or application when accounts are created. Such a process greatly reduces the risk that accounts will be surreptitiously created, and provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are automatically created upon account creation. <br><br>If audit records are not automatically created upon account creation, this is a finding.</td>
      <td>Verify&nbsp;&nbsp;Red Hat Enterprise Linux CoreOS (RHCOS) generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/shadow".<br><br>Logging on as administrator, check the auditing rules in "/etc/audit/audit.rules" by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME: "; grep /etc/shadow /etc/audit/audit.rules /etc/audit/rules.d/*'; done<br><br>(Example output:<br>-w /etc/shadow -p wa -k identity)<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Apply the machine config using the following command:<br><br>for mcpool in $(oc get mcp -oname | sed "s:.*/::" ); do<br>echo "apiVersion: machineconfiguration.openshift.io/v1<br>kind: MachineConfig<br>metadata:<br>&nbsp;&nbsp;name: 75-account-modifications-rules-$mcpool<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;machineconfiguration.openshift.io/role: $mcpool<br>spec:<br>&nbsp;&nbsp;config:<br>&nbsp;&nbsp;&nbsp;&nbsp;ignition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version: 3.1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;storage:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/sudoers.d/%20-p%20wa%20-k%20actions%0A-w%20/etc/sudoers%20-p%20wa%20-k%20actions%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/75-audit-sysadmin-actions.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/group%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_group_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/gshadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_gshadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/security/opasswd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_security_opasswd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/passwd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_passwd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/shadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_shadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>" | oc apply -f -<br>done</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>24</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-000790</td>
      <td></td>
      <td>The container platform must provide the configuration for organization-identified individuals or roles to change the auditing to be performed on all components, based on all selectable event criteria within organization-defined time thresholds.</td>
      <td>Red Hat OpenShift Container Platform 4 must provide the configuration for organization-identified individuals or roles to change the auditing to be performed on all components, based on all selectable event criteria within organization-defined time thresholds.</td>
      <td>Auditing requirements may change per organization or situation within and organization. With the container platform allowing an organization to customize the auditing, an organization can decide to extend or limit auditing as necessary to meet organizational requirements. Auditing that is limited to conserve resources may be extended to address certain threat situations. In addition, auditing may be limited to a specific set of events to facilitate audit reduction, analysis, and reporting. Organizations can establish time thresholds in which audit actions are changed, for example, near real-time, within minutes, or within hours.<br><br>Modifying auditing within the container platform must be controlled to only those individuals or roles identified by the organization to modify auditable events.</td>
      <td></td>
      <td>Applicable - Does Not Meet</td>
      <td>Review documentation and configuration setting. <br><br>If the container platform does not provide the ability for users in authorized roles to reconfigure auditing at any time of the user's choosing, this is a finding. <br><br>If changes in audit configuration cannot take effect until after a certain time or date, or until some event, such as a server restart, has occurred, and if that time or event does not meet the requirements specified by the organization, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td>A way of mitigating the control is to set a verbose audit log level, forward the logs off-cluster and then filter or correlate the log information that are needed using SIEM tools such as Elastic.<br><br>Documentation regarding how to forward cluster logs using the&nbsp;&nbsp;Cluster Logging Operator to specific endpoints can be found at: <br>https://docs.openshift.com/container-platform/latest/logging/cluster-logging.html</td>
      <td></td>
      <td>Custom audit policies are not supported. However,&nbsp;&nbsp;the WriteRequestBodies (or even AllRequestBodies) policies should satisfy all the information the other controls ask for.<br>Red Hat OpenShift supports three different audit policies which are documented at https://docs.openshift.com/container-platform/4.7/security/audit-log-policy-config.html</td>
    </tr>
    <tr>
      <th>25</th>
      <td></td>
      <td>CCI-001764</td>
      <td>SRG-APP-000384-CTR-000915</td>
      <td>CCE-90670-1</td>
      <td>The container platform must prevent component execution in accordance with organization-defined policies regarding software program usage and restrictions, and/or rules authorizing the terms and conditions of software program usage.</td>
      <td>Red Hat OpenShift Container Platform 4 must prevent the installation of patches, service packs, device drivers, or operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.</td>
      <td>The container platform may offer components such as DNS services, firewall services, router services, or web services that are not required by every organization to meet their needs. Container platform components may also add capabilities that run counter to the mission or that provide users with functionality that exceeds mission requirements. To meet the requirements of an organization, the container platform must have a method to remove or disable components not required to meet the organization's mission.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration setting to determine if policies, rules, or restrictions exist regarding usage of container platform components. <br><br>If no such no restrictions are in place, this is not a finding. <br><br>Identify any components the organization requires to be disabled or removed and configure the container platform according to that policy. <br><br>If the container platform components are not disabled or removed according to the organization's policy, this is a finding.</td>
      <td>Run the following command to retrieve the Cluster Version objects in the system:<br>&gt; oc get clusterversion version<br>Make sure the Cluster Version Operator is installed and the AVAILABLE is True.</td>
      <td></td>
      <td>By default, the integrity of RH CoreOS is checked by cluster version operator on OpenShift platform. If the integrity is not verified, reinstall of the cluster may be necessary.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>26</th>
      <td></td>
      <td>CCI-001764</td>
      <td>SRG-APP-000384-CTR-000915</td>
      <td>CCE-90671-9</td>
      <td>The container platform must prevent component execution in accordance with organization-defined policies regarding software program usage and restrictions, and/or rules authorizing the terms and conditions of software program usage.</td>
      <td>Red Hat OpenShift Container Platform 4 must prevent the installation of patches, service packs, device drivers, or operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.</td>
      <td>The container platform may offer components such as DNS services, firewall services, router services, or web services that are not required by every organization to meet their needs. Container platform components may also add capabilities that run counter to the mission or that provide users with functionality that exceeds mission requirements. To meet the requirements of an organization, the container platform must have a method to remove or disable components not required to meet the organization's mission.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration setting to determine if policies, rules, or restrictions exist regarding usage of container platform components. <br><br>If no such no restrictions are in place, this is not a finding. <br><br>Identify any components the organization requires to be disabled or removed and configure the container platform according to that policy. <br><br>If the container platform components are not disabled or removed according to the organization's policy, this is a finding.</td>
      <td>Run the following command to retrieve the Cluster Version objects in the system:<br>&gt; oc get clusterversion version -o yaml<br>Make sure verified is true under status history for each item. If not, this is a finding.</td>
      <td></td>
      <td>By default, the integrity of RH CoreOS is checked by cluster version operator on OpenShift platform. If the integrity is not verified, reinstall of the cluster may be necessary.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>27</th>
      <td></td>
      <td>CCI-001855</td>
      <td>SRG-APP-000359-CTR-000810</td>
      <td></td>
      <td>The container platform must provide an immediate warning to the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity.</td>
      <td>Red Hat OpenShift Container Platform 4 must provide an immediate warning to the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity.</td>
      <td>If security personnel are not notified immediately upon storage volume utilization reaching 75 percent, they are unable to plan for storage capacity expansion.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it is configured to provide an immediate warning to the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity. <br><br>If the container platform is not configured to provide an immediate real-time alert, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not applicable - The location of the external logging server<br>used for audit log aggregation is outside the scope of OpenShift Container Platform<br>configuration. Because the configuration recommended in response to SRG-APP-000111-CTR-000220<br>configures an external log aggregation server outside of the control of the OpenShift<br>cluster, it is up to individual implementation to ensure that the location of that<br>log aggregation point meets other requirements.</td>
    </tr>
    <tr>
      <th>28</th>
      <td></td>
      <td>CCI-001749</td>
      <td>SRG-APP-000131-CTR-000280</td>
      <td></td>
      <td>The container platform must be built from verified packages.</td>
      <td>Red Hat OpenShift Container Platform 4 must be built from verified packages.</td>
      <td>It is important to patch and upgrade the container platform when patches and upgrades are available. More important is to get these patches and upgrades from a known source. To validate the authenticity of any patches and upgrades before installation, the container platform must check that the files are digitally signed by sources approved by the organization.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to verify it has been built from packages that are digitally signed by known and approved sources. <br><br>If the container platform was built from packages that are not digitally signed or are from unknown or non-approved sources, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://github.com/openshift/machine-config-operator/blob/master/docs/OSUpgrades.md#questions-and-answers</td>
      <td>Integrity of the OpenShift platform is handled to start by the cluster version operator. Today the CVO will by default GPG verify the integrity of the release image before applying it. The release image contains a sha256 digest of machine-os-content which is used by the MCO for updates. On the host, the container runtime podman verifies the integrity of that sha256 when pulling the image, before the MCO reads its content. Hence, there is end-to-end GPG-verified integrity for the operating system updates (as well as the rest of the cluster components which run as regular containers).<br><br>https://github.com/openshift/machine-config-operator/blob/master/docs/OSUpgrades.md#questions-and-answers</td>
    </tr>
    <tr>
      <th>29</th>
      <td></td>
      <td>CCI-001082</td>
      <td>SRG-APP-000211-CTR-000530</td>
      <td></td>
      <td>The container platform must separate user functionality (including user interface services) from information system management functionality.</td>
      <td>Red Hat OpenShift Container Platform 4 must separate user functionality (including user interface services) from information system management functionality.</td>
      <td>Separating user functionality from management functionality is a requirement for all the components within the container platform. Without the separation, users may have access to management functions that can degrade the container platform and the services being offered and can offer a method to bypass testing and validation of functions before introduced into a production environment.<br><br>The separation should be enforced by each component within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if management functionality is separated from user functionality. <br><br>Validate that the separation is also implemented within the components by trying to execute management functions for each component as a user. <br><br>If the container platform is not configured to separate management and user functionality or if component management and user functionality are not separated, this is a finding.</td>
      <td>Verify that root and core are the only user accounts on the nodes by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; cat /etc/passwd' 2&gt;/dev/null; done<br><br>The output will look something like<br><br>&lt;node_name&gt; root:x:0:0:root:/root:/bin/bash<br>core:x:1000:1000:CoreOS Admin:/var/home/core:/bin/bash<br>containers:x:993:995:User for housing the sub ID range for containers:/var/home/containers:/sbin/nologin<br><br>If there are any user accounts in addition to root, containers and core, this is a finding.<br><br>Verify the root and core users are set to disable password logon by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; grep -e "^root" -e "^core" /etc/shadow' 2&gt;/dev/null; done<br><br>The output will look something like<br>&lt;node_name&gt;<br>root:*:18367:0:99999:7:::<br>core:*:18939:0:99999:7:::<br><br>If the password entry has anything other than '*', this is a finding.</td>
      <td></td>
      <td>Disable and remove passwords from root and core accounts by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'usermod -p "*" root; usermod -p "*" core' 2&gt;/dev/null; done<br><br>Remove any additional user accounts from the nodes by executing the following:<br><br>oc debug node/&lt;node&gt; -- chroot /host /bin/bash -c 'userdel &lt;user&gt;'</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>30</th>
      <td></td>
      <td>CCI-002418</td>
      <td>SRG-APP-000439-CTR-001080</td>
      <td></td>
      <td>The application must protect the confidentiality and integrity of transmitted information.</td>
      <td>The application must protect the confidentiality and integrity of transmitted information.</td>
      <td>Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered. <br><br>This requirement applies only to those applications that either are distributed or can allow access to data non-locally. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, applications need to leverage transmission protection mechanisms, such as TLS, TLS VPNs, or IPsec.<br><br>Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification. Protecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review container platform configuration to determine if it is using a transmission method that maintains the confidentiality and integrity of information during transmission.<br><br>If a transmission method is not being used that maintains the confidentiality and integrity of the data, this is a finding.</td>
      <td>Verify that routes and ingress are using secured transmission ports and protocols by executing the following:<br><br>oc get routes --all-namespaces<br><br>Review the ingress ports, if the Ingress is not using a secure TLS transport, this is a finding.</td>
      <td></td>
      <td>Delete any Route or Ingress that does not use a secure transport.<br><br>oc delete route &lt;NAME&gt; -n &lt;NAMESPACE&gt;<br><br>or<br><br>oc delete ingress &lt;NAME&gt; -n &lt;NAMESPACE&gt;</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>31</th>
      <td></td>
      <td>CCI-001133,CCI-000764</td>
      <td>SRG-OS-000109-GPOS-00056,SRG-OS-000480-GPOS-00227,SRG-APP-000148-CTR-000335,SRG-APP-000190-CTR-000500</td>
      <td></td>
      <td>The container platform must uniquely identify and authenticate users.</td>
      <td>Red Hat OpenShift Container Platform 4 must not permit direct logons to the root account using remote access via SSH.</td>
      <td>The container platform requires user accounts to perform container platform tasks. These tasks may pertain to the overall container platform or may be component-specific, thus requiring users to authenticate against those specific components. To ensure accountability and prevent unauthenticated access, users must be identified and authenticated to prevent potential misuse and compromise of the system.</td>
      <td>Even though the communications channel may be encrypted, an additional layer of security is gained by extending the policy of not logging directly on as root. In addition, logging in with a user-specific account provides individual accountability of actions performed on the system and also helps to minimize direct attack attempts on root's password.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if users are uniquely identified and authenticated. <br><br>If users are not uniquely identified or are not authenticated, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 remote access using SSH prevents users from logging on directly as "root" with the following command:<br><br>$ sudo /usr/sbin/sshd -dd 2&gt;&amp;1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '<br>' ' ' | xargs sudo grep -iH '^\s*permitrootlogin'<br><br>PermitRootLogin no<br><br>If the "PermitRootLogin" keyword is set to any value other than "no", is missing, or is commented out, this is a finding.</td>
      <td></td>
      <td>To configure the system to prevent SSH users from logging on directly as root add or modify the following line in "/etc/ssh/sshd_config" or in a file in "/etc/ssh/sshd_config.d".<br><br>PermitRootLogin no<br><br>Restart the SSH daemon for the settings to take effect:<br><br>$ sudo systemctl restart sshd.service</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32</th>
      <td></td>
      <td>CCI-002234,CCI-001814</td>
      <td>SRG-OS-000326-GPOS-00126,SRG-OS-000327-GPOS-00127,SRG-APP-000343-CTR-000780,SRG-APP-000381-CTR-000905,SRG-OS-000755-GPOS-00220</td>
      <td></td>
      <td>The container platform must enforce access restrictions and support auditing of the enforcement actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit uses of the "execve" system call.</td>
      <td>Auditing the enforcement of access restrictions against changes to the container platform helps identify attacks and provides forensic data for investigation for after-the-fact actions. Attempts to change configurations, components, or data maintained by a component (e.g., images in the registry, running containers in the runtime, or keys in the keystore) must be audited. <br><br>Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.</td>
      <td>Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.</td>
      <td>Applicable - Configurable</td>
      <td>Review container platform documentation and logs to determine if enforcement actions used to restrict access associated with changes to the container platform are logged. <br><br>If these actions are not logged, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "execve" system call with the following command:<br><br>$ sudo auditctl -l | grep execve<br><br>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv<br>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv<br>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv<br>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv<br><br>If the command does not return all lines, or the lines are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to audit the execution of the "execve" system call.<br><br>Add or update the following file system rules to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv<br>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv<br>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv<br>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>33</th>
      <td></td>
      <td>CCI-001686</td>
      <td>SRG-APP-000294-CTR-000690,SRG-APP-000291-CTR-000675,SRG-APP-000319-CTR-000745,SRG-APP-000293-CTR-000685,SRG-APP-000292-CTR-000680,SRG-APP-000509-CTR-001305,SRG-APP-000028-CTR-000080,SRG-APP-000320-CTR-000750</td>
      <td></td>
      <td>The container platform must notify system administrators and ISSO for account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit rules to capture account creation, modification, disabling, removal and enabling actions.</td>
      <td>When application accounts are removed, user accessibility is affected. Accounts are utilized for identifying users or for identifying the application processes themselves. Sending notification of account removal events to the system administrator and ISSO is one method for mitigating this risk. Such a capability greatly reduces the risk that application accessibility will be negatively affected for extended periods of time, and provides logging that can be used for forensic purposes.<br><br>To address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if system administrators and ISSO are notified when accounts are removed. <br><br>If system administrators and ISSO are not notified, this is a finding.</td>
      <td>Verify the audit rules capture account creation, modification, disabling, removal and enabling actions by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; grep -e user-modify -e group-modify -e audit_rules_usergroup_modification /etc/audit/rules.d/* /etc/audit/audit.rules' 2&gt;/dev/null; done<br><br>Confirm the following rules exist on each node:<br>-w /etc/group -p wa -k audit_rules_usergroup_modification<br>-w /etc/gshadow -p wa -k audit_rules_usergroup_modification<br>-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification<br>-w /etc/passwd -p wa -k audit_rules_usergroup_modification<br>-w /etc/shadow -p wa -k audit_rules_usergroup_modification<br><br>If the above rules are not listed on each node, this is a finding.</td>
      <td></td>
      <td>Apply the machine config using the following command:<br><br>for mcpool in $(oc get mcp -oname | sed "s:.*/::" ); do<br>echo "apiVersion: machineconfiguration.openshift.io/v1<br>kind: MachineConfig<br>metadata:<br>&nbsp;&nbsp;name: 75-account-modifications-rules-$mcpool<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;machineconfiguration.openshift.io/role: $mcpool<br>spec:<br>&nbsp;&nbsp;config:<br>&nbsp;&nbsp;&nbsp;&nbsp;ignition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version: 3.1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;storage:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/sudoers.d/%20-p%20wa%20-k%20actions%0A-w%20/etc/sudoers%20-p%20wa%20-k%20actions%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/75-audit-sysadmin-actions.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/group%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_group_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/gshadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_gshadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/security/opasswd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_security_opasswd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/passwd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_passwd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/shadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_shadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>" | oc apply -f -<br>done</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>34</th>
      <td></td>
      <td>CCI-000193</td>
      <td>SRG-APP-000167-CTR-000415</td>
      <td></td>
      <td>The container platform must enforce password complexity by requiring that at least one lowercase character be used.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce password complexity by requiring that at least one lowercase character be used.</td>
      <td>Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.<br><br>Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces password complexity by requiring that at least one lowercase character be used. <br><br>If the container platform does not enforce password complexity by requiring that at least one lowercase character be used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>35</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000471-GPOS-00215,SRG-OS-000474-GPOS-00219,SRG-OS-000466-GPOS-00210,SRG-OS-000468-GPOS-00212,SRG-OS-000064-GPOS-00033,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lremovexattr system calls.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "setxattr", "fsetxattr", "lsetxattr", "removexattr", "fremovexattr", and "lremovexattr" system calls with the following command:<br><br>$ sudo auditctl -l | grep xattr<br><br>-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod<br>-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod<br><br>If both the "b32" and "b64" audit rules are not defined for the "chmod", "fchmod", and "fchmodat" syscalls "setxattr", "fsetxattr", "lsetxattr", "removexattr", "fremovexattr", and "lremovexattr" ssytem calls, or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to audit the execution of the "setxattr", "fsetxattr", "lsetxattr", "removexattr", "fremovexattr", and "lremovexattr" system calls by adding or updating the following lines to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod<br>-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>36</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000466-GPOS-00210,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000474-GPOS-00219,SRG-OS-000064-GPOS-00033,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Successful/unsuccessful uses of the fsetxattr system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> fsetxattr&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "fsetxattr" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "fsetxattr" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "fremovexattr", "lremovexattr", "removexattr", "fsetxattr", "lsetxattr" and "setxattr".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>37</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000474-GPOS-00219,SRG-OS-000466-GPOS-00210,SRG-OS-000064-GPOS-00033,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Successful/unsuccessful uses of the lremovexattr system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> lremovexattr&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "lremovexattr" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "lremovexattr" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "fremovexattr", "lremovexattr", "removexattr", "fsetxattr", "lsetxattr" and "setxattr".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>38</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000466-GPOS-00210,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000474-GPOS-00219,SRG-OS-000064-GPOS-00033,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Successful/unsuccessful uses of the lsetxattr system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> lsetxattr&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "lsetxattr" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "lsetxattr" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "fremovexattr", "lremovexattr", "removexattr", "fsetxattr", "lsetxattr" and "setxattr".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>39</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000474-GPOS-00219,SRG-OS-000466-GPOS-00210,SRG-OS-000064-GPOS-00033,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Successful/unsuccessful uses of the removexattr system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> removexattr&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "removexattr" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "removexattr" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "fremovexattr", "lremovexattr", "removexattr", "fsetxattr", "lsetxattr" and "setxattr".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>40</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chcon command.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "chcon" command with the following command:<br><br>$ sudo auditctl -l | grep chcon<br><br>-a always,exit -S all -F path=/usr/bin/chcon -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chcon" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>41</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the semanage command.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "semanage" command with the following command:<br><br>$ sudo auditctl -l | grep semanage<br><br>-a always,exit -S all -F path=/usr/sbin/semanage -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "semanage" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>42</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the setfiles command.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "setfiles" command with the following command:<br><br>$ sudo auditctl -l | grep setfiles<br><br>-a always,exit -S all -F path=/usr/sbin/setfiles -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "setfiles" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>43</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the setsebool command.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "setsebool" command with the following command:<br><br>$ sudo auditctl -l | grep setsebool<br><br>-a always,exit -S all -F path=/usr/sbin/setsebool -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate an audit event for any successful/unsuccessful use of the "setsebool " command by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br><br>-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>44</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000496-CTR-001240,SRG-APP-000497-CTR-001245,SRG-APP-000498-CTR-001250,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify security levels occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.</td>
      <td>Unauthorized users could modify the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can modify security levels unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify security levels. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/security/opasswd" with the following command:<br><br>$ sudo auditctl -l | egrep '(/etc/security/opasswd)'<br><br>-a always,exit -F arch=b32 -F path=/etc/security/opasswd -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=(/etc/security/opasswd -F perm=wa -F key=identity<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/security/opasswd".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/security/opasswd -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=(/etc/security/opasswd -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>45</th>
      <td></td>
      <td>CCI-001453,CCI-000068</td>
      <td>SRG-APP-000014-CTR-000040,SRG-APP-000560-CTR-001340</td>
      <td>CCE-86232-6</td>
      <td>The container platform must prohibit communication using TLS versions 1.0 and 1.1, and SSL 2.0 and 3.0.</td>
      <td>Red Hat OpenShift Container Platform 4 must use TLS 1.2 or greater for<br>secure communication.</td>
      <td>The container platform and its components will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.<br><br>The use of unsupported protocol exposes vulnerabilities to the container platform by rogue traffic interceptions, man-in-the middle-attacks, and impersonation of users or services from the container platform runtime, registry, and keystore.<br><br>The container platform and its components will adhere to NIST 800-52R2.</td>
      <td>The authenticity and integrity of the container platform and communication<br>between nodes and components must be secure. If an insecure protocol<br>is used during transmission of data, the data can be intercepted and<br>manipulated. The manipulation of data can be used to inject status changes<br>of the container platform, causing the execution of containers or reporting<br>an incorrect healthcheck. To thwart the manipulation of the data during<br>transmission, a secure protocol (TLS 1.2 or newer) must be used. Further<br>guidance on secure transport protocols can be found in NIST SP 800-52.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 are prohibited for communication. <br><br>If communication using TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 is permitted, this is a finding.</td>
      <td>Verify that the control plane TLS Security Profile is not set to old,<br>or a custom profile that does not enforce TLS 1.2 or above.<br><br>&gt; oc get APIServer cluster -o jsonpath='{.spec.tlsSecurityProfile}'<br><br>If the above returns a TLS profile of "Old", this is a finding.<br><br>If the above returns a TLS profile of "Custom" and the minTLSVersion<br>is not set to "VersionTLS12" or greater, this is a finding.</td>
      <td></td>
      <td>Edit the apiserver/cluster resource and set the TLS Security Profile to Intermediate<br><br>&gt; oc edit APIServer cluster<br><br>set to the following<br><br>apiVersion: config.openshift.io/v1<br>kind: APIServer<br>...<br>spec:<br>&nbsp;&nbsp;tlsSecurityProfile:<br>&nbsp;&nbsp;&nbsp;&nbsp;intermediate: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;type: Intermediate</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>46</th>
      <td></td>
      <td>CCI-001453,CCI-000068</td>
      <td>SRG-APP-000014-CTR-000040,SRG-APP-000560-CTR-001340</td>
      <td>CCE-86623-6</td>
      <td>The container platform must prohibit communication using TLS versions 1.0 and 1.1, and SSL 2.0 and 3.0.</td>
      <td>Red Hat OpenShift Container Platform 4 must use TLS 1.2 or greater for<br>secure communication.</td>
      <td>The container platform and its components will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.<br><br>The use of unsupported protocol exposes vulnerabilities to the container platform by rogue traffic interceptions, man-in-the middle-attacks, and impersonation of users or services from the container platform runtime, registry, and keystore.<br><br>The container platform and its components will adhere to NIST 800-52R2.</td>
      <td>The authenticity and integrity of the container platform and communication<br>between nodes and components must be secure. If an insecure protocol<br>is used during transmission of data, the data can be intercepted and<br>manipulated. The manipulation of data can be used to inject status changes<br>of the container platform, causing the execution of containers or reporting<br>an incorrect healthcheck. To thwart the manipulation of the data during<br>transmission, a secure protocol (TLS 1.2 or newer) must be used. Further<br>guidance on secure transport protocols can be found in NIST SP 800-52.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 are prohibited for communication. <br><br>If communication using TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 is permitted, this is a finding.</td>
      <td>Verify that the Kubelet TLS Security Profile is not set to old, or a custom<br>profile that does not enforce TLS 1.2 or above.<br>&gt; oc get KubeletConfigs -o \<br>jsonpath='{range .items[]} Name: {.metadata.name} Profile: {.spec.tlsSecurityProfile}{"<br>"}'<br><br>If the above returns a TLS profile of "Old", this is a finding.<br><br>If the above returns a TLS profile of "Custom" and the minTLSVersion<br>is not set to "VersionTLS12" or greater, this is a finding.</td>
      <td></td>
      <td>Edit the KubeletConfig and set the TLS Security Profile to Intermediate<br><br>&gt; oc edit KubeletConfig&nbsp;&nbsp;<br><br>set to the following<br><br>apiVersion: config.openshift.io/v1<br>kind: KubeletConfig<br>...<br>spec:<br>&nbsp;&nbsp;tlsSecurityProfile:<br>&nbsp;&nbsp;&nbsp;&nbsp;intermediate: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;type: Intermediate</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>47</th>
      <td></td>
      <td>CCI-001453,CCI-000068</td>
      <td>SRG-APP-000014-CTR-000040,SRG-APP-000560-CTR-001340</td>
      <td>CCE-86234-2</td>
      <td>The container platform must prohibit communication using TLS versions 1.0 and 1.1, and SSL 2.0 and 3.0.</td>
      <td>Red Hat OpenShift Container Platform 4 must use TLS 1.2 or greater for<br>secure communication.</td>
      <td>The container platform and its components will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.<br><br>The use of unsupported protocol exposes vulnerabilities to the container platform by rogue traffic interceptions, man-in-the middle-attacks, and impersonation of users or services from the container platform runtime, registry, and keystore.<br><br>The container platform and its components will adhere to NIST 800-52R2.</td>
      <td>The authenticity and integrity of the container platform and communication<br>between nodes and components must be secure. If an insecure protocol<br>is used during transmission of data, the data can be intercepted and<br>manipulated. The manipulation of data can be used to inject status changes<br>of the container platform, causing the execution of containers or reporting<br>an incorrect healthcheck. To thwart the manipulation of the data during<br>transmission, a secure protocol (TLS 1.2 or newer) must be used. Further<br>guidance on secure transport protocols can be found in NIST SP 800-52.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 are prohibited for communication. <br><br>If communication using TLS versions 1.0 and 1.1, SSL 2.0 and 3.0 is permitted, this is a finding.</td>
      <td>Verify that IngressController TLS Security Profile is not set to old, or a custom<br>profile that does not enforce TLS 1.2 or above.<br><br>&gt; oc get IngressControllers -nopenshift-ingress-operator -o \<br>jsonpath='{range.items[]} Name: {.metadata.name} Profile: {.spec.tlsSecurityProfile}{"<br>"}'<br><br>If the above returns a TLS profile of "Old", this is a finding.<br><br>If the above returns a TLS profile of "Custom" and the minTLSVersion<br>is not set to "VersionTLS12" or greater, this is a finding.</td>
      <td></td>
      <td>Edit each resource and set the TLS Security Profile to Intermediate<br><br>&gt; oc edit ingresscontroller&nbsp;&nbsp; -nopenshift-ingress-operator<br><br>set to the following<br><br>apiVersion: config.openshift.io/v1<br>kind: IngressController<br>...<br>spec:<br>&nbsp;&nbsp;tlsSecurityProfile:<br>&nbsp;&nbsp;&nbsp;&nbsp;intermediate: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;type: Intermediate</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>48</th>
      <td></td>
      <td>CCI-000764</td>
      <td>SRG-APP-000148-CTR-000345</td>
      <td></td>
      <td>The container platform must uniquely identify and authenticate processes acting on behalf of the users.</td>
      <td>Red Hat OpenShift Container Platform 4 must uniquely identify and authenticate processes acting on behalf of the users.</td>
      <td>The container platform will instantiate a container image and use the user privileges given to the user used to execute the container. To ensure accountability and prevent unauthenticated access to containers, the user the container is using to execute must be uniquely identified and authenticated to prevent potential misuse and compromise of the system.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to determine if processes acting on behalf of users are uniquely identified and authenticated. <br><br>If processes acting on behalf of users are not uniquely identified or are not authenticated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation:<br>https://cloud.redhat.com/blog/a-guide-to-openshift-and-uids</td>
      <td>OpenShift does not execute containers with a user's account, as users<br>of OpenShift do not have accounts on the host operating system. Pods<br>are executed using UIDs that do not exist on the system and have no<br>privileges on the host system at all. It is deliberately isolated<br>further per logical namespace to allow for a mapping of UIDs to<br>applications within the context of the API, without allowing for UID<br>collision across logical namespaces.<br><br>For more background information, see: https://cloud.redhat.com/blog/a-guide-to-openshift-and-uids</td>
    </tr>
    <tr>
      <th>49</th>
      <td></td>
      <td>CCI-000381,CCI-000877</td>
      <td>SRG-APP-000185-CTR-000490,SRG-APP-000141-CTR-000315</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td></td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>50</th>
      <td></td>
      <td>CCI-000381</td>
      <td>SRG-OS-000114-GPOS-00059,SRG-OS-000378-GPOS-00163,SRG-OS-000480-GPOS-00227,SRG-APP-000141-CTR-000315</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td>Red Hat OpenShift Container Platform 4 must be configured to disable USB mass storage.</td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td>USB mass storage permits easy introduction of unknown devices, thereby facilitating malicious activity.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 disables the ability to load the USB Storage kernel module with the following command:<br><br>$ grep -r usb-storage /etc/modprobe.conf /etc/modprobe.d/*<br><br>install usb-storage /bin/false<br>blacklist usb-storage<br><br>If the command does not return any output, or either line is commented out, and use of USB Storage is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.</td>
      <td></td>
      <td>To configure the system to prevent the usb-storage kernel module from being loaded, add the following lines to the file "/etc/modprobe.d/usb-storage.conf" (or create "usb-storage.conf" if it does not exist):<br><br>install usb-storage /bin/false<br>blacklist usb-storage</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>51</th>
      <td></td>
      <td>CCI-000381</td>
      <td>SRG-OS-000378-GPOS-00163,SRG-APP-000141-CTR-000315</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td>Red Hat OpenShift Container Platform 4 must have the USBGuard package installed.</td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td>The USBguard-daemon is the main component of the USBGuard software framework. It runs as a service in the background and enforces the USB device authorization policy for all USB devices. The policy is defined by a set of rules using a rule language described in the usbguard-rules.conf file. The policy and the authorization state of USB devices can be modified during runtime using the usbguard tool.<br><br>The system administrator (SA) must work with the site information system security officer (ISSO) to determine a list of authorized peripherals and establish rules within the USBGuard software framework to allow only authorized devices.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td>Verify USBGuard is installed on the operating system with the following command:<br><br>$ sudo dnf list installed usbguard<br><br>Example output:<br><br>Installed Packages<br>usbguard.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0.0-10.el9_1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@rhel-9-for-x86_64-appstream-rpms<br><br>If the USBGuard package is not installed, ask the SA to indicate how unauthorized peripherals are being blocked.<br><br>If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.<br><br>If the system is virtual machine with no virtual or physical USB peripherals attached, this is not a finding.</td>
      <td></td>
      <td>Install the usbguard package with the following command:<br><br>$ sudo dnf install usbguard<br><br>Enable the service to start on boot and then start it with the following commands:<br>$ sudo systemctl enable usbguard<br>$ sudo systemctl start usbguard<br><br>Verify the status of the service with the following command:<br>$ sudo systemctl status usbguard<br><br>Note: usbguard will need to be configured to allow authorized devices once it is enabled on Red Hat OpenShift Container Platform 4.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>52</th>
      <td></td>
      <td>CCI-000381</td>
      <td>SRG-OS-000378-GPOS-00163,SRG-APP-000141-CTR-000315</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td>Red Hat OpenShift Container Platform 4 must have the USBGuard package enabled.</td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td>The USBguard-daemon is the main component of the USBGuard software framework. It runs as a service in the background and enforces the USB device authorization policy for all USB devices. The policy is defined by a set of rules using a rule language described in the usbguard-rules.conf file. The policy and the authorization state of USB devices can be modified during runtime using the usbguard tool.<br><br>The system administrator (SA) must work with the site information system security officer (ISSO) to determine a list of authorized peripherals and establish rules within the USBGuard software framework to allow only authorized devices.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 has USBGuard enabled with the following command:<br><br>$ systemctl is-active usbguard<br><br>active<br><br>If usbguard is not active, ask the SA to indicate how unauthorized peripherals are being blocked.<br><br>If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.<br><br>If the system is virtual machine with no virtual or physical USB peripherals attached, this is not a finding.</td>
      <td></td>
      <td>To enable the USBGuard service run the following command:<br><br>$ sudo systemctl enable --now usbguard</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>53</th>
      <td></td>
      <td>CCI-000381</td>
      <td>SRG-OS-000062-GPOS-00031,SRG-OS-000471-GPOS-00215,SRG-APP-000141-CTR-000315</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td>Red Hat OpenShift Container Platform 4 must enable Linux audit logging for the USBGuard daemon.</td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td>Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>If auditing is enabled late in the startup process, the actions of some startup processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.<br><br>DOD has defined the list of events for which Red Hat OpenShift Container Platform 4 will provide an audit record generation capability as the following:<br><br>1) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);<br><br>2) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system;<br><br>3) All account creations, modifications, disabling, and terminations; and<br><br>4) All kernel module load, unload, and restart actions.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td>To verify that Linux Audit logging is enabled for the USBGuard daemon with the following command:<br><br>$ sudo grep AuditBackend /etc/usbguard/usbguard-daemon.conf<br><br>AuditBackend=LinuxAudit<br><br>If "AuditBackend" is not set to "LinuxAudit", this is a finding.<br><br>If the system is virtual machine with no virtual or physical USB peripherals attached, this is not a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 USBGuard AuditBackend to use the audit system.<br><br>Add or edit the following line in /etc/usbguard/usbguard-daemon.conf<br><br>AuditBackend=LinuxAudit</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>54</th>
      <td></td>
      <td>CCI-001464</td>
      <td>SRG-OS-000114-GPOS-00059,SRG-APP-000092-CTR-000165</td>
      <td></td>
      <td>The container platform must be configured with only essential configurations.</td>
      <td></td>
      <td>The container platform can be built with components that are not used for the intended purpose of the organization. To limit the attack surface of the container platform, it is essential that the non-essential services are not installed.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and verify that only those components needed for operation are installed. <br><br>If components are installed that are not used for the intended purpose of the organization, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>55</th>
      <td></td>
      <td>CCI-002009</td>
      <td>SRG-APP-000402-CTR-000970</td>
      <td></td>
      <td>The container platform must accept Personal Identity Verification (PIV) credentials from other federal agencies.</td>
      <td>Red Hat OpenShift Container Platform 4 must accept Personal Identity Verification (PIV) credentials from other federal agencies.</td>
      <td>Controlling access to the container platform and its components is paramount in having a secure and stable system. Validating users is the first step in controlling the access. Users may be validated by the overall container platform or they may be validated by each component. It is essential to accept PIV credentials from other federal agencies and eliminate the possibility of access being denied to authorized users.<br><br>PIV credentials are those credentials issued by federal agencies that conform to FIPS Publication 201 and supporting guidance documents. OMB Memorandum 11-11 requires federal agencies to continue implementing the requirements specified in HSPD-12 to enable agency-wide use of PIV credentials.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the documentation and configuration to determine if the container platform accepts PIV credentials from other federal agencies. <br><br>If the container platform does not accept other federal agency PIV credentials, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>56</th>
      <td></td>
      <td>CCI-000164,CCI-000163</td>
      <td>SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-APP-000119-CTR-000245,SRG-APP-000120-CTR-000250</td>
      <td></td>
      <td>The container platform must protect audit information from unauthorized modification.</td>
      <td>Red Hat OpenShift Container Platform 4 audit system must protect auditing rules from unauthorized change.</td>
      <td>If audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized modification.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions and limiting log data locations.<br><br>Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make access decisions regarding the modification of audit data.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td>Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.<br><br>Audit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit Red Hat OpenShift Container Platform 4 system activity.<br><br>In immutable mode, unauthorized users cannot execute changes to the audit system to potentially hide malicious activity and then put the audit rules back.&nbsp;&nbsp;A system reboot would be noticeable, and a system administrator could then investigate the unauthorized changes.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit log data is not protected from unauthorized modification, this is a finding.</td>
      <td>Verify the audit system prevents unauthorized changes with the following command:<br><br>$ sudo grep "^\s*[^#]" /etc/audit/audit.rules | tail -1<br><br>-e 2<br><br>If the audit system is not set to be immutable by adding the "-e 2" option to the end of "/etc/audit/audit.rules", this is a finding.</td>
      <td></td>
      <td>Configure the audit system to set the audit rules to be immutable by adding the following line to end of "/etc/audit/rules.d/audit.rules"<br><br>-e 2<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>57</th>
      <td></td>
      <td>CCI-000048</td>
      <td>SRG-APP-000068-CTR-000120</td>
      <td>CCE-84197-3</td>
      <td>The container platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>Red Hat OpenShift Container Platform 4 must display the Standard Mandatory<br>DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>The container platform has countless components where different access levels are needed. To control access, the user must first log in to the component and then be presented with a DoD-approved use notification banner before granting access to the component. This guarantees privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the Standard Mandatory DoD Notice and Consent Banner is configured to be displayed before granting access to platform components. <br><br>Log in to the container platform components and verify that the Standard Mandatory DoD&nbsp;&nbsp;Notice and Consent Banner is being displayed before granting access.<br><br>If the Standard Mandatory DoD Notice and Consent Banner is not configured or is not displayed before granting access to container platform components, this is a finding.</td>
      <td>Check whether a classification banner was configured by creating<br>a Console Notification CRD on OpenShift<br><br>&gt; oc get consolenotification classification-banner -o=jsonpath='{.spec.text}'<br><br>If the above does not return classification text to be displayed in the console,<br>this is a finding.</td>
      <td></td>
      <td>The following steps may be used to create a console classification banner.<br>Replace the text in the example below with an appropriate text.<br><br>cat &lt;&lt; EOF | oc apply -f -<br>apiVersion: console.openshift.io/v1<br>kind: ConsoleNotification<br>metadata:<br> name: classification-banner<br>spec:<br> text: Unclassified ##Classification Level<br> location: BannerTopBottom ##Other options are BannerBottom, BannerTopBottom<br> color: '#FFFFFF' ##Hexcode for white text color<br> backgroundColor: '#008000' ##Hexcode for banner background color<br>EOF</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>58</th>
      <td></td>
      <td>CCI-000048</td>
      <td>SRG-APP-000068-CTR-000120</td>
      <td>CCE-84198-1</td>
      <td>The container platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>Red Hat OpenShift Container Platform 4 must display the Standard Mandatory<br>DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>The container platform has countless components where different access levels are needed. To control access, the user must first log in to the component and then be presented with a DoD-approved use notification banner before granting access to the component. This guarantees privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the Standard Mandatory DoD Notice and Consent Banner is configured to be displayed before granting access to platform components. <br><br>Log in to the container platform components and verify that the Standard Mandatory DoD&nbsp;&nbsp;Notice and Consent Banner is being displayed before granting access.<br><br>If the Standard Mandatory DoD Notice and Consent Banner is not configured or is not displayed before granting access to container platform components, this is a finding.</td>
      <td>From a web browser, go to the Openshift web console to login (logout<br>if already logged in). Verify that the DOD notice and consent banner is<br>displayed before proceeding to the login page.<br><br>If the DOD notice and consent banner is not displayed, this is a finding.</td>
      <td></td>
      <td>The following steps may be used to provide a custom login page that will<br>display the DOD notice and consent banner. This will replace OpenShift's<br>default login page. Please note that depending on the number and type<br>of identity providers configured, it is possible that these pages will<br>not be used. If that is the case, then it is the responsibility of the<br>identity provider being used to display the DOD notice and consent banner.<br><br>1. Create a login page template<br><br>&gt; oc adm create-login-template &gt; login.html<br><br>2. Edit the template to add the DOD notice and consent banner by adding<br>the following lines at the end of the html body. In addition, any look<br>and feel customizations should also be applied to the pages.<br><br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.onload = function(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("You are accessing a U.S. Government (USG)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Information System (IS) that is provided for USG-authorized<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use only. By using this IS (which includes any device<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attached to this IS), you consent to the following<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conditions:<br><br>-The USG routinely intercepts and monitors<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;communications on this IS for purposes including, but<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not limited to, penetration testing, COMSEC monitoring,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network operations and defense, personnel misconduct<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(PM), law enforcement (LE), and counterintelligence (CI)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;investigations.<br><br>-At any time, the USG may inspect and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seize data stored on this IS.<br><br>-Communications using,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or data stored on, this IS are not private, are subject to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routine monitoring, interception, and search, and may be<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disclosed or used for any USG-authorized purpose.<br><br>-This<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS includes security measures (e.g., authentication and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access controls) to protect USG interests--not for your<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personal benefit or privacy.<br><br>-Notwithstanding the above,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using this IS does not constitute consent to PM, LE or<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CI investigative searching or monitoring of the content<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of privileged communications, or work product, related<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to personal representation or services by attorneys,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psychotherapists, or clergy, and their assistants. Such<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;communications and work product are private and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;confidential. See User Agreement for details.");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp; <br><br>3. Add custom login pages to OpenShift<br><br>&gt; oc create secret generic login-template --from-file=login.html -n openshift-config<br>&gt; oc patch oauths cluster --type='merge' -p '{"spec":{"templates":{"login":{"name":"login-template"}}}}'</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>59</th>
      <td></td>
      <td>CCI-000048</td>
      <td>SRG-APP-000068-CTR-000120</td>
      <td>CCE-90666-9</td>
      <td>The container platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>Red Hat OpenShift Container Platform 4 must display the Standard Mandatory<br>DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>The container platform has countless components where different access levels are needed. To control access, the user must first log in to the component and then be presented with a DoD-approved use notification banner before granting access to the component. This guarantees privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the Standard Mandatory DoD Notice and Consent Banner is configured to be displayed before granting access to platform components. <br><br>Log in to the container platform components and verify that the Standard Mandatory DoD&nbsp;&nbsp;Notice and Consent Banner is being displayed before granting access.<br><br>If the Standard Mandatory DoD Notice and Consent Banner is not configured or is not displayed before granting access to container platform components, this is a finding.</td>
      <td>From a web browser, go to the Openshift web console to login (logout<br>if already logged in). Verify that the DOD notice and consent banner is<br>displayed before proceeding to the login page.<br><br>If the DOD notice and consent banner is not displayed, this is a finding.</td>
      <td></td>
      <td>The following steps may be used to provide a custom provider selection<br>page that will display the DOD notice and consent banner. This will replace<br>OpenShift's default the login providers selection page. Please note<br>that depending on the number and type of identity providers configured,<br>it is possible that these pages will not be used. If that is the case,<br>then it is the responsibility of the identity provider being used to<br>display the DOD notice and consent banner.<br><br>1. Create a providers selection page template<br><br>&gt; oc adm create-provider-selection-template &gt; providers.html<br><br>2. Edit the template to add the DOD notice and consent banner by adding<br>the following lines at the end of the html body. In addition, any look<br>and feel customizations should also be applied to the pages.<br><br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.onload = function(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("You are accessing a U.S. Government (USG)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Information System (IS) that is provided for USG-authorized<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use only. By using this IS (which includes any device<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attached to this IS), you consent to the following<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conditions:<br><br>-The USG routinely intercepts and monitors<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;communications on this IS for purposes including, but<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not limited to, penetration testing, COMSEC monitoring,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network operations and defense, personnel misconduct<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(PM), law enforcement (LE), and counterintelligence (CI)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;investigations.<br><br>-At any time, the USG may inspect and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seize data stored on this IS.<br><br>-Communications using,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or data stored on, this IS are not private, are subject to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routine monitoring, interception, and search, and may be<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disclosed or used for any USG-authorized purpose.<br><br>-This<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS includes security measures (e.g., authentication and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access controls) to protect USG interests--not for your<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personal benefit or privacy.<br><br>-Notwithstanding the above,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using this IS does not constitute consent to PM, LE or<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CI investigative searching or monitoring of the content<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of privileged communications, or work product, related<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to personal representation or services by attorneys,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psychotherapists, or clergy, and their assistants. Such<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;communications and work product are private and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;confidential. See User Agreement for details.");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp; <br><br>3. Add custom providers selection to OpenShift<br><br>&gt; oc create secret generic providers-template --from-file=providers.html -n openshift-config<br>&gt; oc patch oauths cluster --type='merge' -p '{"spec":{"templates":{"providerSelection":{"name":"providers-template"}}}}'</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>60</th>
      <td></td>
      <td>CCI-000048</td>
      <td>SRG-APP-000068-CTR-000120</td>
      <td>CCE-84200-5</td>
      <td>The container platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>Red Hat OpenShift Container Platform 4 must display the Standard Mandatory<br>DoD Notice and Consent Banner before granting access to platform components.</td>
      <td>The container platform has countless components where different access levels are needed. To control access, the user must first log in to the component and then be presented with a DoD-approved use notification banner before granting access to the component. This guarantees privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the Standard Mandatory DoD Notice and Consent Banner is configured to be displayed before granting access to platform components. <br><br>Log in to the container platform components and verify that the Standard Mandatory DoD&nbsp;&nbsp;Notice and Consent Banner is being displayed before granting access.<br><br>If the Standard Mandatory DoD Notice and Consent Banner is not configured or is not displayed before granting access to container platform components, this is a finding.</td>
      <td>Login to OpenShift using the oc cli tool<br><br>&gt; oc login -u&nbsp;&nbsp;&nbsp;&nbsp;<br>enter password when prompted<br><br>If the DoD Notice and Consent Banner is not displayed, this is a finding.<br><br>Or<br><br>Verify that motd config map exists and contains the DoD Notice and Consent Banner<br><br>&gt; oc describe configmap/motd -n openshift<br><br>If the configmap does not exist, or it does not contain the DoD Notice<br>and Consent Banner text in the message data attribute, this is a finding.</td>
      <td></td>
      <td>The following command will create a configmap that displays the DOD notice<br>and consent banner when logging in using the OpenShift CLI tool (oc)<br><br>&gt; echo 'apiVersion: v1<br>kind: ConfigMap<br>metadata:<br>&nbsp;&nbsp;name: motd<br>&nbsp;&nbsp;namespace: openshift<br>data:<br>&nbsp;&nbsp;message: "You are accessing a U.S. Government (USG) Information System<br>&nbsp;&nbsp;(IS) that is provided for USG-authorized use only. By using this IS<br>&nbsp;&nbsp;(which includes any device attached to this IS), you consent to the<br>&nbsp;&nbsp;following conditions:<br><br>-The USG routinely intercepts and monitors<br>&nbsp;&nbsp;communications on this IS for purposes including, but not limited to,<br>&nbsp;&nbsp;penetration testing, COMSEC monitoring, network operations and defense,<br>&nbsp;&nbsp;personnel misconduct (PM), law enforcement (LE), and counterintelligence<br>&nbsp;&nbsp;(CI) investigations.<br><br>-At any time, the USG may inspect and seize data<br>&nbsp;&nbsp;stored on this IS.<br><br>-Communications using, or data stored on, this<br>&nbsp;&nbsp;IS are not private, are subject to routine monitoring, interception,<br>&nbsp;&nbsp;and search, and may be disclosed or used for any USG-authorized<br>&nbsp;&nbsp;purpose.<br><br>-This IS includes security measures (e.g., authentication<br>&nbsp;&nbsp;and access controls) to protect USG interests--not for your personal<br>&nbsp;&nbsp;benefit or privacy.<br><br>-Notwithstanding the above, using this IS<br>&nbsp;&nbsp;does not constitute consent to PM, LE or CI investigative searching<br>&nbsp;&nbsp;or monitoring of the content of privileged communications, or work<br>&nbsp;&nbsp;product, related to personal representation or services by attorneys,<br>&nbsp;&nbsp;psychotherapists, or clergy, and their assistants. Such communications<br>&nbsp;&nbsp;and work product are private and confidential. See User Agreement for<br>&nbsp;&nbsp;details."' | oc apply -f -</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>61</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000392-GPOS-00172,SRG-OS-000470-GPOS-00214,SRG-OS-000473-GPOS-00218,SRG-APP-000503-CTR-001275,SRG-APP-000506-CTR-001290</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /var/log/faillock.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/faillock" with the following command:<br><br>$ sudo auditctl -l | grep /var/log/faillock<br><br>-a always,exit -F arch=b32 -F path=/var/log/faillock -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/var/log/faillock -F perm=wa -F key=identity<br><br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/faillock".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/var/log/faillock -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/var/log/faillock -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>62</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000473-GPOS-00218,SRG-OS-000470-GPOS-00214,SRG-APP-000495-CTR-001235,SRG-APP-000503-CTR-001275,SRG-APP-000506-CTR-001290</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /var/log/lastlog.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/lastlog" with the following command:<br><br>$ sudo auditctl -l | grep /var/log/lastlog<br><br>-w /var/log/lastlog -p wa -k logins<br><br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/lastlog".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-w /var/log/lastlog -p wa -k logins<br><br><br>The audit daemon must be restarted for the changes to take effect.<br><br>$ sudo service auditd restart</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>63</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000392-GPOS-00172,SRG-OS-000470-GPOS-00214,SRG-OS-000473-GPOS-00218,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /var/log/tallylog.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/tallylog" with the following command:<br><br>$ sudo auditctl -l | grep /var/log/tallylog<br><br><br>-w /var/log/tallylog -p wa -k logins<br><br><br>If the command does not return a line, or the line is commented out, is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/var/log/tallylog".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-w /var/log/tallylog -p wa -k logins<br><br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>64</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/sudoers.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>The actions taken by system administrators must be audited to keep a record of what was executed on the system, as well as for accountability purposes. Editing the sudoers file may be sign of an attacker trying to establish persistent methods to a system, auditing the editing of the sudoers files mitigates this risk.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/sudoers" with the following command:<br><br>$ sudo auditctl -l | grep '/etc/sudoers[^.]'<br><br>-a always,exit -F arch=b32 -F path=/etc/sudoers -F perm=wa -F key=logins<br>-a always,exit -F arch=b64 -F path=/etc/sudoers -F perm=wa -F key=logins<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/sudoers".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/sudoers -F perm=wa -F key=logins<br>-a always,exit -F arch=b64 -F path=/etc/sudoers -F perm=wa -F key=logins<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>65</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/sudoers.d/ directory.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>The actions taken by system administrators must be audited to keep a record of what was executed on the system, as well as for accountability purposes. Editing the sudoers file may be sign of an attacker trying to establish persistent methods to a system, auditing the editing of the sudoers files mitigates this risk.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/sudoers.d/" with the following command:<br><br>$ sudo auditctl -l | grep /etc/sudoers.d<br><br>-a always,exit -F arch=b32 -F path=/etc/sudoers.d/ -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/sudoers.d/ -F perm=wa -F key=identity<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/sudoers.d/".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/sudoers.d/ -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/sudoers.d/ -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>66</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications must be investigated for legitimacy.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/group" with the following command:<br><br>$ sudo auditctl -l | egrep '(/etc/group)'<br><br>-a always,exit -F arch=b32 -F path=/etc/group -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/group -F perm=wa -F key=identity<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/group".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/group -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/group -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>67</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/gshadow" with the following command:<br><br>$ sudo auditctl -l | egrep '(/etc/gshadow)'<br><br>-a always,exit -F arch=b32 -F path=/etc/gshadow -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/gshadow -F perm=wa -F key=identity<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/gshadow".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/gshadow -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/gshadow -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>68</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000304-GPOS-00121,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-OS-000274-GPOS-00104,SRG-OS-000275-GPOS-00105,SRG-OS-000276-GPOS-00106,SRG-OS-000277-GPOS-00107,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/passwd" with the following command:<br><br>$ sudo auditctl -l | egrep '(/etc/passwd)'<br><br>-a always,exit -F arch=b32 -F path=/etc/passwd -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/passwd -F perm=wa -F key=identity<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/passwd".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/passwd -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/passwd -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>69</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000004-GPOS-00004,SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000304-GPOS-00121,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000466-GPOS-00210,SRG-OS-000476-GPOS-00221,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000503-CTR-001275</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful logon attempts occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.</td>
      <td>The container platform and its components must generate audit records when successful and unsuccessful logon attempts occur. The information system can determine if an account is compromised or is in the process of being compromised and can take actions to thwart the attack. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.</td>
      <td>In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for audit logon events. <br><br>Ensure audit policy for successful and unsuccessful logon events are enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If logon attempts do not generate log records, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/passwd with the following command:<br><br>$ sudo auditctl -l | egrep '(/etc/shadow)'<br><br>-a always,exit -F arch=b32 -F path=/etc/shadow -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/shadow -F perm=wa -F key=identity<br><br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records for all account creations, modifications, disabling, and termination events that affect "/etc/shadow".<br><br>Add or update the following file system rule to "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -F path=/etc/shadow -F perm=wa -F key=identity<br>-a always,exit -F arch=b64 -F path=/etc/shadow -F perm=wa -F key=identity<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>70</th>
      <td></td>
      <td>CCI-000382</td>
      <td>SRG-APP-000142-CTR-000330</td>
      <td>CCE-86255-7</td>
      <td>The container platform runtime must enforce the use of ports that are non-privileged.</td>
      <td>runtime must enforce the use of ports that are non-privileged.</td>
      <td>Privileged ports are those ports below 1024 and that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and the containers within the platform by performing the following checks:<br><br>1. Verify the container platform is configured to disallow the use of privileged ports by containers.<br>2. Validate all containers within the container platform are using non-privileged ports.<br>3. Attempt to instantiate a container image that uses a privileged port.<br><br>If the container platform is not configured to disallow the use of privileged ports, this is a finding.<br><br>If the container platform has containers using privileged ports, this is a finding.<br><br>If the container platform allows containers to be instantiated that use privileged ports, this is a finding.</td>
      <td>Identify any SCC policy that allows containers to access the host filesystem resources by running the following command<br><br>&gt; oc get scc -ojson | jq '.items[]|select(.allowHostDirVolumePlugin)|.metadata.name,{"Group:":.groups},{"User":.users}'<br><br>For each SCC listed, if any of those users or groups are anything other than the following, this is a finding:<br><br>&nbsp;&nbsp;* system:cluster-admins<br>&nbsp;&nbsp;* system:nodes<br>&nbsp;&nbsp;* system:masters<br>&nbsp;&nbsp;* system:admin<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:build-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:pv-recycler-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-machine-api:machine-api-termination-handler<br><br>The group "system:authenticated" is the default group for any authenticated user, this group should only be associated with the restricted profile. If this group is listed under any other SCC Policy, or the restricted SCC policy has been altered to allow any of the non-permitted actions, this is a finding.<br><br><br>Next, determine if there are any cluster roles or local roles that allow the use of use of non-permitted SCC policies.&nbsp;&nbsp;The following commands will print the Role's name and namespace, followed by a list of resource names and if that resource is an SCC.<br><br>&gt; oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>&gt; oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>Excluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.<br><br>examplePrivilegedRole<br>{<br>&nbsp;&nbsp;"scc": "privileged"<br>}<br><br>Finally, determine if there are any role bindings to cluster or local roles that allow use of non-permitted SCCs.<br><br>&gt; oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>&gt; oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>Where&nbsp;&nbsp; and&nbsp;&nbsp; are comma-separated lists of the roles allowing use of non-permitted SCC policies as identified above. For example:<br><br>... .roleRef.name == ("system:openshift:scc:privileged","system:openshift:scc:hostnetwork","system:openshift:scc:hostaccess") ...<br><br>Excluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.</td>
      <td></td>
      <td>For users and groups that are defined in the SCC policy, remove the users or groups by editing the corresponding SCC policy.<br><br>&gt; oc edit scc&nbsp;&nbsp;<br><br>The following instructions will remove the user or group from the cluster role binding for the SCC policy.<br><br>Remove user from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove a group from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-group&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove service account from the SCC Policy binding:<br><br>&gt; oc project&nbsp;&nbsp;<br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp; -z&nbsp;&nbsp;<br><br>Finally, remove any roles that allows use of non-permitted SCC policies (excluding platform defined roles)<br><br>&gt; oc delete clusterrole.rbac&nbsp;&nbsp;<br><br>or<br><br>&gt; oc delete role.rbac&nbsp;&nbsp; -n</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>71</th>
      <td></td>
      <td>CCI-000382</td>
      <td>SRG-APP-000142-CTR-000330</td>
      <td>CCE-86205-2</td>
      <td>The container platform runtime must enforce the use of ports that are non-privileged.</td>
      <td>runtime must enforce the use of ports that are non-privileged.</td>
      <td>Privileged ports are those ports below 1024 and that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and the containers within the platform by performing the following checks:<br><br>1. Verify the container platform is configured to disallow the use of privileged ports by containers.<br>2. Validate all containers within the container platform are using non-privileged ports.<br>3. Attempt to instantiate a container image that uses a privileged port.<br><br>If the container platform is not configured to disallow the use of privileged ports, this is a finding.<br><br>If the container platform has containers using privileged ports, this is a finding.<br><br>If the container platform allows containers to be instantiated that use privileged ports, this is a finding.</td>
      <td>Identify any SCC policy that allows containers to access the host ports by running the following command.<br><br>&gt; oc get scc -ojson | jq '.items[]|select(.allowHostPorts)|.metadata.name,{"Group:":.groups},{"User":.users}'<br><br>For each SCC listed, if any of those users or groups are anything other than the following, this is a finding:<br><br>&nbsp;&nbsp;* system:cluster-admins<br>&nbsp;&nbsp;* system:nodes<br>&nbsp;&nbsp;* system:masters<br>&nbsp;&nbsp;* system:admin<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:build-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:pv-recycler-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-machine-api:machine-api-termination-handler<br><br>The group "system:authenticated" is the default group for any authenticated user, this group should only be associated with the restricted profile. If this group is listed under any other SCC Policy, or the restricted SCC policy has been altered to allow any of the non-permitted actions, this is a finding.<br><br>Next, determine if there are any cluster roles or local roles that allow the use of use of non-permitted SCC policies.&nbsp;&nbsp;The following commands will print the Role's name and namespace, followed by a list of resource names and if that resource is an SCC.<br><br>&gt; oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>&gt; oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>Excluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.<br><br>examplePrivilegedRole<br>{<br>&nbsp;&nbsp;"scc": "privileged"<br>}<br><br>Finally, determine if there are any role bindings to cluster or local roles that allow use of non-permitted SCCs.<br><br>&gt; oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>&gt; oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>Where&nbsp;&nbsp; and&nbsp;&nbsp; are comma-separated lists of the roles allowing use of non-permitted SCC policies as identified above. For example:<br><br>... .roleRef.name == ("system:openshift:scc:privileged","system:openshift:scc:hostnetwork","system:openshift:scc:hostaccess") ...<br><br>Excluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.</td>
      <td></td>
      <td>For users and groups that are defined in the SCC policy, remove the users or groups by editing the corresponding SCC policy.<br><br>&gt; oc edit scc&nbsp;&nbsp;<br><br>The following instructions will remove the user or group from the cluster role binding for the SCC policy.<br><br>Remove user from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove a group from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-group&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove service account from the SCC Policy binding:<br><br>&gt; oc project&nbsp;&nbsp;<br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp; -z&nbsp;&nbsp;<br><br>Finally, remove any roles that allows use of non-permitted SCC policies (excluding platform defined roles)<br><br>&gt; oc delete clusterrole.rbac&nbsp;&nbsp;<br><br>or<br><br>&gt; oc delete role.rbac&nbsp;&nbsp; -n</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>72</th>
      <td></td>
      <td>CCI-000382</td>
      <td>SRG-APP-000142-CTR-000330</td>
      <td>CCE-83492-9</td>
      <td>The container platform runtime must enforce the use of ports that are non-privileged.</td>
      <td>runtime must enforce the use of ports that are non-privileged.</td>
      <td>Privileged ports are those ports below 1024 and that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and the containers within the platform by performing the following checks:<br><br>1. Verify the container platform is configured to disallow the use of privileged ports by containers.<br>2. Validate all containers within the container platform are using non-privileged ports.<br>3. Attempt to instantiate a container image that uses a privileged port.<br><br>If the container platform is not configured to disallow the use of privileged ports, this is a finding.<br><br>If the container platform has containers using privileged ports, this is a finding.<br><br>If the container platform allows containers to be instantiated that use privileged ports, this is a finding.</td>
      <td>Identify any SCC policy that allows containers to access the host network or filesystem resources, or allows privileged containers by running the following command. <br><br>&gt; oc get scc -ojson | jq '.items[]|select(.allowHostNetwork)|.metadata.name,{"Group:":.groups},{"User":.users}'<br><br>For each SCC listed, if any of those users or groups are anything other than the following, this is a finding:<br><br>&nbsp;&nbsp;* system:cluster-admins<br>&nbsp;&nbsp;* system:nodes<br>&nbsp;&nbsp;* system:masters<br>&nbsp;&nbsp;* system:admin<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:build-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-infra:pv-recycler-controller<br>&nbsp;&nbsp;* system:serviceaccount:openshift-machine-api:machine-api-termination-handler<br><br>The group "system:authenticated" is the default group for any authenticated user, this group should only be associated with the restricted profile. If this group is listed under any other SCC Policy, or the restricted SCC policy has been altered to allow any of the non-permitted actions, this is a finding.<br><br>Next, determine if there are any cluster roles or local roles that allow the use of use of non-permitted SCC policies.&nbsp;&nbsp;The following commands will print the Role's name and namespace, followed by a list of resource names and if that resource is an SCC.<br><br>&gt; oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>&gt; oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>Excluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.<br><br>examplePrivilegedRole<br>{<br>&nbsp;&nbsp;"scc": "privileged"<br>}<br><br>Finally, determine if there are any role bindings to cluster or local roles that allow use of non-permitted SCCs.<br><br>&gt; oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>&gt; oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>Where&nbsp;&nbsp; and&nbsp;&nbsp; are comma-separated lists of the roles allowing use of non-permitted SCC policies as identified above. For example:<br><br>... .roleRef.name == ("system:openshift:scc:privileged","system:openshift:scc:hostnetwork","system:openshift:scc:hostaccess") ...<br><br>Excluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.</td>
      <td></td>
      <td>For users and groups that are defined in the SCC policy, remove the users or groups by editing the corresponding SCC policy.<br><br>&gt; oc edit scc&nbsp;&nbsp;<br><br>The following instructions will remove the user or group from the cluster role binding for the SCC policy.<br><br>Remove user from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove a group from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-group&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove service account from the SCC Policy binding:<br><br>&gt; oc project&nbsp;&nbsp;<br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp; -z&nbsp;&nbsp;<br><br>Finally, remove any roles that allows use of non-permitted SCC policies (excluding platform defined roles)<br><br>&gt; oc delete clusterrole.rbac&nbsp;&nbsp;<br><br>or<br><br>&gt; oc delete role.rbac&nbsp;&nbsp; -n</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>73</th>
      <td></td>
      <td>CCI-000382,CCI-002233</td>
      <td>SRG-APP-000342-CTR-000775,SRG-APP-000142-CTR-000330</td>
      <td></td>
      <td>The container platform runtime must enforce the use of ports that are non-privileged.</td>
      <td>Container images instantiated by the container platform must execute using least privileges.</td>
      <td>Privileged ports are those ports below 1024 and that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration and the containers within the platform by performing the following checks:<br><br>1. Verify the container platform is configured to disallow the use of privileged ports by containers.<br>2. Validate all containers within the container platform are using non-privileged ports.<br>3. Attempt to instantiate a container image that uses a privileged port.<br><br>If the container platform is not configured to disallow the use of privileged ports, this is a finding.<br><br>If the container platform has containers using privileged ports, this is a finding.<br><br>If the container platform allows containers to be instantiated that use privileged ports, this is a finding.</td>
      <td>Inspect each SCC and the users and groups allowed to use it returned<br>from running the following command:<br> oc get scc -ojson | jq '.items[]|select(.allowPrivilegedContainer)|.metadata.name,{"Group:":.groups},{"User":.users}' <br><br>The group "system:authenticated" is the default group for any<br>authenticated user, this group should only be associated with the<br>restricted profile. If this group is listed under any other SCC Policy,<br>or the restricted SCC policy has been altered to allow any of the<br>non-permitted actions, this is a finding.<br><br>Next, determine if there are any cluster roles or local roles that allow<br>the use of use of non-permitted SCC policies.&nbsp;&nbsp;The following commands will<br>print the Role's name and namespace, followed by a list of resource names<br>and if that resource is an SCC.<br><br>&gt; oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>&gt; oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>Excluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.<br><br> <br>examplePrivilegedRole<br>{<br>&nbsp;&nbsp;"scc": "privileged"<br>}<br> <br><br>Finally, determine if there are any role bindings to cluster or local<br>roles that allow use of non-permitted SCCs.<br><br>&gt; oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br>&gt; oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>Where "CLUSTER_ROLE_LIST" and "LOCAL_ROLE_LIST" are<br>comma-separated lists of the roles allowing use of non-permitted SCC<br>policies as identified above. For example:<br><br> <br>... .roleRef.name == ("system:openshift:scc:privileged","system:openshift:scc:hostnetwork","system:openshift:scc:hostaccess") ...<br> <br><br>Excluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.</td>
      <td></td>
      <td>For users and groups that are defined in the SCC policy, remove the users or groups by editing the corresponding SCC policy.<br><br>&gt; oc edit scc&nbsp;&nbsp;<br><br>The following instructions will remove the user or group from the cluster role binding for the SCC policy.<br><br>Remove user from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove a group from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-group&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove service account from the SCC Policy binding:<br><br>&gt; oc project&nbsp;&nbsp;<br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp; -z&nbsp;&nbsp;<br><br>Finally, remove any roles that allows use of non-permitted SCC policies (excluding platform defined roles)<br><br>&gt; oc delete clusterrole.rbac&nbsp;&nbsp;<br><br>or<br><br>&gt; oc delete role.rbac&nbsp;&nbsp; -n</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>74</th>
      <td></td>
      <td>CCI-000171,CCI-000169,CCI-000135</td>
      <td>SRG-APP-000089-CTR-000150,SRG-APP-000090-CTR-000155,SRG-APP-000101-CTR-000205</td>
      <td>CCE-83577-7</td>
      <td>The container platform must generate audit records for all DoD-defined auditable events within all components in the platform.</td>
      <td>The container platform must generate audit records for all DoD-defined<br>auditable events within all components in the platform.</td>
      <td>Within the container platform, audit data can be generated from any of the deployed container platform components. This audit data is important when there are issues, including security incidents that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to have the appropriate and required data logged. To handle the need to log DoD-defined auditable events, the container platform must offer a mechanism to change and manage the events that are audited.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to generate audit records for all DoD-defined auditable events within all components in the platform. <br><br>Generate DoD-defined auditable events within all the components to determine if the events are being audited. <br><br>If the container platform is not configured to generate audit records for all DoD-defined auditable events within the components or the events are&nbsp;&nbsp;not generating audit records, this is a finding.</td>
      <td></td>
      <td></td>
      <td>As the cluster administrator, update the<br>APIServer.config.openshift.io/cluster object to set the profile to<br>the defined level of detail. For example, to configure the profile to<br>Write Request Bodies, meaning that all write requests to any API server<br>object are logged in their entirety, run the following command: <br><br>&gt; oc patch apiserver.config.openshift.io/cluster --type=merge \<br>-p '{"spec":{"audit": {"profile": "WriteRequestBodies"}}}'</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>75</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the rename,unlink,rmdir,renameat,renameat2 and unlinkat system calls.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit successful/unsuccessful attempts to use the "rename", "unlink", "rmdir", "renameat", "renameat2", and "unlinkat" system calls with the following command:<br><br>$ sudo auditctl -l | grep 'rename\|unlink\|rmdir'<br><br>-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,renameat2,unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S rename,unlink,rmdir,renameat,renameat2,unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br><br>If the command does not return an audit rule for "rename", "unlink", "rmdir", "renameat", and "unlinkat" or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate an audit event for any successful/unsuccessful use of the "rename", "unlink", "rmdir", "renameat", "renameat2", and "unlinkat" system calls by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br><br>-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,renameat2,unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S rename,unlink,rmdir,renameat,renameat2,unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>76</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Successful/unsuccessful uses of the renameat system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Auditing file deletions will create an audit trail for files that are removed<br>from the system. The audit trail could aid in system troubleshooting, as well as, detecting<br>malicious processes that attempt to delete log files to conceal their presence.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> renameat&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "renameat" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "renameat" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S renameat -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S renameat -F auid&gt;=1000 -F auid!=unset -k delete<br><br>It's allowed to group this system call within the same line as "rename", "unlink", "rmdir", "renameat", and "unlinkat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>77</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Successful/unsuccessful uses of the rmdir system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Auditing file deletions will create an audit trail for files that are removed<br>from the system. The audit trail could aid in system troubleshooting, as well as, detecting<br>malicious processes that attempt to delete log files to conceal their presence.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> rmdir&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "rmdir" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "rmdir" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S rmdir -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S rmdir -F auid&gt;=1000 -F auid!=unset -k delete<br><br>It's allowed to group this system call within the same line as "rename", "unlink", "rmdir", "renameat", "renameat2", and "unlinkat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>78</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Successful/unsuccessful uses of the unlink system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Auditing file deletions will create an audit trail for files that are removed<br>from the system. The audit trail could aid in system troubleshooting, as well as, detecting<br>malicious processes that attempt to delete log files to conceal their presence.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> unlink&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "unlink" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "unlink" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S unlink -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S unlink -F auid&gt;=1000 -F auid!=unset -k delete<br><br>It's allowed to group this system call within the same line as "rename", "unlink", "rmdir", "renameat", "renameat2" and "unlinkat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>79</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Successful/unsuccessful uses of the unlinkat system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Auditing file deletions will create an audit trail for files that are removed<br>from the system. The audit trail could aid in system troubleshooting, as well as, detecting<br>malicious processes that attempt to delete log files to conceal their presence.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> unlinkat&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "unlinkat" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "unlinkat" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br>-a always,exit -F arch=b64 -S unlinkat -F auid&gt;=1000 -F auid!=unset -k delete<br><br>It's allowed to group this system call within the same line as "rename", "unlink", "rmdir", "renameat", "renameat2" and "unlinkat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>80</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chage command.</td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "chage" command with the following command:<br><br>$ sudo auditctl -l | grep chage<br><br>-a always,exit -S all -F path=/usr/bin/chage -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-chage<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chage" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/chage -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-chage<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>81</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000042-GPOS-00020,SRG-OS-000392-GPOS-00172,SRG-OS-000471-GPOS-00215,SRG-APP-000499-CTR-001255,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>82</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000461-GPOS-00205,SRG-OS-000468-GPOS-00212,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>83</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000468-GPOS-00212,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>84</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000468-GPOS-00212,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>85</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000468-GPOS-00212,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>86</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000468-GPOS-00212,SRG-APP-000501-CTR-001265,SRG-APP-000502-CTR-001270</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to delete security objects occur.</td>
      <td></td>
      <td>Unauthorized users modify level the security levels to exploit vulnerabilities within the container platform component. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform. This must establish, correlate, and help assist with investigating the events relating to an incident, or identify those responsible.<br><br>Without audit record generation, unauthorized users can access delete security objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit records are generated on successful/unsuccessful attempts to delete security objects occur. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>87</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chmod, fchmod, and fchmodat syscalls.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "chmod", "fchmod", and "fchmodat" syscalls with the following command:<br><br>$ sudo auditctl -l | grep chmod<br><br>-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>If both the "b32" and "b64" audit rules are not defined for the "chmod", "fchmod", and "fchmodat" syscalls, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chmod", "fchmod", and "fchmodat" syscalls.<br><br>Add or update the following rules in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>88</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chown, fchown, fchownat, and lchown syscalls.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the&nbsp;&nbsp;"chown", "fchown", "fchownat", and "lchown" syscalls with the following command:<br><br>$ sudo auditctl -l | grep chown<br><br>-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>If both the "b32" and "b64" audit rules are not defined for the "chown", "fchown", "fchownat", and "lchown" syscalls, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chown", "fchown", "fchownat", and "lchown"" syscalls.<br><br>Add or update the following rules in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>89</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the fchmod system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> fchmod&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "fchmod" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "fchmod" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "chmod", "fchmod" and "fchmodat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>90</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the fchmodat system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> fchmodat&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "fchmodat" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "fchmodat" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "chmod", "fchmod" and "fchmodat".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>91</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the fchown system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> fchown&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "fchown" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "fchown" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S fchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S fchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "chown", "fchown", "fchownat" and "lchown".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>92</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the fchownat system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> fchownat&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "fchownat" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "fchownat" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "chown", "fchown", "fchownat" and "lchown".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>93</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000466-GPOS-00210,SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the lchown system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> lchown&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "lchown" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "lchown" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S lchown -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "chown", "fchown", "fchownat" and "lchown".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>94</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000466-GPOS-00210,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the setxattr system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to<br>gain access to information that would otherwise be disallowed. Auditing DAC modifications<br>can facilitate the identification of patterns of abuse among both authorized and<br>unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> setxattr&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "setxattr" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "setxattr" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>It's allowed to group this system call within the same line as "fremovexattr", "lremovexattr", "removexattr", "fsetxattr", "lsetxattr" and "setxattr".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>95</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the umount system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 generates an audit record for all uses of the "umount" and system call with the following command:<br><br>$ sudo auditctl -l | grep b32 | grep 'umount\b'<br><br>-a always,exit -F arch=b32 -S umount -F auid&gt;=1000 -F auid!=-1 -F key=privileged-umount<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "umount" system call by adding or updating the following rules in "/etc/audit/audit.rules" and adding the following rules to "/etc/audit/rules.d/perm_mod.rules" or updating the existing rules in files in the "/etc/audit/rules.d/" directory:<br><br>-a always,exit -F arch=b32 -S umount -F auid&gt;=1000 -F auid!=unset -k privileged-umount<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>96</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the umount2 system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the umount2 system call, run the following command:<br><br>$ sudo auditctl -l | grep umount2<br><br>-a always,exit -F arch=b64 -S umount2 -F auid&gt;=1000 -F auid!=-1 -F key=privileged-umount<br>-a always,exit -F arch=b32 -S umount2 -F auid&gt;=1000 -F auid!=-1 -F key=privileged-umount<br><br>If no line is returned, this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "umount2" system call by adding or updating the following rules in a file in "/etc/audit/rules.d".<br><br>-a always,exit -F arch=b32 -S umount2 -F auid&gt;=1000 -F auid!=unset -k privileged-umount<br>-a always,exit -F arch=b64 -S umount2 -F auid&gt;=1000 -F auid!=unset -k privileged-umount<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>97</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chacl command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "chacl" command with the following command:<br><br>$ sudo auditctl -l | grep chacl<br><br>-a always,exit -S all -F path=/usr/bin/chacl -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chacl" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>98</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the setfacl command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "setfacl" command with the following command:<br><br>$ sudo auditctl -l | grep setfacl<br><br>-a always,exit -S all -F path=/usr/bin/setfacl -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "setfacl" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid&gt;=1000 -F auid!=unset -k perm_mod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>99</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the truncate, ftruncate, creat, open, openat, and open_by_handle_at system calls.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit successful/unsuccessful attempts to use the "truncate", "ftruncate", "creat", "open", "openat", and "open_by_handle_at" system calls with the following command:<br><br>$ sudo auditctl -l | grep'open\|truncate\|creat'<br><br>-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>If the output does not produce rules containing "-F exit=-EPERM", this is a finding.<br>If the output does not produce rules containing "-F exit=-EACCES", this is a finding.<br>If the command does not return an audit rule for "truncate", "ftruncate", "creat", "open", "openat", and "open_by_handle_at" or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate an audit event for any successful/unsuccessful use of the "truncate", "ftruncate", "creat", "open", "openat", and "open_by_handle_at" system calls by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br><br>-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>100</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the ftruncate system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing<br>these events could serve as evidence of potential system compromise.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> ftruncate&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "ftruncate" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "ftruncate" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>It's allowed to group this system call within the same line as "creat", "ftruncate", "truncate", "open", "openat" and "open_by_handle_at".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>101</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the open system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing<br>these events could serve as evidence of potential system compromise.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> open&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "open" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "open" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>It's allowed to group this system call within the same line as "creat", "ftruncate", "truncate", "open", "openat" and "open_by_handle_at".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>102</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the open_by_handle_at system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing<br>these events could serve as evidence of potential system compromise.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> open_by_handle_at&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "open_by_handle_at" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "open_by_handle_at" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>It's allowed to group this system call within the same line as "creat", "ftruncate", "truncate", "open", "openat" and "open_by_handle_at".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>103</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the openat system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing<br>these events could serve as evidence of potential system compromise.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> openat&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "openat" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "openat" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>It's allowed to group this system call within the same line as "creat", "ftruncate", "truncate", "open", "openat" and "open_by_handle_at".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>104</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000064-GPOS-00033,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Successful/unsuccessful uses of the truncate system call in Red Hat OpenShift Container Platform 4 must generate an audit record.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing<br>these events could serve as evidence of potential system compromise.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> truncate&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "truncate" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td>Configure the audit system to generate an audit event for any successful/unsuccessful use of the "truncate" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br>-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br>-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k perm_access<br><br>It's allowed to group this system call within the same line as "creat", "ftruncate", "truncate", "open", "openat" and "open_by_handle_at".<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>105</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000477-GPOS-00222,SRG-APP-000495-CTR-001235,SRG-APP-000504-CTR-001280</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the delete_module system call.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "delete_module" system call with the following command:<br><br>$ sudo auditctl -l | grep delete_module<br><br>-a always,exit -F arch=b32 -S delete_module -F auid&gt;=1000 -F auid!=-1 -F key=module_chng<br>-a always,exit -F arch=b64 -S delete_module -F auid&gt;=1000 -F auid!=-1 -F key=module_chng<br><br>If both the "b32" and "b64" audit rules are not defined for the "delete_module" system call, or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate an audit event for any successful/unsuccessful use of the "delete_module" system call by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br><br>-a always,exit -F arch=b32 -S delete_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br>-a always,exit -F arch=b64 -S delete_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>106</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000477-GPOS-00222,SRG-APP-000495-CTR-001235,SRG-APP-000504-CTR-001280</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the init_module and finit_module system calls.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "init_module" and "finit_module" syscalls with the following command:<br><br>$ sudo auditctl -l | grep init_module<br><br>-a always,exit -F arch=b32 -S init_module,finit_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br>-a always,exit -F arch=b64 -S init_module,finit_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br><br>If both the "b32" and "b64" audit rules are not defined for the "delete_module" syscall, or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate an audit event for any successful/unsuccessful use of the "init_module" and "finit_module" system calls by adding or updating the following rules in the "/etc/audit/rules.d/audit.rules" file:<br><br>-a always,exit -F arch=b32 -S init_module,finit_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br>-a always,exit -F arch=b64 -S init_module,finit_module -F auid&gt;=1000 -F auid!=unset -k module_chng<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>107</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000477-GPOS-00222,SRG-APP-000495-CTR-001235,SRG-APP-000504-CTR-001280</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 Must Provide Audit Record Generation Capability For Dod-Defined Auditable Events For All Operating System Components.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>The addition of kernel modules can be used to alter the behavior of<br>the kernel and potentially introduce malicious code into kernel space. It is important<br>to have an audit trail of modules that have been introduced into the kernel.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>To determine if the system is configured to audit calls to the<br> init_module&nbsp;&nbsp;system call, run the following command:<br> $ sudo grep "init_module" /etc/audit/audit.*<br>If the system is configured to audit this activity, it will return a line.<br><br><br>If no line is returned, then this is a finding.</td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>108</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the chsh command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "chsh" command with the following command:<br><br>$ sudo auditctl -l | grep chsh<br><br>-a always,exit -S all -F path=/usr/bin/chsh -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=priv_cmd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "chsh" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid&gt;=1000 -F auid!=unset -k priv_cmd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>109</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the crontab command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "crontab" command with the following command:<br><br>$ sudo auditctl -l | grep crontab<br><br>-a always,exit -S all -F path=/usr/bin/crontab -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-crontab<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "crontab" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-crontab<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>110</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the gpasswd command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "gpasswd" command with the following command:<br><br>$ sudo auditctl -l | grep gpasswd<br><br>-a always,exit -S all -F path=/usr/bin/gpasswd -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-gpasswd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "gpasswd" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-gpasswd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>111</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000477-GPOS-00222,SRG-APP-000495-CTR-001235,SRG-APP-000504-CTR-001280</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the kmod command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "kmod" command with the following command:<br><br>$ sudo auditctl -l | grep kmod<br><br>-a always,exit -S all -F path=/usr/bin/kmod -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=modules<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "kmod" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid&gt;=1000 -F auid!=unset -k modules<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the newgrp command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "newgrp" command with the following command:<br><br>$ sudo auditctl -l | grep newgrp<br><br>-a always,exit -S all -F path=/usr/bin/newgrp -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=priv_cmd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "newgrp" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid&gt;=1000 -F auid!=unset -k priv_cmd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>113</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the pam_timestamp_check command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "pam_timestamp_check" command with the following command:<br><br>$ sudo auditctl -l | grep timestamp<br><br>-a always,exit -S all -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-pam_timestamp_check<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "pam_timestamp_check" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-pam_timestamp_check<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>114</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the passwd command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 generates audit records for all account creations, modifications, disabling, and termination events that affect "/etc/gshadow" with the following command:<br><br>$ sudo auditctl -l | egrep '(/usr/bin/passwd)'<br><br>-a always,exit -S all -F path=/usr/bin/passwd -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-passwd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "passwd" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-passwd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>115</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the postdrop command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "postdrop" command with the following command:<br><br>$ sudo auditctl -l | grep postdrop<br><br>-a always,exit -S all -F path=/usr/sbin/postdrop -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "postdrop" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>116</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the postqueue command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "postqueue" command with the following command:<br><br>$ sudo auditctl -l | grep postqueue<br><br>-a always,exit -S all -F path=/usr/sbin/postqueue -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "postqueue" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>117</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the ssh-agent command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "ssh-agent" command with the following command:<br><br>$ sudo auditctl -l | grep ssh-agent<br><br>-a always,exit -S all -F path=/usr/bin/ssh-agent -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-ssh<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "ssh-agent" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-ssh<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>118</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the ssh-keysign command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "ssh-keysign" command with the following command:<br><br>$ sudo auditctl -l | grep ssh-keysign<br><br>-a always,exit -S all -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-ssh<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "ssh-keysign" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-ssh<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>119</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-OS-000755-GPOS-00220</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the su command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "su" command with the following command:<br><br>$ sudo auditctl -l | grep '/usr/bin/su\b'<br><br>-a always,exit -S all -F path=/usr/bin/su -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-priv_change<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "su" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/su -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-priv_change<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>120</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255,SRG-OS-000755-GPOS-00220</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the sudo command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "sudo" command with the following command:<br><br>$ sudo auditctl -l | grep '/usr/bin/sudo\b'<br><br>-a always,exit -S all -F path=/usr/bin/sudo -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=priv_cmd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "sudo" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid&gt;=1000 -F auid!=unset -k priv_cmd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>121</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235,SRG-OS-000755-GPOS-00220</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the sudoedit command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "sudoedit" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/bin/sudoedit<br><br>-a always,exit -S all -F path=/usr/bin/sudoedit -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=priv_cmd<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "sudoedit" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid&gt;=1000 -F auid!=unset -k priv_cmd<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>122</th>
      <td></td>
      <td>CCI-001405,CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the unix_chkpwd command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "unix_chkpwd" command with the following command:<br><br>$ sudo auditctl -l | grep unix_chkpwd<br><br>-a always,exit -S all -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "unix_chkpwd" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>123</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the unix_update command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "unix_update" command with the following command:<br><br>$ sudo auditctl -l | grep unix_update<br><br>-a always,exit -S all -F path=/usr/sbin/unix_update -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "unix_update" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>124</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the userhelper command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "userhelper" command with the following command:<br><br>$ sudo auditctl -l | grep userhelper<br><br>-a always,exit -S all -F path=/usr/sbin/userhelper -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-unix-update<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "userhelper" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-unix-update<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>125</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000466-GPOS-00210,SRG-APP-000495-CTR-001235,SRG-APP-000499-CTR-001255</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the usermod command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit record specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "usermod" command with the following command:<br><br>$ sudo auditctl -l | grep usermod<br><br>-a always,exit -S all -F path=/usr/sbin/usermod -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-usermod<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "usermod " command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-usermod<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>126</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the mount command.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "mount" command with the following command:<br><br>$ sudo auditctl -l | grep mount<br><br>-a always,exit -F arch=b32 -S mount -F auid&gt;=1000 -F auid!=unset -k export<br>-a always,exit -F arch=b64 -S mount -F auid&gt;=1000 -F auid!=unset -k export<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "mount" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F arch=b32 -S mount -F auid&gt;=1000 -F auid!=unset -k export<br>-a always,exit -F arch=b64 -S mount -F auid&gt;=1000 -F auid!=unset -k export<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>127</th>
      <td></td>
      <td>CCI-001493,CCI-000172</td>
      <td>SRG-OS-000462-GPOS-00206,SRG-OS-000475-GPOS-00220,SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-APP-000121-CTR-000255,SRG-APP-000495-CTR-001235</td>
      <td></td>
      <td>The container platform must generate audit records when successful/unsuccessful attempts to modify privileges occur.</td>
      <td></td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify audit records are generated on successful/unsuccessful attempts to modify privileges. <br><br>If audit records are not generated, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>128</th>
      <td></td>
      <td>CCI-002233</td>
      <td>SRG-APP-000342-CTR-000775</td>
      <td></td>
      <td>Container images instantiated by the container platform must execute using least privileges.</td>
      <td>Container images instantiated by the container platform must execute using least privileges.</td>
      <td>Containers running within the container platform must execute as non-privileged. When a container can execute as a privileged container, the privileged container is also a privileged user within the hosting system, and the hosting system becomes a major security risk. It is important for the container platform runtime to validate the container user and disallow instantiation if the container is trying to execute with more privileges than required, as a privileged user, or is trying to perform a privilege escalation.<br><br>When privileged access is necessary for a container, a new policy for execution should be written for the container. The default behavior must not give containers privileged execution.<br><br>Examples of privileged users are root, admin, and default service accounts for the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform disallows instantiation of containers trying to execute with more privileges than required or with privileged permissions. <br><br>If the container platform does not block containers requesting privileged permissions, privilege escalation, or allows containers to have more privileges than required, this is a finding.</td>
      <td>Inspect each SCC and the users and groups allowed to use it returned<br>from running the following command:<br> oc get scc -ojson | jq '.items[]|select(.runAsUser.type != "MustRunAsRange" )|.metadata.name,{"Group:":.groups},{"User":.users}' <br><br>The group "system:authenticated" is the default group for any<br>authenticated user, this group should only be associated with the<br>restricted profile. If this group is listed under any other SCC Policy,<br>or the restricted SCC policy has been altered to allow any of the<br>non-permitted actions, this is a finding.<br><br>Next, determine if there are any cluster roles or local roles that allow<br>the use of use of non-permitted SCC policies.&nbsp;&nbsp;The following commands will<br>print the Role's name and namespace, followed by a list of resource names<br>and if that resource is an SCC.<br><br>&gt; oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>&gt; oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == ("security.openshift.io")) and (.resources[]? == ("securitycontextconstraints")) and (.verbs[]? == ("use"))))|.metadata.name,{"scc":(.rules[]?|select((.resources[]? == ("securitycontextconstraints"))).resourceNames[]?)}'<br><br>Excluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.<br><br> <br>examplePrivilegedRole<br>{<br>&nbsp;&nbsp;"scc": "privileged"<br>}<br> <br><br>Finally, determine if there are any role bindings to cluster or local<br>roles that allow use of non-permitted SCCs.<br><br>&gt; oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br>&gt; oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == ("ClusterRole","Role") and .roleRef.name == ( ))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br><br>Where "CLUSTER_ROLE_LIST" and "LOCAL_ROLE_LIST" are<br>comma-separated lists of the roles allowing use of non-permitted SCC<br>policies as identified above. For example:<br><br> <br>... .roleRef.name == ("system:openshift:scc:privileged","system:openshift:scc:hostnetwork","system:openshift:scc:hostaccess") ...<br> <br><br>Excluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.</td>
      <td></td>
      <td>For users and groups that are defined in the SCC policy, remove the users or groups by editing the corresponding SCC policy.<br><br>&gt; oc edit scc&nbsp;&nbsp;<br><br>The following instructions will remove the user or group from the cluster role binding for the SCC policy.<br><br>Remove user from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove a group from the SCC Policy binding:<br><br>&gt; oc adm policy remove-scc-from-group&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Remove service account from the SCC Policy binding:<br><br>&gt; oc project&nbsp;&nbsp;<br>&gt; oc adm policy remove-scc-from-user&nbsp;&nbsp; -z&nbsp;&nbsp;<br><br>Finally, remove any roles that allows use of non-permitted SCC policies (excluding platform defined roles)<br><br>&gt; oc delete clusterrole.rbac&nbsp;&nbsp;<br><br>or<br><br>&gt; oc delete role.rbac&nbsp;&nbsp; -n</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>129</th>
      <td></td>
      <td>CCI-000194</td>
      <td>SRG-APP-000168-CTR-000420</td>
      <td></td>
      <td>The container platform must enforce password complexity by requiring that at least one numeric character be used.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce password complexity by requiring that at least one numeric character be used.</td>
      <td>Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.<br><br>Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces password complexity by requiring that at least one numeric character be used. <br><br>If the container platform does not enforce password complexity by requiring that at least one numeric character be used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>130</th>
      <td></td>
      <td>CCI-002385,CCI-001094</td>
      <td>SRG-APP-000246-CTR-000605,SRG-APP-000435-CTR-001070</td>
      <td>CCE-90734-5</td>
      <td>The container platform must restrict individuals' ability to launch organizationally defined denial-of-service (DoS) attacks against other information systems.</td>
      <td>Red Hat OpenShift Container Platform 4 must restrict individuals the ability to launch organizational-defined Denial-of-Service (DOS) attacks against other information systems.</td>
      <td>The container platform will offer services to users and these services share resources available on the hosting system. To share the resources in a manner that does not exhaust or over utilize resources, it is necessary for the container platform to have mechanisms that allow developers to size there containers to provide minimum and maximum amounts. If there is no mechanism to specify limits, container services can cause DoS by over utilization.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform implementation and security documentation and components settings to determine if the information system restricts the ability of users or systems to launch organization-defined DoS attacks against other information systems or networks from the container platform. <br><br>If the container platform is not configured to restrict this ability, this is a finding.</td>
      <td></td>
      <td></td>
      <td>Configure a default resource quota as necessary to protect resource over utilization by performing the following steps.<br><br>1. Create a bootstrap project template<br><br>&gt; oc adm create-bootstrap-project-template -o yaml &gt; template.yaml<br><br>2. Edit the template and add a ResourceQuota object definition before the parameters section<br><br>- apiVersion: v1<br>&nbsp;&nbsp;kind: ResourceQuota<br>&nbsp;&nbsp;metadata:<br>&nbsp;&nbsp;&nbsp;&nbsp;name: example<br>&nbsp;&nbsp;spec:<br>&nbsp;&nbsp;&nbsp;&nbsp;hard:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;persistentvolumeclaims: "10"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requests.storage: "50Gi"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>parameters:<br><br> 3. Apply the project template to the cluster<br><br>&gt; oc create -f template.yaml -n openshift-config<br><br> 4. Set the default cluster project request template<br><br> &gt; oc patch project.config.openshift.io/cluster --type=merge -p '{"spec":{"projectRequestTemplate":{"name": " "}}}'<br><br>Details regarding the configuration of resource quotas can be reviewed at the below documentation.<br>https://docs.openshift.com/container-platform/latest/applications/quotas/quotas-setting-per-project.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>131</th>
      <td></td>
      <td>CCI-002385,CCI-001094,CCI-002824</td>
      <td>SRG-APP-000246-CTR-000605,SRG-APP-000435-CTR-001070,SRG-APP-000450-CTR-001105</td>
      <td>CCE-90582-8</td>
      <td>The container platform must restrict individuals' ability to launch organizationally defined denial-of-service (DoS) attacks against other information systems.</td>
      <td>Red Hat OpenShift Container Platform 4 must restrict individuals the ability to launch organizational-defined Denial-of-Service (DOS) attacks against other information systems.</td>
      <td>The container platform will offer services to users and these services share resources available on the hosting system. To share the resources in a manner that does not exhaust or over utilize resources, it is necessary for the container platform to have mechanisms that allow developers to size there containers to provide minimum and maximum amounts. If there is no mechanism to specify limits, container services can cause DoS by over utilization.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform implementation and security documentation and components settings to determine if the information system restricts the ability of users or systems to launch organization-defined DoS attacks against other information systems or networks from the container platform. <br><br>If the container platform is not configured to restrict this ability, this is a finding.</td>
      <td></td>
      <td></td>
      <td>Add a resource quota to an existing project namespace by performing the following steps:<br><br>1. Create a quota.yml file with the ResourceQuota object definition, and edit the file with the desired resource quota content. The following is an example resource quota definition.<br><br>apiVersion: v1<br>kind: ResourceQuota<br>metadata:<br>&nbsp;&nbsp;name: compute-resources<br>spec:<br>&nbsp;&nbsp;hard:<br>&nbsp;&nbsp;&nbsp;&nbsp;pods: "4"<br>&nbsp;&nbsp;&nbsp;&nbsp;requests.cpu: "1"<br>&nbsp;&nbsp;&nbsp;&nbsp;requests.memory: 1Gi<br>&nbsp;&nbsp;&nbsp;&nbsp;requests.ephemeral-storage: 2Gi<br>&nbsp;&nbsp;&nbsp;&nbsp;limits.cpu: "2"<br>&nbsp;&nbsp;&nbsp;&nbsp;limits.memory: 2Gi<br>&nbsp;&nbsp;&nbsp;&nbsp;limits.ephemeral-storage: 4Gi<br><br>2. Apply the ResourceQuota definition to the project namespace<br>&gt; oc apply -f quota.yml -n&nbsp;&nbsp;<br><br>Details regarding the configuration of resource quotas can be reviewed at the below documentation.<br>https://docs.openshift.com/container-platform/latest/applications/quotas/quotas-setting-per-project.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>132</th>
      <td></td>
      <td>CCI-002385,CCI-001094</td>
      <td>SRG-APP-000246-CTR-000605,SRG-APP-000435-CTR-001070</td>
      <td>CCE-90779-0</td>
      <td>The container platform must restrict individuals' ability to launch organizationally defined denial-of-service (DoS) attacks against other information systems.</td>
      <td>The container platform must protect against or limit the effects of all types of Denial-of-Service (DoS) attacks by employing organization-defined security safeguards.</td>
      <td>The container platform will offer services to users and these services share resources available on the hosting system. To share the resources in a manner that does not exhaust or over utilize resources, it is necessary for the container platform to have mechanisms that allow developers to size there containers to provide minimum and maximum amounts. If there is no mechanism to specify limits, container services can cause DoS by over utilization.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform implementation and security documentation and components settings to determine if the information system restricts the ability of users or systems to launch organization-defined DoS attacks against other information systems or networks from the container platform. <br><br>If the container platform is not configured to restrict this ability, this is a finding.</td>
      <td></td>
      <td></td>
      <td>Add the haproxy.router.openshift.io/rate-limit-connections annotation to any routes outside the kube-* or openshift-* namespaces</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>133</th>
      <td></td>
      <td>CCI-001665</td>
      <td>SRG-APP-000226-CTR-000575</td>
      <td></td>
      <td>The container platform must preserve any information necessary to determine the cause of the disruption or failure.</td>
      <td>Red Hat OpenShift Container Platform 4 must preserve any information necessary to determine the cause of the disruption or failure.</td>
      <td>When a failure occurs within the container platform, preserving the state of the container platform and its components, along with other container services, helps to facilitate container platform restart and return to the operational mode of the organization with less disruption to mission essential processes. When preserving state, considerations for preservation of data confidentiality and integrity must be taken into consideration.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to determine if information necessary to determine the cause of a disruption or failure is preserved. <br><br>If the information is not preserved, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/support/gathering-cluster-data.html</td>
      <td>In the event that there is a failure or disruption to the OpenShift platform, information necessary to identifying the cause would be preserved. The cluster state (resource definitions) is preserved by etcd, audit and system logs are preserved via journald service at the node levels. The following guide provide steps on how to gather cluster data in order to investigate issue with the cluster.<br>https://docs.openshift.com/container-platform/latest/support/gathering-cluster-data.html</td>
    </tr>
    <tr>
      <th>134</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-001330</td>
      <td></td>
      <td>The container platform must be able to store and instantiate industry standard container images.</td>
      <td>Red Hat OpenShift Container Platform 4 must be able to store and instantiate industry standard container images.</td>
      <td>Monitoring the container images and containers during their lifecycle is important to guarantee the container platform is secure. To monitor the containers and images, security tools can be put in place. To fully utilize the security tools available, using images formatted in an industry standard format should be used. This allows the tools to fully understand the images and containers. One standard being worked on by industry leaders in the container space is the Open Container Initiative (OCI). This group is developing a standard container image format.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration and documentation to determine if the platform is configured to store and instantiate industry standard container images. <br><br>If the container platform cannot instantiate industry standard container images, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/architecture/architecture.html</td>
      <td>Red Hat OpenShift leverages CRI-O as its runtime which was designed as a container engine specifically to work with Kubernetes and can run the legacy Docker container format as well as the newer industry standard OCI container image format</td>
    </tr>
    <tr>
      <th>135</th>
      <td></td>
      <td>CCI-000044</td>
      <td>SRG-APP-000065-CTR-000115</td>
      <td></td>
      <td>The container platform must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.</td>
      <td>By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform to determine if it is configured to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.<br><br>If the container platform is not configured to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>136</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-001335</td>
      <td>CCE-90613-1</td>
      <td>The container platform must continuously scan components, containers, and images for vulnerabilities.</td>
      <td>Red Hat OpenShift Container Platform 4 must continuously scan components, containers, and images for vulnerabilities.</td>
      <td>Finding vulnerabilities quickly within the container platform and within containers deployed within the platform is important to keep the overall platform secure. When a vulnerability within a component or container is unknown or allowed to remain unpatched, other containers and customers within the platform become vulnerability. The vulnerability can lead to the loss of application data, organizational infrastructure data, and denial of service (DoS) to hosted applications.<br><br>Vulnerability scanning can be performed by the container platform or by external applications.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to validate continuous vulnerability scans of components, containers, and container images are being performed. <br><br>If continuous vulnerability scans are not being performed, this is a finding.</td>
      <td>The Container Security Operator, provided by Red Hat as a supported optional component, can be installed to continuously scan container images associated with running containers for vulnerabilities via their manifests.<br>Other tools such as Red Hat Advanced Cluster Security (formerly StackRox) provide documentation on identifying vulnerabilities: https://help.stackrox.com/docs/manage-vulnerabilities/<br>For 3rd party tools, reference their documentation to configure vulnerability scanning.<br><br>To check if the Container Security Operator is installed, run the following command:<br>&gt; oc get sub -nopenshift-operators container-security-operator -ojsonpath='{.status.installedCSV}'<br><br>If this command returns an error or an empty string, and a separate tool is not being used to perform continuous vulnerability scans of components, containers, and container images, this is a finding.<br><br>To check if the Container Security Operator is running, run the following command:<br>&gt; oc get deploy -n openshift-operators container-security-operator -ojsonpath='{.status.readyReplicas}'<br><br>If this command returns an error or the number 0, and a separate tool is not being used to perform continuous vulnerability scans of components, containers, and container images, this is a finding.</td>
      <td></td>
      <td>Vulnerability scanning can be performed by the Container Security Operator, Red Hat Advanced Cluster Security (formerly StackRox) or by external applications. To install the Container Security Operator into your cluster, run the following command:<br><br>&gt; oc apply -f - &lt;&lt; 'EOF'<br>---<br>apiVersion: operators.coreos.com/v1alpha1<br>kind: Subscription<br>metadata:<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;operators.coreos.com/container-security-operator.openshift-operators: ''<br>&nbsp;&nbsp;name: container-security-operator<br>&nbsp;&nbsp;namespace: openshift-operators<br>spec:<br>&nbsp;&nbsp;channel: quay-v3.5<br>&nbsp;&nbsp;installPlanApproval: Automatic<br>&nbsp;&nbsp;name: container-security-operator<br>&nbsp;&nbsp;source: redhat-operators<br>&nbsp;&nbsp;sourceNamespace: openshift-marketplace<br>...<br>EOF</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>137</th>
      <td></td>
      <td>CCI-000068</td>
      <td>SRG-APP-000014-CTR-000035</td>
      <td>CCE-86123-7</td>
      <td>The container platform must use TLS 1.2 or greater for secure container image transport from trusted sources.</td>
      <td>Red Hat OpenShift Container Platform 4 must use TLS 1.2 or greater for secure container<br>image transport from trusted sources.</td>
      <td>The authenticity and integrity of the container image during the container image lifecycle is part of the overall security posture of the container platform. This begins with the container image creation and pull of a base image from a trusted source for child container image creation and the instantiation of the new image into a running service. If an insecure protocol is used during transmission of container images at any step of the lifecycle, a bad actor may inject nefarious code into the container image. The container image, when instantiated, then becomes a security risk to the container platform, the host server, and other containers within the container platform. To thwart the injection of code during transmission, a secure protocol (TLS 1.2 or newer) must be used. Further guidance on secure transport protocols can be found in NIST SP 800-52.</td>
      <td>The authenticity and integrity of the container image during the<br>container image lifecycle is part of the overall security posture of<br>the container platform. This begins with the container image creation<br>and pull of a base image from a trusted source for child container<br>image creation and the instantiation of the new image into a running<br>service. If an insecure protocol is used during transmission of<br>container images at any step of the lifecycle, a bad actor may inject<br>nefarious code into the container image. The container image, when<br>instantiated, then becomes a security risk to the container platform,<br>the host server, and other containers within the container platform. To<br>thwart the injection of code during transmission, a secure protocol<br>(TLS 1.2 or newer) must be used. Further guidance on secure transport<br>protocols can be found in NIST SP 800-52.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify that TLS 1.2 or greater is being used for secure container image transport from trusted sources. <br><br>If TLS 1.2 or greater is not being used for secure container image transport, this is a finding.</td>
      <td>Verify that no insecure registries are configured:<br><br>$ oc get image.config.openshift.io/cluster -ojsonpath='{.spec.registrySources}'<br><br>If the results contain any "insecureRegistries", this is a finding</td>
      <td></td>
      <td>Remove any insecureRegistries configured using the following command:<br>$ oc patch image.config.openshift.io cluster --type=json -p "[{'op': 'remove', 'path': '/spec/registrySources/insecureRegistries'}]"<br>or by editing the whole registry configuration:<br>$ oc edit image.config.openshift.io/cluster</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>138</th>
      <td></td>
      <td>CCI-000068</td>
      <td>SRG-APP-000014-CTR-000035</td>
      <td>CCE-86235-9</td>
      <td>The container platform must use TLS 1.2 or greater for secure container image transport from trusted sources.</td>
      <td>Red Hat OpenShift Container Platform 4 must use TLS 1.2 or greater for secure container<br>image transport from trusted sources.</td>
      <td>The authenticity and integrity of the container image during the container image lifecycle is part of the overall security posture of the container platform. This begins with the container image creation and pull of a base image from a trusted source for child container image creation and the instantiation of the new image into a running service. If an insecure protocol is used during transmission of container images at any step of the lifecycle, a bad actor may inject nefarious code into the container image. The container image, when instantiated, then becomes a security risk to the container platform, the host server, and other containers within the container platform. To thwart the injection of code during transmission, a secure protocol (TLS 1.2 or newer) must be used. Further guidance on secure transport protocols can be found in NIST SP 800-52.</td>
      <td>The authenticity and integrity of the container image during the<br>container image lifecycle is part of the overall security posture of<br>the container platform. This begins with the container image creation<br>and pull of a base image from a trusted source for child container<br>image creation and the instantiation of the new image into a running<br>service. If an insecure protocol is used during transmission of<br>container images at any step of the lifecycle, a bad actor may inject<br>nefarious code into the container image. The container image, when<br>instantiated, then becomes a security risk to the container platform,<br>the host server, and other containers within the container platform. To<br>thwart the injection of code during transmission, a secure protocol<br>(TLS 1.2 or newer) must be used. Further guidance on secure transport<br>protocols can be found in NIST SP 800-52.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify that TLS 1.2 or greater is being used for secure container image transport from trusted sources. <br><br>If TLS 1.2 or greater is not being used for secure container image transport, this is a finding.</td>
      <td>Verify that no insecure registries are configured:<br><br>$ oc get image.config.openshift.io/cluster -o json | jq '.spec | (.allowedRegistriesForImport[])? | select(.insecure==true)'<br><br>If the command produces any output, this is a finding.</td>
      <td></td>
      <td>Remove any insecureRegistries configured using the following command by editing the registry configuration:<br>$ oc edit image.config.openshift.io/cluster</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>139</th>
      <td></td>
      <td>CCI-002530</td>
      <td>SRG-APP-000431-CTR-001065</td>
      <td></td>
      <td>The container platform runtime must maintain separate execution domains for each container by assigning each container a separate address space.</td>
      <td>Red Hat OpenShift Container Platform 4 runtime must maintain separate execution domains for each container by assigning each container a separate address space.</td>
      <td>Container namespace access is limited upon runtime execution. Each container is a distinct process so that communication between containers is performed in a manner controlled through security policies that limits the communication so one container cannot modify another container. Different groups of containers with different security needs should be deployed in separate namespaces as a first level of isolation.<br><br>Namespaces are a key boundary for network policies, orchestrator access control restrictions, and other important security controls. Separating workloads into namespaces can help contain attacks and limit the impact of mistakes or destructive actions by authorized users.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review container platform runtime documentation and configuration is maintaining a separate execution domain for each executing process. Different groups of applications, and services with different security needs, should be deployed in separate namespaces as a first level of isolation. <br><br>If container platform runtime is not configured to execute processes in separate domains and namespaces, this is a finding. <br><br>If namespaces use defaults, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html#rbac-default-projects_using-rbac<br>https://docs.openshift.com/container-platform/latest/authentication/managing-security-context-constraints.html<br>https://docs.openshift.com/container-platform/latest/authentication/managing-security-context-constraints.html#examining-a-security-context-constraints-object_configuring-internal-oauth</td>
      <td>The control is met because SELinux and namespaces are enabled by default.<br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html#rbac-default-projects_using-rbac<br>https://docs.openshift.com/container-platform/latest/authentication/managing-security-context-constraints.html<br>https://docs.openshift.com/container-platform/latest/authentication/managing-security-context-constraints.html#examining-a-security-context-constraints-object_configuring-internal-oauth<br>- OpenShift comes with a number of default projects, and projects starting with `openshift-` are considered essential to users. Resources in OpenShift should be segregated by project, to allow for security controls to be applied at that level and to make it easier to manage resources. Review projects to ensure that only system managed resources belong in default projects.<br>oc project &lt; project-name &gt; &amp;&amp; oc get all<br>- By default, OpenShift also sets a SCC for all authenticated users. Specifically, it sets the restricted SCC by default, which denies access to all host features and requires pods to be run with a UID and SELinux context that are allocated to the project. <br>To get all SCC's:<br>&nbsp;&nbsp;oc get scc<br>To describe an SCC, including which users, service accounts, and groups SCC is applied to:<br>&nbsp;&nbsp;oc describe scc &lt;scc-name&gt;</td>
    </tr>
    <tr>
      <th>140</th>
      <td></td>
      <td>CCI-000199</td>
      <td>SRG-APP-000174-CTR-000450</td>
      <td></td>
      <td>The container platform must enforce a 60-day maximum password lifetime restriction.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce a 60-day maximum password lifetime restriction.</td>
      <td>Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed at specific intervals. <br><br>One method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. <br><br>This requirement does not include emergency administration accounts that are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces a 60-day maximum password lifetime restriction. <br><br>If the container platform does not enforce a 60-day maximum password lifetime restriction, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>141</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000461-GPOS-00205,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295</td>
      <td></td>
      <td>The container platform runtime must generate audit records when successful/unsuccessful attempts to access objects occur.</td>
      <td></td>
      <td>Container platform runtime objects are defined as configuration files, code, etc. This provides the ability to configure resources and software parameters prior to image execution from the container platform registry. An unauthorized user with malicious intent could modify existing objects causing vulnerabilities or attacks. It would be difficult to establish, correlate, and investigate events relating to an incident or identify those responsible without audit record generation.<br><br>Without audit record generation, unauthorized users can access objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify that the runtime generates audit records on successful/unsuccessful access to objects. <br><br>If audit records are not generated by the runtime when objects are successfully/unsuccessfully accessed, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>142</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000461-GPOS-00205,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295</td>
      <td></td>
      <td>The container platform runtime must generate audit records when successful/unsuccessful attempts to access objects occur.</td>
      <td></td>
      <td>Container platform runtime objects are defined as configuration files, code, etc. This provides the ability to configure resources and software parameters prior to image execution from the container platform registry. An unauthorized user with malicious intent could modify existing objects causing vulnerabilities or attacks. It would be difficult to establish, correlate, and investigate events relating to an incident or identify those responsible without audit record generation.<br><br>Without audit record generation, unauthorized users can access objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify that the runtime generates audit records on successful/unsuccessful access to objects. <br><br>If audit records are not generated by the runtime when objects are successfully/unsuccessfully accessed, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>143</th>
      <td></td>
      <td>CCI-000172</td>
      <td>SRG-OS-000458-GPOS-00203,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000461-GPOS-00205,SRG-APP-000091-CTR-000160,SRG-APP-000492-CTR-001220,SRG-APP-000493-CTR-001225,SRG-APP-000494-CTR-001230,SRG-APP-000500-CTR-001260,SRG-APP-000507-CTR-001295</td>
      <td></td>
      <td>The container platform runtime must generate audit records when successful/unsuccessful attempts to access objects occur.</td>
      <td></td>
      <td>Container platform runtime objects are defined as configuration files, code, etc. This provides the ability to configure resources and software parameters prior to image execution from the container platform registry. An unauthorized user with malicious intent could modify existing objects causing vulnerabilities or attacks. It would be difficult to establish, correlate, and investigate events relating to an incident or identify those responsible without audit record generation.<br><br>Without audit record generation, unauthorized users can access objects unknowingly for malicious intent creating vulnerabilities within the container platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to verify that the runtime generates audit records on successful/unsuccessful access to objects. <br><br>If audit records are not generated by the runtime when objects are successfully/unsuccessfully accessed, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>144</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/dbus-1/dbus-daemon-launch-helper command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/dbus-1/dbus-daemon-launch-helper" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/dbus-1/dbus-daemon-launch-helper<br><br>-a always,exit -F path=/usr/libexec/dbus-1/dbus-daemon-launch-helper -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "polkit-agent-helper" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path= /usr/libexec/dbus-1/dbus-daemon-launch-helper -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>145</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the fusermount command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "fusermount" command with the following command:<br><br>$ sudo auditctl -l | grep fusermount<br><br>-a always,exit -F path=/usr/bin/fusermount -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-fusermount<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "fusermount" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/fusermount -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-fusermount<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>146</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the fusermount3 command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "fusermount3" command with the following command:<br><br>$ sudo auditctl -l | grep fusermount3<br><br>-a always,exit -F path=/usr/bin/fusermount3 -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-fusermount3<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "fusermount3" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/fusermount3 -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-fusermount3<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>147</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/sbin/grub2-set-bootflag command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/sbin/grub2-set-bootflag" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/sbin/grub2-set-bootflag<br><br>-a always,exit -F path=/usr/sbin/grub2-set-bootflag -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/sbin/grub2-set-bootflag" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/grub2-set-bootflag -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>148</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the mount command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "mount" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/bin/mount<br><br>-a always,exit -S all -F path=/usr/bin/mount -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-mount<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "mount" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/mount -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-mount<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>149</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/sbin/mount.nfs command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/sbin/mount.nfs" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/sbin/mount.nfs<br><br>-a always,exit -F path=/usr/sbin/mount.nfs -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/sbin/mount.nfs" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/sbin/mount.nfs -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>150</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085,SRG-OS-000037-GPOS-00015</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the pkexec command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "pkexec" command with the following command:<br><br>$ sudo auditctl -l | grep pkexec<br><br>-a always,exit -F path=/usr/bin/pkexec -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-pkexec<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "pkexec" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/pkexec -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-pkexec<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>151</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/sssd/krb5_child command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/sssd/krb5_child" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/sssd/krb5_child<br><br>-a always,exit -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/libexec/sssd/krb5_child" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>152</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/sssd/ldap_child command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/sssd/ldap_child" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/sssd/ldap_child<br><br>-a always,exit -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/libexec/sssd/ldap_child" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>153</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/sssd/proxy_child command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/sssd/proxy_child" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/sssd/proxy_child<br><br>-a always,exit -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/libexec/sssd/proxy_child" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>154</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/sssd/selinux_child command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/sssd/selinux_child" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/sssd/selinux_child<br><br>-a always,exit -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "/usr/libexec/sssd/selinux_child" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>155</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of umount system calls.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each system call made by all programs on the system. Therefore, it is very important to use system call rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining system calls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "umount" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/bin/umount<br><br>-a always,exit -S all -F path=/usr/bin/umount -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=privileged-mount<br><br>If the command does not return an audit rule for "umount" or any of the lines returned are commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "umount" command by adding or updating the following rules in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/umount -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-mount<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>156</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/libexec/utempter command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/libexec/utempter" command with the following command:<br><br>$ sudo auditctl -l | grep /usr/libexec/utempter<br><br>-a always,exit -F path=/usr/libexec/utempter -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "polkit-agent-helper" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path= /usr/libexec/utempter -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>157</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the /usr/lib/polkit-1/polkit-agent-helper-1 command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "/usr/lib/polkit-1/polkit-agent-helper-1" command with the following command:<br><br>$ sudo auditctl -l | grep polkit-agent-helper-1<br><br>-a always,exit -F path=/usr/lib/polkit-1/polkit-agent-helper-1 -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "polkit-agent-helper" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path= /usr/lib/polkit-1/polkit-agent-helper-1-F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>158</th>
      <td></td>
      <td>CCI-001405</td>
      <td>SRG-APP-000029-CTR-000085</td>
      <td></td>
      <td>The container platform must automatically audit account removal actions.</td>
      <td>Red Hat OpenShift Container Platform 4 must audit all uses of the write command.</td>
      <td>When application accounts are removed, user accessibility is affected. Once an attacker establishes access to an application, the attacker often attempts to remove authorized accounts to disrupt services or prevent the implementation of countermeasures. Auditing account removal actions provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/audit mechanisms meeting or exceeding access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td>Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.<br><br>Audit records can be generated from various components within the information system (e.g., module or policy filter).<br><br>When a user logs on, the auid is set to the uid of the account that is being authenticated. Daemons are not user sessions and have the loginuid set to -1. The auid representation is an unsigned 32-bit integer, which equals 4294967295. The audit system interprets -1, 4294967295, and "unset" in the same way.<br><br>The system call rules are loaded into a matching engine that intercepts each syscall made by all programs on the system. Therefore, it is very important to use syscall rules only when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance can be helped, however, by combining syscalls into one rule whenever possible.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account removal is automatically audited. <br><br>If account removal is not automatically audited, this is a finding.</td>
      <td>Verify that Red Hat OpenShift Container Platform 4 is configured to audit the execution of the "write" command with the following command:<br><br>$ sudo auditctl -l | grep write<br><br>-a always,exit -F path=/usr/bin/write -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-write<br><br>If the command does not return a line, or the line is commented out, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to generate audit records upon successful/unsuccessful attempts to use the "write" command by adding or updating the following rule in "/etc/audit/rules.d/audit.rules":<br><br>-a always,exit -F path=/usr/bin/write -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-write<br><br>The audit daemon must be restarted for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>159</th>
      <td></td>
      <td>CCI-000198</td>
      <td>SRG-APP-000173-CTR-000445</td>
      <td></td>
      <td>The container platform must enforce 24 hours (one day) as the minimum password lifetime.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce 24 hours (one day) as the minimum password lifetime.</td>
      <td>Enforcing a minimum password lifetime helps prevent repeated password changes to defeat the password reuse or history enforcement requirement.<br><br>Restricting this setting limits the user's ability to change their password. Passwords need to be changed at specific policy-based intervals; however, if the application allows the user to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces 24 hours/1 day as the minimum password lifetime. <br><br>If the container platform does not enforce 24 hours/1 day as the minimum password lifetime, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>160</th>
      <td></td>
      <td>CCI-000382</td>
      <td>SRG-APP-000645-CTR-001410</td>
      <td></td>
      <td>The container platform must prohibit or restrict the use of protocols that transmit unencrypted authentication information or use flawed cryptographic algorithms for transmission.</td>
      <td>Red Hat OpenShift Container Platform 4 must prohibit or restrict the use of protocols that transmit unencrypted authentication information or use flawed cryptographic algorithms for transmission.</td>
      <td>The use of secure ports, protocols and services within the container platform must be controlled and conform to the PPSM CAL. Those ports, protocols, and services that fall outside the PPSM CAL must be blocked by the runtime. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.<br><br>Unsecure protocols for transmission will expose the information system data and information, making the session susceptible to manipulation, hijacking, and man-in-the middle attacks.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to verify that container platform is not using protocols that transmit authentication data unencrypted and that the container platform is not using flawed cryptographic algorithms for transmission. <br><br>If the container platform is using protocols to transmit authentication data unencrypted or is using flawed cryptographic algorithms, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT I</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/post_installation_configuration/network-configuration.html</td>
      <td>The ports and protocols configured with OpenShift are required for the<br>proper functioning of the clusters and associated network.&nbsp;&nbsp;Details on<br>configuration options are located in the following document:<br>https://docs.openshift.com/container-platform/latest/post_installation_configuration/network-configuration.html</td>
    </tr>
    <tr>
      <th>161</th>
      <td></td>
      <td>CCI-001350</td>
      <td>SRG-APP-000126-CTR-000275</td>
      <td>CCE-90688-3</td>
      <td>The container platform must use FIPS validated cryptographic mechanisms to protect the integrity of log information.</td>
      <td>The container platform must use FIPS validated cryptographic mechanisms to protect the integrity<br>of log information.</td>
      <td>To fully investigate an incident and to have trust in the audit data that is generated, it is important to put in place data protections. Without integrity protections, unauthorized changes may be made to the audit files and reliable forensic analysis and discovery of the source of malicious system activity may be degraded. Although digital signatures are one example of protecting integrity, this control is not intended to cause a new cryptographic hash to be generated every time a record is added to a log file. <br><br>Integrity protections can also be implemented by using cryptographic techniques for security function isolation and file system protections to protect against unauthorized changes.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if FIPS-validated cryptographic mechanisms are being used to protect the integrity of log information. <br><br>If FIPS-validated cryptographic mechanisms are not being used to protect the integrity of log information, this is a finding.</td>
      <td>Verify that the Cluster Log Forwarder is using an encrypted transport:<br><br>&gt; oc get clusterlogforwarder -n openshift-logging<br><br>For each Cluster Log Forwarder, run the following command to display the configuration<br><br>&gt; oc describe clusterlogforwarder&nbsp;&nbsp; -n openshift-logging<br><br>Review the configuration and determine if the transport is secure, such<br>as tls:// or https://. If there are any transports configured that are<br>not secured by TLS, this is a finding.</td>
      <td></td>
      <td>Edit the Cluster Log Forwarder configuration to configure TLS on the transport.<br><br>&gt; oc edit clusterlogforwarder&nbsp;&nbsp; -n openshift-logging<br><br>For detailed information regarding<br>configuration of the Cluster Log Forwarder see<br>https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>162</th>
      <td></td>
      <td>CCI-000206</td>
      <td>SRG-APP-000178-CTR-000470</td>
      <td></td>
      <td>The container platform must obscure feedback of authentication information during the authentication process to protect the information from possible exploitation/use by unauthorized individuals.</td>
      <td>Red Hat OpenShift Container Platform 4 must obscure feedback of authentication information during the authentication process to protect the information from possible exploitation/use by unauthorized individuals.</td>
      <td>To prevent the compromise of authentication information such as passwords during the authentication process, the feedback from the container platform and its components, e.g., runtime, registry, and keystore, must not provide any information that would allow an unauthorized user to compromise the authentication mechanism.<br><br>Obfuscation of user-provided information when typed is a method used in addressing this risk.<br><br>Displaying asterisks when a user types in a password is an example of obscuring feedback of authentication information.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review container platform documentation and configuration to determine if any interfaces that are provided for authentication purposes display the user's password when it is typed into the data entry field. <br><br>If authentication information is not obfuscated when entered, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/authentication/index.html</td>
      <td>The OpenShift Container Platform's web console hides the user's<br>password as it is typed in. The CLI interface also hides the password as it is typed<br>via standard input on the console.&nbsp;&nbsp;To access the API server a user must first authenticate<br>and obtain an OAuth token (or a x.509 certificate) in order send requests to the<br>API server. In this way, the user's authentication credentials (username/password)<br>are protected from discovery.</td>
    </tr>
    <tr>
      <th>163</th>
      <td></td>
      <td>CCI-002142</td>
      <td>SRG-APP-000317-CTR-000735</td>
      <td></td>
      <td>The container platform must terminate shared/group account credentials when members leave the group.</td>
      <td>Red Hat OpenShift Container Platform 4 must terminate shared/group account credentials when members leave the group.</td>
      <td>If shared/group account credentials are not terminated when individuals leave the group, the user that left the group can still gain access even though they are no longer authorized. A shared/group account credential is a shared form of authentication that allows multiple individuals to access the application using a single account. There may also be instances when specific user actions need to be performed on the information system without unique user identification or authentication. Examples of credentials include passwords and group membership certificates.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Determine if the container platform is configured to terminate shared/group account credentials when members leave the group. <br><br>If the container platform does not terminated shared/group account credentials when members leave the group, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>164</th>
      <td></td>
      <td>CCI-002702</td>
      <td>SRG-APP-000474-CTR-001180</td>
      <td></td>
      <td>The container platform must provide system notifications to the system administrator and operational staff when anomalies in the operation of the organization-defined security functions are discovered.</td>
      <td>Red Hat OpenShift Container Platform 4 must provide system notifications to the system administrator and operational staff when anomalies in the operation of the organization-defined security functions are discovered.</td>
      <td>If anomalies are not acted upon, security functions may fail to secure the container within the container platform runtime.<br><br>Security functions are responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.<br><br>Notifications provided by information systems include, for example, electronic alerts to system administrators.</td>
      <td></td>
      <td>Applicable - Does Not Meet</td>
      <td>Review container platform runtime documentation and configuration settings. <br><br>If the container platform is not configured to notify organization-defined information system role when anomalies in the operation of security functions as defined by site security plan are discovered, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td>Use external tooling, such as Red Hat Advanced Cluster Security or<br>compliance solutions from other vendors to provide active alerts<br>conditionally. Applying an external tool mitigates this risk to a<br>CAT III.</td>
      <td></td>
      <td>If the OpenShift Compliance Operator is configured in accordance with<br>the Fix data in SRG-APP-000516-CTR-001325, then administrators will be<br>able to query when a ComplianceCheckResult shows non-compliant status<br>for any of the rules defined in the compliance profile, aligning with<br>the SSP for the system.<br><br>This capability does not currently natively support alerting for<br>non-compliant status. External tooling, such as Red Hat Advanced Cluster<br>Security or compliance solutions from other vendors, may be integrated<br>using their own mechanisms to provide active alerts conditionally.</td>
    </tr>
    <tr>
      <th>165</th>
      <td></td>
      <td>CCI-001619</td>
      <td>SRG-APP-000169-CTR-000425</td>
      <td></td>
      <td>The container platform must enforce password complexity by requiring that at least one special character be used.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce password complexity by requiring that at least one special character be used.</td>
      <td>Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.<br><br>Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.<br><br>Special characters are those characters that are not alphanumeric. Examples include ~ ! @ # $ % ^ *.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces password complexity by requiring that at least one special character be used. <br><br>If the container platform does not enforce password complexity by requiring that at least one special character be used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>166</th>
      <td></td>
      <td>CCI-000192</td>
      <td>SRG-APP-000166-CTR-000410</td>
      <td></td>
      <td>The container platform must enforce password complexity by requiring that at least one uppercase character be used.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce password complexity by requiring that at least one uppercase character be used.</td>
      <td>Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.<br><br>Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it enforces password complexity by requiring that at least one uppercase character be used. <br><br>If the container platform does not enforce password complexity by requiring that at least one uppercase character be used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>167</th>
      <td></td>
      <td>CCI-001090</td>
      <td>SRG-APP-000243-CTR-000600</td>
      <td></td>
      <td>The container platform must prevent unauthorized and unintended information transfer via shared system resources.</td>
      <td></td>
      <td>The container platform makes host system resources available to container services. These shared resources, such as the host system kernel, network connections, and storage, must be protected to prevent unauthorized and unintended information transfer. The protections must be implemented for users and processes acting on behalf of users.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform architecture documentation to find out if and how it protects the resources of one process or user (such as working memory, storage, host system kernel, network connections) from unauthorized access by another user or process. <br><br>If the container platform configuration settings do not effectively implement these protections to prevent unauthorized access by another user or process, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>168</th>
      <td></td>
      <td>CCI-001090</td>
      <td>SRG-OS-000480-GPOS-00227,SRG-APP-000243-CTR-000600</td>
      <td></td>
      <td>The container platform must prevent unauthorized and unintended information transfer via shared system resources.</td>
      <td></td>
      <td>The container platform makes host system resources available to container services. These shared resources, such as the host system kernel, network connections, and storage, must be protected to prevent unauthorized and unintended information transfer. The protections must be implemented for users and processes acting on behalf of users.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform architecture documentation to find out if and how it protects the resources of one process or user (such as working memory, storage, host system kernel, network connections) from unauthorized access by another user or process. <br><br>If the container platform configuration settings do not effectively implement these protections to prevent unauthorized access by another user or process, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>169</th>
      <td></td>
      <td>CCI-001090</td>
      <td>SRG-APP-000243-CTR-000600</td>
      <td></td>
      <td>The container platform must prevent unauthorized and unintended information transfer via shared system resources.</td>
      <td></td>
      <td>The container platform makes host system resources available to container services. These shared resources, such as the host system kernel, network connections, and storage, must be protected to prevent unauthorized and unintended information transfer. The protections must be implemented for users and processes acting on behalf of users.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform architecture documentation to find out if and how it protects the resources of one process or user (such as working memory, storage, host system kernel, network connections) from unauthorized access by another user or process. <br><br>If the container platform configuration settings do not effectively implement these protections to prevent unauthorized access by another user or process, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>170</th>
      <td></td>
      <td>CCI-001090</td>
      <td>SRG-OS-000132-GPOS-00067,SRG-OS-000138-GPOS-00069,SRG-APP-000243-CTR-000600</td>
      <td></td>
      <td>The container platform must prevent unauthorized and unintended information transfer via shared system resources.</td>
      <td>Red Hat OpenShift Container Platform 4 must restrict access to the kernel message buffer.</td>
      <td>The container platform makes host system resources available to container services. These shared resources, such as the host system kernel, network connections, and storage, must be protected to prevent unauthorized and unintended information transfer. The protections must be implemented for users and processes acting on behalf of users.</td>
      <td>Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.<br><br>This requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DOD or other government agencies.<br><br>There may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.<br><br>Restricting access to the kernel message buffer limits access to only root. This prevents attackers from gaining additional system information as a nonprivileged user.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform architecture documentation to find out if and how it protects the resources of one process or user (such as working memory, storage, host system kernel, network connections) from unauthorized access by another user or process. <br><br>If the container platform configuration settings do not effectively implement these protections to prevent unauthorized access by another user or process, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 is configured to restrict access to the kernel message buffer with the following commands:<br><br>Check the status of the kernel.dmesg_restrict kernel parameter.<br><br>$ sudo sysctl kernel.dmesg_restrict<br><br>kernel.dmesg_restrict = 1<br><br>If "kernel.dmesg_restrict" is not set to "1" or is missing, this is a finding.<br><br>Check that the configuration files are present to enable this kernel parameter.<br><br>$ sudo /usr/lib/systemd/systemd-sysctl --cat-config | egrep -v '^(#|;)' | grep -F kernel.dmesg_restrict | tail -1<br><br>kernel.dmesg_restrict = 1<br><br>If "kernel.dmesg_restrict" is not set to "1" or is missing, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to restrict access to the kernel message buffer.<br><br>Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:<br><br>kernel.dmesg_restrict = 1<br><br>Load settings from all system configuration files with the following command:<br><br>$ sudo sysctl --system</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>171</th>
      <td></td>
      <td>CCI-001090</td>
      <td>SRG-OS-000132-GPOS-00067,SRG-OS-000138-GPOS-00069,SRG-APP-000243-CTR-000600</td>
      <td></td>
      <td>The container platform must prevent unauthorized and unintended information transfer via shared system resources.</td>
      <td>Red Hat OpenShift Container Platform 4 must prevent kernel profiling by nonprivileged users.</td>
      <td>The container platform makes host system resources available to container services. These shared resources, such as the host system kernel, network connections, and storage, must be protected to prevent unauthorized and unintended information transfer. The protections must be implemented for users and processes acting on behalf of users.</td>
      <td>Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.<br><br>This requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DOD or other government agencies.<br><br>There may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.<br><br>Setting the kernel.perf_event_paranoid kernel parameter to "2" prevents attackers from gaining additional system information as a nonprivileged user.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform architecture documentation to find out if and how it protects the resources of one process or user (such as working memory, storage, host system kernel, network connections) from unauthorized access by another user or process. <br><br>If the container platform configuration settings do not effectively implement these protections to prevent unauthorized access by another user or process, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 is configured to prevent kernel profiling by nonprivileged users with the following commands:<br><br>Check the status of the kernel.perf_event_paranoid kernel parameter.<br><br>$ sysctl kernel.perf_event_paranoid<br><br>kernel.perf_event_paranoid = 2<br><br>If "kernel.perf_event_paranoid" is not set to "2" or is missing, this is a finding.<br><br>Check that the configuration files are present to enable this kernel parameter.<br><br>$ sudo /usr/lib/systemd/systemd-sysctl --cat-config&nbsp;&nbsp;| egrep -v '^(#|;)' | grep -F kernel.perf_event_paranoid | tail -1<br><br>kernel.perf_event_paranoid = 2<br><br>If "kernel.perf_event_paranoid" is not set to "2" or is missing, this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to prevent kernel profiling by nonprivileged users.<br><br>Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:<br><br>kernel.perf_event_paranoid = 2<br><br>Load settings from all system configuration files with the following command:<br><br>$ sudo sysctl --system</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>172</th>
      <td></td>
      <td>CCI-000197</td>
      <td>SRG-APP-000172-CTR-000440</td>
      <td></td>
      <td>For accounts using password authentication, the container platform must use FIPS-validated SHA-2 or later protocol to protect the integrity of the password authentication process.</td>
      <td>For accounts using password authentication, the container platform must use FIPS-validated SHA-2 or later protocol to protect the integrity of the password authentication process.</td>
      <td>Passwords need to be protected on entry, in transmission, during authentication, and when stored. If compromised at any of these security points, a nefarious user can use the password along with stolen user account information to gain access or to escalate privileges. The container platform may require account authentication during container platform tasks and before accessing container platform components, e.g. runtime, registry, and keystore.<br><br>During any user authentication, the container platform must use FIPS-validated SHA-2 or later protocol to protect the integrity of the password authentication process.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the documentation and configuration to determine if the container platform enforces the required FIPS-validated encrypt passwords when they are transmitted. <br><br>If the container platform is not configured to meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT I</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>173</th>
      <td></td>
      <td>CCI-001749</td>
      <td>SRG-APP-000131-CTR-000285</td>
      <td>CCE-90254-4</td>
      <td>The container platform must verify container images.</td>
      <td>Red Hat OpenShift Container Platform 4 must verify container images.</td>
      <td>The container platform must be capable of validating container images are signed and that the digital signature is from a recognized and approved source approved by the organization. Allowing any container image to be introduced into the registry and instantiated into a container can allow for services to be introduced that are not trusted and may contain malicious code, which introduces unwanted services. These unwanted services can cause harm and security risks to the hosting server, the container platform, other services running within the container platform, and the overall organization.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if container images are verified by enforcing image signing and that the image is signed recognized by an approved source. <br><br>If container images are not verified or the signature is not verified as a recognized and approved source, this is a finding.</td>
      <td>Check to see if a policy has been put in place by running the commands:<br><br>&gt; for node in $(oc get node -oname); do \<br>oc debug $node -- chroot /host/bin/bash \<br>-c 'echo -n "$HOSTNAME "; cat /etc/containers/policy.json'2&gt;/dev/null; \ <br>done<br><br>Make sure that the default policy to verify container images is set<br>to reject. Also, ensure that the registries have the appropriate<br>signature keys.&nbsp;&nbsp;This should look as follows:<br><br> <br>&nbsp;&nbsp;{<br>"default": [{"type": "reject"}],<br>"transports": {<br>&nbsp;&nbsp;"docker": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"registry.access.redhat.com": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "signedBy",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"keyType": "GPGKeys",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;"registry.redhat.io": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "signedBy",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"keyType": "GPGKeys",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br><br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;}<br><br>If the policy is not set to reject by default, and the signature keys<br>are not configure appropriately on the registries, this is a finding.</td>
      <td></td>
      <td>Configure the OpenShift Container policy to validate that images signatures are verified and enforced.&nbsp;&nbsp;This can be configured manually or through the use of the MachineConfig Operator published by Red Hat.<br><br>&gt; for mcpool in $(oc get mcp -oname | sed "s:.*/::" ); do<br>echo "apiVersion: machineconfiguration.openshift.io/v1<br>kind: MachineConfig<br>metadata:<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;machineconfiguration.openshift.io/role: $mcpool<br>&nbsp;&nbsp;name: 51-rh-registry-trust-$mcpool<br>spec:<br>&nbsp;&nbsp;config:<br>&nbsp;&nbsp;&nbsp;&nbsp;ignition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version: 3.2.0<br>&nbsp;&nbsp;&nbsp;&nbsp;storage:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:text/plain;charset=utf-8;base64,LS0tCmRvY2tlcjoKICByZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNvbToKICAgIHNpZ3N0b3JlOiBodHRwczovL2FjY2Vzcy5yZWRoYXQuY29tL3dlYmFzc2V0cy9kb2NrZXIvY29udGVudC9zaWdzdG9yZQo=<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verification: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filesystem: root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 420<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/containers/registries.d/registry.access.redhat.com.yaml<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:text/plain;charset=utf-8;base64,LS0tCmRvY2tlcjoKICByZWdpc3RyeS5yZWRoYXQuaW86CiAgICBzaWdzdG9yZTogaHR0cHM6Ly9yZWdpc3RyeS5yZWRoYXQuaW8vY29udGFpbmVycy9zaWdzdG9yZQo=<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verification: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filesystem: root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 420<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/containers/registries.d/registry.redhat.io.yaml<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:text/plain;charset=utf-8;base64,ewogICJkZWZhdWx0IjogW3sidHlwZSI6ICJyZWplY3QifV0sCiAgInRyYW5zcG9ydHMiOiB7CiAgICAiZG9ja2VyIjogewogICAgICAicmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20iOiBbCiAgICAgICAgewogICAgICAgICAgInR5cGUiOiAic2lnbmVkQnkiLAogICAgICAgICAgImtleVR5cGUiOiAiR1BHS2V5cyIsCiAgICAgICAgICAia2V5UGF0aCI6ICIvZXRjL3BraS9ycG0tZ3BnL1JQTS1HUEctS0VZLXJlZGhhdC1yZWxlYXNlIgogICAgICAgIH0KICAgICAgXSwKICAgICAgInJlZ2lzdHJ5LnJlZGhhdC5pbyI6IFsKICAgICAgICB7CiAgICAgICAgICAidHlwZSI6ICJzaWduZWRCeSIsCiAgICAgICAgICAia2V5VHlwZSI6ICJHUEdLZXlzIiwKICAgICAgICAgICJrZXlQYXRoIjogIi9ldGMvcGtpL3JwbS1ncGcvUlBNLUdQRy1LRVktcmVkaGF0LXJlbGVhc2UiCiAgICAgICAgfQogICAgICBdLAogICAgICAiaW1hZ2UtcmVnaXN0cnkub3BlbnNoaWZ0LWltYWdlLXJlZ2lzdHJ5LnN2Yzo1MDAwIjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dLAogICAgICAicXVheS5pby9jb21wbGlhbmNlYXNjb2RlIjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dLAogICAgICAicXVheS5pby9jb21wbGlhbmNlLW9wZXJhdG9yIjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dLAogICAgICAicXVheS5pby9rZXljbG9hayI6IFt7InR5cGUiOiAiaW5zZWN1cmVBY2NlcHRBbnl0aGluZyJ9XSwKICAgICAgInF1YXkuaW8vb3BlbnNoaWZ0LXJlbGVhc2UtZGV2IjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dLAogICAgICAicmVnaXN0cnkuYnVpbGQwMi5jaS5vcGVuc2hpZnQub3JnIjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dLAogICAgICAicmVnaXN0cnkuYnVpbGQwMS5jaS5vcGVuc2hpZnQub3JnIjogW3sidHlwZSI6ICJpbnNlY3VyZUFjY2VwdEFueXRoaW5nIn1dCiAgICB9CiAgfQp9Cg==<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verification: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filesystem: root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 420<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/containers/policy.json<br>" | oc apply -f -<br>done</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>174</th>
      <td></td>
      <td>CCI-000016</td>
      <td>SRG-APP-000024-CTR-000060</td>
      <td></td>
      <td>The container platform must automatically remove or disable temporary user accounts after 72 hours.</td>
      <td>Red Hat OpenShift Container Platform 4 must automatically remove or disable temporary user accounts after 72 hours.</td>
      <td>If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be used to gain unauthorized access. To mitigate this risk, automated termination of all temporary user accounts must be set upon account creation.<br><br>Temporary user accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.<br><br>If temporary user accounts are used, the application must be configured to automatically terminate these types of accounts after a DoD-defined period of 72 hours.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if temporary user accounts are automatically removed or disabled after 72 hours. <br><br>If temporary user accounts are not automatically removed or disabled after 72 hours, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>175</th>
      <td></td>
      <td>CCI-001849</td>
      <td>SRG-OS-000341-GPOS-00132,SRG-OS-000480-GPOS-00227,SRG-APP-000357-CTR-000800</td>
      <td></td>
      <td>The container platform must allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a separate file system for the system audit data path.</td>
      <td>In order to ensure applications have a sufficient storage capacity in which to write the audit logs, applications need to be able to allocate audit record storage capacity.<br><br>The task of allocating audit record storage capacity is usually performed during initial installation of the application and is closely associated with the DBA and system administrator roles. The DBA or system administrator will usually coordinate the allocation of physical drive space with the application owner/installer and the application will prompt the installer to provide the capacity information, the physical location of the disk, or both.</td>
      <td>Placing "/var/log/audit" in its own partition enables better separation between audit files and other system files, and helps ensure that auditing cannot be halted due to the partition running out of space.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if audit record storage capacity is allocated in accordance with organization-defined audit record storage requirements. <br><br>If audit record storage capacity is not allocated in accordance with organization-defined audit record storage requirements, this is a finding.</td>
      <td>Verify that a separate file system/partition has been created for the system audit data path with the following command:<br><br>Note: /var/log/audit is used as the example as it is a common location.<br><br>$ mount | grep /var/log/audit<br><br>/dev/mapper/rootvg-varlogaudit on /var/log/audit type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)<br>Note: Options displayed for mount may differ.<br><br>If no line is returned, this is a finding.</td>
      <td></td>
      <td>Migrate the system audit data path onto a separate file system.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>176</th>
      <td></td>
      <td>CCI-002364</td>
      <td>SRG-APP-000297-CTR-000705</td>
      <td>CCE-90780-8</td>
      <td>Access to the container platform must display an explicit logout message to user indicating the reliable termination of authenticated communication sessions.</td>
      <td>Access to Red Hat OpenShift Container Platform 4 must display an explicit logout message<br>to user indicating the reliable termination of authenticated communication<br>sessions.</td>
      <td>Access to the container platform will occur through web and terminal sessions. Any web interfaces must conform to application and web security requirements. Terminal access to the container platform and its components must provide a logout facility that terminates the connection to the component or the platform.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration settings to determine if the container platform displays a logout message. <br><br>If the container platform does not display a logout message, this is a finding.</td>
      <td>Verify that the logout redirect setting in web console configuration<br>is set.<br><br>&gt; oc get console.config.openshift.io cluster -o jsonpath='{.spec.authentication.logoutRedirect}{"<br>"}'<br><br>If nothing is returned this is a finding.</td>
      <td></td>
      <td>Configure the web console's logout redirect to direct to an appropriate<br>logout page.&nbsp;&nbsp;If OpenShift is configured to use an OIDC provider,<br>then the redirect needs to first go to the OIDC provider's logout page,<br>and then it can be redirected to another logout page as needed.<br><br>Run the following command to update the console<br><br>&gt; oc patch console.config.openshift.io cluster --type merge -p '{"spec":{"authentication":{"logoutRedirect":" "}}}'<br><br>where LOGOUT_URL is set to the logout page</td>
      <td>CAT III</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>177</th>
      <td></td>
      <td>CCI-002041</td>
      <td>SRG-APP-000397-CTR-000955</td>
      <td></td>
      <td>The container platform must allow the use of a temporary password for system logons with an immediate change to a permanent password.</td>
      <td>Red Hat OpenShift Container Platform 4 must allow the use of a temporary password for system logons with an immediate change to a permanent password.</td>
      <td>Without providing this capability, an account may be created without a password. Non-repudiation cannot be guaranteed once an account is created if a user is not forced to change the temporary password upon initial login.<br><br>Temporary passwords are typically used to allow access to applications when new accounts are created or passwords are changed. It is common practice for administrators to create temporary passwords for user accounts, which allow the users to log in, yet forces them to change the password once they have successfully authenticated.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the platform is configured to allow the use of a temporary password for system logons with an immediate change to a permanent password. <br><br>If the container platform is not configured to allow temporary passwords with immediate change to a permanent password, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>178</th>
      <td></td>
      <td>CCI-002605</td>
      <td>SRG-APP-000456-CTR-001125</td>
      <td></td>
      <td>The container platform registry must contain the latest images with most recent updates and execute within the container platform runtime as authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Red Hat OpenShift Container Platform 4 registry must contain the latest images with most<br>recent updates and execute within the container platform runtime as<br>authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Software supporting the container platform, images in the registry must stay up to date with the latest patches, service packs, and hot fixes. Not updating the container platform and container images will expose the organization to vulnerabilities.<br><br>Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.<br><br>Organization-defined time periods for updating security-relevant container platform components may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).<br><br>This requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.<br><br>The container platform components will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The container platform registry will ensure the images are current. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td>
      <td>It is critical to the security ond stability of the container platform and the software services running on the platform to ensure that images are deployed through a trusted software supply chain. Some key elements to having a trusted supply chain include ensuring that images deployed to the container platform come from known, trusted sources.&nbsp;&nbsp;Additionally, it is also important to check for and apply security relevant updates in a timely manner.<br><br>In order to help users manage images, OpenShift uses image streams to provide a level of abstraction for the users. In this way the users can trigger automatic redeployments as images are updated. It is also possible to configure the image stream to periodically check the image source repository for any updates and automatically pull in the latest updates.<br><br>The OpenShift platform can be configured to limit and control which image source repositories may be used by the platform and the users of the platform. By configuring this to only allow users to deploy images from trusted sources, lowers the risk for a user to deploy unsafe, or untested images that would be detrimental to the security and stability of the platform.</td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform registry inspects and contains approved vendor repository latest images containing security-relevant updates within a timeframe directed by an authoritative source (IAVM, CTOs, DTMs, STIGs, etc.). <br><br>If the container platform registry does not contain the latest image with security-relevant updates within the time period directed by the authoritative source, this is a finding.<br><br>The container platform registry should help the user understand where the code in the environment was deployed from, and must provide controls that prevent deployment from untrusted sources or registries.</td>
      <td>To list all the imagestreams and identify which imagestream tags are configured to periodically check for updates (imagePolicy = { scheduled: true }) and (kind = DockerImage) run the following command:<br><br>&gt; oc get imagestream --all-namespaces -o jsonpath='{range .items[*]}{.metadata.name}{"<br>"}{range .spec.tags[*]}{"\t"}{.name}{": "}{.importPolicy}{"\t"}{.from}{"<br>"}<br><br>You will see an ouput similar to:<br><br>httpd<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4-el7: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4-el8: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latest: {}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <br>installer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latest: {"scheduled":true}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <br>installer-artifacts<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latest: {"scheduled":true}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <br><br>Review the listing, and for each imagestream tag version that does not have the value '{"scheduled":true}' that should otherwise check for updates, this is a finding.</td>
      <td></td>
      <td>For container images that are not scheduled to check for updates that otherwise should, update the imagestream to schedule updates for each tag using the following command.<br><br>&gt; oc patch imagestream&nbsp;&nbsp; -n NAMESPACE --type merge -p '{"spec":{"tags":[{"name":" ","importPolicy":{"scheduled":true}}]}}' <br><br>where,<br>NAME: The imagestream name to update<br>NAMESPACE: The namespace the imagestream is in. This will most often be 'openshift'.<br>TAG_NAME: The imagestream tag to update</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>179</th>
      <td></td>
      <td>CCI-002605</td>
      <td>SRG-APP-000456-CTR-001125</td>
      <td></td>
      <td>The container platform registry must contain the latest images with most recent updates and execute within the container platform runtime as authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Red Hat OpenShift Container Platform 4 registry must contain the latest images with most<br>recent updates and execute within the container platform runtime as<br>authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Software supporting the container platform, images in the registry must stay up to date with the latest patches, service packs, and hot fixes. Not updating the container platform and container images will expose the organization to vulnerabilities.<br><br>Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.<br><br>Organization-defined time periods for updating security-relevant container platform components may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).<br><br>This requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.<br><br>The container platform components will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The container platform registry will ensure the images are current. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td>
      <td>It is critical to the security ond stability of the container platform and the software services running on the platform to ensure that images are deployed through a trusted software supply chain. Some key elements to having a trusted supply chain include ensuring that images deployed to the container platform come from known, trusted sources.&nbsp;&nbsp;Additionally, it is also important to check for and apply security relevant updates in a timely manner.<br><br>In order to help users manage images, OpenShift uses image streams to provide a level of abstraction for the users. In this way the users can trigger automatic redeployments as images are updated. It is also possible to configure the image stream to periodically check the image source repository for any updates and automatically pull in the latest updates.<br><br>The OpenShift platform can be configured to limit and control which image source repositories may be used by the platform and the users of the platform. By configuring this to only allow users to deploy images from trusted sources, lowers the risk for a user to deploy unsafe, or untested images that would be detrimental to the security and stability of the platform.</td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform registry inspects and contains approved vendor repository latest images containing security-relevant updates within a timeframe directed by an authoritative source (IAVM, CTOs, DTMs, STIGs, etc.). <br><br>If the container platform registry does not contain the latest image with security-relevant updates within the time period directed by the authoritative source, this is a finding.<br><br>The container platform registry should help the user understand where the code in the environment was deployed from, and must provide controls that prevent deployment from untrusted sources or registries.</td>
      <td>To verify that the image source policy is configured, run the following command<br><br>&gt; oc get image.config.openshift.io/cluster -o jsonpath='{.spec.registrySources}{"<br>AllowedRegistriesForImport: "}{.spec.allowedRegistriesForImport}{"<br>"}'<br><br>You will see an output similar to the following:<br><br>{"allowedRegistries":["quay.io","registry.redhat.io","image-registry.openshift-image-registry.svc:5000"]}<br>AllowedRegistriesForImport: [{"domainName":"quay.io","insecure":false}]<br><br>If nothing is returned, this is a finding. If the registries listed under allowedRegistries, insecureRegistries, or AllowedRegistriesForImport are not from trusted sources as defined by the organization, this is a finding.</td>
      <td></td>
      <td>Edit the cluster image config resource to define the allowed registries.<br><br>&gt; oc edit image.config.openshift.io/cluster<br><br>The following is an example configuration, for a detailed explanation of the configuration properties see https://docs.openshift.com/container-platform/4.8/openshift_images/image-configuration.html<br><br>----------------------------------------------------------------------<br>apiVersion: config.openshift.io/v1<br>kind: Image <br>metadata:<br>annotations:<br>&nbsp;&nbsp;&nbsp;&nbsp;release.openshift.io/create-only: "true"<br>creationTimestamp: "2019-05-17T13:44:26Z"<br>generation: 1<br>name: cluster<br>resourceVersion: "8302"<br>selfLink: /apis/config.openshift.io/v1/images/cluster<br>uid: e34555da-78a9-11e9-b92b-06d6c7da38dc<br>spec:<br>allowedRegistriesForImport: <br>&nbsp;&nbsp;&nbsp;&nbsp;- domainName: quay.io<br>&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>additionalTrustedCA: <br>&nbsp;&nbsp;&nbsp;&nbsp;name: myconfigmap<br>registrySources: <br>&nbsp;&nbsp;&nbsp;&nbsp;allowedRegistries:<br>&nbsp;&nbsp;&nbsp;&nbsp;- example.com<br>&nbsp;&nbsp;&nbsp;&nbsp;- quay.io<br>&nbsp;&nbsp;&nbsp;&nbsp;- registry.redhat.io<br>&nbsp;&nbsp;&nbsp;&nbsp;- image-registry.openshift-image-registry.svc:5000<br>&nbsp;&nbsp;&nbsp;&nbsp;- reg1.io/myrepo/myapp:latest<br>&nbsp;&nbsp;&nbsp;&nbsp;insecureRegistries:<br>&nbsp;&nbsp;&nbsp;&nbsp;- insecure.com<br>status:<br>internalRegistryHostname: image-registry.openshift-image-registry.svc:5000<br>----------------------------------------------------------------------</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>180</th>
      <td></td>
      <td>CCI-002605</td>
      <td>SRG-APP-000456-CTR-001125</td>
      <td></td>
      <td>The container platform registry must contain the latest images with most recent updates and execute within the container platform runtime as authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Red Hat OpenShift Container Platform 4 registry must contain the latest images with most<br>recent updates and execute within the container platform runtime as<br>authorized by IAVM, CTOs, DTMs, and STIGs.</td>
      <td>Software supporting the container platform, images in the registry must stay up to date with the latest patches, service packs, and hot fixes. Not updating the container platform and container images will expose the organization to vulnerabilities.<br><br>Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.<br><br>Organization-defined time periods for updating security-relevant container platform components may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).<br><br>This requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.<br><br>The container platform components will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The container platform registry will ensure the images are current. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td>
      <td>It is critical to the security ond stability of the container platform and the software services running on the platform to ensure that images are deployed through a trusted software supply chain. Some key elements to having a trusted supply chain include ensuring that images deployed to the container platform come from known, trusted sources.&nbsp;&nbsp;Additionally, it is also important to check for and apply security relevant updates in a timely manner.<br><br>In order to help users manage images, OpenShift uses image streams to provide a level of abstraction for the users. In this way the users can trigger automatic redeployments as images are updated. It is also possible to configure the image stream to periodically check the image source repository for any updates and automatically pull in the latest updates.<br><br>The OpenShift platform can be configured to limit and control which image source repositories may be used by the platform and the users of the platform. By configuring this to only allow users to deploy images from trusted sources, lowers the risk for a user to deploy unsafe, or untested images that would be detrimental to the security and stability of the platform.</td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform registry inspects and contains approved vendor repository latest images containing security-relevant updates within a timeframe directed by an authoritative source (IAVM, CTOs, DTMs, STIGs, etc.). <br><br>If the container platform registry does not contain the latest image with security-relevant updates within the time period directed by the authoritative source, this is a finding.<br><br>The container platform registry should help the user understand where the code in the environment was deployed from, and must provide controls that prevent deployment from untrusted sources or registries.</td>
      <td>To verify that the image source policy is configured, run the following command<br><br>&gt; oc get image.config.openshift.io/cluster -o jsonpath='{.spec.registrySources}{"<br>AllowedRegistriesForImport: "}{.spec.allowedRegistriesForImport}{"<br>"}'<br><br>You will see an output similar to the following:<br><br>{"allowedRegistries":["quay.io","registry.redhat.io","image-registry.openshift-image-registry.svc:5000"]}<br>AllowedRegistriesForImport: [{"domainName":"quay.io","insecure":false}]<br><br>If nothing is returned, this is a finding. If the registries listed under allowedRegistries, insecureRegistries, or AllowedRegistriesForImport are not from trusted sources as defined by the organization, this is a finding.</td>
      <td></td>
      <td>Edit the cluster image config resource to define the allowed registries.<br><br>&gt; oc edit image.config.openshift.io/cluster<br><br>The following is an example configuration, for a detailed explanation of the configuration properties see https://docs.openshift.com/container-platform/4.8/openshift_images/image-configuration.html<br><br>----------------------------------------------------------------------<br>apiVersion: config.openshift.io/v1<br>kind: Image <br>metadata:<br>annotations:<br>&nbsp;&nbsp;&nbsp;&nbsp;release.openshift.io/create-only: "true"<br>creationTimestamp: "2019-05-17T13:44:26Z"<br>generation: 1<br>name: cluster<br>resourceVersion: "8302"<br>selfLink: /apis/config.openshift.io/v1/images/cluster<br>uid: e34555da-78a9-11e9-b92b-06d6c7da38dc<br>spec:<br>allowedRegistriesForImport: <br>&nbsp;&nbsp;&nbsp;&nbsp;- domainName: quay.io<br>&nbsp;&nbsp;&nbsp;&nbsp;insecure: false<br>additionalTrustedCA: <br>&nbsp;&nbsp;&nbsp;&nbsp;name: myconfigmap<br>registrySources: <br>&nbsp;&nbsp;&nbsp;&nbsp;allowedRegistries:<br>&nbsp;&nbsp;&nbsp;&nbsp;- example.com<br>&nbsp;&nbsp;&nbsp;&nbsp;- quay.io<br>&nbsp;&nbsp;&nbsp;&nbsp;- registry.redhat.io<br>&nbsp;&nbsp;&nbsp;&nbsp;- image-registry.openshift-image-registry.svc:5000<br>&nbsp;&nbsp;&nbsp;&nbsp;- reg1.io/myrepo/myapp:latest<br>&nbsp;&nbsp;&nbsp;&nbsp;insecureRegistries:<br>&nbsp;&nbsp;&nbsp;&nbsp;- insecure.com<br>status:<br>internalRegistryHostname: image-registry.openshift-image-registry.svc:5000<br>----------------------------------------------------------------------</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>181</th>
      <td></td>
      <td>CCI-000381</td>
      <td>SRG-APP-000141-CTR-000320</td>
      <td></td>
      <td>The container platform registry must contain only container images for those capabilities being offered by the container platform.</td>
      <td>Red Hat OpenShift Container Platform 4 registry must contain only container images for those capabilities being offered by the container platform.</td>
      <td>Allowing container images to reside within the container platform registry that are not essential to the capabilities being offered by the container platform becomes a potential security risk. By allowing these non-essential container images to exist, the possibility for accidental instantiation exists. The images may be unpatched, not supported, or offer non-approved capabilities. Those images for customer services are considered essential capabilities.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform registry and the container images being stored. <br><br>If container images are stored in the registry and are not being used to offer container platform capabilities, this is a finding.</td>
      <td>To review the container images within the container platform registry, run the following command:<br>&gt; oc get images<br>Review the container platform container images to validate that only<br>necessary container images for the functionality of the information<br>system are present.</td>
      <td></td>
      <td>Remove all container images from the container platform registry that<br>are not being used or contain features and functions not supported by<br>the platform.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>182</th>
      <td></td>
      <td>CCI-001953</td>
      <td>SRG-APP-000391-CTR-000935</td>
      <td></td>
      <td>The container platform must be configured to use multi-factor authentication for user authentication.</td>
      <td>Red Hat OpenShift Container Platform 4 must be configured to use multi-factor authentication for user authentication.</td>
      <td>Controlling access to the container platform and its components is paramount in having a secure and stable system. Validating users is the first step in controlling the access. Users may be validated by the overall container platform or they may be validated by each component. To standardize and reduce the risks of unauthorized access, the use of multifactor token-based credentials is the preferred method.<br><br>DoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under HSPD 12, as well as a primary component of layered protection for national security systems.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review documentation and configuration to ensure the container platform is configured to use an approved DoD multifactor token (CAC) when accessing platform via user interfaces. <br><br>If multifactor authentication is not configured, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>183</th>
      <td></td>
      <td>CCI-002422</td>
      <td>SRG-APP-000442-CTR-001095</td>
      <td></td>
      <td>The container platform must maintain the confidentiality and integrity of information during reception.</td>
      <td>Red Hat OpenShift Container Platform 4 must maintain the confidentiality and integrity of information during reception.</td>
      <td>Information either can be unintentionally or maliciously disclosed or modified during reception for reception within the container platform during aggregation, at protocol transformation points, and during container image runtime. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. When receiving data, the container platform components need to leverage protection mechanisms, such as TLS, TLS VPNs, or IPsec.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review documentation and configuration settings to determine if the container platform maintains the confidentiality and integrity of information during reception.<br><br>If confidentiality and integrity are not maintained using mechanisms such as TLS, TLS VPNs, or IPsec during reception, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://access.redhat.com/articles/5348961</td>
      <td>The OpenShift Container Platform uses TLS encryption for communication with the internal components. Many of these components support additional levels of configuration, such as allowed cyphers and minimum TLS levels. Although not all components support this additional configuration, they still use TLS for encryption of the internal communications.</td>
    </tr>
    <tr>
      <th>184</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td></td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>185</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000206-GPOS-00084,SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td>Red Hat OpenShift Container Platform 4 audit logs file must have mode 0600 or less permissive to prevent unauthorized access to the audit log.</td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td>Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the Red Hat OpenShift Container Platform 4 system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.<br><br>The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td>Verify the audit logs have a mode of "0600".<br><br>Determine where the audit logs are stored with the following command:<br><br>$ sudo grep -iw log_file /etc/audit/auditd.conf<br><br>log_file = /var/log/audit/audit.log<br><br>Using the location of the audit log file, determine the mode of each audit log with the following command:<br><br>$ sudo find /var/log/audit/ -type f -exec stat -c '%a %n' {} \;<br><br>rw-------. 2 root root 237923 Jun 11 11:56 /var/log/audit/audit.log<br><br>If the audit logs have a mode more permissive than "0600", this is a finding.</td>
      <td></td>
      <td>Configure the audit logs to have a mode of "0600" with the following command:<br><br>Replace "[audit_log_file]" with the path to each audit log file. By default, these logs are located in "/var/log/audit/.<br><br>$ sudo chmod 0600 /var/log/audit/[audit_log_file]<br><br>Check the group that owns the system audit logs:<br><br>$ sudo grep -iw log_group /etc/audit/auditd.conf<br><br>If log_group is set to a user other than root, configure the permissions the following way:<br><br>$ sudo chmod 0640 $log_file<br>$ sudo chmod 0440 $log_file.*<br><br>Otherwise, configure the permissions the following way:<br><br>$ sudo chmod 0600 $log_file<br>$ sudo chmod 0400 $log_file.*</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>186</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td></td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>187</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td></td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>188</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td></td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>189</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-OS-000206-GPOS-00084,SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td>Red Hat OpenShift Container Platform 4 /var/log directory must have mode 0755 or less permissive.</td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td>Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the Red Hat OpenShift Container Platform 4 system or platform. Additionally, personally identifiable information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.<br><br>The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td>Verify that the "/var/log" directory has a mode of "0755" or less permissive with the following command:<br><br>$ stat -c '%a %n' /var/log<br><br>755 /var/log<br><br>If "/var/log" does not have a mode of "0755" or less permissive, this is a finding.</td>
      <td></td>
      <td>Configure the "/var/log" directory to a mode of "0755" by running the following command:<br><br>$ sudo chmod 0755 /var/log</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>190</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-OS-000206-GPOS-00084,SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td>Red Hat OpenShift Container Platform 4 /var/log directory must be owned by root.</td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td>Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the Red Hat OpenShift Container Platform 4 system or platform. Additionally, personally identifiable information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.<br><br>The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td>Verify the "/var/log" directory is owned by root with the following command:<br><br>$ stat -c "%U %n" /var/log<br><br>root /var/log<br><br>If "/var/log" does not have an owner of "root", this is a finding.</td>
      <td></td>
      <td>Configure the owner of the directory "/var/log" to "root" by running the following command:<br><br>$ sudo chown root /var/log</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>191</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-OS-000206-GPOS-00084,SRG-APP-000118-CTR-000240</td>
      <td></td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td>Red Hat OpenShift Container Platform 4 /var/log directory must be group-owned by root.</td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td>Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the Red Hat OpenShift Container Platform 4 system or platform. Additionally, personally identifiable information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.<br><br>The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td>Verify the "/var/log" directory is group-owned by root with the following command:<br><br>$ stat -c "%G %n" /var/log<br><br>root /var/log<br><br>If "/var/log" does not have a group owner of "root", this is a finding.</td>
      <td></td>
      <td>Configure the group owner of the directory "/var/log" to "root" by running the following command:<br><br>$ sudo chgrp root /var/log</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>192</th>
      <td></td>
      <td>CCI-000162</td>
      <td>SRG-APP-000118-CTR-000240</td>
      <td>CCE-88593-9</td>
      <td>The container platform must protect audit information from any type of unauthorized read access.</td>
      <td>OpenShift must protect audit information from unauthorized modification.</td>
      <td>If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.<br><br>To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.<br><br>This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.<br><br>Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.<br><br>Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine where audit information is stored. <br><br>If the audit information is not protected from any type of unauthorized read access, this is a finding.</td>
      <td>Verify the permissions and ownership of files located under "/var/log/pods" that store the output of pods are set to protect from unauthorized access.<br><br>1. Verify the files are readable only by the owner by executing the following command:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; find /var/log/pods/ -type f \( -perm /022 -o -perm /044 \)' 2&gt;/dev/null; done<br><br>If any files are returned, this is a finding.<br><br>2. Verify files are group-owned by root and owned by root by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; find /var/log/pods/ -type f \! -user 0' 2&gt;/dev/null; done<br><br>(Example output:<br>ip-10-0-150-1 root root)<br><br>If "root" is not returned as the owner, this is a finding.<br><br>If "root" is not returned as the group owner, this is a finding.</td>
      <td></td>
      <td>Change the permissions and ownership of files located under "/var/log/pods" to protect from unauthorized access.<br><br>1. Execute the following to set the output of pods readable only by the owner:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; find /var/log/pods/ -type f \( -perm /022 -o -perm /044 \) | xargs -r chmod 600' 2&gt;/dev/null; done<br><br>2. Execute the following to set the group and group-ownership to root for files that store the output of pods:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; find /var/log/pods/ -type f \! -user 0 | xargs -r chown root:root' 2&gt;/dev/null; done</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>193</th>
      <td></td>
      <td>CCI-000187</td>
      <td>SRG-APP-000177-CTR-000465</td>
      <td></td>
      <td>The container platform must map the authenticated identity to the individual user or group account for PKI-based authentication.</td>
      <td>Red Hat OpenShift Container Platform 4 must map the authenticated identity to the individual user or group account for PKI-based authentication.</td>
      <td>The container platform and its components may require authentication before use. When the authentication is PKI-based, the container platform or component must map the certificate to a user account. If the certificate is not mapped to a user account, the ability to determine the identity of the individual user or group will not be available for forensic analysis.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review documentation and configuration to ensure the container platform provides a PKI integration capability that meets DoD PKI infrastructure requirements. <br><br>If the container platform is not configured to meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>194</th>
      <td></td>
      <td>CCI-001084</td>
      <td>SRG-APP-000233-CTR-000585</td>
      <td></td>
      <td>The container platform runtime must isolate security functions from non-security functions.</td>
      <td></td>
      <td>The container platform runtime must be configured to isolate those services used for security functions from those used for non-security functions. This separation can be performed using environment variables, labels, network segregation, and kernel groups.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Verify container platform runtime configuration settings to determine whether container services used for security functions are located in an isolated security function such as a separate environment variables, labels, network segregation, and kernel groups.<br><br>If security-related functions are not separate, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>195</th>
      <td></td>
      <td>CCI-001084</td>
      <td>SRG-OS-000445-GPOS-00199,SRG-APP-000233-CTR-000585</td>
      <td></td>
      <td>The container platform runtime must isolate security functions from non-security functions.</td>
      <td>Red Hat OpenShift Container Platform 4 must enable the SELinux targeted policy.</td>
      <td>The container platform runtime must be configured to isolate those services used for security functions from those used for non-security functions. This separation can be performed using environment variables, labels, network segregation, and kernel groups.</td>
      <td>Setting the SELinux policy to "targeted" or a more specialized policy<br>ensures the system will confine processes that are likely to be<br>targeted for exploitation, such as network or system services.<br><br><br><br>Note: During the development or debugging of SELinux modules, it is common to<br>temporarily place non-production systems in "permissive" mode. In such<br>temporary cases, SELinux policies should be developed, and once work<br>is completed, the system should be reconfigured to<br>"targeted".</td>
      <td>Applicable - Configurable</td>
      <td>Verify container platform runtime configuration settings to determine whether container services used for security functions are located in an isolated security function such as a separate environment variables, labels, network segregation, and kernel groups.<br><br>If security-related functions are not separate, this is a finding.</td>
      <td>Verify the SELINUX on Red Hat OpenShift Container Platform 4 is using the targeted policy with the following command:<br><br>$ sestatus | grep policy<br><br>Loaded policy name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; targeted<br><br>If the loaded policy name is not "targeted", this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to use the targetd SELINUX policy.<br><br>Edit the file "/etc/selinux/config" and add or modify the following line:<br><br> SELINUXTYPE=targeted<br><br>A reboot is required for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>196</th>
      <td></td>
      <td></td>
      <td>SRG-OS-000445-GPOS-00199,SRG-OS-000134-GPOS-00068</td>
      <td></td>
      <td>The container platform runtime must isolate security functions from non-security functions.</td>
      <td>Red Hat OpenShift Container Platform 4 must use a Linux Security Module configured to enforce limits on system services.</td>
      <td>The container platform runtime must be configured to isolate those services used for security functions from those used for non-security functions. This separation can be performed using environment variables, labels, network segregation, and kernel groups.</td>
      <td>Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.<br><br>This requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.</td>
      <td>Applicable - Configurable</td>
      <td>Verify container platform runtime configuration settings to determine whether container services used for security functions are located in an isolated security function such as a separate environment variables, labels, network segregation, and kernel groups.<br><br>If security-related functions are not separate, this is a finding.</td>
      <td>Ensure that Red Hat OpenShift Container Platform 4 verifies correct operation of security functions through the use of SELinux with the following command:<br><br>$ getenforce<br><br>Enforcing<br><br>If SELINUX is not set to "Enforcing", this is a finding.<br><br>Verify that SELinux is configured to be enforcing at boot.<br><br>grep "SELINUX=" /etc/selinux/config<br># SELINUX= can take one of these three values:<br># NOTE: In earlier Fedora kernel builds, SELINUX=disabled would also<br>SELINUX=enforcing<br><br>If SELINUX line is missing, commented out, or not set to "enforcing", this is a finding.</td>
      <td></td>
      <td>Configure Red Hat OpenShift Container Platform 4 to verify correct operation of security functions.<br><br>Edit the file "/etc/selinux/config" and add or modify the following line:<br> SELINUX=enforcing<br><br>A reboot is required for the changes to take effect.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>197</th>
      <td></td>
      <td>CCI-001312</td>
      <td>SRG-APP-000266-CTR-000625</td>
      <td></td>
      <td>The container platform must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</td>
      <td>Red Hat OpenShift Container Platform 4 must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</td>
      <td>The container platform is responsible for offering services to users. These services could be across diverse user groups and data types. To protect information about the container platform, services, users, and data, it is important during error message generation to offer enough information to diagnose the error, but not reveal information that needs to be protected.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review documentation and logs to determine if the container platform writes sensitive information such as passwords or private keys into the logs and administrative messages. <br><br>If the container platform writes sensitive or potentially harmful information into the logs and administrative messages, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation:<br>https://docs.openshift.com/container-platform/latest/logging/cluster-logging-visualizer.html<br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
      <td>In OpenShift, the logs depend greatly on the component. Some components would just write messages to stdout that the cluster administrator can retrieve logs through the use of the oc command. Some components emit events, and others emit a Prometheus metric which the API server would write into their logs.<br><br>For the OCP components that run in a container (most operators), the usual RBAC rules would prevent a non-admin user from reading the container logs or events.<br><br>OpenShift error message handling is designed to obscure or not log sensitive information which is contained inside Secrets.<br><br>Error Messages from applications will need to be reviewed independently as the messages provided by the application hosted on the platform is outside the scope of the platform control.</td>
    </tr>
    <tr>
      <th>198</th>
      <td></td>
      <td>CCI-000768</td>
      <td>SRG-APP-000152-CTR-000370</td>
      <td></td>
      <td>The container platform must use multifactor authentication for local access to non-privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use multifactor authentication for local access to non-privileged accounts.</td>
      <td>To ensure accountability, prevent unauthenticated access, and prevent misuse of the system, non-privileged users must utilize multi-factor authentication for local access.<br><br>Multifactor authentication is defined as using two or more factors to achieve authentication.<br><br>Factors include: <br>(i) Something a user knows (e.g., password/PIN); <br>(ii) Something a user has (e.g., cryptographic identification device, token); or <br>(iii) Something a user is (e.g., biometric).<br><br>A non-privileged account is defined as an information system account with authorizations of a regular or non-privileged user.<br><br>Local access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if multifactor authentication is used for local access to non-privileged accounts. <br><br>If multifactor authentication for local access to non-privileged accounts is not being used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>199</th>
      <td></td>
      <td>CCI-000766</td>
      <td>SRG-APP-000150-CTR-000360</td>
      <td></td>
      <td>The container platform must use multifactor authentication for network access to non-privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use multifactor authentication for network access to non-privileged accounts.</td>
      <td>To ensure accountability and prevent unauthenticated access, non-privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.<br><br>Multifactor authentication uses two or more factors to achieve authentication.<br><br>Factors include: <br>(i) Something you know (e.g., password/PIN); <br>(ii) Something you have (e.g., cryptographic identification device, token); or <br>(iii) Something you are (e.g., biometric).<br><br>A non-privileged account is any information system account with authorizations of a non-privileged user.<br><br>Network access is any access to an application by a user (or process acting on behalf of a user) where said access is obtained through a network connection.<br><br>Applications integrating with the DoD Active Directory and utilize the DoD CAC are examples of compliant multifactor authentication solutions.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to use multifactor authentication for network access to non-privileged accounts. <br><br>If the container platform does not use multifactor authentication for network access to non-privileged accounts, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>200</th>
      <td></td>
      <td>CCI-000382</td>
      <td>SRG-APP-000142-CTR-000325</td>
      <td></td>
      <td>The container platform runtime must enforce ports, protocols, and services that adhere to the PPSM CAL.</td>
      <td>Red Hat OpenShift Container Platform 4 runtime must enforce ports, protocols, and services that adhere to the PPSM CAL.</td>
      <td>Ports, protocols, and services within the container platform runtime must be controlled and conform to the PPSM CAL. Those ports, protocols, and services that fall outside the PPSM CAL must be blocked by the runtime. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform documentation and deployment configuration to determine which ports and protocols are enabled. <br><br>Verify the ports and protocols being used are not prohibited by PPSM CAL in accordance to DoD Instruction 8551.01 Policy and are necessary for the operations and applications.<br><br>If any of the ports or protocols is prohibited or not necessary for the operation, this is a finding.</td>
      <td>Review the OpenShift documentation and configuration.<br>(See for additional information: https://docs.openshift.com/container-platform/4.12/installing/installing_platform_agnostic/installing-platform-agnostic.html)<br><br>1. Interview the application administrator.<br><br>2. Identify the TCP/IP port numbers OpenShift is configured to utilize and is utilizing by using a combination of relevant OS commands and application configuration utilities.<br><br>3. Identify the network ports and protocols that are utilized by kube-apiserver by executing the following:<br>oc get configmap kube-apiserver-pod -n openshift-kube-apiserver -o "jsonpath={ .data['pod\.yaml'] }" | jq '..|.containerPort?' | grep -v "null"<br><br>oc get configmap kube-apiserver-pod -n openshift-kube-apiserver -o "jsonpath={ .data['pod\.yaml'] }" | jq '..|.hostPort?' | grep -v "null"<br><br>oc get services -A --show-labels | grep apiserver | awk '{print $6,$8}' | grep apiserver<br><br>4. Identify the network ports and protocols that are utilized by kube-scheduler by executing the following:<br>oc get configmap kube-scheduler-pod -n openshift-kube-scheduler -o "jsonpath={ .data['pod\.yaml'] }" | jq '..|.containerPort?' | grep -v "null"<br><br>oc get services -A --show-labels | grep scheduler | awk '{print $6,$8}' | grep scheduler<br><br>5. Identify the network ports and protocols that are utilized by kube-controller-manager by executing the following:<br>oc get configmap kube-controller-manager-pod -n openshift-kube-controller-manager -o "jsonpath={ .data['pod\.yaml'] }" | jq '..|.containerPort?' | grep -v "null"<br><br>oc get services -A --show-labels | grep kube-controller<br><br>6. Identify the network ports and protocols that are utilized by etcd by executing the following:<br>oc get configmap etcd-pod -n openshift-etcd -o "jsonpath={ .data['pod\.yaml'] }" | grep -Po '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}:[0-9]+' | sort -u<br><br><br>Review the PPSM web page at:<br><br>http://www.disa.mil/Network-Services/Enterprise-Connections/PPSM<br><br>Review the PPSM Category Assurance List (CAL) directly at the following link: <br><br>https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx<br><br>Verify the ports used by the OpenShift are approved by the PPSM CAL.<br><br>If the ports, protocols, and services have not be registered locally, this is a finding.</td>
      <td></td>
      <td>Verify the accreditation documentation lists all interfaces and the ports, protocols, and services used.<br><br>Register OpenShift's ports, protocols, and services with PPSM.</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>201</th>
      <td></td>
      <td>CCI-001682</td>
      <td>SRG-APP-000234-CTR-000590</td>
      <td></td>
      <td>The container platform must never automatically remove or disable emergency accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must never automatically remove or disable emergency accounts.</td>
      <td>Emergency accounts are administrator accounts that are established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.<br><br>Emergency accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency account is normally a different account that is created for use by vendors or system maintainers.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform to determine if emergency accounts are automatically removed or disabled. <br><br>If emergency accounts are automatically removed or disabled, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/post_installation_configuration/preparing-for-users.html</td>
      <td>No users are ever created or removed automatically. Any manually created<br>emergency accounts would persist, and it is recommended that normal<br>cluster authentication be delegated to an external IdP as recommended<br>in SRG-APP-000023-CTR-000055.</td>
    </tr>
    <tr>
      <th>202</th>
      <td></td>
      <td>CCI-001890</td>
      <td>SRG-APP-000374-CTR-000865</td>
      <td></td>
      <td>All audit records must use UTC or GMT time stamps.</td>
      <td>All audit records must use UTC or GMT time stamps.</td>
      <td>The container platform and its components must generate audit records using either Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT) time stamps or local time that offset from UTC. All the components must use the same standard so that the events can be tied together to understand what took place within the overall container platform.<br><br>Time stamps generated by the container platform and its components must include date and time.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform documentation and configuration files to determine if time stamps for log records can be mapped to UTC or GMT or local time that offsets from UTC. <br><br>If the time stamp cannot be mapped to UTC or GMT, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/security/audit-log-view.html</td>
      <td>Openshift Container Platform conforms to DoD/DISA requirements regarding audit log fields.</td>
    </tr>
    <tr>
      <th>203</th>
      <td></td>
      <td>CCI-000017</td>
      <td>SRG-APP-000025-CTR-000065</td>
      <td></td>
      <td>The container platform must automatically disable accounts after a 35-day period of account inactivity.</td>
      <td>Red Hat OpenShift Container Platform 4 must automatically disable accounts after a 35-day period of account inactivity.</td>
      <td>Attackers that are able to exploit an inactive account can potentially obtain and maintain undetected access to an application. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained. Applications need to track periods of user inactivity and disable accounts after 35 days of inactivity. Such a process greatly reduces the risk that accounts will be hijacked, leading to a data compromise.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.<br><br>This policy does not apply to either emergency accounts or infrequently used accounts. Infrequently used accounts are local login administrator accounts used by system administrators when network or normal logon/access is not available. Emergency accounts are administrator accounts created in response to crisis situations.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Determine if the container platform automatically disables accounts after a 35-day period of account inactivity. <br><br>If the container platform does not automatically disable accounts after a 35-day period of account inactivity, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>204</th>
      <td></td>
      <td>CCI-000196</td>
      <td>SRG-APP-000171-CTR-000435</td>
      <td></td>
      <td>For container platform using password authentication, the application must store only cryptographic representations of passwords.</td>
      <td>For container platform using password authentication, the application must store only cryptographic representations of passwords.</td>
      <td>Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read and easily compromised. Use of passwords for authentication is intended only for limited situations and should not be used as a replacement for two-factor CAC-enabled authentication.<br><br>Examples of situations where a user ID and password might be used include:<br><br>- When the user does not use a CAC and is not a current DoD employee, member of the military, or DoD contractor.<br><br>- When a user has been officially designated as temporarily unable to present a CAC for some reason (lost, damaged, not yet issued, broken card reader) (i.e., Temporary Exception User) and to satisfy urgent organizational needs must be temporarily permitted to use user ID/password authentication until the problem with CAC use has been remedied.<br><br>- When the application is publicly available and or hosting publicly releasable data requiring some degree of need-to-know protection.<br><br>If the password is already encrypted and not a plaintext password, this meets this requirement. Implementation of this requirement requires configuration of FIPS-approved cipher block algorithm and block cipher modes for encryption. This method uses a one-way hashing encryption algorithm with a salt value to validate a user's password without having to store the actual password. Performance and time required to access are factors that must be considered, and the one-way hash is the most feasible means of securing the password and providing an acceptable measure of password security.<br><br>Verifying the user knows a password is performed using a password verifier. In its simplest form, a password verifier is a computational function that is capable of creating a hash of a password and determining if the value provided by the user matches the hash. A more secure version of verifying a user knowing a password is to store the result of an iterating hash function and a large random salt value as follows:<br><br>H0 = H(pwd, H(salt))<br>Hn = H(Hn-1,H(salt))<br><br>In the above, "n" is a cryptographically-strong random [*3] number. "Hn" is stored along with the salt. When the application wishes to verify that the user knows a password, it simply repeats the process and compares "Hn" with the stored "Hn". A salt is essentially a fixed-length cryptographically strong random value.<br><br>Another method is using a keyed-hash message authentication code (HMAC). HMAC calculates a message authentication code via a cryptographic hash function used in conjunction with an encryption key. The key must be protected as with any private key.<br><br>This requirement applies to all accounts including authentication server, AAA, and local account, including the root account and the account of last resort.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it using password authentication and stores only cryptographic representations of the passwords. <br><br>If the container platform is using password authentication and does not store only cryptographic representations of passwords, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>205</th>
      <td></td>
      <td>CCI-001190</td>
      <td>SRG-APP-000225-CTR-000570</td>
      <td></td>
      <td>The container platform runtime must fail to a secure state if system initialization fails, shutdown fails, or aborts fail.</td>
      <td>Red Hat OpenShift Container Platform 4 runtime must fail to a secure state if system initialization fails, shutdown fails, or aborts fail.</td>
      <td>The container platform offers services for container image orchestration and services for users. If any of these services were to fail into an insecure state, security measures for user and data separation and image instantiation could become absent. In addition, audit log protections could be relaxed allowing for investigation of what occurred could be lost. To protect services and data, it is important for the container platform to fail to a secure state if the container platform registry initialization fails, shutdown fails, or aborts fail.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review documentation and configuration to determine if the container platform runtime fails to a secure state if system initialization fails, shutdown fails, or aborts fail. <br><br>If the container platform runtime cannot be configured to fail securely, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/support/gathering-cluster-data.html</td>
      <td>In the event that there is a failure or disruption to the OpenShift platform, information necessary to identifying the cause would be preserved. The cluster state (resource definitions) is preserved by etcd, audit and system logs are preserved via journald service at the node levels. The following guide provide steps on how to gather cluster data in order to investigate issue with the cluster.<br>https://docs.openshift.com/container-platform/latest/support/gathering-cluster-data.html</td>
    </tr>
    <tr>
      <th>206</th>
      <td></td>
      <td>CCI-002824</td>
      <td>SRG-OS-000433-GPOS-00193,SRG-OS-000480-GPOS-00227,SRG-APP-000450-CTR-001105</td>
      <td></td>
      <td>The container platform must implement organization-defined security safeguards to protect system CPU and memory from resource depletion and unauthorized code execution.</td>
      <td>Red Hat OpenShift Container Platform 4 must implement address space layout randomization (ASLR) to protect its memory from unauthorized code execution.</td>
      <td>The execution of images within the container platform runtime must implement organizational defined security safeguards to prevent distributed denial-of-service (DDOS) and other possible attacks against the container image at runtime.<br><br>Security safeguards employed to protect memory and CPU include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can be software-enforced. Other means of protection are to limit memory and CPU resources to a container.</td>
      <td>Address space layout randomization (ASLR) makes it more difficult for an attacker to predict the location of attack code they have introduced into a process' address space during an attempt at exploitation. Additionally, ASLR makes it more difficult for an attacker to know the location of existing code in order to repurpose it using return oriented programming (ROP) techniques.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if safeguards are in place to protect the system memory and CPU from resource depletion and unauthorized execution. <br><br>If safeguards are not in place, this is a finding.</td>
      <td>Verify Red Hat OpenShift Container Platform 4 is implementing ASLR with the following command:<br><br>$ sudo sysctl kernel.randomize_va_space<br><br>kernel.randomize_va_space = 2<br><br>Check that the configuration files are present to enable this kernel parameter.<br>Verify the configuration of the kernel.kptr_restrict kernel parameter with the following command:<br><br>$ sudo /usr/lib/systemd/systemd-sysctl --cat-config | egrep -v '^(#|;)' |&nbsp;&nbsp;grep -F kernel.randomize_va_space | tail -1<br><br>kernel.randomize_va_space = 2<br><br>If "kernel.randomize_va_space" is not set to "2" or is missing, this is a finding.</td>
      <td></td>
      <td>Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:<br><br>kernel.randomize_va_space = 2<br><br>Reload settings from all system configuration files with the following command:<br><br>$ sudo sysctl --system</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>207</th>
      <td></td>
      <td>CCI-002824</td>
      <td>SRG-OS-000433-GPOS-00192,SRG-APP-000450-CTR-001105</td>
      <td></td>
      <td>The container platform must implement organization-defined security safeguards to protect system CPU and memory from resource depletion and unauthorized code execution.</td>
      <td>Red Hat OpenShift Container Platform 4 must implement non-executable data to protect its memory from unauthorized code execution.</td>
      <td>The execution of images within the container platform runtime must implement organizational defined security safeguards to prevent distributed denial-of-service (DDOS) and other possible attacks against the container image at runtime.<br><br>Security safeguards employed to protect memory and CPU include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can be software-enforced. Other means of protection are to limit memory and CPU resources to a container.</td>
      <td>ExecShield uses the segmentation feature on all x86 systems to prevent<br>execution in memory higher than a certain address. It writes an address as<br>a limit in the code segment descriptor, to control where code can be<br>executed, on a per-process basis. When the kernel places a process's memory<br>regions such as the stack and heap higher than this address, the hardware<br>prevents execution in that address range. This is enabled by default on the<br>latest Red Hat and Fedora systems if supported by the hardware.</td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if safeguards are in place to protect the system memory and CPU from resource depletion and unauthorized execution. <br><br>If safeguards are not in place, this is a finding.</td>
      <td>Verify the NX (no-execution) bit flag is set on the system.<br><br>Check that the no-execution bit flag is set with the following commands:<br><br>$ sudo dmesg | grep NX<br><br>[ 0.000000] NX (Execute Disable) protection: active<br><br>If "dmesg" does not show "NX (Execute Disable) protection" active, check the cpuinfo settings with the following command:<br><br>$ sudo grep -i flags /proc/cpuinfo<br>flags : fpu vme de pse tsc ms nx rdtscp lm constant_tsc<br><br>If "flags" does not contain the "nx" flag, this is a finding.</td>
      <td></td>
      <td>Update the GRUB 2 bootloader configuration.<br><br>Run the following command:<br><br>$ sudo grubby --update-kernel=ALL --remove-args=noexec</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>208</th>
      <td></td>
      <td>CCI-000185</td>
      <td>SRG-APP-000605-CTR-001380</td>
      <td></td>
      <td>The container platform must validate certificates used for Transport Layer Security (TLS) functions by performing an RFC 5280-compliant certification path validation.</td>
      <td>Red Hat OpenShift Container Platform 4 must validate certificates used for Transport Layer Security (TLS) functions by performing an RFC 5280-compliant certification path validation.</td>
      <td>A certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate and discourages the use of self-signed certificates.<br><br>Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses. Compliance checks should be in accordance to RFC 5280.<br><br>Not adhering to RFC 5280 could result in rogue certificates, session hijacks, man-in-the-middle, denial-of-service attacks, malware, and data or information manipulation.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to verify the container platform is validating certificates used for Transport Layer Security (TLS) functions by performing a RFC 5280-compliant certification path validation and that self-signed certificates are not being used. <br><br>If the container platform is not validating certificates used for TLS functions by performing an RFC 5280-compliant certification path validation, this is a finding. <br><br>If self-signed certificates are in use, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/security/certificate_types_descriptions/node-certificates.html</td>
      <td>Internal components are secured with two-way TLS. Certificate revocation lists (CRLs) are not currently supported by Kubernetes upstream - https://github.com/kubernetes/kubernetes/issues/18982. Application components can be fully compliant by adding the checks inside container images.<br><br>https://docs.openshift.com/container-platform/latest/security/certificate_types_descriptions/node-certificates.html<br><br>Node certificates are signed by the cluster; they come from a certificate authority (CA) that is generated by the bootstrap process. Once the cluster is installed, the node certificates are auto-rotated.<br><br>Node certificates are managed by the cluster and not the user<br></td>
    </tr>
    <tr>
      <th>209</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-001325</td>
      <td></td>
      <td>The container platform must prohibit containers from accessing privileged resources.</td>
      <td></td>
      <td>Containers images instantiated within the container platform may request access to host system resources. Access to privileged resources can allow for unauthorized and unintended transfer of information, but in some cases, these resources may be needed for the service being offered by the container. By default, containers should be denied instantiation when privileged system resources are requested and granted only after approval has been given.<br><br>When access to privileged resources is necessary for a container, a new policy for execution should be written for the container. The default behavior must not give containers privileged access to host system resources.<br><br>Examples of system resources that should be protected are kernel namespaces and host system sensitive directories such as /etc and /usr.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform disallows instantiation of containers trying to access host system privileged resources. <br><br>If the container platform does not block containers requesting host system privileged resources, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>210</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-001325</td>
      <td>CCE-84042-1</td>
      <td>The container platform must prohibit containers from accessing privileged resources.</td>
      <td></td>
      <td>Containers images instantiated within the container platform may request access to host system resources. Access to privileged resources can allow for unauthorized and unintended transfer of information, but in some cases, these resources may be needed for the service being offered by the container. By default, containers should be denied instantiation when privileged system resources are requested and granted only after approval has been given.<br><br>When access to privileged resources is necessary for a container, a new policy for execution should be written for the container. The default behavior must not give containers privileged access to host system resources.<br><br>Examples of system resources that should be protected are kernel namespaces and host system sensitive directories such as /etc and /usr.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review documentation and configuration to determine if the container platform disallows instantiation of containers trying to access host system privileged resources. <br><br>If the container platform does not block containers requesting host system privileged resources, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>211</th>
      <td></td>
      <td>CCI-002696</td>
      <td>SRG-APP-000472-CTR-001170</td>
      <td>CCE-83697-3</td>
      <td>The organization-defined role must verify correct operation of security functions in the container platform.</td>
      <td>The organization-defined role must verify correct operation of security functions in the container platform.</td>
      <td>Without verification, security functions may not operate correctly and this failure may go unnoticed within the container platform. The container platform components must identity and ensure the security functions are still operational and applicable to the organization.<br><br>Security functions are responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.<br><br>Notifications provided by information systems include, for example, electronic alerts to system administrators.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review container platform documentation and configuration verification of the correct operation of security functions, which may include the valid connection to an external security manager (ESM). <br><br>If verification of the correct operation of security functions is not performed, this is a finding.</td>
      <td>Review the cluster configuration to validate that all required security functions are being validated with the Compliance Operator.<br><br>To see if any scans have been applied to your cluster, and what their status is, run the following command:<br>&gt; oc get compliancescan -n openshift-compliance<br><br>Example output:<br>NAME PHASE RESULT<br>ocp4-cis DONE NON-COMPLIANT<br>ocp4-cis-manual DONE NON-COMPLIANT<br>ocp4-cis-node-master DONE NON-COMPLIANT<br>ocp4-cis-node-master-manual DONE NON-COMPLIANT<br>ocp4-cis-node-worker DONE NON-COMPLIANT<br>ocp4-cis-node-worker-manual DONE NON-COMPLIANT<br>ocp4-moderate DONE NON-COMPLIANT<br>ocp4-moderate-manual DONE NON-COMPLIANT<br>rhcos4-moderate-master DONE NON-COMPLIANT<br>rhcos4-moderate-master-manual DONE NON-COMPLIANT<br>rhcos4-moderate-worker DONE NON-COMPLIANT<br>rhcos4-moderate-worker-manual DONE NON-COMPLIANT<br><br>If no ComplianceScan names return, the scans don't align to the organizationally-defined appropriate security functions, the command returns with an error, or any of the results show "NON-COMPLIANT" as their result, then this is a finding.</td>
      <td></td>
      <td>The compliance operator can be leveraged to ensure that components are configured in alignment with the SSP. To install the Compliance Operator, run the following command:<br><br>&gt; oc apply -f -&nbsp;&nbsp; oc apply -f my-scansettingbinding.yml -n openshift-compliance<br><br>For more information about the compliance operator and its use, including the creation of TailoredProfiles and the ScanSettings available to meet specific security functions or organizational goals defined in the SSP, please see the product documentation https://docs.openshift.com/container-platform/4.8/security/compliance_operator/compliance-operator-understanding.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>212</th>
      <td></td>
      <td>CCI-000140</td>
      <td>SRG-APP-000109-CTR-000215</td>
      <td>CCE-90744-4</td>
      <td>The container platform must take appropriate action upon an audit failure.</td>
      <td>must take appropriate action upon an audit failure.</td>
      <td>It is critical that when the container platform is at risk of failing to process audit logs as required that it take action to mitigate the failure. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.<br><br>Because availability of the services provided by the container platform, approved actions in response to an audit failure are as follows:<br><br>(i) If the failure was caused by the lack of audit record storage capacity, the container platform must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.<br><br>(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the container platform must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the configuration settings to determine how the container platform components are configured for audit failures. When the audit failure is due to the lack of audit record storage, the container platform must continue generating audit records, restarting services if necessary, and overwrite the oldest audit records in a first-in-first-out manner. <br><br>If the audit failure is due to a communication to a centralized collection server, the container platform must queue audit records locally until communication is restored or the records are retrieved manually.&nbsp;&nbsp;<br><br>If the container platform is not configured to handle audit failures appropriately, this is a finding.</td>
      <td>Verify that there is a prometheus rule to watch for audit events<br><br>&gt; oc get prometheusrule -o yaml --all-namespaces | grep apiserver_audit<br>&nbsp;&nbsp;&nbsp;&nbsp;sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~".+-apiserver"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~".+-apiserver"}[5m])) &gt; 0<br><br>If the output above is not displayed, this is a finding</td>
      <td></td>
      <td>Apply the following prometheus rule<br><br>apiVersion: monitoring.coreos.com/v1<br>kind: PrometheusRule<br>metadata:<br>&nbsp;&nbsp;name: audit-errors<br>&nbsp;&nbsp;namespace: openshift-kube-apiserver<br>spec:<br>&nbsp;&nbsp;groups:<br>&nbsp;&nbsp;- name: apiserver-audit<br>&nbsp;&nbsp;&nbsp;&nbsp;rules:<br>&nbsp;&nbsp;&nbsp;&nbsp;- alert: AuditLogError<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;annotations:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;summary: |-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An API Server instance was unable to write audit logs. This could be<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;triggered by the node running out of space, or a malicious actor<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tampering with the audit logs.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description: An API Server had an error writing to an audit log.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr: |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~".+-apiserver"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~".+-apiserver"}[5m])) &gt; 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for: 1m<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;severity: warning</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>213</th>
      <td></td>
      <td>CCI-001876</td>
      <td>SRG-APP-000181-CTR-000485</td>
      <td></td>
      <td>The container platform must provide an audit reduction capability that supports on-demand reporting requirements.</td>
      <td>Red Hat OpenShift Container Platform 4 must provide an audit reduction capability that supports on-demand reporting requirements.</td>
      <td>The ability to generate on-demand reports, including after the audit data has been subjected to audit reduction, greatly facilitates the organization's ability to generate incident reports as needed to better handle larger-scale or more complex security incidents. <br><br>Audit reduction is a process that manipulates collected audit information and organizes such information in a summary format that is more meaningful to analysts. The report generation capability provided by the application must support on-demand (i.e., customizable, ad hoc, and as-needed) reports.<br><br>This requirement is specific to applications with audit reduction capabilities; however, applications need to support on-demand audit review and analysis.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to provide an audit reduction capability that supports on-demand reporting requirements. <br><br>If the container platform is not configured to support on-demand reporting requirements, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not applicable - The location of the external logging server used for audit<br>log aggregation is outside the scope of Red Hat OpenShift Container Platform 4 configuration.<br>Because the configuration recommended in response to SRG-APP-000111-CTR-000220<br>configures an external log aggregation server outside of the control of the<br>Red Hat OpenShift Container Platform 4 cluster, it is up to individual implementation to ensure that<br>the location of that log aggregation point meets other requirements.</td>
    </tr>
    <tr>
      <th>214</th>
      <td></td>
      <td>CCI-002420</td>
      <td>SRG-APP-000441-CTR-001090</td>
      <td></td>
      <td>The container platform must maintain the confidentiality and integrity of information during preparation for transmission.</td>
      <td>Red Hat OpenShift Container Platform 4 must maintain the confidentiality and integrity of information during preparation for transmission.</td>
      <td>Information may be unintentionally or maliciously disclosed or modified during preparation for transmission within the container platform during aggregation, at protocol transformation points, and during container image runtime. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. When transmitting data, the container platform components need to leverage transmission protection mechanisms, such as TLS, TLS VPNs, or IPsec.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the documentation and deployed configuration to determine if the container platform maintains the confidentiality and integrity of information during preparation before transmission. <br><br>If the confidentiality and integrity are not maintained using mechanisms such as TLS, TLS VPNs, or IPsec during preparation before transmission, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://access.redhat.com/articles/5348961</td>
      <td>The OpenShift Container Platform uses TLS encryption for communication with the internal components. Many of these components support additional levels of configuration, such as allowed cyphers and minimum TLS levels. Although not all components support this additional configuration, they still use TLS for encryption of the internal communications.</td>
    </tr>
    <tr>
      <th>215</th>
      <td></td>
      <td>CCI-001067</td>
      <td>SRG-APP-000414-CTR-001010</td>
      <td></td>
      <td>Vulnerability scanning applications must implement privileged access authorization to all container platform components, containers, and container images for selected organization-defined vulnerability scanning activities.</td>
      <td>Vulnerability scanning applications must implement privileged access authorization to all container platform components, containers, and container images for selected organization-defined vulnerability scanning activities.</td>
      <td>In certain situations, the nature of the vulnerability scanning may be more intrusive, or the container platform component that is the subject of the scanning may contain highly sensitive information. Privileged access authorization to selected system components facilitates more thorough vulnerability scanning and protects the sensitive nature of such scanning.<br><br>The vulnerability scanning application must utilize privileged access authorization for the scanning account.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Validate that scanning applications have privileged access to container platform components, containers, and container images to properly perform vulnerability scans. <br><br>If privileged access is not given to the scanning application, this is a finding.</td>
      <td>Identify the service accounts used by the vulnerability scanning tools. If the tool runs as a container on the platform, then service account information can be found in the the pod details.<br>&gt; oc get pod &lt;POD_ID&gt; -o jsonpath='{.spec.serviceAccount}{"<br>"}'<br><br>View cluster role bindings to determine which role the service account is bound to.<br>&gt; oc get clusterrolebinding -ojson | jq '.items[]|select(.subjects[]?|select(.kind == "ServiceAccount" and .name == "&lt;SA_NAME&gt;"))|{ "crb": .metadata.name, "roleRef": .roleRef, "subjects": .subjects}'<br>Find the role to which the service account is bound, if the service account is not bound to a cluster role, or the role does not provide sufficient access, this is a finding. If no service account exists for the vulnerabilty scanning toll, this is also a finding.</td>
      <td></td>
      <td>Create a service if one does not already exist in the appropriate namespace.<br><br>&gt; oc create serviceaccount &lt;NAME&gt;<br><br>Bind to the appropriate cluster RBAC role<br><br>&gt; oc adm policy add-cluster-role-to-user &lt;ROLE&gt; -z &lt;NAME&gt;<br><br>For more information see the following guides:<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html<br>https://docs.openshift.com/container-platform/latest/authentication/understanding-and-creating-service-accounts.html<br>https://docs.openshift.com/container-platform/latest/authentication/using-service-accounts-in-applications.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>216</th>
      <td></td>
      <td>CCI-001889</td>
      <td>SRG-APP-000375-CTR-000870</td>
      <td></td>
      <td>The container platform must record time stamps for audit records that meet a granularity of one second for a minimum degree of precision.</td>
      <td>Red Hat OpenShift Container Platform 4 must record time stamps for audit records that meet a granularity of one second for a minimum degree of precision.</td>
      <td>To properly investigate an event, it is important to have enough granularity within the time stamps to determine the chronological order of the audited events. Without this granularity, events may be interpreted out of proper sequence, thus hobbling the investigation or causing the investigation to come to inaccurate conclusions.<br><br>Time stamps generated by the container platform include date and time. Granularity of time measurements refers to the degree of synchronization between information system clocks and reference clocks.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform documentation and configuration files to determine if time stamps for log records meet a granularity of one second. <br><br>If the time stamp cannot generate to a one-second granularity, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/security/audit-log-view.html</td>
      <td>Openshift Container Platform conforms to DoD/DISA requirements regarding audit log fields.</td>
    </tr>
    <tr>
      <th>217</th>
      <td></td>
      <td>CCI-000366</td>
      <td>SRG-APP-000516-CTR-001325</td>
      <td></td>
      <td>Container platform components must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including SRGs, STIGs, NSA configuration guides, CTOs, and DTMs.</td>
      <td>Container platform components must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including SRGs, STIGs, NSA configuration guides, CTOs, and DTMs.</td>
      <td>Container platform components are part of the overall container platform, offering services that enable the container platform to fully orchestrate user containers. These components may fall outside the scope of this document, but they still must be secured. Examples of such components are DNS, routers, and firewalls. These and any other services offered by the container platform must follow the appropriate STIG or SRG for the technology offered. If a STIG or SRG is not available for the technology, then best practices for the technology must be used. For example, the Cloud Native Computing Foundation (CNCF) is an open-source organization that is working on container platform best practices.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine the services offered by the container platform and validate that any services that are offered are configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including SRGs, STIGs, NSA configuration guides, CTOs, and DTMs. <br><br>If container platform services are not configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including SRGs, STIGs, NSA configuration guides, CTOs, and DTMs, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>218</th>
      <td></td>
      <td>CCI-002039</td>
      <td>SRG-APP-000390-CTR-000930</td>
      <td></td>
      <td>The container platform must require devices to reauthenticate when organization-defined circumstances or situations requiring reauthentication.</td>
      <td>Red Hat OpenShift Container Platform 4 must require devices to reauthenticate when organization-defined circumstances or situations requiring reauthentication.</td>
      <td>The container platform may require external devices be used to fully orchestrate the services needed for users. Examples would be storage or external servers. Without reauthentication, unidentified or unknown devices may be introduced; thereby facilitating malicious activity.<br><br>The container platform must be capable of allowing the organization to set requirements associated with device reauthentication. Examples are:<br><br>Organizations may require reauthentication of devices, including (but not limited to), the following other situations:<br><br>(i) When authenticators change; <br>(ii) When roles change; <br>(iii) When security categories of information systems change;<br>(iv) After a fixed period of time; or <br>(v) Periodically.<br><br>For distributed architectures (e.g., service-oriented architectures), the decisions regarding the validation of identification claims may be made by services separate from the services acting on those decisions. In such situations, it is necessary to provide the identification decisions (as opposed to the actual identifiers) to the services that need to act on those decisions.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review documentation and configuration to determine if the container platform requires devices to reauthenticate when organization-defined circumstances or situations require reauthentication. <br><br>If the container platform does not require a device to reauthenticate, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
      <td>The OpenShift Container Platform does not required a user/device to re-authenticate when changes to the RBAC policy, or permissions to a service/object change in the system.&nbsp;&nbsp;These changes are applied and effective immediately and do not require the user/device to first logout.<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
    </tr>
    <tr>
      <th>219</th>
      <td></td>
      <td>CCI-000159</td>
      <td>SRG-APP-000116-CTR-000235</td>
      <td></td>
      <td>The container platform must use internal system clocks to generate audit record time stamps.</td>
      <td></td>
      <td>Understanding when and sequence of events for an incident is crucial to understand what may have taken place. Without a common clock, the components generating audit events could be out of synchronization and would then present a picture of the event that is warped and corrupted. To give a clear picture, it is important that the container platform and its components use a common internal clock.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration files to determine if the internal system clock is used for time stamps. <br><br>If the container platform does not use the internal system clock to generate time stamps, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>220</th>
      <td></td>
      <td>CCI-000159</td>
      <td>SRG-APP-000116-CTR-000235</td>
      <td></td>
      <td>The container platform must use internal system clocks to generate audit record time stamps.</td>
      <td></td>
      <td>Understanding when and sequence of events for an incident is crucial to understand what may have taken place. Without a common clock, the components generating audit events could be out of synchronization and would then present a picture of the event that is warped and corrupted. To give a clear picture, it is important that the container platform and its components use a common internal clock.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration files to determine if the internal system clock is used for time stamps. <br><br>If the container platform does not use the internal system clock to generate time stamps, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>221</th>
      <td></td>
      <td>CCI-002754</td>
      <td>SRG-APP-000447-CTR-001100</td>
      <td></td>
      <td>The container platform must behave in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received.</td>
      <td>Red Hat OpenShift Container Platform 4 must behave in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received.</td>
      <td>Software or code parameters typically follow well-defined protocols that use structured messages (i.e., commands or queries) to communicate between software modules or system components. Structured messages can contain raw or unstructured data interspersed with metadata or control information. If attacker-supplied inputs to construct structured messages without properly encoding such messages, then the attacker could insert malicious commands or special characters that can cause the data to be interpreted as control information or metadata.<br><br>This requirement guards against adverse or unintended system behavior caused by invalid inputs, where container platform components responses to the invalid input may be disruptive or cause the container image runtime to fail into an unsafe state.<br><br>The behavior will be derived from the organizational and system requirements and includes, but is not limited to, notification of the appropriate personnel, creating an audit record, and rejecting invalid input.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the configuration to determine if the container platform behaves in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received. <br><br>If the container platform does not meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/rest_api/understanding-compatibility-guidelines.html</td>
      <td>All changes to the system go through API Server which is protected through transport security (TLS), as well as authentication, authorization, and additional admission controllers. These security mechanisms are configured out of the box with strong security controls but can be even further limited to enforce least privilege. Additionally, the API Server safeguards against unintended consequences by rejecting invalid inputs and creating audit records of API events. Alerts and logs and also be setup to display changes of API events.</td>
    </tr>
    <tr>
      <th>222</th>
      <td></td>
      <td>CCI-001991</td>
      <td>SRG-APP-000401-CTR-000965</td>
      <td></td>
      <td>The container platform, for PKI-based authentication, must implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network.</td>
      <td>Red Hat OpenShift Container Platform 4, for PKI-based authentication, must implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network.</td>
      <td>The potential of allowing access to users who are no longer authorized&nbsp;&nbsp;(have revoked certificates) increases unless a local cache of revocation data is configured.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration.<br><br> If the container platform is not implemented to use a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>223</th>
      <td></td>
      <td>CCI-000767</td>
      <td>SRG-APP-000151-CTR-000365</td>
      <td></td>
      <td>The container platform must use multifactor authentication for local access to privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must use multifactor authentication for local access to privileged accounts.</td>
      <td>To ensure accountability and prevent unauthenticated access, privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.<br><br>Multifactor authentication is defined as using two or more factors to achieve authentication.<br><br>Factors include: <br>(i) Something a user knows (e.g., password/PIN); <br>(ii) Something a user has (e.g., cryptographic identification device, token); or <br>(iii) Something a user is (e.g., biometric).<br><br>A privileged account is defined as an information system account with authorizations of a privileged user.<br><br>Local access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if multifactor authentication is used for local access to privileged accounts. <br><br>If multifactor authentication for local access to privileged accounts is not being used, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>224</th>
      <td></td>
      <td>CCI-001942</td>
      <td>SRG-APP-000157-CTR-000385</td>
      <td></td>
      <td>The container platform must implement replay-resistant authentication mechanisms for network access to non-privileged accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must implement replay-resistant authentication mechanisms for network access to non-privileged accounts.</td>
      <td>A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.<br><br>An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.<br><br>A non-privileged account is any operating system account with authorizations of a non-privileged user.<br><br>Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if the container platform is configured to provide replay-resistant authentication mechanisms for network access to non-privileged accounts. <br><br>If the container platform is not configured to provide replay-resistant authentication mechanisms for network access to non-privileged accounts, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>225</th>
      <td></td>
      <td>CCI-001464,CCI-001851,CCI-000154</td>
      <td>SRG-APP-000092-CTR-000165,SRG-APP-000111-CTR-000220,SRG-APP-000358-CTR-000805</td>
      <td>CCE-85918-1</td>
      <td>The container platform components must provide the ability to send audit logs to a central enterprise repository for review and analysis.</td>
      <td>The container platform must initiate session auditing upon startup.</td>
      <td>The container platform components must send audit events to a central managed audit log repository to provide reporting, analysis, and alert notification. Incident response relies on successful timely, accurate system analysis in order for the organization to identify and respond to possible security events.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the configuration settings to determine if the container platform components are configured to send audit events to central managed audit log repository. <br><br>If the container platform is not configured to send audit events to central managed audit log repository, this is a finding.</td>
      <td>Determine if cluster log forwarding is configured by performing the<br>following commands.<br><br>Verify that the cluster-logging operator is installed:<br><br>&gt; oc get subscription/cluster-logging -n openshift-logging <br>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACKAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SOURCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANNEL <br>cluster-logging cluster-logging redhat-operators&nbsp;&nbsp;stable<br><br>If the cluster-logging operator is not present, this is a finding.</td>
      <td></td>
      <td>To resolve this, the OpenShift Cluster Logging operator first needs to<br>be installed, then the Cluster Log Forwarder is configured to forward<br>logs to a centralized log aggregation service.<br><br>In order to install the OpenShift Cluster Logging operator, Run the<br>following command to apply the subscription manifests to your cluster:<br><br>&gt; oc apply -f - &lt;&lt; 'EOF' --- <br>apiVersion: project.openshift.io/v1 <br>kind:Project <br>metadata:<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;kubernetes.io/metadata.name: openshift-logging<br>&nbsp;&nbsp;&nbsp;&nbsp;openshift.io/cluster-monitoring: "true"<br>&nbsp;&nbsp;name: openshift-logging<br>spec: {} <br>...&nbsp;&nbsp;<br>--- <br>apiVersion: operators.coreos.com/v1 <br>kind: OperatorGroup<br>metadata:<br>&nbsp;&nbsp;name: openshift-logging <br>&nbsp;&nbsp;namespace: openshift-logging<br>spec:<br>&nbsp;&nbsp;targetNamespaces: <br>&nbsp;&nbsp;- openshift-logging<br>...&nbsp;&nbsp;<br>--- <br>apiVersion: operators.coreos.com/v1alpha1 <br>kind: Subscription<br>metadata:<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;operators.coreos.com/cluster-logging.openshift-logging: ""<br>&nbsp;&nbsp;name: cluster-logging <br>&nbsp;&nbsp;namespace: openshift-logging<br>spec:<br>&nbsp;&nbsp;channel: stable <br>&nbsp;&nbsp;installPlanApproval: Automatic <br>&nbsp;&nbsp;name: cluster-logging<br>&nbsp;&nbsp;source: redhat-operators <br>&nbsp;&nbsp;sourceNamespace: openshift-marketplace<br>...&nbsp;&nbsp;<br>EOF</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>226</th>
      <td></td>
      <td>CCI-001464,CCI-001851,CCI-000154</td>
      <td>SRG-APP-000092-CTR-000165,SRG-APP-000111-CTR-000220,SRG-APP-000358-CTR-000805</td>
      <td>CCE-84076-9</td>
      <td>The container platform components must provide the ability to send audit logs to a central enterprise repository for review and analysis.</td>
      <td>The container platform must initiate session auditing upon startup.</td>
      <td>The container platform components must send audit events to a central managed audit log repository to provide reporting, analysis, and alert notification. Incident response relies on successful timely, accurate system analysis in order for the organization to identify and respond to possible security events.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the configuration settings to determine if the container platform components are configured to send audit events to central managed audit log repository. <br><br>If the container platform is not configured to send audit events to central managed audit log repository, this is a finding.</td>
      <td>List the cluster log forwarders defined:<br><br>&gt; oc get clusterlogforwarder -n openshift-logging<br><br>If there are no clusterlogforwarders defined, this is a finding.<br><br>For each cluster log forwarder listed above, view the configuration details:<br><br>&gt; oc describe clusterlogforwarder/&nbsp;&nbsp;-n openshift-logging<br><br>Review the details of the cluster log forwarder. If the configuration is<br>not set to forward logs the organization's centralized logging service,<br>this is a finding.</td>
      <td></td>
      <td>After the OpenShift Logging operator has been installed, you can<br>create a ClusterLogForwarder instance to forward cluster logs to a log<br>aggregator. A basic configuration that would forward OpenShift audit,<br>application, and infrastructure logs to an rsyslog server that you manage<br>separately, and is configured for mTLS authentication over TCP when<br>sending Audit logs but traditional UDP access for other types of logs,<br>can be provided by editing the appropriate values in the Secret resource<br>below and changing the "url" parameters in the "outputs" section of the<br>"spec" below, then running the command to apply it like this: <br><br>oc apply -f -&nbsp;&nbsp; <br>&nbsp;&nbsp;tls.key:&nbsp;&nbsp; <br>&nbsp;&nbsp;ca-bundle.crt:&nbsp;&nbsp;<br>...&nbsp;&nbsp;<br>--- <br>apiVersion: logging.openshift.io/v1 <br>kind: ClusterLogForwarder<br>metadata:<br>&nbsp;&nbsp;name: instance <br>&nbsp;&nbsp;namespace: openshift-logging<br>spec:<br>&nbsp;&nbsp;outputs: <br>&nbsp;&nbsp;- name: rsyslog-audit<br>&nbsp;&nbsp;&nbsp;&nbsp;type: syslog <br>&nbsp;&nbsp;&nbsp;&nbsp;syslog:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;facility: security <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc: RFC5424 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;severity: Informational<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appName: openshift <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msgID: audit <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procID: audit<br>&nbsp;&nbsp;&nbsp;&nbsp;url: 'tls://rsyslogserver.example.com:514' <br>&nbsp;&nbsp;&nbsp;&nbsp;secret:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: rsyslog-tls-secret<br>&nbsp;&nbsp;- name: rsyslog-apps<br>&nbsp;&nbsp;&nbsp;&nbsp;type: syslog <br>&nbsp;&nbsp;&nbsp;&nbsp;syslog:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;facility: user <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc: RFC5424 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;severity: Informational <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appName: openshift <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msgID: apps <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procID: apps<br>&nbsp;&nbsp;&nbsp;&nbsp;url: 'udp://rsyslogserver.example.com:514'<br>&nbsp;&nbsp;- name: rsyslog-infra<br>&nbsp;&nbsp;&nbsp;&nbsp;type: syslog <br>&nbsp;&nbsp;&nbsp;&nbsp;syslog:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;facility: local0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc: RFC5424 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;severity: Informational <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appName: openshift <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msgID: infra <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procID: infra<br>&nbsp;&nbsp;&nbsp;&nbsp;url: 'udp://rsyslogserver.example.com:514'<br>&nbsp;&nbsp;pipelines: <br>&nbsp;&nbsp;- name: audit-logs<br>&nbsp;&nbsp;&nbsp;&nbsp;inputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- audit<br>&nbsp;&nbsp;&nbsp;&nbsp;outputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- rsyslog-audit<br>&nbsp;&nbsp;- name: apps-logs<br>&nbsp;&nbsp;&nbsp;&nbsp;inputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- application<br>&nbsp;&nbsp;&nbsp;&nbsp;outputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- rsyslog-apps<br>&nbsp;&nbsp;- name: infrastructure-logs<br>&nbsp;&nbsp;&nbsp;&nbsp;inputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- infrastructure<br>&nbsp;&nbsp;&nbsp;&nbsp;outputRefs:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- rsyslog-infra<br>...&nbsp;&nbsp;<br>EOF<br><br>Please note that many log forwarding destinations are<br>supported, and the fix does not require that you forward your<br>audit logs to rsyslog over mTLS. To better understand how to<br>configure the ClusterLogForwarder for your infrastructure and<br>environment, please consult the OpenShift Logging documentation:<br>https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>227</th>
      <td></td>
      <td>CCI-001493</td>
      <td>SRG-APP-000121-CTR-000255</td>
      <td>CCE-90648-7</td>
      <td>The container platform must protect audit tools from unauthorized access.</td>
      <td>Red Hat OpenShift Container Platform 4 must protect audit tools from unauthorized access.</td>
      <td>Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.<br><br>Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.<br><br>Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to validate container platform audit tools are protected from unauthorized access. <br><br>If the audit tools are not protected from unauthorized access, this is a finding.</td>
      <td>Perform a check to list the users and groups who have permission to view the cluster logging configuration by running the following two commands.<br><br>&nbsp;&nbsp;&gt; oc policy who-can view ClusterLogging -n openshift-logging<br><br>&nbsp;&nbsp;&gt; oc policy who-can view ClusterLoggingForwarder -n openshift-logging<br><br>&nbsp;&nbsp;Review the list of users and groups who have view access to the cluster logging resources.<br>&nbsp;&nbsp;If any user or group listed should not have access to view the cluster logging resources, this is a finding.</td>
      <td></td>
      <td>Remove view permissions from any unauthorized user or group by performing one or more of the following commands:<br><br>&nbsp;&nbsp;* Remove role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-user ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;Where ROLE/CLUSTER_ROLE is the role granting user view permission to resources in openshift-logging namespace.}</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>228</th>
      <td></td>
      <td>CCI-001464</td>
      <td>SRG-APP-000092-CTR-000165</td>
      <td></td>
      <td>The container platform must initiate session auditing upon startup.</td>
      <td></td>
      <td>When the container platform is started, container platform components and user services can also be started. It is important that the container platform begin auditing on startup in order to handle container platform startup events along with events for container platform components and services that begin on startup.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for session audits. <br><br>Ensure audit policy for session logging at startup is enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If the container platform is not configured to meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>229</th>
      <td></td>
      <td>CCI-001464</td>
      <td>SRG-OS-000254-GPOS-00095,SRG-APP-000092-CTR-000165</td>
      <td></td>
      <td>The container platform must initiate session auditing upon startup.</td>
      <td></td>
      <td>When the container platform is started, container platform components and user services can also be started. It is important that the container platform begin auditing on startup in order to handle container platform startup events along with events for container platform components and services that begin on startup.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration for session audits. <br><br>Ensure audit policy for session logging at startup is enabled. <br><br>Verify events are written to the log. <br><br>Validate system documentation is current. <br><br>If the container platform is not configured to meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>230</th>
      <td></td>
      <td>CCI-001762</td>
      <td>SRG-APP-000383-CTR-000910</td>
      <td></td>
      <td>All non-essential, unnecessary, and unsecure DoD ports, protocols, and services must be disabled in the container platform.</td>
      <td>All non-essential, unnecessary, and unsecure DoD ports, protocols, and services must be disabled in the container platform.</td>
      <td>To properly offer services to the user and to orchestrate containers, the container platform may offer services that use ports and protocols that best fit those services. The container platform, when offering the services, must only offer the services on ports and protocols authorized by the DoD.<br><br>To validate that the services are using only the approved ports and protocols, the organization must perform a periodic scan/review of the container platform and disable functions, ports, protocols, and services deemed to be unneeded or non-secure.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to determine if services or capabilities presently on the information system are required for operational or mission needs. <br><br>If additional services or capabilities are present on the system, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/installing/installing_bare_metal/installing-bare-metal.html#installation-network-user-infra_installing-bare-metal</td>
      <td>The container platform inherently only exposes the ports which are needed and adhere to DoD standards. By default all communications use two-way TLS. A full list is available here:<br><br>https://docs.openshift.com/container-platform/latest/installing/installing_bare_metal/installing-bare-metal.html#installation-network-user-infra_installing-bare-metal</td>
    </tr>
    <tr>
      <th>231</th>
      <td></td>
      <td>CCI-001494</td>
      <td>SRG-APP-000122-CTR-000260</td>
      <td>CCE-90717-0</td>
      <td>The container platform must protect audit tools from unauthorized modification.</td>
      <td>Red Hat OpenShift Container Platform 4 must protect audit tools from unauthorized modification.</td>
      <td>Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.<br><br>Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the modification of audit tools.<br><br>Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to validate container platform audit tools are protected from unauthorized modification. <br><br>If the audit tools are not protected from unauthorized modification, this is a finding.</td>
      <td>Perform a check to list the users and groups who have permission to edit the cluster logging configuration by running the following two commands.<br><br>&nbsp;&nbsp;&gt; oc policy who-can edit ClusterLogging -n openshift-logging<br><br>&nbsp;&nbsp;&gt; oc policy who-can edit ClusterLoggingForwarder -n openshift-logging<br><br>&nbsp;&nbsp;Review the list of users and groups who have edit access to the cluster logging resources.<br>&nbsp;&nbsp;If any user or group listed should not have access to edit the cluster logging resources, this is a finding.</td>
      <td></td>
      <td>Remove edit permissions from any unauthorized user or group by performing one or more of the following commands:<br><br>&nbsp;&nbsp;* Remove role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-user ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;Where ROLE/CLUSTER_ROLE is the role granting user edit permission to resources in openshift-logging namespace.}</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>232</th>
      <td></td>
      <td>CCI-001495</td>
      <td>SRG-APP-000123-CTR-000265</td>
      <td>CCE-90433-4</td>
      <td>The container platform must protect audit tools from unauthorized deletion.</td>
      <td>Red Hat OpenShift Container Platform 4 must protect audit tools from unauthorized deletion.</td>
      <td>Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.<br><br>Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the deletion of audit tools.<br><br>Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform to validate container platform audit tools are protected from unauthorized deletion. <br><br>If the audit tools are not protected from unauthorized deletion, this is a finding.</td>
      <td>Perform a check to list the users and groups who have permission to delete the cluster logging configuration by running the following two commands.<br><br>&nbsp;&nbsp;&gt; oc policy who-can delete ClusterLogging -n openshift-logging<br><br>&nbsp;&nbsp;&gt; oc policy who-can delete ClusterLoggingForwarder -n openshift-logging<br><br>&nbsp;&nbsp;Review the list of users and groups who have delete access to the cluster logging resources.<br>&nbsp;&nbsp;If any user or group listed should not have access to delete the cluster logging resources, this is a finding.</td>
      <td></td>
      <td>Remove delete permissions from any unauthorized user or group by performing one or more of the following commands:<br><br>&nbsp;&nbsp;* Remove role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-user ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from user<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging<br><br>&nbsp;&nbsp;* Remove cluster role from group<br>&nbsp;&nbsp;&gt; oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging<br><br>&nbsp;&nbsp;Where ROLE/CLUSTER_ROLE is the role granting user delete permission to resources in openshift-logging namespace.}</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>233</th>
      <td></td>
      <td>CCI-002605</td>
      <td>SRG-APP-000456-CTR-001130</td>
      <td></td>
      <td>The container platform runtime must have updates installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td>
      <td>Red Hat OpenShift Container Platform 4 runtime must have updates installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td>
      <td>The container platform runtime must be carefully monitored for vulnerabilities, and when problems are detected, they must be remediated quickly. A vulnerable runtime exposes all containers it supports, as well as the host itself, to potentially significant risk. Organizations should use tools to look for Common Vulnerabilities and Exposures (CVEs) vulnerabilities in the runtimes deployed, to upgrade any instances at risk, and to ensure that orchestrators only allow deployments to properly maintained runtimes.</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review documentation and configuration to determine if the container platform registry inspects and contains approved vendor repository latest images containing security-relevant updates within a timeframe directed by an authoritative source (IAVM, CTOs, DTMs, STIGs, etc.). <br><br>If the container platform registry does not contain the latest image with security-relevant updates within the time period directed by the authoritative source, this is a finding.<br><br>The container platform registry should help the user understand where the code in the environment was deployed from and must provide controls that prevent deployment from untrusted sources or registries.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>The container platform and underlying operating system regularly release updates alongside Red Hat Security Advisories covering CVE patches. These updates are sent out at the same cadence of reliability as Red Hat Enterprise Linux.<br><br>The organization must define how and when to update the container platform, including the synchronization of Red Hat provided updates that patch CVEs to the registry used for the container platform.<br><br>Update Service Architecture Overview<br>https://docs.openshift.com/container-platform/latest/architecture/architecture-installation.html#update-service-overview_architecture-installation</td>
    </tr>
    <tr>
      <th>234</th>
      <td></td>
      <td>CCI-000200</td>
      <td>SRG-APP-000165-CTR-000405</td>
      <td></td>
      <td>The container platform must prohibit password reuse for a minimum of 10 generations.</td>
      <td>Red Hat OpenShift Container Platform 4 must prohibit password reuse for a minimum of 10 generations.</td>
      <td>Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.<br><br>To meet password policy requirements, passwords need to be changed at specific policy-based intervals.<br><br>If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed as per policy requirements.<br><br>The references for this check are:<br>NIST SP 800-53 :: IA-5 (1) (e)<br>NIST SP 800-53A :: IA-5 (1).1 (v)<br>NIST SP 800-53 Revision 4 :: IA-5 (1)<br>CNSS 1253</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Review the container platform configuration to determine if it prohibits password reuse for a minimum of five generations. <br><br>If the container platform does not prohibit password reuse for a minimum of five generations, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>235</th>
      <td></td>
      <td>CCI-002145</td>
      <td>SRG-APP-000318-CTR-000740</td>
      <td></td>
      <td>The container platform must enforce organization-defined circumstances and/or usage conditions for organization-defined accounts.</td>
      <td>Red Hat OpenShift Container Platform 4 must enforce organization-defined circumstances and/or usage conditions for organization-defined accounts.</td>
      <td>Activity under unusual conditions can indicate hostile activity. For example, what is normal activity during business hours can indicate hostile activity if it occurs during off hours.<br><br>Depending on mission needs and conditions, account usage restrictions based on conditions and circumstances may be critical to limit access to resources and data to comply with operational or mission access control requirements. Thus, the application must be configured to enforce the specific conditions or circumstances under which application accounts can be used (e.g., by restricting usage to certain days of the week, time of day, or specific durations of time).</td>
      <td></td>
      <td>Not Applicable</td>
      <td>Determine if the container platform is configured to enforce organization-defined circumstances and/or usage conditions for organization-defined accounts. <br><br>If the container platform does not enforce organization-defined circumstances and/or usage conditions for organization-defined accounts, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td>Not Applicable. Applicable to Identity Management Provider and not<br>OCP. Only configurable check is to ensure OCP is configured for an<br>IDP under SRG-APP-000023-CTR-000055. Verify with IdM service provider<br>admins that the IdM meets the requirements.</td>
    </tr>
    <tr>
      <th>236</th>
      <td></td>
      <td>CCI-001858</td>
      <td>SRG-APP-000360-CTR-000815</td>
      <td></td>
      <td>The container platform must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events requiring real-time alerts.</td>
      <td>Red Hat OpenShift Container Platform 4 must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events requiring real-time alerts.</td>
      <td>It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.<br><br>Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if it is configured to provide an immediate real-time alert to the SA and ISSO of all audit failure events requiring real-time alerts. <br><br>If the container platform is not configured to provide an immediate real-time alert, this is a finding.</td>
      <td>Verify that the AlertManager config includes a configured receiver. <br><br>1. From the Administrator perspective on the OpenShift web console, navigate to Administration-&gt;Cluster Settings -&gt; Global Configuration -&gt; Alertmanager<br>2. View the list of receivers, and inspect the configuration<br>3. Verify that at least one receiver is configured as either PagerDuty, Webhook, Email, or Slack according to the organizations policy.<br><br>If an alert receiver is not configured according to the organizational policy this is a finding.</td>
      <td></td>
      <td>Create a alert notification receiver<br><br>1. From the Administrator perspective on the OpenShift web console, navigate to Administration-&gt;Cluster Settings -&gt; Global Configuration -&gt; Alertmanager<br>2. Select Create Receiver<br>3. Set the name, and choose a Receiver Type<br>4. Complete the form as per the organizations policy<br><br>Refer to the following documentation for more information<br><br>https://docs.openshift.com/container-platform/latest/monitoring/managing-alerts.html#sending-notifications-to-external-systems_managing-alerts</td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting documentation is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/post_installation_configuration/configuring-alert-notifications.html<br>https://kubernetes.io/docs/tasks/debug-application-cluster/audit/#parameter-tuning</td>
      <td>The OpenShift Container Platform provides an alert notification<br>service to notify admins of critical events.</td>
    </tr>
    <tr>
      <th>237</th>
      <td></td>
      <td>CCI-002038</td>
      <td>SRG-APP-000389-CTR-000925</td>
      <td></td>
      <td>The container platform must require users to reauthenticate when organization-defined circumstances or situations require reauthentication.</td>
      <td>Red Hat OpenShift Container Platform 4 must require users to reauthenticate when organization-defined circumstances or situations require reauthentication.</td>
      <td>Controlling user access is paramount in securing the container platform. During a user's access to the container platform, events may occur that change the user's access and which require reauthentication. For instance, if the capability to change security roles or escalate privileges is implemented, it is critical the user reauthenticate.<br><br>In addition to the reauthentication requirements associated with change in security roles or privilege escalation, organizations may require reauthentication of individuals in other situations, including (but not limited to) the following circumstances:<br><br>(i) When authenticators change; <br>(ii) When roles change; <br>(iii) When security categories of information systems change; <br>(iv) When the execution of privileged functions occurs; <br>(v) After a fixed period of time; or<br>(vi) Periodically.<br><br>Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review documentation and configuration to determine if the container platform requires a user to reauthenticate when organization-defined circumstances or situations are met. <br><br>If the container platform does not meet this requirement, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
      <td>The OpenShift Container Platform does not required a user to re-authenticate when changes to the RBAC policy, or permissions to a service/object change in the system.&nbsp;&nbsp;These changes are applied and effective immediately and do not require the user to first logout.<br><br>https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html</td>
    </tr>
    <tr>
      <th>238</th>
      <td></td>
      <td>CCI-001403</td>
      <td>SRG-APP-000027-CTR-000075</td>
      <td></td>
      <td>The container platform must automatically audit account modification.</td>
      <td>Red Hat OpenShift Container Platform 4 must automatically audit account modification.</td>
      <td>Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing of account creation is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail documents the creation of application user accounts and, as required, notifies administrators and/or application when accounts are created. Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.<br><br>To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review the container platform configuration to determine if account modification is automatically audited. <br><br>If account modification is not automatically audited, this is a finding.</td>
      <td>Verify for each of the files that contain account information the system is configured to emit an audit event in case of a write, by executing the following:<br><br>for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n "$HOSTNAME "; for f in /etc/passwd /etc/group /etc/gshadow /etc/security/opasswd /etc/shadow /etc/sudoers /etc/sudoers.d/; do grep -q "\-w $f \-p wa \-k" /etc/audit/audit.rules || echo "rule for $f not found"; done' 2&gt;/dev/null; done<br><br>If for any of the files a line saying "rule for $filename not found" is printed, this is a finding.</td>
      <td></td>
      <td>Apply the machine config using the following command:<br><br>for mcpool in $(oc get mcp -oname | sed "s:.*/::" ); do<br>echo "apiVersion: machineconfiguration.openshift.io/v1<br>kind: MachineConfig<br>metadata:<br>&nbsp;&nbsp;name: 75-account-modifications-rules-$mcpool<br>&nbsp;&nbsp;labels:<br>&nbsp;&nbsp;&nbsp;&nbsp;machineconfiguration.openshift.io/role: $mcpool<br>spec:<br>&nbsp;&nbsp;config:<br>&nbsp;&nbsp;&nbsp;&nbsp;ignition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version: 3.1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;storage:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/sudoers.d/%20-p%20wa%20-k%20actions%0A-w%20/etc/sudoers%20-p%20wa%20-k%20actions%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/75-audit-sysadmin-actions.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/group%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_group_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/gshadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_gshadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/security/opasswd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_security_opasswd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/passwd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_passwd_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- contents:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source: data:,-w%20/etc/shadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode: 0644<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/audit/rules.d/30-etc_shadow_usergroup_modification.rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwrite: true<br>" | oc apply -f -<br>done</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>239</th>
      <td></td>
      <td>CCI-002699</td>
      <td>SRG-APP-000473-CTR-001175</td>
      <td>CCE-90762-6</td>
      <td>The container platform must perform verification of the correct operation of security functions: upon system startup and/or restart; upon command by a user with privileged access; and/or every 30 days. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.</td>
      <td>The container platform must perform verification of the correct operation of security functions: upon system startup and/or restart; upon command by a user with privileged access; and/or every 30 days. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.</td>
      <td>Without verification, security functions may not operate correctly and this failure may go unnoticed within the container platform.<br><br>Security functions are responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.<br><br>Notifications provided by information systems include, for example, electronic alerts to organization-defined role.</td>
      <td></td>
      <td>Applicable - Configurable</td>
      <td>Review container platform documentation.<br><br>Verify that the container platform is configured to perform verification of the correct operation of security functions, which may include the valid connection to an external security manager (ESM), upon product startup/restart, by a user with privileged access, and/or every 30 days.<br><br>If it is not, this is a finding.</td>
      <td>Review the cluster configuration to validate that all required security functions are being validated with the Compliance Operator.<br><br>To map the schedule of every profile through its ScanSettingBinding and output the schedules on which each Profile or TailoredProfile is run, execute the following commands:<br>&gt; declare -A binding_profiles<br>&gt; declare -A binding_schedule<br>&gt; while read binding setting profiles; do binding_profiles[$binding]="$profiles"; binding_schedule[$binding]=$(oc get scansetting -n openshift-compliance $setting -ojsonpath='{.schedule}'); done&nbsp;&nbsp; for binding in "${!binding_profiles[@]}"; do for profile in ${binding_profiles[$binding]}; do echo "$profile: ${binding_schedule[$binding]}"; done; done<br><br>If the profiles that are bound to schedules do not cover the organization-designed security functions, or if the schedules are not at least monthly or within the organization defined periodicity, this is a finding.<br><br>To determine which rules are enforced by the profiles that are currently bound to the scheduled periodicities, execute the following commands:<br>&gt; for binding in "${!binding_profiles[@]}"; do for profile in ${binding_profiles[$binding]}; do for rule in $(oc get profile.compliance $profile -n openshift-compliance -ojsonpath='{range .rules[*]}{$}{"<br>"}{end}'); do echo "$rule: ${binding_schedule[$binding]}"; done; done; done | sort -u</td>
      <td></td>
      <td>The compliance operator can be leveraged to ensure that components are configured in alignment with the SSP at a desired schedule. To install the Compliance Operator, run the following command:<br><br>&gt; oc apply -f -&nbsp;&nbsp; oc apply -f my-scansettingbinding.yml -n openshift-compliance<br><br>For more information about the compliance operator and its use, including the configurability of scheduling of scan cadence in ScanSetting resources and the Role-based access control requirements for manually triggered scans, please see the product documentation https://docs.openshift.com/container-platform/4.8/security/compliance_operator/compliance-operator-understanding.html</td>
      <td>CAT II</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>240</th>
      <td></td>
      <td>CCI-000778</td>
      <td>SRG-APP-000158-CTR-000390</td>
      <td></td>
      <td>The container platform must uniquely identify all network-connected nodes before establishing any connection.</td>
      <td>Red Hat OpenShift Container Platform 4 must uniquely identify all network-connected nodes before establishing any connection.</td>
      <td>A container platform usually consists of multiple nodes. It is important for these nodes to be uniquely identified before a connection is allowed. Without identifying the nodes, unidentified or unknown nodes may be introduced, thereby facilitating malicious activity.</td>
      <td></td>
      <td>Applicable - Inherently Met</td>
      <td>Review the container platform configuration to determine if the container platform uniquely identifies all nodes before establishing a connection. <br><br>If the container platform is not configured to uniquely identify all nodes before establishing the connection, this is a finding.</td>
      <td></td>
      <td></td>
      <td></td>
      <td>CAT II</td>
      <td></td>
      <td>Supporting evidence is in the following documentation<br>https://docs.openshift.com/container-platform/latest/security/certificate_types_descriptions/node-certificates.html</td>
      <td>Internal components are secured with two-way TLS.<br>https://docs.openshift.com/container-platform/latest/security/certificate_types_descriptions/node-certificates.html<br>Node certificates are signed by the cluster; they come from a certificate authority (CA) that is generated by the bootstrap process. Once the cluster is installed, the node certificates are auto-rotated.<br>Node certificates are managed by the cluster and not the user</td>
    </tr>
  </tbody>
</table>
</body>
</html>
