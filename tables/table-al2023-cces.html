<html xmlns:cce="http://cce.mitre.org" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title> CCE Identifiers in Guide to the Secure Configuration of Amazon Linux 2023</title>
</head>
<body>
<br><br><div style="text-align: center; font-size: x-large; font-weight:bold">
			CCE Identifiers in Guide to the Secure Configuration of Amazon Linux 2023</div>
<br><br><style type="text/css">
		table
		{
			border-collapse:collapse;
		}
		table, th, td
		{
			border: 2px solid #dcdcdc;
			border-left: none;
			border-right: none;
			vertical-align: top;
			padding: 2px;
			font-family: verdana,arial,sans-serif;
			font-size:11px;
		}
		pre { 
			white-space: pre-wrap;
			white-space: -moz-pre-wrap !important;
			word-wrap:break-word; 
		}
		table tr:nth-child(2n+2) { background-color: #f4f4f4; }
		thead
		{
			display: table-header-group;
			font-weight: bold;
			background-color: #dedede;
		}
	</style>
<table>
<thead>
<td>CCE ID</td>
<td>Rule Title</td>
<td>Description</td>
</thead>
<tr>
<td></td>
<td>Install AIDE</td>
<td>The <code>aide</code> package can be installed with the following command:
<pre>
$ sudo dnf install aide</pre>
         </td>
</tr>
<tr>
<td></td>
<td>Build and Test AIDE Database</td>
<td>Run the following command to generate a new database:

<pre>$ sudo /usr/sbin/aide --init</pre>

By default, the database will be written to the file

<code>/var/lib/aide/aide.db.new.gz</code>.

Storing the database, the configuration file <code>/etc/aide.conf</code>, and the binary
<code>/usr/sbin/aide</code>
(or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.
The newly-generated database can be installed as follows:

<pre>$ sudo cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre>

To initiate a manual check, run the following command:
<pre>$ sudo /usr/sbin/aide --check</pre>
If this check produces any unexpected output, investigate.</td>
</tr>
<tr>
<td></td>
<td>Configure AIDE to Verify the Audit Tools</td>
<td>The operating system file integrity tool must be configured to protect the integrity of the audit tools.</td>
</tr>
<tr>
<td></td>
<td>Configure Periodic Execution of AIDE</td>
<td>At a minimum, AIDE should be configured to run a weekly scan.
To implement a daily execution of AIDE at 4:05am using cron, add the following line to <code>/etc/crontab</code>:
<pre>05 4 * * * root /usr/sbin/aide --check</pre>
To implement a weekly execution of AIDE at 4:05am using cron, add the following line to <code>/etc/crontab</code>:
<pre>05 4 * * 0 root /usr/sbin/aide --check</pre>
AIDE can be executed periodically through other means; this is merely one example.
The usage of cron's special time codes, such as  <code>@daily</code> and
<code>@weekly</code> is acceptable.</td>
</tr>
<tr>
<td></td>
<td>Configure System Cryptography Policy</td>
<td>To configure the system cryptography policy to use ciphers only from the <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_system_crypto_policy" use="legacy"></xccdf-1.2:sub></code>
policy, run the following command:
<pre>$ sudo update-crypto-policies --set <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_system_crypto_policy" use="legacy"></xccdf-1.2:sub>
         </pre>
The rule checks if settings for selected crypto policy are configured as expected. Configuration files in the <code>/etc/crypto-policies/back-ends</code> are either symlinks to correct files provided by Crypto-policies package or they are regular files in case crypto policy customizations are applied.
Crypto policies may be customized by crypto policy modules, in which case it is delimited from the base policy using a colon.</td>
</tr>
<tr>
<td></td>
<td>Configure SSH to use System Crypto Policy</td>
<td>Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
SSH is supported by crypto policy, but the SSH configuration may be
set up to ignore it.
To check that Crypto Policies settings are configured correctly, ensure that
the <code>CRYPTO_POLICY</code> variable is either commented or not set at all
in the <code>/etc/sysconfig/sshd</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure /dev/shm is configured</td>
<td>The <code>/dev/shm</code> is a traditional shared memory concept.
One program will create a memory portion, which other processes
(if permitted) can access. If <code>/dev/shm</code> is not configured,
tmpfs will be mounted to /dev/shm by systemd.</td>
</tr>
<tr>
<td></td>
<td>Ensure /home Located On Separate Partition</td>
<td>If user home directories will be stored locally, create a separate partition
for <code>/home</code> at installation time (or migrate it later using LVM). If
<code>/home</code> will be mounted from another system such as an NFS server, then
creating a separate partition is not necessary at installation time, and the
mountpoint can instead be configured later.</td>
</tr>
<tr>
<td></td>
<td>Ensure /tmp Located On Separate Partition</td>
<td>The <code>/tmp</code> directory is a world-writable directory used
for temporary file storage. Ensure it has its own partition or
logical volume at installation time, or migrate it using LVM.</td>
</tr>
<tr>
<td></td>
<td>Ensure /var Located On Separate Partition</td>
<td>The <code>/var</code> directory is used by daemons and other system
services to store frequently-changing data. Ensure that <code>/var</code> has its own partition
or logical volume at installation time, or migrate it using LVM.</td>
</tr>
<tr>
<td></td>
<td>Ensure /var/log Located On Separate Partition</td>
<td>System logs are stored in the <code>/var/log</code> directory.

Ensure that <code>/var/log</code> has its own partition or logical
volume at installation time, or migrate it using LVM.</td>
</tr>
<tr>
<td></td>
<td>Ensure /var/log/audit Located On Separate Partition</td>
<td>Audit logs are stored in the <code>/var/log/audit</code> directory.

Ensure that <code>/var/log/audit</code> has its own partition or logical
volume at installation time, or migrate it using LVM.
Make absolutely certain that it is large enough to store all
audit logs that will be created by the auditing daemon.</td>
</tr>
<tr>
<td></td>
<td>Ensure /var/tmp Located On Separate Partition</td>
<td>The <code>/var/tmp</code> directory is a world-writable directory used
for temporary file storage. Ensure it has its own partition or
logical volume at installation time, or migrate it using LVM.</td>
</tr>
<tr>
<td></td>
<td>Install sudo Package</td>
<td>The <code>sudo</code> package can be installed with the following command:
<pre>
$ sudo dnf install sudo</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo use_pty</td>
<td>The sudo <code>use_pty</code> tag, when specified, will only execute sudo
commands from users logged in to a real tty.
This should be enabled by making sure that the <code>use_pty</code> tag exists in
<code>/etc/sudoers</code> configuration file or any sudo configuration snippets
in <code>/etc/sudoers.d/</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure Sudo Logfile Exists - sudo logfile</td>
<td>A custom log sudo file can be configured with the 'logfile' tag. This rule configures
a sudo custom logfile at the default location suggested by CIS, which uses
/var/log/sudo.log.</td>
</tr>
<tr>
<td></td>
<td>Require Re-Authentication When Using the sudo Command</td>
<td>The sudo <code>timestamp_timeout</code> tag sets the amount of time sudo password prompt waits.
The default <code>timestamp_timeout</code> value is 5 minutes.
The timestamp_timeout should be configured by making sure that the
<code>timestamp_timeout</code> tag exists in
<code>/etc/sudoers</code> configuration file or any sudo configuration snippets
in <code>/etc/sudoers.d/</code>.
If the value is set to an integer less than 0, the user's time stamp will not expire
and the user will not have to re-authenticate for privileged actions until the user's session is terminated.</td>
</tr>
<tr>
<td></td>
<td>Ensure gpgcheck Enabled In Main dnf Configuration</td>
<td>The <code>gpgcheck</code> option controls whether
RPM packages' signatures are always checked prior to installation.
To configure dnf to check package signatures before installing
them, ensure the following line appears in <code>/etc/dnf/dnf.conf</code> in
the <code>[main]</code> section:
<pre>gpgcheck=1</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Modify the System Login Banner</td>
<td>
To configure the system login banner edit <code>/etc/issue</code>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.


The DoD required text is either:
<br>
        <br>
        <code>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br>-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br>-At any time, the USG may inspect and seize data stored on this IS.
<br>-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br>-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br>-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</code>
        <br>
        <br>
OR:
<br>
        <br>
        <code>I've read &amp; consent to terms in IS user agreem't.</code>
       </td>
</tr>
<tr>
<td></td>
<td>Modify the System Login Banner for Remote Connections</td>
<td>To configure the system login banner edit <code>/etc/issue.net</code>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.

The DoD required text is either:
<br>
        <br>
        <code>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br>-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br>-At any time, the USG may inspect and seize data stored on this IS.
<br>-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br>-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br>-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</code>
        <br>
        <br>
OR:
<br>
        <br>
        <code>I've read &amp; consent to terms in IS user agreem't.</code>
       </td>
</tr>
<tr>
<td></td>
<td>Modify the System Message of the Day Banner</td>
<td>To configure the system message banner edit <code>/etc/motd</code>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.

The DoD required text is either:
<br>
        <br>
        <code>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br>-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br>-At any time, the USG may inspect and seize data stored on this IS.
<br>-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br>-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br>-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</code>
        <br>
        <br>
OR:
<br>
        <br>
        <code>I've read &amp; consent to terms in IS user agreem't.</code>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Ownership of System Login Banner</td>
<td>
To properly set the group owner of <code>/etc/issue</code>, run the command:

  <pre>$ sudo chgrp root /etc/issue</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Ownership of System Login Banner for Remote Connections</td>
<td>
To properly set the group owner of <code>/etc/issue.net</code>, run the command:

  <pre>$ sudo chgrp root /etc/issue.net</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Ownership of Message of the Day Banner</td>
<td>
To properly set the group owner of <code>/etc/motd</code>, run the command:

  <pre>$ sudo chgrp root /etc/motd</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify ownership of System Login Banner</td>
<td>
To properly set the owner of <code>/etc/issue</code>, run the command:

  <pre>$ sudo chown root /etc/issue </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify ownership of System Login Banner for Remote Connections</td>
<td>
To properly set the owner of <code>/etc/issue.net</code>, run the command:

  <pre>$ sudo chown root /etc/issue.net </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify ownership of Message of the Day Banner</td>
<td>
To properly set the owner of <code>/etc/motd</code>, run the command:

  <pre>$ sudo chown root /etc/motd </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify permissions on System Login Banner</td>
<td>
To properly set the permissions of <code>/etc/issue</code>, run the command:
<pre>$ sudo chmod 0644 /etc/issue</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify permissions on System Login Banner for Remote Connections</td>
<td>
To properly set the permissions of <code>/etc/issue.net</code>, run the command:
<pre>$ sudo chmod 0644 /etc/issue.net</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify permissions on Message of the Day Banner</td>
<td>
To properly set the permissions of <code>/etc/motd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/motd</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth File.</td>
<td>The pam_faillock.so module must be loaded in preauth in /etc/pam.d/password-auth.</td>
</tr>
<tr>
<td></td>
<td>Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth File.</td>
<td>The pam_faillock.so module must be loaded in preauth in /etc/pam.d/system-auth.</td>
</tr>
<tr>
<td></td>
<td>Limit Password Reuse: password-auth</td>
<td>Do not allow users to reuse recent passwords. This can be accomplished by using the
<code>remember</code> option for the <code>pam_pwhistory</code> PAM module.
<br>
         <br>

On systems with newer versions of <code>authselect</code>, the <code>pam_pwhistory</code> PAM module
can be enabled via authselect feature:
<pre>authselect enable-feature with-pwhistory</pre>

Otherwise, it should be enabled using an authselect custom profile.
<br>
         <br>
Newer systems also have the <code>/etc/security/pwhistory.conf</code> file for setting
<code>pam_pwhistory</code> module options. This file should be used whenever available.
Otherwise, the <code>pam_pwhistory</code> module options can be set in PAM files.
<br>
         <br>
The value for <code>remember</code> option must be equal or greater than
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_remember" use="legacy"></xccdf-1.2:sub>
        </td>
</tr>
<tr>
<td></td>
<td>Limit Password Reuse: system-auth</td>
<td>Do not allow users to reuse recent passwords. This can be accomplished by using the
<code>remember</code> option for the <code>pam_pwhistory</code> PAM module.
<br>
         <br>

On systems with newer versions of <code>authselect</code>, the <code>pam_pwhistory</code> PAM module
can be enabled via authselect feature:
<pre>authselect enable-feature with-pwhistory</pre>

Otherwise, it should be enabled using an authselect custom profile.
<br>
         <br>
Newer systems also have the <code>/etc/security/pwhistory.conf</code> file for setting
<code>pam_pwhistory</code> module options. This file should be used whenever available.
Otherwise, the <code>pam_pwhistory</code> module options can be set in PAM files.
<br>
         <br>
The value for <code>remember</code> option must be equal or greater than
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_remember" use="legacy"></xccdf-1.2:sub>
        </td>
</tr>
<tr>
<td></td>
<td>Lock Accounts After Failed Password Attempts</td>
<td>This rule configures the system to lock out accounts after a number of incorrect login attempts
using <code>pam_faillock.so</code>.
pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected.
Ensure that the file <code>/etc/security/faillock.conf</code> contains the following entry:
<code>deny = &lt;count&gt;</code>
Where count should be less than or equal to
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"></xccdf-1.2:sub> and greater than 0.

In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <code>authselect</code> or <code>authconfig</code>,
depending on the OS version.</td>
</tr>
<tr>
<td></td>
<td>Set Lockout Time for Failed Password Attempts</td>
<td>This rule configures the system to lock out accounts during a specified time period after a
number of incorrect login attempts using <code>pam_faillock.so</code>.

Ensure that the file <code>/etc/security/faillock.conf</code> contains the following entry:
<code>unlock_time=&lt;interval-in-seconds&gt;</code> where
<code>interval-in-seconds</code> is <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"></xccdf-1.2:sub></code> or greater.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid any errors when manually editing these files,
it is recommended to use the appropriate tools, such as <code>authselect</code> or <code>authconfig</code>,
depending on the OS version.

If <code>unlock_time</code> is set to <code>0</code>, manual intervention by an administrator is required
to unlock a user. This should be done using the <code>faillock</code> tool.</td>
</tr>
<tr>
<td></td>
<td>Ensure PAM Enforces Password Requirements - Minimum Different Categories</td>
<td>The pam_pwquality module's <code>minclass</code> parameter controls
requirements for usage of different character classes, or types, of character
that must exist in a password before it is considered valid. For example,
setting this value to three (3) requires that any password must have characters
from at least three different categories in order to be approved. The default
value is zero (0), meaning there are no required classes. There are four
categories available:
<pre>
* Upper-case characters
* Lower-case characters
* Digits
* Special characters (for example, punctuation)
</pre>
Modify the <code>minclass</code> setting in <code>/etc/security/pwquality.conf</code> entry
to require <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_minclass" use="legacy"></xccdf-1.2:sub>
differing categories of characters when changing passwords.</td>
</tr>
<tr>
<td></td>
<td>Ensure PAM Enforces Password Requirements - Minimum Length</td>
<td>The pam_pwquality module's <code>minlen</code> parameter controls requirements for
minimum characters required in a password. Add <code>minlen=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy"></xccdf-1.2:sub>
          </code>
after pam_pwquality to set minimum password length requirements.</td>
</tr>
<tr>
<td></td>
<td>Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session</td>
<td>To configure the number of retry prompts that are permitted per-session:

Edit the <code>pam_pwquality.so</code> statement in

<code>/etc/pam.d/system-auth</code> to show


<code>retry=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_retry" use="legacy"></xccdf-1.2:sub>
          </code>, or a lower value if site
policy is more restrictive. The profile requirement is a maximum of <code>retry=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_retry" use="legacy"></xccdf-1.2:sub>
          </code> prompts
per session.</td>
</tr>
<tr>
<td></td>
<td>Set Password Hashing Algorithm in /etc/login.defs</td>
<td>In <code>/etc/login.defs</code>, add or update the following line to ensure the system will use
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm" use="legacy"></xccdf-1.2:sub> as the hashing algorithm:
<pre>ENCRYPT_METHOD <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm" use="legacy"></xccdf-1.2:sub>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Set PAM''s Password Hashing Algorithm - password-auth</td>
<td>The PAM system service can be configured to only store encrypted representations of passwords.
In <code>/etc/pam.d/password-auth</code>, the <code>password</code> section of the file controls which
PAM modules to execute during a password change.

Set the <code>pam_unix.so</code> module in the <code>password</code> section to include the option
<code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub></code> and no other hashing
algorithms as shown below:
<br>
         <pre>password    sufficient    pam_unix.so <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub>
          <i>other arguments...</i>
         </pre>
         <br>
This will help ensure that new passwords for local users will be stored using the
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub> algorithm.</td>
</tr>
<tr>
<td></td>
<td>Set PAM''s Password Hashing Algorithm</td>
<td>The PAM system service can be configured to only store encrypted representations of passwords.
In "/etc/pam.d/system-auth", the <code>password</code> section of the file controls which
PAM modules to execute during a password change.

Set the <code>pam_unix.so</code> module in the <code>password</code> section to include the option
<code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub></code> and no other hashing
algorithms as shown below:
<br>
         <pre>password    sufficient    pam_unix.so <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub>
          <i>other arguments...</i>
         </pre>
         <br>
This will help ensure that new passwords for local users will be stored using the
<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_hashing_algorithm_pam" use="legacy"></xccdf-1.2:sub> algorithm.</td>
</tr>
<tr>
<td></td>
<td>Ensure All Accounts on the System Have Unique User IDs</td>
<td>Change user IDs (UIDs), or delete accounts, so each has a unique name.</td>
</tr>
<tr>
<td></td>
<td>Ensure All Groups on the System Have Unique Group ID</td>
<td>Change the group name or delete groups, so each has a unique id.</td>
</tr>
<tr>
<td></td>
<td>Ensure All Groups on the System Have Unique Group Names</td>
<td>Change the group name or delete groups, so each has a unique name.</td>
</tr>
<tr>
<td></td>
<td>Set Account Expiration Following Inactivity</td>
<td>To specify the number of days after a password expires (which
signifies inactivity) until an account is permanently disabled, add or correct
the following line in <code>/etc/default/useradd</code>:
<pre>INACTIVE=<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_account_disable_post_pw_expiration" use="legacy"></xccdf-1.2:sub></i>
         </pre>
If a password is currently on the verge of expiration, then
<code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_account_disable_post_pw_expiration" use="legacy"></xccdf-1.2:sub></code>
day(s) remain(s) until the account is automatically
disabled. However, if the password will not expire for another 60 days, then 60
days plus <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_account_disable_post_pw_expiration" use="legacy"></xccdf-1.2:sub></code> day(s) could
elapse until the account would be automatically disabled. See the
<code>useradd</code> man page for more information.</td>
</tr>
<tr>
<td></td>
<td>Ensure All Accounts on the System Have Unique Names</td>
<td>Ensure accounts on the system have unique names.

To ensure all accounts have unique names, run the following command:
<pre>$ sudo getent passwd | awk -F: '{ print $1}' | uniq -d</pre>
If a username is returned, change or delete the username.</td>
</tr>
<tr>
<td></td>
<td>Set Password Maximum Age</td>
<td>To specify password maximum age for new accounts,
edit the file <code>/etc/login.defs</code>
and add or correct the following line:
<pre>PASS_MAX_DAYS <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" use="legacy"></xccdf-1.2:sub>
         </pre>
The profile requirement is <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" use="legacy"></xccdf-1.2:sub></code>.</td>
</tr>
<tr>
<td></td>
<td>Set Password Minimum Age</td>
<td>To specify password minimum age for new accounts,
edit the file <code>/etc/login.defs</code>
and add or correct the following line:
<pre>PASS_MIN_DAYS <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs" use="legacy"></xccdf-1.2:sub>
         </pre>
A value of 1 day is considered sufficient for many
environments.
The profile requirement is <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs" use="legacy"></xccdf-1.2:sub></code>.</td>
</tr>
<tr>
<td></td>
<td>Set Existing Passwords Maximum Age</td>
<td>Configure non-compliant accounts to enforce a <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" use="legacy"></xccdf-1.2:sub>-day maximum password lifetime
restriction by running the following command:
<pre>$ sudo chage -M <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" use="legacy"></xccdf-1.2:sub>
          <i>USER</i>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Set Existing Passwords Minimum Age</td>
<td>Configure non-compliant accounts to enforce a 24 hours/1 day minimum password
lifetime by running the following command:
<pre>$ sudo chage -m 1 <i>USER</i>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Set Existing Passwords Warning Age</td>
<td>To configure how many days prior to password expiration that a warning will be issued to
users, run the command:
<pre>$ sudo chage --warndays <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" use="legacy"></xccdf-1.2:sub>
          <i>USER</i>
         </pre>
This profile requirement is <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" use="legacy"></xccdf-1.2:sub></code>.</td>
</tr>
<tr>
<td></td>
<td>Set Password Warning Age</td>
<td>To specify how many days prior to password
expiration that a warning will be issued to users,
edit the file <code>/etc/login.defs</code> and add or correct
 the following line:
<pre>PASS_WARN_AGE <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" use="legacy"></xccdf-1.2:sub>
         </pre>
The profile requirement is <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" use="legacy"></xccdf-1.2:sub></code>.</td>
</tr>
<tr>
<td></td>
<td>Set existing passwords a period of inactivity before they been locked</td>
<td>Configure user accounts that have been inactive for over a given period of time
to be automatically disabled by running the following command:
<pre>$ sudo chage --inactive 30 USER</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify All Account Password Hashes are Shadowed</td>
<td>If any password hashes are stored in <code>/etc/passwd</code> (in the second field,
instead of an <code>x</code> or <code>*</code>), the cause of this misconfiguration should be
investigated. The account should have its password reset and the hash should be
properly stored, or the account should be deleted entirely.</td>
</tr>
<tr>
<td></td>
<td>Ensure all users last password change date is in the past</td>
<td>All users should have a password change date in the past.</td>
</tr>
<tr>
<td></td>
<td>All GIDs referenced in /etc/passwd must be defined in /etc/group</td>
<td>Add a group to the system for each GID referenced without a corresponding group.</td>
</tr>
<tr>
<td></td>
<td>Ensure There Are No Accounts With Blank or Null Passwords</td>
<td>Check the "/etc/shadow" file for blank passwords with the
following command:
<pre>$ sudo awk -F: '!$2 {print $1}' /etc/shadow</pre>
If the command returns any results, this is a finding.
Configure all accounts on the system to have a password or lock
the account with the following commands:
Perform a password reset:
<pre>$ sudo passwd [username]</pre>
Lock an account:
<pre>$ sudo passwd -l [username]</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify No .forward Files Exist</td>
<td>The <code>.forward</code> file specifies an email address to forward the user's mail to.</td>
</tr>
<tr>
<td></td>
<td>Verify Only Root Has UID 0</td>
<td>If any account other than root has a UID of 0, this misconfiguration should
be investigated and the accounts other than root should be removed or have
their UID changed.
<br>
If the account is associated with system commands or applications the UID
should be changed to one greater than "0" but less than "1000."
Otherwise assign a UID greater than "1000" that has not already been
assigned.</td>
</tr>
<tr>
<td></td>
<td>Verify Root Has A Primary GID 0</td>
<td>The <code>root</code> user should have a primary group of 0.</td>
</tr>
<tr>
<td></td>
<td>Ensure the Group Used by pam_wheel.so Module Exists on System and is Empty</td>
<td>Ensure that the group <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_pam_wheel_group_for_su" use="legacy"></xccdf-1.2:sub></code> referenced by
<code>var_pam_wheel_group_for_su</code> variable and used as value for the <code>pam_wheel.so</code>
         <code>group</code> option exists and has no members. This empty group used by
<code>pam_wheel.so</code> in <code>/etc/pam.d/su</code> ensures that no user can run commands with
altered privileges through the <code>su</code> command.</td>
</tr>
<tr>
<td></td>
<td>Ensure Authentication Required for Single User Mode</td>
<td>Single user mode is used for recovery when the system detects an
issue during boot or by manual selection from the bootloader.</td>
</tr>
<tr>
<td></td>
<td>Ensure that System Accounts Are Locked</td>
<td>Some accounts are not associated with a human user of the system, and exist to perform some
administrative functions. An attacker should not be able to log into these accounts.
<br>
         <br>
System accounts are those user accounts with a user ID less than <code>1000</code>.
If any system account other than <code>root</code>, <code>halt</code>, <code>sync</code>, <code>shutdown</code>
and <code>nfsnobody</code> has an unlocked password, disable it with the command:
<pre>$ sudo usermod -L <i>account</i>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Ensure that System Accounts Do Not Run a Shell Upon Login</td>
<td>Some accounts are not associated with a human user of the system, and exist to perform some
administrative functions. Should an attacker be able to log into these accounts, they should
not be granted access to a shell.
<br>
         <br>
The login shell for each local account is stored in the last field of each line in
<code>/etc/passwd</code>. System accounts are those user accounts with a user ID less than
<code>1000</code>. The user ID is stored in the third field. If any system account
other than <code>root</code> has a login shell, disable it with the command:
<pre>$ sudo usermod -s /sbin/nologin <i>account</i>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enforce Usage of pam_wheel with Group Parameter for su Authentication</td>
<td>To ensure that only users who are members of the group set in the <code>group</code> option of
<code>pam_wheel.so</code> module can run commands with altered privileges through the <code>su</code>
command, make sure that the following line exists in the file <code>/etc/pam.d/su</code>:
<pre>auth required pam_wheel.so use_uid group=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_pam_wheel_group_for_su" use="legacy"></xccdf-1.2:sub>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Set Interactive Session Timeout</td>
<td>Setting the <code>TMOUT</code> option in <code>/etc/profile</code> ensures that
all user sessions will terminate based on inactivity. A value of <code>0</code> (zero)
disables the automatic logout feature and is therefore not a compliant setting.
The value of TMOUT should be a positive integer, exported, and read only.
The <code>TMOUT</code>

setting in a file loaded by <code>/etc/profile</code>, e.g.
<code>/etc/profile.d/tmout.sh</code> should read as follows:
<pre>typeset -xr TMOUT=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy"></xccdf-1.2:sub>
        </pre>
or
<pre>declare -xr TMOUT=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy"></xccdf-1.2:sub>
        </pre>
Using the <code>typeset</code> keyword is preferred for wider compatibility with ksh and other shells.</td>
</tr>
<tr>
<td></td>
<td>User Initialization Files Must Be Group-Owned By The Primary Group</td>
<td>Change the group owner of interactive users files to the group found
in <pre>/etc/passwd</pre> for the user. To change the group owner of a local
interactive user home directory, use the following command:
<pre>$ sudo chgrp <i>USER_GROUP</i> /home/<i>USER</i>/.<i>INIT_FILE</i>
        </pre>

This rule ensures every initialization file related to an interactive user
is group-owned by an interactive user.</td>
</tr>
<tr>
<td></td>
<td>User Initialization Files Must Be Owned By the Primary User</td>
<td>Set the owner of the user initialization files for interactive users to
the primary owner with the following command:
<pre>$ sudo chown <i>USER</i> /home/<i>USER</i>/.*</pre>

This rule ensures every initialization file related to an interactive user
is owned by an interactive user.</td>
</tr>
<tr>
<td></td>
<td>All Interactive Users Home Directories Must Exist</td>
<td>Create home directories to all local interactive users that currently do not
have a home directory assigned. Use the following commands to create the user
home directory assigned in <code>/etc/passwd</code>:
<pre>$ sudo mkdir /home/<i>USER</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure users' .netrc Files are not group or world accessible</td>
<td>While the system administrator can establish secure permissions for users' .netrc files, the
users can easily override these.

This rule ensures every .netrc file or directory under the home directory related
to an interactive user is not group or world accessible</td>
</tr>
<tr>
<td></td>
<td>All Interactive User Home Directories Must Be Group-Owned By The Primary Group</td>
<td>Change the group owner of interactive users home directory to the
group found in <code>/etc/passwd</code>. To change the group owner of
interactive users home directory, use the following command:
<pre>$ sudo chgrp <i>USER_GROUP</i> /home/<i>USER</i>
        </pre>

This rule ensures every home directory related to an interactive user is
group-owned by an interactive user. It also ensures that interactive users
are group-owners of one and only one home directory.</td>
</tr>
<tr>
<td></td>
<td>All Interactive User Home Directories Must Be Owned By The Primary User</td>
<td>Change the owner of interactive users home directories to that correct
owner. To change the owner of a interactive users home directory, use
the following command:
<pre>$ sudo chown <i>USER</i> /home/<i>USER</i>
        </pre>

This rule ensures every home directory related to an interactive user is
owned by an interactive user. It also ensures that interactive users are
owners of one and only one home directory.</td>
</tr>
<tr>
<td></td>
<td>Ensure All User Initialization Files Have Mode 0740 Or Less Permissive</td>
<td>Set the mode of the user initialization files to <code>0740</code> with the
following command:
<pre>$ sudo chmod 0740 /home/<i>USER</i>/.<i>INIT_FILE</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>All Interactive User Home Directories Must Have mode 0750 Or Less Permissive</td>
<td>Change the mode of interactive users home directories to <code>0750</code>. To
change the mode of interactive users home directory, use the
following command:
<pre>$ sudo chmod 0750 /home/<i>USER</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure that Root's Path Does Not Include World or Group-Writable Directories</td>
<td>For each element in root's path, run:
<pre># ls -ld <i>DIR</i>
         </pre>
and ensure that write permissions are disabled for group and
other.</td>
</tr>
<tr>
<td></td>
<td>Ensure that Root's Path Does Not Include Relative Paths or Null Directories</td>
<td>Ensure that none of the directories in root's path is equal to a single
<code>.</code> character, or
that it contains any instances that lead to relative path traversal, such as
<code>..</code> or beginning a path without the slash (<code>/</code>) character.
Also ensure that there are no "empty" elements in the path, such as in these examples:
<pre>PATH=:/bin
PATH=/bin:
PATH=/bin::/sbin</pre>
These empty elements have the same effect as a single <code>.</code> character.</td>
</tr>
<tr>
<td></td>
<td>Ensure the Default Bash Umask is Set Correctly</td>
<td>To ensure the default umask for users of the Bash shell is set properly,
add or correct the <code>umask</code> setting in <code>/etc/bashrc</code> to read
as follows:
<pre>umask <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"></xccdf-1.2:sub>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Ensure the Default Umask is Set Correctly in login.defs</td>
<td>To ensure the default umask controlled by <code>/etc/login.defs</code> is set properly,
add or correct the <code>UMASK</code> setting in <code>/etc/login.defs</code> to read as follows:
<pre>UMASK <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"></xccdf-1.2:sub>
         </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Ensure the Default Umask is Set Correctly in /etc/profile</td>
<td>To ensure the default umask controlled by <code>/etc/profile</code> is set properly,
add or correct the <code>umask</code> setting in <code>/etc/profile</code> to read as follows:
<pre>umask <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"></xccdf-1.2:sub>
         </pre>

Note that <code>/etc/profile</code> also reads scripts within <code>/etc/profile.d</code> directory.
These scripts are also valid files to set umask value. Therefore, they should also be
considered during the check and properly remediated, if necessary.</td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/grub.cfg Group Ownership</td>
<td>The file <code>/boot/grub2/grub.cfg</code> should
be group-owned by the <code>root</code> group to prevent
destruction or modification of the file.

To properly set the group owner of <code>/boot/grub2/grub.cfg</code>, run the command:

  <pre>$ sudo chgrp root /boot/grub2/grub.cfg</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/user.cfg Group Ownership</td>
<td>The file <code>/boot/grub2/user.cfg</code> should be group-owned by the <code>root</code>
group to prevent reading or modification of the file.

To properly set the group owner of <code>/boot/grub2/user.cfg</code>, run the command:

  <pre>$ sudo chgrp root /boot/grub2/user.cfg</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/grub.cfg User Ownership</td>
<td>The file <code>/boot/grub2/grub.cfg</code> should
be owned by the <code>root</code> user to prevent destruction
or modification of the file.

To properly set the owner of <code>/boot/grub2/grub.cfg</code>, run the command:

  <pre>$ sudo chown root /boot/grub2/grub.cfg </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/user.cfg User Ownership</td>
<td>The file <code>/boot/grub2/user.cfg</code> should be owned by the <code>root</code>
user to prevent reading or modification of the file.

To properly set the owner of <code>/boot/grub2/user.cfg</code>, run the command:

  <pre>$ sudo chown root /boot/grub2/user.cfg </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/grub.cfg Permissions</td>
<td>File permissions for <code>/boot/grub2/grub.cfg</code> should be set to 600.

To properly set the permissions of <code>/boot/grub2/grub.cfg</code>, run the command:
<pre>$ sudo chmod 600 /boot/grub2/grub.cfg</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify /boot/grub2/user.cfg Permissions</td>
<td>File permissions for <code>/boot/grub2/user.cfg</code> should be set to 600.

To properly set the permissions of <code>/boot/grub2/user.cfg</code>, run the command:
<pre>$ sudo chmod 600 /boot/grub2/user.cfg</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure rsyslog is Installed</td>
<td>Rsyslog is installed by default. The <code>rsyslog</code> package can be installed with the following command: <pre> $ sudo dnf install rsyslog</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Ensure rsyslog Default File Permissions Configured</td>
<td>rsyslog will create logfiles that do not already exist on the system.
This settings controls what permissions will be applied to these newly
created files.</td>
</tr>
<tr>
<td></td>
<td>Ensure Log Files Are Owned By Appropriate Group</td>
<td>The group-owner of all log files written by
<code>rsyslog</code> should be <code>root</code>.
These log files are determined by the second part of each Rule line in
<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.
For each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,
run the following command to inspect the file's group owner:
<pre>$ ls -l <i>LOGFILE</i>
        </pre>
If the owner is not <code>root</code>,
run the following command to
correct this:
<pre>$ sudo chgrp root <i>LOGFILE</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure Log Files Are Owned By Appropriate User</td>
<td>The owner of all log files written by
<code>rsyslog</code> should be

<code>root</code>.

These log files are determined by the second part of each Rule line in
<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.
For each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,
run the following command to inspect the file's owner:
<pre>$ ls -l <i>LOGFILE</i>
        </pre>
If the owner is not

<code>root</code>,

run the following command to
correct this:

<pre>$ sudo chown root <i>LOGFILE</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure System Log Files Have Correct Permissions</td>
<td>The file permissions for all log files written by <code>rsyslog</code> should
be set to 640, or more restrictive. These log files are determined by the
second part of each Rule line in <code>/etc/rsyslog.conf</code> and typically
all appear in <code>/var/log</code>. For each log file <i>LOGFILE</i>
referenced in <code>/etc/rsyslog.conf</code>, run the following command to
inspect the file's permissions:
<pre>$ ls -l <i>LOGFILE</i>
        </pre>
If the permissions are not 640 or more restrictive, run the following
command to correct this:
<pre>$ sudo chmod 640 <i>LOGFILE</i>
        </pre>"</td>
</tr>
<tr>
<td></td>
<td>Enable systemd-journald Service</td>
<td>The <code>systemd-journald</code> service is an essential component of
systemd.

The <code>systemd-journald</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable systemd-journald.service</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure journald is configured to compress large log files</td>
<td>The journald system can compress large log files to avoid fill the system disk.</td>
</tr>
<tr>
<td></td>
<td>Ensure journald is configured to send logs to rsyslog</td>
<td>Data from journald may be stored in volatile memory or persisted locally.
Utilities exist to accept remote export of journald logs.</td>
</tr>
<tr>
<td></td>
<td>Ensure journald is configured to write log files to persistent disk</td>
<td>The journald system may store log files in volatile memory or locally on disk.
If the logs are only stored in volatile memory they will be lost upon reboot.</td>
</tr>
<tr>
<td></td>
<td>Disable systemd-journal-remote Socket</td>
<td>Journald supports the ability to receive messages from remote hosts,
thus acting as a log server. Clients should not receive data from
other hosts.
NOTE:
    The same package, systemd-journal-remote , is used for both sending
    logs to remote hosts and receiving incoming logs.
    With regards to receiving logs, there are two Systemd unit files;
    systemd-journal-remote.socket and systemd-journal-remote.service.</td>
</tr>
<tr>
<td></td>
<td>Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server</td>
<td>The <code>rsyslog</code> daemon should not accept remote messages unless the system acts as a log
server. To ensure that it is not listening on the network, ensure any of the following lines
are <i>not</i> found in <code>rsyslog</code> configuration files.

If using legacy syntax:
<pre>$ModLoad imtcp
$InputTCPServerRun <i>port</i>
$ModLoad imudp
$UDPServerRun <i>port</i>
$ModLoad imrelp
$InputRELPServerRun <i>port</i>
        </pre>

If using RainerScript syntax:
<pre>module(load="imtcp")
module(load="imudp")
input(type="imtcp" port="514")
input(type="imudp" port="514")
</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure Logs Sent To Remote Host</td>
<td>To configure rsyslog to send logs to a remote log server,
open <code>/etc/rsyslog.conf</code> and read and understand the last section of the file,
which describes the multiple directives necessary to activate remote
logging.
Along with these other directives, the system can be configured
to forward its logs to a particular log server by
adding or correcting one of the following lines,
substituting <code><i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i></code> appropriately.
The choice of protocol depends on the environment of the system;
although TCP and RELP provide more reliable message delivery,
they may not be supported in all environments.
<br>
To use UDP for log message delivery:
<pre>*.* @<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>
        </pre>
        <br>
Or in RainerScript:
<pre>*.* action(type="omfwd" ... target="<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>" protocol="udp")</pre>
        <br>
To use TCP for log message delivery:
<pre>*.* @@<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>
        </pre>
        <br>
Or in RainerScript:
<pre>*.* action(type="omfwd" ... target="<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>" protocol="tcp")</pre>
        <br>
To use RELP for log message delivery:
<pre>*.* :omrelp:<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>
        </pre>
        <br>
Or in RainerScript:
<pre>*.* action(type="omfwd" ... target="<i><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub></i>" protocol="relp")</pre>
        <br>
There must be a resolvable DNS CNAME or Alias record set to "<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_rsyslog_remote_loghost_address" use="legacy"></xccdf-1.2:sub>" for logs to be sent correctly to the centralized logging utility.</td>
</tr>
<tr>
<td></td>
<td>Install firewalld Package</td>
<td>The <code>firewalld</code> package can be installed with the following command:
<pre>
$ sudo dnf install firewalld</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify firewalld Enabled</td>
<td>
The <code>firewalld</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable firewalld.service</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Configure Firewalld to Restrict Loopback Traffic</td>
<td>Configure <code>firewalld</code> to restrict loopback traffic to the <code>lo</code> interface.

The loopback traffic must be trusted by assigning the <code>lo</code> interface to the
<code>firewalld</code>
         <code>trusted</code> zone. However, the loopback traffic must be restricted
to the loopback interface as an anti-spoofing measure.

To configure <code>firewalld</code> to restrict loopback traffic to the <code>lo</code> interface,
run the following commands:
<pre>
sudo firewall-cmd --permanent --zone=trusted --add-rich-rule='rule family=ipv4 source address="127.0.0.1" destination not address="127.0.0.1" drop'
sudo firewall-cmd --permanent --zone=trusted --add-rich-rule='rule family=ipv6 source address="::1" destination not address="::1" drop'
</pre>

To ensure <code>firewalld</code> settings are applied in runtime, run the following command:
<pre>firewall-cmd --reload</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Configure Firewalld to Trust Loopback Traffic</td>
<td>Assign loopback interface to the <code>firewalld</code>
         <code>trusted</code> zone in order to
explicitly allow the loopback traffic in the system.

To configure <code>firewalld</code> to trust loopback traffic, run the following command:
<pre>sudo firewall-cmd --permanent --zone=trusted --add-interface=lo</pre>
To ensure <code>firewalld</code> settings are applied in runtime, run the following command:
<pre>firewall-cmd --reload</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Set Default firewalld Zone for Incoming Packets</td>
<td>To set the default zone to <code>drop</code> for
the built-in default zone which processes incoming IPv4 and IPv6 packets,
modify the following line in
<code>/etc/firewalld/firewalld.conf</code> to be:
<pre>DefaultZone=drop</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Configure Accepting Router Advertisements on All IPv6 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv6.conf.all.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_ra = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Accepting ICMP Redirects for All IPv6 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv6.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv6.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_source_route = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for IPv6 Forwarding</td>
<td>To set the runtime status of the <code>net.ipv6.conf.all.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.forwarding = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Accepting Router Advertisements on all IPv6 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv6.conf.default.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_ra = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv6.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv6.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_source_route = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Accepting ICMP Redirects for All IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.accept_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.accept_source_route = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.log_martians = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.rp_filter = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.secure_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.accept_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.accept_source_route = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.log_martians = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.rp_filter = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Configure Kernel Parameter for Accepting Secure Redirects By Default</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.secure_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.icmp_echo_ignore_broadcasts</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.icmp_echo_ignore_broadcasts = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.icmp_ignore_bogus_error_responses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.icmp_ignore_bogus_error_responses = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Enable Kernel Parameter to Use TCP Syncookies on Network Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.tcp_syncookies</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_syncookies=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.tcp_syncookies = 1</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.conf.all.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.send_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default</td>
<td>To set the runtime status of the <code>net.ipv4.conf.default.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.send_redirects = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces</td>
<td>To set the runtime status of the <code>net.ipv4.ip_forward</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.ip_forward=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.ip_forward = 0</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Install nftables Package</td>
<td>nftables provides a new in-kernel packet classification framework that is based on a
network-specific Virtual Machine (VM) and a new nft userspace command line tool.
nftables reuses the existing Netfilter subsystems such as the existing hook infrastructure,
the connection tracking system, NAT, userspace queuing and logging subsystem.
The <code>nftables</code> package can be installed with the following command:
<pre>
$ sudo dnf install nftables</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify nftables Service is Disabled</td>
<td>nftables is a subsystem of the Linux kernel providing filtering and classification of network
packets/datagrams/frames and is the successor to iptables.
The <code>nftables</code> service can be disabled with the following command:
<pre>systemctl disable nftables</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure a Table Exists for Nftables</td>
<td>Tables in nftables hold chains. Each table only has one address family and only applies
to packets of this family. Tables can have one of six families.</td>
</tr>
<tr>
<td></td>
<td>Disable DCCP Support</td>
<td>The Datagram Congestion Control Protocol (DCCP) is a
relatively new transport layer protocol, designed to support
streaming media and telephony.

To configure the system to prevent the <code>dccp</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/dccp.conf</code>:
<pre>install dccp /bin/false</pre>
This entry will cause a non-zero return value during a <code>dccp</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install dccp /bin/true</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable RDS Support</td>
<td>The Reliable Datagram Sockets (RDS) protocol is a transport
layer protocol designed to provide reliable high-bandwidth,
low-latency communications between nodes in a cluster.

To configure the system to prevent the <code>rds</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/rds.conf</code>:
<pre>install rds /bin/false</pre>
This entry will cause a non-zero return value during a <code>rds</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install rds /bin/true</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable SCTP Support</td>
<td>The Stream Control Transmission Protocol (SCTP) is a
transport layer protocol, designed to support the idea of
message-oriented communication, with several streams of messages
within one connection.

To configure the system to prevent the <code>sctp</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/sctp.conf</code>:
<pre>install sctp /bin/false</pre>
This entry will cause a non-zero return value during a <code>sctp</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install sctp /bin/true</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable TIPC Support</td>
<td>The Transparent Inter-Process Communication (TIPC) protocol
is designed to provide communications between nodes in a
cluster.

To configure the system to prevent the <code>tipc</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/tipc.conf</code>:
<pre>install tipc /bin/false</pre>
This entry will cause a non-zero return value during a <code>tipc</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install tipc /bin/true</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify that All World-Writable Directories Have Sticky Bits Set</td>
<td>When the so-called 'sticky bit' is set on a directory, only the owner of a given file may
remove that file from the directory. Without the sticky bit, any user with write access to a
directory may remove any file in the directory. Setting the sticky bit prevents users from
removing each other's files. In cases where there is no reason for a directory to be
world-writable, a better solution is to remove that permission rather than to set the sticky
bit. However, if a directory is used by a particular application, consult that application's
documentation instead of blindly changing modes.
<br>
To set the sticky bit on a world-writable directory <i>DIR</i>, run the following command:
<pre>$ sudo chmod +t <i>DIR</i>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure No World-Writable Files Exist</td>
<td>It is generally a good idea to remove global (other) write access to a file when it is
discovered. However, check with documentation for specific applications before making changes.
Also, monitor for recurring world-writable files, as these may be symptoms of a misconfigured
application or user account. Finally, this applies to real files and not virtual files that
are a part of pseudo file systems such as <code>sysfs</code> or <code>procfs</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure All Files Are Owned by a Group</td>
<td>If any file is not group-owned by a valid defined group, the cause of the lack of
group-ownership must be investigated. Following this, those files should be deleted or
assigned to an appropriate group. The groups need to be defined in <code>/etc/group</code>
or in <code>/usr/lib/group</code> if <code>nss-altfiles</code> are configured to be used
in <code>/etc/nsswitch.conf</code>.

Locate the mount points related to local devices by the following command:
<pre>$ findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,)</pre>

For all mount points listed by the previous command, it is necessary to search for files which
do not belong to a valid group using the following command:
<pre>$ sudo find <i>MOUNTPOINT</i> -xdev -nogroup 2&gt;/dev/null</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure All Files Are Owned by a User</td>
<td>If any files are not owned by a user, then the cause of their lack of ownership should be
investigated. Following this, the files should be deleted or assigned to an appropriate user.

Locate the mount points related to local devices by the following command:
<pre>$ findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,)</pre>

For all mount points listed by the previous command, it is necessary to search for files which
do not belong to a valid user using the following command:
<pre>$ sudo find <i>MOUNTPOINT</i> -xdev -nouser 2&gt;/dev/null</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns Backup group File</td>
<td> To properly set the group owner of <code>/etc/group-</code>, run the command:
<pre>$ sudo chgrp root /etc/group-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns Backup gshadow File</td>
<td> To properly set the group owner of <code>/etc/gshadow-</code>, run the command:
<pre>$ sudo chgrp root /etc/gshadow-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns Backup passwd File</td>
<td> To properly set the group owner of <code>/etc/passwd-</code>, run the command:
<pre>$ sudo chgrp root /etc/passwd-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns Backup shadow File</td>
<td> To properly set the group owner of <code>/etc/shadow-</code>, run the command:
<pre>$ sudo chgrp root /etc/shadow-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns group File</td>
<td> To properly set the group owner of <code>/etc/group</code>, run the command:
<pre>$ sudo chgrp root /etc/group</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns gshadow File</td>
<td> To properly set the group owner of <code>/etc/gshadow</code>, run the command:
<pre>$ sudo chgrp root /etc/gshadow</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns passwd File</td>
<td> To properly set the group owner of <code>/etc/passwd</code>, run the command:
<pre>$ sudo chgrp root /etc/passwd</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns shadow File</td>
<td> To properly set the group owner of <code>/etc/shadow</code>, run the command:
<pre>$ sudo chgrp root /etc/shadow</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns Backup group File</td>
<td> To properly set the owner of <code>/etc/group-</code>, run the command:
<pre>$ sudo chown root /etc/group- </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns Backup gshadow File</td>
<td> To properly set the owner of <code>/etc/gshadow-</code>, run the command:
<pre>$ sudo chown root /etc/gshadow- </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns Backup passwd File</td>
<td> To properly set the owner of <code>/etc/passwd-</code>, run the command:
<pre>$ sudo chown root /etc/passwd- </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns Backup shadow File</td>
<td> To properly set the owner of <code>/etc/shadow-</code>, run the command:
<pre>$ sudo chown root /etc/shadow- </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns group File</td>
<td> To properly set the owner of <code>/etc/group</code>, run the command:
<pre>$ sudo chown root /etc/group </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns gshadow File</td>
<td> To properly set the owner of <code>/etc/gshadow</code>, run the command:
<pre>$ sudo chown root /etc/gshadow </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns passwd File</td>
<td> To properly set the owner of <code>/etc/passwd</code>, run the command:
<pre>$ sudo chown root /etc/passwd </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns shadow File</td>
<td> To properly set the owner of <code>/etc/shadow</code>, run the command:
<pre>$ sudo chown root /etc/shadow </pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on Backup group File</td>
<td>
To properly set the permissions of <code>/etc/group-</code>, run the command:
<pre>$ sudo chmod 0644 /etc/group-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on Backup gshadow File</td>
<td>
To properly set the permissions of <code>/etc/gshadow-</code>, run the command:
<pre>$ sudo chmod 0000 /etc/gshadow-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on Backup passwd File</td>
<td>
To properly set the permissions of <code>/etc/passwd-</code>, run the command:
<pre>$ sudo chmod 0644 /etc/passwd-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on Backup shadow File</td>
<td>
To properly set the permissions of <code>/etc/shadow-</code>, run the command:
<pre>$ sudo chmod 0000 /etc/shadow-</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on group File</td>
<td>
To properly set the permissions of <code>/etc/group</code>, run the command:
<pre>$ sudo chmod 0644 /etc/group</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on gshadow File</td>
<td>
To properly set the permissions of <code>/etc/gshadow</code>, run the command:
<pre>$ sudo chmod 0000 /etc/gshadow</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on passwd File</td>
<td>
To properly set the permissions of <code>/etc/passwd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/passwd</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on shadow File</td>
<td>
To properly set the permissions of <code>/etc/shadow</code>, run the command:
<pre>$ sudo chmod 0000 /etc/shadow</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of cramfs</td>
<td>
To configure the system to prevent the <code>cramfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/cramfs.conf</code>:
<pre>install cramfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>cramfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install cramfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <code>cramfs</code> filesystem type is a compressed read-only
Linux filesystem embedded in small footprint systems. A
<code>cramfs</code> image can be used without having to first
decompress the image.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of freevxfs</td>
<td>
To configure the system to prevent the <code>freevxfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/freevxfs.conf</code>:
<pre>install freevxfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>freevxfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install freevxfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of hfs</td>
<td>
To configure the system to prevent the <code>hfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/hfs.conf</code>:
<pre>install hfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>hfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install hfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of hfsplus</td>
<td>
To configure the system to prevent the <code>hfsplus</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/hfsplus.conf</code>:
<pre>install hfsplus /bin/false</pre>
This entry will cause a non-zero return value during a <code>hfsplus</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install hfsplus /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of jffs2</td>
<td>
To configure the system to prevent the <code>jffs2</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/jffs2.conf</code>:
<pre>install jffs2 /bin/false</pre>
This entry will cause a non-zero return value during a <code>jffs2</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install jffs2 /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of squashfs</td>
<td>
To configure the system to prevent the <code>squashfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/squashfs.conf</code>:
<pre>install squashfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>squashfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install squashfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <code>squashfs</code> filesystem type is a compressed read-only Linux
filesystem embedded in small footprint systems (similar to
<code>cramfs</code>). A <code>squashfs</code> image can be used without having
to first decompress the image.</td>
</tr>
<tr>
<td></td>
<td>Disable Mounting of udf</td>
<td>
To configure the system to prevent the <code>udf</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/udf.conf</code>:
<pre>install udf /bin/false</pre>
This entry will cause a non-zero return value during a <code>udf</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install udf /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <code>udf</code> filesystem type is the universal disk format
used to implement the ISO/IEC 13346 and ECMA-167 specifications.
This is an open vendor filesystem type for data storage on a broad
range of media. This filesystem type is necessary to support
writing DVDs and newer optical disc formats.</td>
</tr>
<tr>
<td></td>
<td>Disable Modprobe Loading of USB Storage Driver</td>
<td>To prevent USB storage devices from being used, configure the kernel module loading system
to prevent automatic loading of the USB storage driver.

To configure the system to prevent the <code>usb-storage</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/usb-storage.conf</code>:
<pre>install usb-storage /bin/false</pre>
This entry will cause a non-zero return value during a <code>usb-storage</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install usb-storage /bin/true</pre>

This will prevent the <code>modprobe</code> program from loading the <code>usb-storage</code>
module, but will not prevent an administrator (or another program) from using the
<code>insmod</code> program to load the module manually.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /dev/shm</td>
<td>The <code>nodev</code> mount option can be used to prevent creation of device
files in <code>/dev/shm</code>. Legitimate character and block devices should
not exist within temporary directories like <code>/dev/shm</code>.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/dev/shm</code>.</td>
</tr>
<tr>
<td></td>
<td>Add noexec Option to /dev/shm</td>
<td>The <code>noexec</code> mount option can be used to prevent binaries
from being executed out of <code>/dev/shm</code>.
It can be dangerous to allow the execution of binaries
from world-writable temporary storage directories such as <code>/dev/shm</code>.
Add the <code>noexec</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/dev/shm</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /dev/shm</td>
<td>The <code>nosuid</code> mount option can be used to prevent execution
of setuid programs in <code>/dev/shm</code>.  The SUID and SGID permissions should not
be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/dev/shm</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /home</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/home</code>.
Legitimate character and block devices should exist only in
the <code>/dev</code> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/home</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /home</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/home</code>. The SUID and SGID permissions
should not be required in these user data directories.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/home</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /tmp</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/tmp</code>. Legitimate character and block devices
should not exist within temporary directories like <code>/tmp</code>.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Add noexec Option to /tmp</td>
<td>The <code>noexec</code> mount option can be used to prevent binaries
from being executed out of <code>/tmp</code>.
Add the <code>noexec</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /tmp</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/tmp</code>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /var/log/audit</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/var/log/audit</code>.
Legitimate character and block devices should exist only in
the <code>/dev</code> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log/audit</code>.</td>
</tr>
<tr>
<td></td>
<td>Add noexec Option to /var/log/audit</td>
<td>The <code>noexec</code> mount option can be used to prevent binaries
from being executed out of <code>/var/log/audit</code>.
Add the <code>noexec</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log/audit</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /var/log/audit</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/var/log/audit</code>. The SUID and SGID permissions
should not be required in directories containing audit log files.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log/audit</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /var/log</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/var/log</code>.
Legitimate character and block devices should exist only in
the <code>/dev</code> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log</code>.</td>
</tr>
<tr>
<td></td>
<td>Add noexec Option to /var/log</td>
<td>The <code>noexec</code> mount option can be used to prevent binaries
from being executed out of <code>/var/log</code>.
Add the <code>noexec</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /var/log</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/var/log</code>. The SUID and SGID permissions
should not be required in directories containing log files.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/log</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /var</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/var</code>.
Legitimate character and block devices should exist only in
the <code>/dev</code> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /var</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/var</code>. The SUID and SGID permissions
should not be required for this directory.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nodev Option to /var/tmp</td>
<td>The <code>nodev</code> mount option can be used to prevent device files from
being created in <code>/var/tmp</code>. Legitimate character and block devices
should not exist within temporary directories like <code>/var/tmp</code>.
Add the <code>nodev</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Add noexec Option to /var/tmp</td>
<td>The <code>noexec</code> mount option can be used to prevent binaries
from being executed out of <code>/var/tmp</code>.
Add the <code>noexec</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Add nosuid Option to /var/tmp</td>
<td>The <code>nosuid</code> mount option can be used to prevent
execution of setuid programs in <code>/var/tmp</code>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<code>/etc/fstab</code> for the line which controls mounting of
<code>/var/tmp</code>.</td>
</tr>
<tr>
<td></td>
<td>Restrict usage of ptrace to descendant processes</td>
<td>To set the runtime status of the <code>kernel.yama.ptrace_scope</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.yama.ptrace_scope=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>kernel.yama.ptrace_scope = 1</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable core dump backtraces</td>
<td>The <code>ProcessSizeMax</code> option in <code>[Coredump]</code> section
of <code>/etc/systemd/coredump.conf</code> or in a drop-in file under
<code>/etc/systemd/coredump.conf.d/</code> specifies the maximum size in bytes
of a core which will be processed. Core dumps exceeding this size may be
stored, but the backtrace will not be generated.</td>
</tr>
<tr>
<td></td>
<td>Disable storing core dump</td>
<td>The <code>Storage</code> option in <code>[Coredump]</code> section
of <code>/etc/systemd/coredump.conf</code> or a drop-in file in
<code>/etc/systemd/coredump.conf.d/*.conf</code>
can be set to <code>none</code> to disable storing core dumps permanently.</td>
</tr>
<tr>
<td></td>
<td>Enable Randomized Layout of Virtual Address Space</td>
<td>To set the runtime status of the <code>kernel.randomize_va_space</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.randomize_va_space=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>kernel.randomize_va_space = 2</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Install libselinux Package</td>
<td>The <code>libselinux</code> package can be installed with the following command:
<pre>
$ sudo dnf install libselinux</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Uninstall mcstrans Package</td>
<td>The <code>mcstransd</code> daemon provides category label information
to client processes requesting information. The label translations are defined
in <code>/etc/selinux/targeted/setrans.conf</code>.
The <code>mcstrans</code> package can be removed with the following command:
<pre>
$ sudo dnf remove mcstrans</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Uninstall setroubleshoot Package</td>
<td>The SETroubleshoot service notifies desktop users of SELinux
denials. The service provides information around configuration errors,
unauthorized intrusions, and other potential errors.
The <code>setroubleshoot</code> package can be removed with the following command:
<pre>
$ sudo dnf remove setroubleshoot</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Ensure SELinux Not Disabled in /etc/default/grub</td>
<td>SELinux can be disabled at boot time by an argument in
<code>/etc/default/grub</code>.
Remove any instances of <code>selinux=0</code> from the kernel arguments in that
file to prevent SELinux from being disabled at boot.</td>
</tr>
<tr>
<td></td>
<td>Ensure No Daemons are Unconfined by SELinux</td>
<td>Daemons for which the SELinux policy does not contain rules will inherit the
context of the parent process. Because daemons are launched during
startup and descend from the <code>init</code> process, they inherit the <code>unconfined_service_t</code> context.
<br>
       <br>
To check for unconfined daemons, run the following command:
<pre>$ sudo ps -eZ | grep "unconfined_service_t"</pre>
It should produce no output in a well-configured system.</td>
</tr>
<tr>
<td></td>
<td>Ensure SELinux is Not Disabled</td>
<td>The SELinux state should be set to <code>enforcing</code> or <code>permissive</code> at system boot
time. In the file <code>/etc/selinux/config</code>, add or correct the following line to configure
the system to boot into enforcing or permissive mode:
<pre>SELINUX=enforcing</pre>
OR
<pre>SELINUX=permissive</pre>
Ensure that all files have correct SELinux labels by running:
<pre>fixfiles onboot</pre>
Then reboot the system.</td>
</tr>
<tr>
<td></td>
<td>Configure SELinux Policy</td>
<td>The SELinux <code>targeted</code> policy is appropriate for
general-purpose desktops and servers, as well as systems in many other roles.
To configure the system to use this policy, add or correct the following line
in <code>/etc/selinux/config</code>:
<pre>SELINUXTYPE=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_selinux_policy_name" use="legacy"></xccdf-1.2:sub>
       </pre>
Other policies, such as <code>mls</code>, provide additional security labeling
and greater confinement but are not compatible with many general-purpose
use cases.</td>
</tr>
<tr>
<td></td>
<td>Ensure SELinux State is Enforcing</td>
<td>The SELinux state should be set to <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_selinux_state" use="legacy"></xccdf-1.2:sub></code> at
system boot time.  In the file <code>/etc/selinux/config</code>, add or correct the
following line to configure the system to boot into enforcing mode:
<pre>SELINUX=<xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_selinux_state" use="legacy"></xccdf-1.2:sub>
       </pre>
Ensure that all files have correct SELinux labels by running:
<pre>fixfiles onboot</pre>
Then reboot the system.</td>
</tr>
<tr>
<td></td>
<td>Uninstall avahi Server Package</td>
<td>If the system does not need to have an Avahi server which implements
the DNS Service Discovery and Multicast DNS protocols,
the avahi-autoipd and avahi packages can be uninstalled.</td>
</tr>
<tr>
<td></td>
<td>Enable cron Service</td>
<td>The <code>crond</code> service is used to execute commands at
preconfigured times. It is required by almost all systems to perform necessary
maintenance tasks, such as notifying root of system activity.

The <code>crond</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable crond.service</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns cron.d</td>
<td>
To properly set the group owner of <code>/etc/cron.d</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.d</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns cron.daily</td>
<td>
To properly set the group owner of <code>/etc/cron.daily</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.daily</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns cron.hourly</td>
<td>
To properly set the group owner of <code>/etc/cron.hourly</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.hourly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns cron.monthly</td>
<td>
To properly set the group owner of <code>/etc/cron.monthly</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.monthly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns cron.weekly</td>
<td>
To properly set the group owner of <code>/etc/cron.weekly</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.weekly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns Crontab</td>
<td>
To properly set the group owner of <code>/etc/crontab</code>, run the command:

  <pre>$ sudo chgrp root /etc/crontab</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on cron.d</td>
<td>
To properly set the owner of <code>/etc/cron.d</code>, run the command:

  <pre>$ sudo chown root /etc/cron.d </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on cron.daily</td>
<td>
To properly set the owner of <code>/etc/cron.daily</code>, run the command:

  <pre>$ sudo chown root /etc/cron.daily </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on cron.hourly</td>
<td>
To properly set the owner of <code>/etc/cron.hourly</code>, run the command:

  <pre>$ sudo chown root /etc/cron.hourly </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on cron.monthly</td>
<td>
To properly set the owner of <code>/etc/cron.monthly</code>, run the command:

  <pre>$ sudo chown root /etc/cron.monthly </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on cron.weekly</td>
<td>
To properly set the owner of <code>/etc/cron.weekly</code>, run the command:

  <pre>$ sudo chown root /etc/cron.weekly </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Owner on crontab</td>
<td>
To properly set the owner of <code>/etc/crontab</code>, run the command:

  <pre>$ sudo chown root /etc/crontab </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on cron.d</td>
<td>
To properly set the permissions of <code>/etc/cron.d</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.d</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on cron.daily</td>
<td>
To properly set the permissions of <code>/etc/cron.daily</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.daily</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on cron.hourly</td>
<td>
To properly set the permissions of <code>/etc/cron.hourly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.hourly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on cron.monthly</td>
<td>
To properly set the permissions of <code>/etc/cron.monthly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.monthly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on cron.weekly</td>
<td>
To properly set the permissions of <code>/etc/cron.weekly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.weekly</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on crontab</td>
<td>
To properly set the permissions of <code>/etc/crontab</code>, run the command:
<pre>$ sudo chmod 0600 /etc/crontab</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Ensure that /etc/at.deny does not exist</td>
<td>The file <code>/etc/at.deny</code> should not exist.
Use <code>/etc/at.allow</code> instead.</td>
</tr>
<tr>
<td></td>
<td>Ensure that /etc/cron.allow exists</td>
<td>The file <code>/etc/cron.allow</code> should exist and should be used instead
of <code>/etc/cron.deny</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure that /etc/cron.deny does not exist</td>
<td>The file <code>/etc/cron.deny</code> should not exist.
Use <code>/etc/cron.allow</code> instead.</td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns /etc/at.allow file</td>
<td>If <code>/etc/at.allow</code> exists, it must be group-owned by <code>root</code>.

To properly set the group owner of <code>/etc/at.allow</code>, run the command:

  <pre>$ sudo chgrp root /etc/at.allow</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns /etc/cron.allow file</td>
<td>If <code>/etc/cron.allow</code> exists, it must be group-owned by <code>root</code>.

To properly set the group owner of <code>/etc/cron.allow</code>, run the command:

  <pre>$ sudo chgrp root /etc/cron.allow</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns /etc/at.allow file</td>
<td>If <code>/etc/at.allow</code> exists, it must be owned by <code>root</code>.

To properly set the owner of <code>/etc/at.allow</code>, run the command:

  <pre>$ sudo chown root /etc/at.allow </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify User Who Owns /etc/cron.allow file</td>
<td>If <code>/etc/cron.allow</code> exists, it must be owned by <code>root</code>.

To properly set the owner of <code>/etc/cron.allow</code>, run the command:

  <pre>$ sudo chown root /etc/cron.allow </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on /etc/at.allow file</td>
<td>If <code>/etc/at.allow</code> exists, it must have permissions <code>0640</code>
or more restrictive.


To properly set the permissions of <code>/etc/at.allow</code>, run the command:
<pre>$ sudo chmod 0640 /etc/at.allow</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on /etc/cron.allow file</td>
<td>If <code>/etc/cron.allow</code> exists, it must have permissions <code>0640</code>
or more restrictive.


To properly set the permissions of <code>/etc/cron.allow</code>, run the command:
<pre>$ sudo chmod 0640 /etc/cron.allow</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall DHCP Server Package</td>
<td>If the system does not need to act as a DHCP server,
the dhcp package can be uninstalled.

The <code>dhcp</code> package can be removed with the following command:
<pre>
$ sudo dnf remove dhcp</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall dnsmasq Package</td>
<td>dnsmasq is a lightweight tool that provides DNS caching, DNS forwarding and
DHCP (Dynamic Host Configuration Protocol) services.
<br>
The <code>dnsmasq</code> package can be removed with the following command:
<pre>
$ sudo dnf remove dnsmasq</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Uninstall bind Package</td>
<td>The <code>named</code> service is provided by the <code>bind</code> package.
The <code>bind</code> package can be removed with the following command:
<pre>
$ sudo dnf remove bind</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Remove ftp Package</td>
<td>FTP (File Transfer Protocol) is a traditional and widely used standard tool for
transferring files between a server and clients over a network, especially where no
authentication is necessary (permits anonymous users to connect to a server).
<br>
The <code>ftp</code> package can be removed with the following command:
<pre>
$ sudo dnf remove ftp</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Uninstall vsftpd Package</td>
<td>The <code>vsftpd</code> package can be removed with the following command: <pre> $ sudo dnf remove vsftpd</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall httpd Package</td>
<td>The <code>httpd</code> package can be removed with the following command:
<pre>
$ sudo dnf remove httpd</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall nginx Package</td>
<td>The <code>nginx</code> package can be removed with the following command:
<pre>
$ sudo dnf remove nginx</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall cyrus-imapd Package</td>
<td>The <code>cyrus-imapd</code> package can be removed with the following command:
<pre>
$ sudo dnf remove cyrus-imapd</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall dovecot Package</td>
<td>
The <code>dovecot</code> package can be removed with the following command:
<pre>
$ sudo dnf remove dovecot</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure LDAP client is not installed</td>
<td>The Lightweight Directory Access Protocol (LDAP) is a service that provides
a method for looking up information from a central database.
The <code>openldap-clients</code> package can be removed with the following command:
<pre>
$ sudo dnf remove openldap-clients</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure Mail Transfer Agent is not Listening on any non-loopback Address</td>
<td>Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to
listen for incoming mail and transfer the messages to the appropriate
user or mail server. If the system is not intended to be a mail server,
it is recommended that the MTA be configured to only process local mail.</td>
</tr>
<tr>
<td></td>
<td>Disable Postfix Network Listening</td>
<td>Edit the file <code>/etc/postfix/main.cf</code> to ensure that only the following
<code>inet_interfaces</code> line appears:
<pre>inet_interfaces = <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_postfix_inet_interfaces" use="legacy"></xccdf-1.2:sub>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable rpcbind Service</td>
<td>The rpcbind utility maps RPC services to the ports on which they listen.
RPC processes notify rpcbind when they start, registering the ports they
are listening on and the RPC program numbers they expect to serve. The
rpcbind service redirects the client to the proper port number so it can
communicate with the requested service. If the system does not require RPC
(such as for NFS servers) then this service should be disabled.

The <code>rpcbind</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now rpcbind.service</pre>
        </td>
</tr>
<tr>
<td></td>
<td>Disable Network File System (nfs)</td>
<td>The Network File System (NFS) service allows remote hosts to mount
and interact with shared filesystems on the local system. If the local system
is not designated as a NFS server then this service should be disabled.

The <code>nfs-server</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now nfs-server.service</pre>
        </td>
</tr>
<tr>
<td></td>
<td>A remote time server for Chrony is configured</td>
<td>
<code>Chrony</code> is a daemon which implements the Network Time Protocol (NTP). It is designed
to synchronize system clocks across a variety of systems and use a source that is highly
accurate. More information on <code>chrony</code> can be found at

    <a href="https://chrony-project.org/">https://chrony-project.org/</a>.
<code>Chrony</code> can be configured to be a client and/or a server.
Add or edit server or pool lines to <code>/etc/chrony.conf</code> as appropriate:
<pre>server &lt;remote-server&gt;</pre>
Multiple servers may be configured.</td>
</tr>
<tr>
<td></td>
<td>Ensure that chronyd is running under chrony user account</td>
<td>chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to
synchronize system clocks across a variety of systems and use a source that is highly
accurate. More information on chrony can be found at

    <a href="https://chrony-project.org/">https://chrony-project.org/</a>.
Chrony can be configured to be a client and/or a server.
To ensure that chronyd is running under chrony user account,
add or edit the
<code>OPTIONS</code> variable in <code>/etc/sysconfig/chronyd</code> to include <code>-u chrony</code>:
<pre>OPTIONS="-u chrony"</pre>

This recommendation only applies if chrony is in use on the system.</td>
</tr>
<tr>
<td></td>
<td>Uninstall rsync Package</td>
<td>The rsyncd service can be used to synchronize files between systems over network links.
The <code>rsync</code> package can be removed with the following command:
<pre>
$ sudo dnf remove rsync</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Remove Rsh Trust Files</td>
<td>The files <code>/etc/hosts.equiv</code> and <code>~/.rhosts</code> (in
each user's home directory) list remote hosts and users that are trusted by the
local system when using the rshd daemon.
To remove these files, run the following command to delete them from any
location:
<pre>$ sudo rm /etc/hosts.equiv</pre>
        <pre>$ rm ~/.rhosts</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall telnet-server Package</td>
<td>The <code>telnet-server</code> package can be removed with the following command:
<pre>
$ sudo dnf remove telnet-server</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Remove telnet Clients</td>
<td>The telnet client allows users to start connections to other systems via
the telnet protocol.</td>
</tr>
<tr>
<td></td>
<td>Uninstall tftp-server Package</td>
<td>The <code>tftp-server</code> package can be removed with the following command: <pre> $ sudo dnf remove tftp-server</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall CUPS Package</td>
<td>The <code>cups</code> package can be removed with the following command:
<pre>
$ sudo dnf remove cups</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Uninstall squid Package</td>
<td>The <code>squid</code> package can be removed with the following command: <pre> $ sudo dnf remove squid</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall Samba Package</td>
<td>The <code>samba</code> package can be removed with the following command: <pre> $ sudo dnf remove samba</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Uninstall net-snmp Package</td>
<td>
The <code>net-snmp</code> package provides the snmpd service.
The <code>net-snmp</code> package can be removed with the following command:
<pre>
$ sudo dnf remove net-snmp</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable snmpd Service</td>
<td>
The <code>snmpd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now snmpd.service</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Verify Group Who Owns SSH Server config file</td>
<td>
To properly set the group owner of <code>/etc/ssh/sshd_config</code>, run the command:

  <pre>$ sudo chgrp root /etc/ssh/sshd_config</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Group Ownership on SSH Server Private *_key Key Files</td>
<td>SSH server private keys, files that match the <code>/etc/ssh/*_key</code> glob, must be
group-owned by <code>ssh_keys</code> group.</td>
</tr>
<tr>
<td></td>
<td>Verify Group Ownership on SSH Server Public *.pub Key Files</td>
<td>SSH server public keys, files that match the <code>/etc/ssh/*.pub</code> glob, must be
group-owned by <code>root</code> group.</td>
</tr>
<tr>
<td></td>
<td>Verify Owner on SSH Server config file</td>
<td>
To properly set the owner of <code>/etc/ssh/sshd_config</code>, run the command:

  <pre>$ sudo chown root /etc/ssh/sshd_config </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Ownership on SSH Server Private *_key Key Files</td>
<td>SSH server private keys, files that match the <code>/etc/ssh/*_key</code> glob, must be owned
by <code>root</code> user.</td>
</tr>
<tr>
<td></td>
<td>Verify Ownership on SSH Server Public *.pub Key Files</td>
<td>SSH server public keys, files that match the <code>/etc/ssh/*.pub</code> glob, must be owned
by <code>root</code> user.</td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on SSH Server config file</td>
<td>
To properly set the permissions of <code>/etc/ssh/sshd_config</code>, run the command:
<pre>$ sudo chmod 0600 /etc/ssh/sshd_config</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on SSH Server Private *_key Key Files</td>
<td>SSH server private keys - files that match the <code>/etc/ssh/*_key</code> glob, have to have restricted permissions.
If those files are owned by the <code>root</code> user and the <code>root</code> group, they have to have the <code>0600</code> permission or stricter.
If they are owned by the <code>root</code> user, but by a dedicated group <code>ssh_keys</code>, they can have the <code>0640</code> permission or stricter.</td>
</tr>
<tr>
<td></td>
<td>Verify Permissions on SSH Server Public *.pub Key Files</td>
<td> To properly set the permissions of <code>/etc/ssh/*.pub</code>, run the command: <pre>$ sudo chmod 0644 /etc/ssh/*.pub</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Set SSH Client Alive Count Max</td>
<td>The SSH server sends at most <code>ClientAliveCountMax</code> messages
during a SSH session and waits for a response from the SSH client.
The option <code>ClientAliveInterval</code> configures timeout after
each <code>ClientAliveCountMax</code> message. If the SSH server does not
receive a response from the client, then the connection is considered unresponsive
and terminated.
For SSH earlier than v8.2, a <code>ClientAliveCountMax</code> value of <code>0</code>
causes a timeout precisely when the <code>ClientAliveInterval</code> is set.
Starting with v8.2, a value of <code>0</code> disables the timeout functionality
completely. If the option is set to a number greater than <code>0</code>, then
the session will be disconnected after
<code>ClientAliveInterval * ClientAliveCountMax</code> seconds without receiving
a keep alive message.</td>
</tr>
<tr>
<td></td>
<td>Set SSH Client Alive Interval</td>
<td>SSH allows administrators to set a network responsiveness timeout interval.
After this interval has passed, the unresponsive client will be automatically logged out.
<br>
        <br>
To set this timeout interval, edit the following line in <code>/etc/ssh/sshd_config</code> as
follows:
<pre>ClientAliveInterval <b><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_sshd_idle_timeout_value" use="legacy"></xccdf-1.2:sub></b>
        </pre>
        <br>
        <br>
The timeout <b>interval</b> is given in seconds. For example, have a timeout
of 10 minutes, set <b>interval</b> to 600.
<br>
        <br>
If a shorter timeout has already been set for the login shell, that value will
preempt any SSH setting made in <code>/etc/ssh/sshd_config</code>. Keep in mind that
some processes may stop SSH from correctly detecting that the user is idle.</td>
</tr>
<tr>
<td></td>
<td>Disable Host-Based Authentication</td>
<td>SSH's cryptographic host-based authentication is
more secure than <code>.rhosts</code> authentication. However, it is
not recommended that hosts unilaterally trust one another, even
within an organization.
<br>
The default SSH configuration disables host-based authentication. The appropriate
configuration is used if no value is set for <code>HostbasedAuthentication</code>.
<br>
To explicitly disable host-based authentication, add or correct the
following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>HostbasedAuthentication no</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable SSH Access via Empty Passwords</td>
<td>Disallow SSH login with empty passwords.
The default SSH configuration disables logins with empty passwords. The appropriate
configuration is used if no value is set for <code>PermitEmptyPasswords</code>.
<br>
To explicitly disallow SSH login from accounts with empty passwords,
add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<br>
        <pre>PermitEmptyPasswords no</pre>
Any accounts with empty passwords should be disabled immediately, and PAM configuration
should prevent users from being able to assign themselves empty passwords.</td>
</tr>
<tr>
<td></td>
<td>Disable SSH Support for .rhosts Files</td>
<td>SSH can emulate the behavior of the obsolete rsh
command in allowing users to enable insecure access to their
accounts via <code>.rhosts</code> files.
<br>
The default SSH configuration disables support for <code>.rhosts</code>. The appropriate
configuration is used if no value is set for <code>IgnoreRhosts</code>.
<br>
To explicitly disable support for .rhosts files, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>IgnoreRhosts yes</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable SSH Root Login</td>
<td>The root user should never be allowed to login to a
system directly over a network.
To disable root login via SSH, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>PermitRootLogin no</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable SSH TCP Forwarding</td>
<td>The <code>AllowTcpForwarding</code> parameter specifies whether TCP forwarding is permitted.
To disable TCP forwarding, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>AllowTcpForwarding no</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Disable X11 Forwarding</td>
<td>The X11Forwarding parameter provides the ability to tunnel X11 traffic
through the connection to enable remote graphic connections.
SSH has the capability to encrypt remote X11 connections when SSH's
<code>X11Forwarding</code> option is enabled.
<br>
The default SSH configuration disables X11Forwarding. The appropriate
configuration is used if no value is set for <code>X11Forwarding</code>.
<br>
To explicitly disable X11 Forwarding, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>X11Forwarding no</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Do Not Allow SSH Environment Options</td>
<td>Ensure that users are not able to override environment variables of the SSH daemon.
<br>
The default SSH configuration disables environment processing. The appropriate
configuration is used if no value is set for <code>PermitUserEnvironment</code>.
<br>
To explicitly disable Environment options, add or correct the following


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>PermitUserEnvironment no</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Enable PAM</td>
<td>UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will
enable PAM authentication using ChallengeResponseAuthentication and
PasswordAuthentication in addition to PAM account and session module processing for all
authentication types.

To enable PAM authentication, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>UsePAM yes</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Enable SSH Warning Banner</td>
<td>To enable the warning banner and ensure it is consistent
across the system, add or correct the following line in

<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>Banner /etc/issue.net</pre>
Another section contains information on how to create an
appropriate system-wide warning banner.</td>
</tr>
<tr>
<td></td>
<td>Limit Users' SSH Access</td>
<td>By default, the SSH configuration allows any user with an account
to access the system. There are several options available to limit
which users and group can access the system via SSH. It is
recommended that at least one of the following options be leveraged:
- AllowUsers variable gives the system administrator the option of
  allowing specific users to ssh into the system. The list consists of
  space separated user names. Numeric user IDs are not recognized with
  this variable. If a system administrator wants to restrict user
  access further by specifically allowing a user's access only from a
  particular host, the entry can be specified in the form of user@host.
- AllowGroups variable gives the system administrator the option of
  allowing specific groups of users to ssh into the system. The list
  consists of space separated group names. Numeric group IDs are not
  recognized with this variable.
- DenyUsers variable gives the system administrator the option of
  denying specific users to ssh into the system. The list consists of
  space separated user names. Numeric user IDs are not recognized with
  this variable. If a system administrator wants to restrict user
  access further by specifically denying a user's access from a
  particular host, the entry can be specified in the form of user@host.
- DenyGroups variable gives the system administrator the option of
  denying specific groups of users to ssh into the system. The list
  consists of space separated group names. Numeric group IDs are not
  recognized with this variable.</td>
</tr>
<tr>
<td></td>
<td>Ensure SSH LoginGraceTime is configured</td>
<td>The <code>LoginGraceTime</code> parameter to the SSH server specifies the time allowed for successful authentication to
the SSH server. The longer the Grace period is the more open unauthenticated connections
can exist. Like other session controls in this session the Grace Period should be limited to
appropriate limits to ensure the service is available for needed access.</td>
</tr>
<tr>
<td></td>
<td>Set SSH Daemon LogLevel to VERBOSE</td>
<td>The <code>VERBOSE</code> parameter configures the SSH daemon to record login and logout activity.
To specify the log level in
SSH, add or correct the following line in


<code>/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf</code>:

<pre>LogLevel VERBOSE</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Set SSH authentication attempt limit</td>
<td>The <code>MaxAuthTries</code> parameter specifies the maximum number of authentication attempts
permitted per connection. Once the number of failures reaches half this value, additional failures are logged.
to set MaxAUthTries edit <code>/etc/ssh/sshd_config</code> as follows:
<pre>MaxAuthTries <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_sshd_max_auth_tries_value" use="legacy"></xccdf-1.2:sub>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Set SSH MaxSessions limit</td>
<td>The <code>MaxSessions</code> parameter specifies the maximum number of open sessions permitted
from a given connection. To set MaxSessions edit
<code>/etc/ssh/sshd_config</code> as follows: <pre>MaxSessions <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_sshd_max_sessions" use="legacy"></xccdf-1.2:sub>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure SSH MaxStartups is configured</td>
<td>The MaxStartups parameter specifies the maximum number of concurrent unauthenticated
connections to the SSH daemon. Additional connections will be dropped until authentication
succeeds or the LoginGraceTime expires for a connection. To configure MaxStartups, you should
add or edit the following line in the <code>/etc/ssh/sshd_config</code> file:
<pre>MaxStartups <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_sshd_set_maxstartups" use="legacy"></xccdf-1.2:sub>
        </pre>
       </td>
</tr>
<tr>
<td></td>
<td>Remove the X Windows Package Group</td>
<td>By removing the xorg-x11-server-common package, the system no longer has X Windows
installed. If X Windows is not installed then the system cannot boot into graphical user mode.
This prevents the system from being accidentally or maliciously booted into a <code>graphical.target</code>
mode. To do so, run the following command:
<pre>$ sudo dnf groupremove "X Window System"</pre>
        <pre>$ sudo dnf remove xorg-x11-server-common</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure the audit Subsystem is Installed</td>
<td>The audit package should be installed.</td>
</tr>
<tr>
<td></td>
<td>Enable auditd Service</td>
<td>The <code>auditd</code> service is an essential userspace component of
the Linux Auditing System, as it is responsible for writing audit records to
disk.

The <code>auditd</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable auditd.service</pre>
     </td>
</tr>
<tr>
<td></td>
<td>Enable Auditing for Processes Which Start Prior to the Audit Daemon</td>
<td>To ensure all processes can be audited, even those which start
prior to the audit daemon, add the argument <code>audit=1</code> to the default
GRUB 2 command line for the Linux operating system.
Configure the default Grub2 kernel command line to contain audit=1 as follows:
<pre># grub2-editenv - set "$(grub2-editenv - list | grep kernelopts) audit=1"</pre>
     </td>
</tr>
<tr>
<td></td>
<td>Extend Audit Backlog Limit for the Audit Daemon</td>
<td>To improve the kernel capacity to queue all log events, even those which occurred
prior to the audit daemon, add the argument <code>audit_backlog_limit=8192</code> to the default
GRUB 2 command line for the Linux operating system.
Configure the default Grub2 kernel command line to contain audit_backlog_limit=8192 as follows:
<pre># grub2-editenv - set "$(grub2-editenv - list | grep kernelopts) audit_backlog_limit=8192"</pre>
     </td>
</tr>
<tr>
<td></td>
<td>Make the auditd Configuration Immutable</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code> in order to make the auditd configuration
immutable:
<pre>-e 2</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file in order to make the auditd configuration
immutable:
<pre>-e 2</pre>
With this setting, a reboot will be required to change any audit rules.</td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Mandatory Access Controls</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/selinux/ -p wa -k MAC-policy</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:

<pre>-w /etc/selinux/ -p wa -k MAC-policy</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Mandatory Access Controls in usr/share</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /usr/share/selinux/ -p wa -k MAC-policy</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /usr/share/selinux/ -p wa -k MAC-policy</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Exporting to Media (successful)</td>
<td>At a minimum, the audit system should collect media exportation
events for all users and root. If the <code>auditd</code> daemon is configured to
use the <code>augenrules</code> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <code>.rules</code> in
the directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for
32-bit system, or having two lines for both b32 and b64 in case your
system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S mount -F auid&gt;=1000 -F auid!=unset -F key=export</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for
32-bit system, or having two lines for both b32 and b64 in case your
system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S mount -F auid&gt;=1000 -F auid!=unset -F key=export</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Network Environment</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for
32-bit system, or having two lines for both b32 and b64 in case your system
is 64-bit:
<pre>-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification
-w /etc/issue -p wa -k audit_rules_networkconfig_modification
-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification
-w /etc/hosts -p wa -k audit_rules_networkconfig_modification

-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for
32-bit system, or having two lines for both b32 and b64 in case your system
is 64-bit:
<pre>-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification
-w /etc/issue -p wa -k audit_rules_networkconfig_modification
-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification
-w /etc/hosts -p wa -k audit_rules_networkconfig_modification
-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Network Environment - /etc/sysconfig/network-scripts</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/sysconfig/network-scripts -p wa -k audit_rules_networkconfig_modification_network_scripts</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/sysconfig/network-scripts -p wa -k audit_rules_networkconfig_modification_network_scripts</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter Process and Session Initiation Information</td>
<td>The audit system already collects process information for all
users and root. If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code> in order to watch for attempted manual
edits of files involved in storing such process information:
<pre>-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file in order to watch for attempted manual
edits of files involved in storing such process information:
<pre>-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events When Executables Are Run As Another User</td>
<td>Verify the system generates an audit record when actions are run as another user.
sudo provides users with temporary elevated privileges to perform operations, either as the superuser or another user.

If audit is using the "auditctl" tool to load the rules, run the following command:

<pre>$ sudo grep execve /etc/audit/audit.rules</pre>

If audit is using the "augenrules" tool to load the rules, run the following command:

<pre>$ sudo grep -r execve /etc/audit/rules.d</pre>
       <pre>-a always,exit -F arch=b32 -S execve -C euid!=uid -F auid!=unset -k user_emulation</pre>
       <pre>-a always,exit -F arch=b64  S execve -C euid!=uid -F auid!=unset -k user_emulation</pre>

If both the "b32" and "b64" audit rules for "SUID" files are not defined, this is a finding.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects System Administrator Actions</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/sudoers -p wa -k actions</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/sudoers -p wa -k actions</pre>






If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/sudoers.d/ -p wa -k actions</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/sudoers.d/ -p wa -k actions</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify User/Group Information - /etc/group</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/group -p wa -k audit_rules_usergroup_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/group -p wa -k audit_rules_usergroup_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify User/Group Information - /etc/gshadow</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/gshadow -p wa -k audit_rules_usergroup_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/gshadow -p wa -k audit_rules_usergroup_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify User/Group Information - /etc/security/opasswd</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify User/Group Information - /etc/passwd</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/passwd -p wa -k audit_rules_usergroup_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/passwd -p wa -k audit_rules_usergroup_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify User/Group Information - /etc/shadow</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/shadow -p wa -k audit_rules_usergroup_modification</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/shadow -p wa -k audit_rules_usergroup_modification</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to perform maintenance activities</td>
<td>The Amazon Linux 2023 operating system must generate audit records for
privileged activities, nonlocal maintenance, diagnostic sessions and
other system-level access.

Verify the operating system audits activities performed during nonlocal
maintenance and diagnostic sessions. Run the following command:
<pre>$ sudo auditctl -l | grep sudo.log
-w /var/log/sudo.log -p wa -k maintenance</pre>





If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /var/log/sudo.log -p wa -k maintenance</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /var/log/sudo.log -p wa -k maintenance</pre>
      </td>
</tr>
<tr>
<td></td>
<td>System Audit Logs Must Have Mode 0750 or Less Permissive</td>
<td>
If <code>log_group</code> in <code>/etc/audit/auditd.conf</code> is set to a group other than the <code>root</code>
group account, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0750 /var/log/audit</pre>
       <br>
Otherwise, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0700 /var/log/audit</pre>
      </td>
</tr>
<tr>
<td></td>
<td>System Audit Logs Must Be Group Owned By Root</td>
<td>All audit logs must be group owned by root user. The path for audit log can
be configured via <code>log_file</code> parameter in <pre>/etc/audit/auditd.conf</pre>
or, by default, the path for audit log is <pre>/var/log/audit/</pre>.

To properly set the group owner of <code>/var/log/audit/*</code>, run the command:

  <pre>$ sudo chgrp root /var/log/audit/*</pre>
  


If <code>log_group</code> in <code>/etc/audit/auditd.conf</code> is set to a group other
than the <code>root</code> group account, change the group ownership of the audit logs
to this specific group.</td>
</tr>
<tr>
<td></td>
<td>Audit Configuration Files Must Be Owned By Group root</td>
<td>All audit configuration files must be owned by group root.
<pre>chown :root /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*</pre>
      </td>
</tr>
<tr>
<td></td>
<td>Audit Configuration Files Must Be Owned By Root</td>
<td>All audit configuration files must be owned by root user.

To properly set the owner of <code>/etc/audit/</code>, run the command:

  <pre>$ sudo chown root /etc/audit/ </pre>
  


To properly set the owner of <code>/etc/audit/rules.d/</code>, run the command:

  <pre>$ sudo chown root /etc/audit/rules.d/ </pre>
      </td>
</tr>
<tr>
<td></td>
<td>System Audit Logs Must Be Owned By Root</td>
<td>All audit logs must be owned by root user. The path for audit log can be
configured via <code>log_file</code> parameter in <pre>/etc/audit/auditd.conf</pre>
or by default, the path for audit log is <pre>/var/log/audit/</pre>.

To properly set the owner of <code>/var/log/audit/*</code>, run the command:

  <pre>$ sudo chown root /var/log/audit/* </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Audit Configuration Files Permissions are 640 or More Restrictive</td>
<td>All audit configuration files permissions must be 640 or more restrictive.
<pre>chmod 0640 /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*</pre>
      </td>
</tr>
<tr>
<td></td>
<td>System Audit Logs Must Have Mode 0640 or Less Permissive</td>
<td>
If <code>log_group</code> in <code>/etc/audit/auditd.conf</code> is set to a group other than the
<code>root</code>
group account, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0640 <i>audit_file</i>
       </pre>
       <br>
Otherwise, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0600 <i>audit_file</i>
       </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - chmod</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured to
use the <code>augenrules</code> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <code>.rules</code> in
the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - chown</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured to
use the <code>augenrules</code> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <code>.rules</code> in
the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fchmod</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured to
use the <code>augenrules</code> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <code>.rules</code> in
the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fchmodat</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured to
use the <code>augenrules</code> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <code>.rules</code> in
the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fchown</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fchownat</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fremovexattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root.
<br>
        <br>
If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - fsetxattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - lchown</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - lremovexattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root.
<br>
        <br>
If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - lsetxattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - removexattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root.
<br>
        <br>
If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following line to a file with suffix <code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
        <br>
        <br>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Events that Modify the System's Discretionary Access Controls - setxattr</td>
<td>At a minimum, the audit system should collect file permission
changes for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Any Attempts to Run chacl</td>
<td>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <code>.rules</code>
in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F path=/usr/bin/chacl -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add a line of the
following form to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F path=/usr/bin/chacl -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Any Attempts to Run setfacl</td>
<td>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <code>.rules</code>
in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F path=/usr/bin/setfacl -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add a line of the
following form to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F path=/usr/bin/setfacl -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Any Attempts to Run chcon</td>
<td>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <code>.rules</code>
in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F path=/usr/bin/chcon -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add a line of the
following form to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F path=/usr/bin/chcon -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects File Deletion Events by User - rename</td>
<td>At a minimum, the audit system should collect file deletion events
for all users and root. If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S rename -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S rename -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects File Deletion Events by User - renameat</td>
<td>At a minimum, the audit system should collect file deletion events
for all users and root. If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects File Deletion Events by User - unlink</td>
<td>At a minimum, the audit system should collect file deletion events
for all users and root. If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S unlink -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S unlink -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects File Deletion Events by User - unlinkat</td>
<td>At a minimum, the audit system should collect file deletion events
for all users and root. If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S unlinkat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -S unlinkat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Unsuccessful Access Attempts to Files - creat</td>
<td>At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Unsuccessful Access Attempts to Files - ftruncate</td>
<td>At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Unsuccessful Access Attempts to Files - open</td>
<td>At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Unsuccessful Access Attempts to Files - openat</td>
<td>At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Unsuccessful Access Attempts to Files - truncate</td>
<td>At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <code>auditd</code> daemon is configured
to use the <code>augenrules</code> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Kernel Module Unloading - create_module</td>
<td>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S create_module -F key=modules</pre>


Place to add the line depends on a way <code>auditd</code> daemon is configured. If it is configured
to use the <code>augenrules</code> program (the default), add the line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility,
add the line to file <code>/etc/audit/audit.rules</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Kernel Module Unloading - delete_module</td>
<td>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S delete_module -F key=modules</pre>


Place to add the line depends on a way <code>auditd</code> daemon is configured. If it is configured
to use the <code>augenrules</code> program (the default), add the line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility,
add the line to file <code>/etc/audit/audit.rules</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Kernel Module Loading and Unloading - finit_module</td>
<td>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S finit_module -F key=modules</pre>


Place to add the line depends on a way <code>auditd</code> daemon is configured. If it is configured
to use the <code>augenrules</code> program (the default), add the line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility,
add the line to file <code>/etc/audit/audit.rules</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Kernel Module Loading - init_module</td>
<td>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S init_module -F key=modules</pre>


Place to add the line depends on a way <code>auditd</code> daemon is configured. If it is configured
to use the <code>augenrules</code> program (the default), add the line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility,
add the line to file <code>/etc/audit/audit.rules</code>.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on Kernel Module Loading and Unloading - query_module</td>
<td>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S query_module -F key=modules</pre>


Place to add the line depends on a way <code>auditd</code> daemon is configured. If it is configured
to use the <code>augenrules</code> program (the default), add the line to a file with suffix
<code>.rules</code> in the directory <code>/etc/audit/rules.d</code>.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility,
add the line to file <code>/etc/audit/audit.rules</code>.</td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter Logon and Logout Events - faillock</td>
<td>The audit system already collects login information for all users
and root.




If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_dir" use="legacy"></xccdf-1.2:sub> -p wa -k logins</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_dir" use="legacy"></xccdf-1.2:sub> -p wa -k logins</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter Logon and Logout Events - lastlog</td>
<td>The audit system already collects login information for all users
and root.




If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /var/log/lastlog -p wa -k logins</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /var/log/lastlog -p wa -k logins</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on the Use of Privileged Commands</td>
<td>The audit system should collect information about usage of privileged commands for all users.
These are commands with suid or sgid bits on and they are specially risky in local block
device partitions not mounted with noexec and nosuid options. Therefore, these partitions
should be first identified by the following command:
<pre>findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv "noexec|nosuid"</pre>

For all partitions listed by the previous command, it is necessary to search for
setuid / setgid programs using the following command:
<pre>$ sudo find <i>PARTITION</i> -xdev -perm /6000 -type f 2&gt;/dev/null</pre>

For each setuid / setgid program identified by the previous command, an audit rule must be
present in the appropriate place using the following line structure, setting ARCH to either b32 for 32-bit
system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=ARCH -F path=<i>PROG_PATH</i> -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code> program to read
audit rules during daemon startup, add the line to a file with suffix <code>.rules</code> in the
<code>/etc/audit/rules.d</code> directory, replacing the <i>PROG_PATH</i> part with the full path
of that setuid / setgid identified program.

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code> utility instead, add
the line to the <code>/etc/audit/audit.rules</code> file, also replacing the <i>PROG_PATH</i> part
with the full path of that setuid / setgid identified program.</td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on the Use of Privileged Commands - kmod</td>
<td>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <code>.rules</code>
in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F path=/usr/bin/kmod -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add a line of the
following form to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F path=/usr/bin/kmod -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Ensure auditd Collects Information on the Use of Privileged Commands - usermod</td>
<td>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <code>.rules</code>
in the directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F path=/usr/sbin/usermod -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add a line of the
following form to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F path=/usr/sbin/usermod -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record attempts to alter time through adjtimex</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can be
used for better reporting capability through ausearch and aureport. Multiple
system calls can be defined on the same line to save space if desired, but is
not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter Time Through clock_settime</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change</pre>
The -k option allows for the specification of a key in string form that can
be used for better reporting capability through ausearch and aureport.
Multiple system calls can be defined on the same line to save space if
desired, but is not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record attempts to alter time through settimeofday</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:
<pre>-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules</pre>
If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file:
<pre>-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can be
used for better reporting capability through ausearch and aureport. Multiple
system calls can be defined on the same line to save space if desired, but is
not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter Time Through stime</td>
<td>If the <code>auditd</code> daemon is configured to use the
<code>augenrules</code> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code> for both 32 bit and 64 bit systems:
<pre>-a always,exit -F arch=b32 -S stime -F key=audit_time_rules</pre>
Since the 64 bit version of the "stime" system call is not defined in the audit
lookup table, the corresponding "-F arch=b64" form of this rule is not expected
to be defined on 64 bit systems (the aforementioned "-F arch=b32" stime rule
form itself is sufficient for both 32 bit and 64 bit systems). If the
<code>auditd</code> daemon is configured to use the <code>auditctl</code> utility to
read audit rules during daemon startup, add the following line to
<code>/etc/audit/audit.rules</code> file for both 32 bit and 64 bit systems:
<pre>-a always,exit -F arch=b32 -S stime -F key=audit_time_rules</pre>
Since the 64 bit version of the "stime" system call is not defined in the audit
lookup table, the corresponding "-F arch=b64" form of this rule is not expected
to be defined on 64 bit systems (the aforementioned "-F arch=b32" stime rule
form itself is sufficient for both 32 bit and 64 bit systems). The -k option
allows for the specification of a key in string form that can be used for
better reporting capability through ausearch and aureport. Multiple system
calls can be defined on the same line to save space if desired, but is not
required. See an example of multiple combined system calls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Record Attempts to Alter the localtime File</td>
<td>



If the <code>auditd</code> daemon is configured to use the <code>augenrules</code>
program to read audit rules during daemon startup (the default), add the
following lines to a file with suffix <code>.rules</code> in the
directory <code>/etc/audit/rules.d</code>:

<pre>-w /etc/localtime -p wa -k audit_time_rules</pre>

If the <code>auditd</code> daemon is configured to use the <code>auditctl</code>
utility to read audit rules during daemon startup, add the following lines to
<code>/etc/audit/audit.rules</code>:

<pre>-w /etc/localtime -p wa -k audit_time_rules</pre>
       </td>
</tr>
<tr>
<td></td>
<td>Configure auditd mail_acct Action on Low Disk Space</td>
<td>The <code>auditd</code> service can be configured to send email to
a designated account in certain situations. Add or correct the following line
in <code>/etc/audit/auditd.conf</code> to ensure that administrators are notified
via email for those situations:
<pre>action_mail_acct = <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_auditd_action_mail_acct" use="legacy"></xccdf-1.2:sub>
       </pre>
      </td>
</tr>
<tr>
<td></td>
<td>Configure auditd admin_space_left Action on Low Disk Space</td>
<td>The <code>auditd</code> service can be configured to take an action
when disk space is running low but prior to running out of space completely.
Edit the file <code>/etc/audit/auditd.conf</code>. Add or modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>admin_space_left_action = <i>ACTION</i>
       </pre>
Set this value to <code>single</code> to cause the system to switch to single user
mode for corrective action. Acceptable values also include <code>suspend</code> and
<code>halt</code>. For certain systems, the need for availability
outweighs the need to log all actions, and a different setting should be
determined. Details regarding all possible values for <i>ACTION</i> are described in the
<code>auditd.conf</code> man page.</td>
</tr>
<tr>
<td></td>
<td>Configure auditd Max Log File Size</td>
<td>Determine the amount of audit data (in megabytes)
which should be retained in each log file. Edit the file
<code>/etc/audit/auditd.conf</code>. Add or modify the following line, substituting
the correct value of <xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_auditd_max_log_file" use="legacy"></xccdf-1.2:sub> for <i>STOREMB</i>:
<pre>max_log_file = <i>STOREMB</i>
       </pre>
Set the value to <code>6</code> (MB) or higher for general-purpose systems.
Larger values, of course,
support retention of even more audit data.</td>
</tr>
<tr>
<td></td>
<td>Configure auditd max_log_file_action Upon Reaching Maximum Log Size</td>
<td>The default action to take when the logs reach their maximum size
is to rotate the log files, discarding the oldest one. To configure the action taken
by <code>auditd</code>, add or correct the line in <code>/etc/audit/auditd.conf</code>:
<pre>max_log_file_action = <i>ACTION</i>
       </pre>
Possible values for <i>ACTION</i> are described in the <code>auditd.conf</code> man
page. These include:
<ul>
<li><code>ignore</code></li>
<li><code>syslog</code></li>
<li><code>suspend</code></li>
<li><code>rotate</code></li>
<li><code>keep_logs</code></li>
</ul>
Set the <code><i>ACTION</i></code> to <code><xccdf-1.2:sub xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_auditd_max_log_file_action" use="legacy"></xccdf-1.2:sub></code>.
The setting is case-insensitive.</td>
</tr>
<tr>
<td></td>
<td>Configure auditd space_left Action on Low Disk Space</td>
<td>The <code>auditd</code> service can be configured to take an action
when disk space <i>starts</i> to run low.
Edit the file <code>/etc/audit/auditd.conf</code>. Modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>space_left_action = <i>ACTION</i>
       </pre>
Possible values for <i>ACTION</i> are described in the <code>auditd.conf</code> man page.
These include:
<ul>
<li><code>syslog</code></li>
<li><code>email</code></li>
<li><code>exec</code></li>
<li><code>suspend</code></li>
<li><code>single</code></li>
<li><code>halt</code></li>
</ul>
Set this to <code>email</code> (instead of the default,
which is <code>suspend</code>) as it is more likely to get prompt attention. Acceptable values
also include <code>suspend</code>, <code>single</code>, and <code>halt</code>.</td>
</tr>
<tr>
<td></td>
<td>Verify that audit tools are owned by group root</td>
<td>The Amazon Linux 2023 operating system audit tools must have the proper
ownership configured to protected against unauthorized access.

Verify it by running the following command:
<pre>$ stat -c "%n %G" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/audispd /sbin/augenrules

/sbin/auditctl root

/sbin/aureport root

/sbin/ausearch root

/sbin/autrace root

/sbin/auditd root

/sbin/audispd root

/sbin/augenrules root

</pre>

Audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators</td>
</tr>
<tr>
<td></td>
<td>Verify that audit tools are owned by root</td>
<td>The Amazon Linux 2023 operating system audit tools must have the proper
ownership configured to protected against unauthorized access.

Verify it by running the following command:
<pre>$ stat -c "%n %U" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/audispd /sbin/augenrules

/sbin/auditctl root

/sbin/aureport root

/sbin/ausearch root

/sbin/autrace root

/sbin/auditd root

/sbin/audispd root

/sbin/augenrules root

</pre>

Audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators</td>
</tr>
<tr>
<td></td>
<td>Verify that audit tools Have Mode 0755 or less</td>
<td>The Amazon Linux 2023 operating system audit tools must have the proper
permissions configured to protected against unauthorized access.

Verify it by running the following command:
<pre>$ stat -c "%n %a" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/audispd /sbin/augenrules

/sbin/auditctl 755

/sbin/aureport 755

/sbin/ausearch 755

/sbin/autrace 755

/sbin/auditd 755

/sbin/audispd 755

/sbin/augenrules 755

</pre>

Audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators</td>
</tr>
</table>
</body>
</html>
