<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8"/>
  <title>Rules Related To 'kernel'</title>
  
<style>
</style>
</head>
<body>



<h1>Rules Related To 'kernel'</h1>





<h2>Component overview</h2>

<h3>Relevant packages:</h3>

<ul>

<li>kernel</li>

</ul>


<h3>Relevant groups:</h3>

<ul>

<li>gcc_plugin</li>

<li>kernel_build_config</li>

<li>network-ipv6</li>

<li>network-kernel</li>

</ul>


<h3>Changelog:</h3>

<div>No changes recorded.</div>


<h3>Relevant rules:</h3>

<ul>

<li><a href="#audit_rules_kernel_module_loading">audit_rules_kernel_module_loading</a></li>

<li><a href="#audit_rules_kernel_module_loading_create">audit_rules_kernel_module_loading_create</a></li>

<li><a href="#audit_rules_kernel_module_loading_delete">audit_rules_kernel_module_loading_delete</a></li>

<li><a href="#audit_rules_kernel_module_loading_finit">audit_rules_kernel_module_loading_finit</a></li>

<li><a href="#audit_rules_kernel_module_loading_init">audit_rules_kernel_module_loading_init</a></li>

<li><a href="#audit_rules_kernel_module_loading_query">audit_rules_kernel_module_loading_query</a></li>

<li><a href="#coreos_audit_backlog_limit_kernel_argument">coreos_audit_backlog_limit_kernel_argument</a></li>

<li><a href="#coreos_enable_selinux_kernel_argument">coreos_enable_selinux_kernel_argument</a></li>

<li><a href="#coreos_nousb_kernel_argument">coreos_nousb_kernel_argument</a></li>

<li><a href="#coreos_page_poison_kernel_argument">coreos_page_poison_kernel_argument</a></li>

<li><a href="#coreos_pti_kernel_argument">coreos_pti_kernel_argument</a></li>

<li><a href="#coreos_slub_debug_kernel_argument">coreos_slub_debug_kernel_argument</a></li>

<li><a href="#coreos_vsyscall_kernel_argument">coreos_vsyscall_kernel_argument</a></li>

<li><a href="#directory_groupowner_etc_sysctld">directory_groupowner_etc_sysctld</a></li>

<li><a href="#directory_owner_etc_sysctld">directory_owner_etc_sysctld</a></li>

<li><a href="#directory_permissions_etc_sysctld">directory_permissions_etc_sysctld</a></li>

<li><a href="#grub2_ipv6_disable_argument">grub2_ipv6_disable_argument</a></li>

<li><a href="#install_PAE_kernel_on_x86-32">install_PAE_kernel_on_x86-32</a></li>

<li><a href="#kernel_config_acpi_custom_method">kernel_config_acpi_custom_method</a></li>

<li><a href="#kernel_config_arm64_sw_ttbr0_pan">kernel_config_arm64_sw_ttbr0_pan</a></li>

<li><a href="#kernel_config_binfmt_misc">kernel_config_binfmt_misc</a></li>

<li><a href="#kernel_config_bug">kernel_config_bug</a></li>

<li><a href="#kernel_config_bug_on_data_corruption">kernel_config_bug_on_data_corruption</a></li>

<li><a href="#kernel_config_compat_brk">kernel_config_compat_brk</a></li>

<li><a href="#kernel_config_compat_vdso">kernel_config_compat_vdso</a></li>

<li><a href="#kernel_config_debug_credentials">kernel_config_debug_credentials</a></li>

<li><a href="#kernel_config_debug_fs">kernel_config_debug_fs</a></li>

<li><a href="#kernel_config_debug_list">kernel_config_debug_list</a></li>

<li><a href="#kernel_config_debug_notifiers">kernel_config_debug_notifiers</a></li>

<li><a href="#kernel_config_debug_sg">kernel_config_debug_sg</a></li>

<li><a href="#kernel_config_debug_wx">kernel_config_debug_wx</a></li>

<li><a href="#kernel_config_default_mmap_min_addr">kernel_config_default_mmap_min_addr</a></li>

<li><a href="#kernel_config_devkmem">kernel_config_devkmem</a></li>

<li><a href="#kernel_config_fortify_source">kernel_config_fortify_source</a></li>

<li><a href="#kernel_config_gcc_plugin_latent_entropy">kernel_config_gcc_plugin_latent_entropy</a></li>

<li><a href="#kernel_config_gcc_plugin_randstruct">kernel_config_gcc_plugin_randstruct</a></li>

<li><a href="#kernel_config_gcc_plugin_stackleak">kernel_config_gcc_plugin_stackleak</a></li>

<li><a href="#kernel_config_gcc_plugin_structleak">kernel_config_gcc_plugin_structleak</a></li>

<li><a href="#kernel_config_gcc_plugin_structleak_byref_all">kernel_config_gcc_plugin_structleak_byref_all</a></li>

<li><a href="#kernel_config_hardened_usercopy">kernel_config_hardened_usercopy</a></li>

<li><a href="#kernel_config_hardened_usercopy_fallback">kernel_config_hardened_usercopy_fallback</a></li>

<li><a href="#kernel_config_hibernation">kernel_config_hibernation</a></li>

<li><a href="#kernel_config_ia32_emulation">kernel_config_ia32_emulation</a></li>

<li><a href="#kernel_config_ipv6">kernel_config_ipv6</a></li>

<li><a href="#kernel_config_kexec">kernel_config_kexec</a></li>

<li><a href="#kernel_config_legacy_ptys">kernel_config_legacy_ptys</a></li>

<li><a href="#kernel_config_legacy_vsyscall_emulate">kernel_config_legacy_vsyscall_emulate</a></li>

<li><a href="#kernel_config_legacy_vsyscall_none">kernel_config_legacy_vsyscall_none</a></li>

<li><a href="#kernel_config_legacy_vsyscall_xonly">kernel_config_legacy_vsyscall_xonly</a></li>

<li><a href="#kernel_config_modify_ldt_syscall">kernel_config_modify_ldt_syscall</a></li>

<li><a href="#kernel_config_module_sig">kernel_config_module_sig</a></li>

<li><a href="#kernel_config_module_sig_all">kernel_config_module_sig_all</a></li>

<li><a href="#kernel_config_module_sig_force">kernel_config_module_sig_force</a></li>

<li><a href="#kernel_config_module_sig_hash">kernel_config_module_sig_hash</a></li>

<li><a href="#kernel_config_module_sig_key">kernel_config_module_sig_key</a></li>

<li><a href="#kernel_config_module_sig_sha512">kernel_config_module_sig_sha512</a></li>

<li><a href="#kernel_config_page_poisoning">kernel_config_page_poisoning</a></li>

<li><a href="#kernel_config_page_poisoning_no_sanity">kernel_config_page_poisoning_no_sanity</a></li>

<li><a href="#kernel_config_page_poisoning_zero">kernel_config_page_poisoning_zero</a></li>

<li><a href="#kernel_config_page_table_isolation">kernel_config_page_table_isolation</a></li>

<li><a href="#kernel_config_panic_on_oops">kernel_config_panic_on_oops</a></li>

<li><a href="#kernel_config_panic_timeout">kernel_config_panic_timeout</a></li>

<li><a href="#kernel_config_proc_kcore">kernel_config_proc_kcore</a></li>

<li><a href="#kernel_config_randomize_base">kernel_config_randomize_base</a></li>

<li><a href="#kernel_config_randomize_memory">kernel_config_randomize_memory</a></li>

<li><a href="#kernel_config_refcount_full">kernel_config_refcount_full</a></li>

<li><a href="#kernel_config_retpoline">kernel_config_retpoline</a></li>

<li><a href="#kernel_config_sched_stack_end_check">kernel_config_sched_stack_end_check</a></li>

<li><a href="#kernel_config_seccomp">kernel_config_seccomp</a></li>

<li><a href="#kernel_config_seccomp_filter">kernel_config_seccomp_filter</a></li>

<li><a href="#kernel_config_security">kernel_config_security</a></li>

<li><a href="#kernel_config_security_dmesg_restrict">kernel_config_security_dmesg_restrict</a></li>

<li><a href="#kernel_config_security_writable_hooks">kernel_config_security_writable_hooks</a></li>

<li><a href="#kernel_config_security_yama">kernel_config_security_yama</a></li>

<li><a href="#kernel_config_slab_freelist_hardened">kernel_config_slab_freelist_hardened</a></li>

<li><a href="#kernel_config_slab_freelist_random">kernel_config_slab_freelist_random</a></li>

<li><a href="#kernel_config_slab_merge_default">kernel_config_slab_merge_default</a></li>

<li><a href="#kernel_config_slub_debug">kernel_config_slub_debug</a></li>

<li><a href="#kernel_config_stackprotector">kernel_config_stackprotector</a></li>

<li><a href="#kernel_config_stackprotector_strong">kernel_config_stackprotector_strong</a></li>

<li><a href="#kernel_config_strict_kernel_rwx">kernel_config_strict_kernel_rwx</a></li>

<li><a href="#kernel_config_strict_module_rwx">kernel_config_strict_module_rwx</a></li>

<li><a href="#kernel_config_syn_cookies">kernel_config_syn_cookies</a></li>

<li><a href="#kernel_config_unmap_kernel_at_el0">kernel_config_unmap_kernel_at_el0</a></li>

<li><a href="#kernel_config_vmap_stack">kernel_config_vmap_stack</a></li>

<li><a href="#kernel_config_x86_vsyscall_emulation">kernel_config_x86_vsyscall_emulation</a></li>

<li><a href="#kernel_disable_entropy_contribution_for_solid_state_drives">kernel_disable_entropy_contribution_for_solid_state_drives</a></li>

<li><a href="#kernel_module_atm_disabled">kernel_module_atm_disabled</a></li>

<li><a href="#kernel_module_bluetooth_disabled">kernel_module_bluetooth_disabled</a></li>

<li><a href="#kernel_module_can_disabled">kernel_module_can_disabled</a></li>

<li><a href="#kernel_module_cfg80211_disabled">kernel_module_cfg80211_disabled</a></li>

<li><a href="#kernel_module_cramfs_disabled">kernel_module_cramfs_disabled</a></li>

<li><a href="#kernel_module_dccp_disabled">kernel_module_dccp_disabled</a></li>

<li><a href="#kernel_module_firewire-core_disabled">kernel_module_firewire-core_disabled</a></li>

<li><a href="#kernel_module_freevxfs_disabled">kernel_module_freevxfs_disabled</a></li>

<li><a href="#kernel_module_hfs_disabled">kernel_module_hfs_disabled</a></li>

<li><a href="#kernel_module_hfsplus_disabled">kernel_module_hfsplus_disabled</a></li>

<li><a href="#kernel_module_ipv6_option_disabled">kernel_module_ipv6_option_disabled</a></li>

<li><a href="#kernel_module_iwlmvm_disabled">kernel_module_iwlmvm_disabled</a></li>

<li><a href="#kernel_module_iwlwifi_disabled">kernel_module_iwlwifi_disabled</a></li>

<li><a href="#kernel_module_jffs2_disabled">kernel_module_jffs2_disabled</a></li>

<li><a href="#kernel_module_mac80211_disabled">kernel_module_mac80211_disabled</a></li>

<li><a href="#kernel_module_overlayfs_disabled">kernel_module_overlayfs_disabled</a></li>

<li><a href="#kernel_module_rds_disabled">kernel_module_rds_disabled</a></li>

<li><a href="#kernel_module_sctp_disabled">kernel_module_sctp_disabled</a></li>

<li><a href="#kernel_module_squashfs_disabled">kernel_module_squashfs_disabled</a></li>

<li><a href="#kernel_module_tipc_disabled">kernel_module_tipc_disabled</a></li>

<li><a href="#kernel_module_udf_disabled">kernel_module_udf_disabled</a></li>

<li><a href="#kernel_module_usb-storage_disabled">kernel_module_usb-storage_disabled</a></li>

<li><a href="#kernel_module_uvcvideo_disabled">kernel_module_uvcvideo_disabled</a></li>

<li><a href="#kernel_module_vfat_disabled">kernel_module_vfat_disabled</a></li>

<li><a href="#network_ipv6_default_gateway">network_ipv6_default_gateway</a></li>

<li><a href="#network_ipv6_disable_interfaces">network_ipv6_disable_interfaces</a></li>

<li><a href="#network_ipv6_disable_rpc">network_ipv6_disable_rpc</a></li>

<li><a href="#network_ipv6_privacy_extensions">network_ipv6_privacy_extensions</a></li>

<li><a href="#network_ipv6_static_address">network_ipv6_static_address</a></li>

<li><a href="#package_abrt-addon-kerneloops_removed">package_abrt-addon-kerneloops_removed</a></li>

<li><a href="#package_iptables-nft_installed">package_iptables-nft_installed</a></li>

<li><a href="#package_nfs-kernel-server_removed">package_nfs-kernel-server_removed</a></li>

<li><a href="#sebool_domain_kernel_load_modules">sebool_domain_kernel_load_modules</a></li>

<li><a href="#sysctl_fs_protected_fifos">sysctl_fs_protected_fifos</a></li>

<li><a href="#sysctl_fs_protected_hardlinks">sysctl_fs_protected_hardlinks</a></li>

<li><a href="#sysctl_fs_protected_regular">sysctl_fs_protected_regular</a></li>

<li><a href="#sysctl_fs_protected_symlinks">sysctl_fs_protected_symlinks</a></li>

<li><a href="#sysctl_fs_suid_dumpable">sysctl_fs_suid_dumpable</a></li>

<li><a href="#sysctl_kernel_core_pattern">sysctl_kernel_core_pattern</a></li>

<li><a href="#sysctl_kernel_core_pattern_empty_string">sysctl_kernel_core_pattern_empty_string</a></li>

<li><a href="#sysctl_kernel_core_uses_pid">sysctl_kernel_core_uses_pid</a></li>

<li><a href="#sysctl_kernel_dmesg_restrict">sysctl_kernel_dmesg_restrict</a></li>

<li><a href="#sysctl_kernel_exec_shield">sysctl_kernel_exec_shield</a></li>

<li><a href="#sysctl_kernel_kexec_load_disabled">sysctl_kernel_kexec_load_disabled</a></li>

<li><a href="#sysctl_kernel_kptr_restrict">sysctl_kernel_kptr_restrict</a></li>

<li><a href="#sysctl_kernel_modules_disabled">sysctl_kernel_modules_disabled</a></li>

<li><a href="#sysctl_kernel_panic_on_oops">sysctl_kernel_panic_on_oops</a></li>

<li><a href="#sysctl_kernel_perf_cpu_time_max_percent">sysctl_kernel_perf_cpu_time_max_percent</a></li>

<li><a href="#sysctl_kernel_perf_event_max_sample_rate">sysctl_kernel_perf_event_max_sample_rate</a></li>

<li><a href="#sysctl_kernel_perf_event_paranoid">sysctl_kernel_perf_event_paranoid</a></li>

<li><a href="#sysctl_kernel_pid_max">sysctl_kernel_pid_max</a></li>

<li><a href="#sysctl_kernel_randomize_va_space">sysctl_kernel_randomize_va_space</a></li>

<li><a href="#sysctl_kernel_sysrq">sysctl_kernel_sysrq</a></li>

<li><a href="#sysctl_kernel_unprivileged_bpf_disabled">sysctl_kernel_unprivileged_bpf_disabled</a></li>

<li><a href="#sysctl_kernel_unprivileged_bpf_disabled_accept_default">sysctl_kernel_unprivileged_bpf_disabled_accept_default</a></li>

<li><a href="#sysctl_kernel_yama_ptrace_scope">sysctl_kernel_yama_ptrace_scope</a></li>

<li><a href="#sysctl_net_core_bpf_jit_harden">sysctl_net_core_bpf_jit_harden</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_accept_local">sysctl_net_ipv4_conf_all_accept_local</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_accept_redirects">sysctl_net_ipv4_conf_all_accept_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_accept_source_route">sysctl_net_ipv4_conf_all_accept_source_route</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_arp_filter">sysctl_net_ipv4_conf_all_arp_filter</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_arp_ignore">sysctl_net_ipv4_conf_all_arp_ignore</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_drop_gratuitous_arp">sysctl_net_ipv4_conf_all_drop_gratuitous_arp</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_forwarding">sysctl_net_ipv4_conf_all_forwarding</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_log_martians">sysctl_net_ipv4_conf_all_log_martians</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_route_localnet">sysctl_net_ipv4_conf_all_route_localnet</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_rp_filter">sysctl_net_ipv4_conf_all_rp_filter</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_secure_redirects">sysctl_net_ipv4_conf_all_secure_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_send_redirects">sysctl_net_ipv4_conf_all_send_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_all_shared_media">sysctl_net_ipv4_conf_all_shared_media</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_accept_redirects">sysctl_net_ipv4_conf_default_accept_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_accept_source_route">sysctl_net_ipv4_conf_default_accept_source_route</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_forwarding">sysctl_net_ipv4_conf_default_forwarding</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_log_martians">sysctl_net_ipv4_conf_default_log_martians</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_rp_filter">sysctl_net_ipv4_conf_default_rp_filter</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_secure_redirects">sysctl_net_ipv4_conf_default_secure_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_send_redirects">sysctl_net_ipv4_conf_default_send_redirects</a></li>

<li><a href="#sysctl_net_ipv4_conf_default_shared_media">sysctl_net_ipv4_conf_default_shared_media</a></li>

<li><a href="#sysctl_net_ipv4_icmp_echo_ignore_broadcasts">sysctl_net_ipv4_icmp_echo_ignore_broadcasts</a></li>

<li><a href="#sysctl_net_ipv4_icmp_ignore_bogus_error_responses">sysctl_net_ipv4_icmp_ignore_bogus_error_responses</a></li>

<li><a href="#sysctl_net_ipv4_ip_forward">sysctl_net_ipv4_ip_forward</a></li>

<li><a href="#sysctl_net_ipv4_ip_local_port_range">sysctl_net_ipv4_ip_local_port_range</a></li>

<li><a href="#sysctl_net_ipv4_tcp_invalid_ratelimit">sysctl_net_ipv4_tcp_invalid_ratelimit</a></li>

<li><a href="#sysctl_net_ipv4_tcp_rfc1337">sysctl_net_ipv4_tcp_rfc1337</a></li>

<li><a href="#sysctl_net_ipv4_tcp_syncookies">sysctl_net_ipv4_tcp_syncookies</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_ra">sysctl_net_ipv6_conf_all_accept_ra</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_ra_defrtr">sysctl_net_ipv6_conf_all_accept_ra_defrtr</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_ra_pinfo">sysctl_net_ipv6_conf_all_accept_ra_pinfo</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_ra_rtr_pref">sysctl_net_ipv6_conf_all_accept_ra_rtr_pref</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_redirects">sysctl_net_ipv6_conf_all_accept_redirects</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_accept_source_route">sysctl_net_ipv6_conf_all_accept_source_route</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_autoconf">sysctl_net_ipv6_conf_all_autoconf</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_disable_ipv6">sysctl_net_ipv6_conf_all_disable_ipv6</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_forwarding">sysctl_net_ipv6_conf_all_forwarding</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_max_addresses">sysctl_net_ipv6_conf_all_max_addresses</a></li>

<li><a href="#sysctl_net_ipv6_conf_all_router_solicitations">sysctl_net_ipv6_conf_all_router_solicitations</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_ra">sysctl_net_ipv6_conf_default_accept_ra</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_ra_defrtr">sysctl_net_ipv6_conf_default_accept_ra_defrtr</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_ra_pinfo">sysctl_net_ipv6_conf_default_accept_ra_pinfo</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_ra_rtr_pref">sysctl_net_ipv6_conf_default_accept_ra_rtr_pref</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_redirects">sysctl_net_ipv6_conf_default_accept_redirects</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_accept_source_route">sysctl_net_ipv6_conf_default_accept_source_route</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_autoconf">sysctl_net_ipv6_conf_default_autoconf</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_disable_ipv6">sysctl_net_ipv6_conf_default_disable_ipv6</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_forwarding">sysctl_net_ipv6_conf_default_forwarding</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_max_addresses">sysctl_net_ipv6_conf_default_max_addresses</a></li>

<li><a href="#sysctl_net_ipv6_conf_default_router_solicitations">sysctl_net_ipv6_conf_default_router_solicitations</a></li>

<li><a href="#sysctl_user_max_user_namespaces">sysctl_user_max_user_namespaces</a></li>

<li><a href="#sysctl_user_max_user_namespaces_no_remediation">sysctl_user_max_user_namespaces_no_remediation</a></li>

<li><a href="#sysctl_vm_mmap_min_addr">sysctl_vm_mmap_min_addr</a></li>

</ul>



<h2>Rule details</h2>


<div id="audit_rules_kernel_module_loading" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Loading and Unloading</h3>
<div>audit_rules_kernel_module_loading</div>
<h4>Description</h4>
<p>To capture kernel module loading and unloading events, use following lines, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>
-a always,exit -F arch=<i>ARCH</i> -S init_module,finit_module,delete_module -F auid>=1000 -F auid!=unset -F key=modules
</pre>

The place to add the lines depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the lines to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="audit_rules_kernel_module_loading_create" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Unloading - create_module</h3>
<div>audit_rules_kernel_module_loading_create</div>
<h4>Description</h4>
<p>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S create_module -F auid>=1000 -F auid!=unset -F key=modules</pre>


Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="audit_rules_kernel_module_loading_delete" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Unloading - delete_module</h3>
<div>audit_rules_kernel_module_loading_delete</div>
<h4>Description</h4>
<p>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S delete_module -F auid>=1000 -F auid!=unset -F key=modules</pre>


Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="audit_rules_kernel_module_loading_finit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Loading and Unloading - finit_module</h3>
<div>audit_rules_kernel_module_loading_finit</div>
<h4>Description</h4>
<p>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S finit_module -F auid>=1000 -F auid!=unset -F key=modules</pre>


Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="audit_rules_kernel_module_loading_init" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Loading - init_module</h3>
<div>audit_rules_kernel_module_loading_init</div>
<h4>Description</h4>
<p>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S init_module -F auid>=1000 -F auid!=unset -F key=modules</pre>


Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The addition of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="audit_rules_kernel_module_loading_query" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on Kernel Module Loading and Unloading - query_module</h3>
<div>audit_rules_kernel_module_loading_query</div>
<h4>Description</h4>
<p>
To capture kernel module loading and unloading events, use the following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:

<pre>-a always,exit -F arch=<i>ARCH</i> -S query_module -F auid>=1000 -F auid!=unset -F key=modules</pre>


Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.</p>
<h4>Rationale</h4>
<p>The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p>
</div>

<div id="coreos_audit_backlog_limit_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Extend Audit Backlog Limit for the Audit Daemon</h3>
<div>coreos_audit_backlog_limit_kernel_argument</div>
<h4>Description</h4>
<p>To improve the kernel capacity to queue all log events, even those which occurred
prior to the audit daemon, add the argument <tt>audit_backlog_limit=8192</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.</p>
<h4>Rationale</h4>
<p>audit_backlog_limit sets the queue length for audit events awaiting transfer
to the audit daemon. Until the audit daemon is up and running, all log messages
are stored in this queue.  If the queue is overrun during boot process, the action
defined by audit failure flag is taken.</p>
</div>

<div id="coreos_enable_selinux_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure SELinux Not Disabled in the kernel arguments</h3>
<div>coreos_enable_selinux_kernel_argument</div>
<h4>Description</h4>
<p>SELinux can be disabled at boot time by disabling it via a kernel argument.
Remove any instances of <tt>selinux=0</tt> from the kernel arguments in that
file to prevent SELinux from being disabled at boot.</p>
<h4>Rationale</h4>
<p>Disabling a major host protection feature, such as SELinux, at boot time prevents
it from confining system services at boot time.  Further, it increases
the chances that it will remain off during system operation.</p>
</div>

<div id="coreos_nousb_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Support for USB via Bootloader Configuration</h3>
<div>coreos_nousb_kernel_argument</div>
<h4>Description</h4>
<p>All USB support can be disabled by adding the <tt>nousb</tt>
argument to the kernel's boot loader configuration. To do so,
Add the <tt>nousb</tt> kernel argument via a <tt>MachineConfig</tt>
object.</p>
<h4>Rationale</h4>
<p>Disabling the USB subsystem within the Linux kernel at system boot will
protect against potentially malicious USB devices, although it is only practical
in specialized systems.</p>
</div>

<div id="coreos_page_poison_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable page allocator poisoning</h3>
<div>coreos_page_poison_kernel_argument</div>
<h4>Description</h4>
<p>To enable poisoning of free pages, add the argument <tt>page_poison=1</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.</p>
<h4>Rationale</h4>
<p>Poisoning writes an arbitrary value to freed pages, so any modification or
reference to that page after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.</p>
</div>

<div id="coreos_pti_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Page-Table Isolation (KPTI)</h3>
<div>coreos_pti_kernel_argument</div>
<h4>Description</h4>
<p>To enable Kernel page-table isolation, add the argument <tt>pti=on</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.</p>
<h4>Rationale</h4>
<p>Kernel page-table isolation is a kernel feature that mitigates
the Meltdown security vulnerability and hardens the kernel
against attempts to bypass kernel address space layout
randomization (KASLR).</p>
</div>

<div id="coreos_slub_debug_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable SLUB/SLAB allocator poisoning</h3>
<div>coreos_slub_debug_kernel_argument</div>
<h4>Description</h4>
<p>To enable poisoning of SLUB/SLAB objects, add the argument <tt>slub_debug=P</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.</p>
<h4>Rationale</h4>
<p>Poisoning writes an arbitrary value to freed objects, so any modification or
reference to that object after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.</p>
</div>

<div id="coreos_vsyscall_kernel_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable vsyscalls</h3>
<div>coreos_vsyscall_kernel_argument</div>
<h4>Description</h4>
<p>To disable use of virtual syscalls, add the argument <tt>vsyscall=none</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.</p>
<h4>Rationale</h4>
<p>Virtual Syscalls provide an opportunity of attack for a user who has control
of the return instruction pointer.</p>
</div>

<div id="directory_groupowner_etc_sysctld" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Group Who Owns /etc/sysctl.d Directory</h3>
<div>directory_groupowner_etc_sysctld</div>
<h4>Description</h4>
<p> To properly set the group owner of <code>/etc/sysctl.d</code>, run the command:
<pre>$ sudo chgrp root /etc/sysctl.d</pre>
</p>
<h4>Rationale</h4>
<p>The ownership of the /etc/sysctl.d directory by the root group is important
because this directory hosts kernel configuration. Protection of this
directory is critical for system security. Assigning the ownership to root
ensures exclusive control of the kernel configuration.</p>
</div>

<div id="directory_owner_etc_sysctld" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify User Who Owns /etc/sysctl.d Directory</h3>
<div>directory_owner_etc_sysctld</div>
<h4>Description</h4>
<p> To properly set the owner of <code>/etc/sysctl.d</code>, run the command:
<pre>$ sudo chown root /etc/sysctl.d </pre>
</p>
<h4>Rationale</h4>
<p>The ownership of the /etc/sysctl.d directory by the root user is important
because this directory hosts kernel configuration. Protection of this
directory is critical for system security. Assigning the ownership to root
ensures exclusive control of the kernel configuration.</p>
</div>

<div id="directory_permissions_etc_sysctld" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Permissions On /etc/sysctl.d Directory</h3>
<div>directory_permissions_etc_sysctld</div>
<h4>Description</h4>
<p> To properly set the permissions of <code>/etc/sysctl.d</code>, run the command: <pre>$ sudo chmod 0755 /etc/sysctl.d</pre></p>
<h4>Rationale</h4>
<p>Setting correct permissions on the /etc/sysctl.d directory is important
because this directory hosts kernel configuration. Protection of this
directory is critical for system security. Restricting the permissions
ensures exclusive control of the kernel configuration.</p>
</div>

<div id="grub2_ipv6_disable_argument" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure IPv6 is disabled through kernel boot parameter</h3>
<div>grub2_ipv6_disable_argument</div>
<h4>Description</h4>
<p>To disable IPv6 protocol support in the Linux kernel,
add the argument <tt>ipv6.disable=1</tt> to the default
GRUB2 command line for the Linux operating system.
To ensure that <tt>ipv6.disable=1</tt> is added as a kernel command line
argument to newly installed kernels, add <tt>ipv6.disable=1</tt> to the
default Grub2 command line for Linux operating systems. Modify the line within
<tt>/etc/default/grub</tt> as shown below:
<pre>GRUB_CMDLINE_LINUX="... ipv6.disable=1 ..."</pre>
Run the following command to update command line for already installed kernels:<pre># grubby --update-kernel=ALL --args="ipv6.disable=1"</pre>
If the system is distributed as a bootable container image, GRUB2 can't be configured using the method described above, but the following method needs to be used instead.
The kernel arguments should be set in <tt>/usr/lib/bootc/kargs.d</tt> in a TOML file that has the following form:
<pre>
# /usr/lib/bootc/kargs.d/10-example.toml
kargs = ["ipv6.disable=1"]
</pre>
For more details on configuring kernel arguments in bootable container images, please refer to <a xmlns='http://www.w3.org/1999/xhtml' href='https://bootc-dev.github.io/bootc//building/kernel-arguments.html'>Bootc documentation</a>.</p>
<h4>Rationale</h4>
<p>Any unnecessary network stacks, including IPv6, should be disabled to reduce
the vulnerability to exploitation.</p>
</div>

<div id="install_PAE_kernel_on_x86-32" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install PAE Kernel on Supported 32-bit x86 Systems</h3>
<div>install_PAE_kernel_on_x86-32</div>
<h4>Description</h4>
<p>Systems that are using the 64-bit x86 kernel package
do not need to install the kernel-PAE package because the 64-bit
x86 kernel already includes this support. However, if the system is
32-bit and also supports the PAE and NX features as
determined in the previous section, the kernel-PAE package should
be installed to enable XD or NX support.
The <code>kernel-PAE</code> package can be installed with the following command:
<pre>
$ sudo dnf install kernel-PAE</pre>
The installation process should also have configured the
bootloader to load the new kernel at boot. Verify this after reboot
and modify <tt>/etc/default/grub</tt> if necessary.</p>
<h4>Rationale</h4>
<p>On 32-bit systems that support the XD or NX bit, the vendor-supplied
PAE kernel is required to enable either Execute Disable (XD) or No Execute (NX) support.</p>
</div>

<div id="kernel_config_acpi_custom_method" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Do not allow ACPI methods to be inserted/replaced at run time</h3>
<div>kernel_config_acpi_custom_method</div>
<h4>Description</h4>
<p>This debug facility allows ACPI AML methods to be inserted and/or replaced without rebooting
the system.
This configuration is available from kernel 3.0.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_ACPI_CUSTOM_METHOD</tt>, run the following command:
    <tt>grep CONFIG_ACPI_CUSTOM_METHOD /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Enabling this feature allows arbitrary kernel memory to be written to by root (uid=0) users,
allowing them to bypass certain security measures</p>
</div>

<div id="kernel_config_arm64_sw_ttbr0_pan" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Emulate Privileged Access Never (PAN)</h3>
<div>kernel_config_arm64_sw_ttbr0_pan</div>
<h4>Description</h4>
<p>Enabling this option prevents the kernel from accessing user-space memory directly by pointing
TTBR0_EL1 to a reserved zeroed area and reserved ASID.
The user access routines restore the valid TTBR0_EL1 temporarily.
This configuration is available from kernel 4.10, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_ARM64_SW_TTBR0_PAN</tt>, run the following command:
    <tt>grep CONFIG_ARM64_SW_TTBR0_PAN /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>The Privileged Access Never (PAN) is the ARM equivalent of the x86 Supervisor Mode Access
Prevention (SMAP), and it prevents privileged access to user data unless explicitly enabled.</p>
</div>

<div id="kernel_config_binfmt_misc" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable kernel support for MISC binaries</h3>
<div>kernel_config_binfmt_misc</div>
<h4>Description</h4>
<p>Enabling <tt>CONFIG_BINFMT_MISC</tt> makes it possible to plug wrapper-driven binary formats
into the kernel. This is specially useful for programs that need an interpreter to run like
Java, Python and DOS emulators. Once you have registered such a binary class with the kernel,
you can start one of those programs simply by typing in its name at a shell prompt.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_BINFMT_MISC</tt>, run the following command:
    <tt>grep CONFIG_BINFMT_MISC /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>This disables arbitrary binary format support and helps reduce attack surface.</p>
</div>

<div id="kernel_config_bug" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable support for BUG()</h3>
<div>kernel_config_bug</div>
<h4>Description</h4>
<p>Disabling this option eliminates support for BUG and WARN, reducing the size of your kernel
image and potentially quietly ignoring numerous fatal conditions. You should only consider
disabling this option for embedded systems with no facilities for reporting errors.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_BUG</tt>, run the following command:
    <tt>grep CONFIG_BUG /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Not setting this variable may hide a number of critical errors.</p>
</div>

<div id="kernel_config_bug_on_data_corruption" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Trigger a kernel BUG when data corruption is detected</h3>
<div>kernel_config_bug_on_data_corruption</div>
<h4>Description</h4>
<p>This option makes the kernel BUG when it encounters data corruption in kernel memory structures
when they get checked for validity.
This configuration is available from kernel 4.10.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_BUG_ON_DATA_CORRUPTION</tt>, run the following command:
    <tt>grep CONFIG_BUG_ON_DATA_CORRUPTION /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This helps detect data corruptions early and stop with a BUG() error message.</p>
</div>

<div id="kernel_config_compat_brk" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable compatibility with brk()</h3>
<div>kernel_config_compat_brk</div>
<h4>Description</h4>
<p>Enabling compatiliby with <tt>brk()</tt> allows legacy binaries to run (i.e. those linked
against libc5). But this compatibility comes at the cost of not being able to randomize
the heap placement (ASLR).

Unless legacy binaries need to run on the system, set <tt>CONFIG_COMPAT_BRK</tt> to <tt>"n"</tt>.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_COMPAT_BRK</tt>, run the following command:
    <tt>grep CONFIG_COMPAT_BRK /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Enabling compatibility with brk() disables support for ASLR.</p>
</div>

<div id="kernel_config_compat_vdso" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the 32-bit vDSO</h3>
<div>kernel_config_compat_vdso</div>
<h4>Description</h4>
<p>Certain buggy versions of glibc (2.3.3) will crash if they are presented with a 32-bit vDSO
that is not mapped at the address indicated in its segment table.
Setting <tt>CONFIG_COMPAT_VDSO</tt> to <tt>y</tt> turns off the 32-bit VDSO and works
around the glibc bug.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_COMPAT_VDSO</tt>, run the following command:
    <tt>grep CONFIG_COMPAT_VDSO /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Enabling VDSO compatibility hurts performance and disables ASLR.</p>
</div>

<div id="kernel_config_debug_credentials" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable checks on credential management</h3>
<div>kernel_config_debug_credentials</div>
<h4>Description</h4>
<p>Enable this to turn on some debug checking for credential management. The additional code keeps
track of the number of pointers from task_structs to any given cred struct, and checks to see
that this number never exceeds the usage count of the cred struct.

Furthermore, if SELinux is enabled, this also checks that the security pointer in the cred
struct is never seen to be invalid.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_CREDENTIALS</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_CREDENTIALS /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This adds sanity checks and validations to credential data structures.</p>
</div>

<div id="kernel_config_debug_fs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable kernel debugfs</h3>
<div>kernel_config_debug_fs</div>
<h4>Description</h4>
<p><tt>debugfs</tt> is a virtual file system that kernel developers use to put debugging files
into. Enable this option to be able to read and write to these files.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_FS</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_FS /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>To reduce the attack surface, this file system should be disabled if not in use.</p>
</div>

<div id="kernel_config_debug_list" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable checks on linked list manipulation</h3>
<div>kernel_config_debug_list</div>
<h4>Description</h4>
<p>Enable this to turn on extended checks in the linked-list walking routines.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_LIST</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_LIST /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This add sanity checks to manipulation of linked lists structures in the kernel and may
prevent exploits such as CVE-2017-1661, where a race condition and simultaneous operations
caused a list to corrupt.</p>
</div>

<div id="kernel_config_debug_notifiers" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable checks on notifier call chains</h3>
<div>kernel_config_debug_notifiers</div>
<h4>Description</h4>
<p>Enable this to turn on sanity checking for notifier call chains. This is most useful for kernel
developers to make sure that modules properly unregister themselves from notifier chains.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_NOTIFIERS</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_NOTIFIERS /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This provides validation of notifier chains, it checks whether the notifiers are from the
kernel or a module that is still loaded prior to being invoked.</p>
</div>

<div id="kernel_config_debug_sg" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable checks on scatter-gather (SG) table operations</h3>
<div>kernel_config_debug_sg</div>
<h4>Description</h4>
<p>Scatter-gather tables are mechanism used for high performance I/O on DMA devices.
Enable this to turn on checks on scatter-gather tables.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_SG</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_SG /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This can help find problems with drivers that do not properly initialize their SG tables.</p>
</div>

<div id="kernel_config_debug_wx" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Warn on W+X mappings found at boot</h3>
<div>kernel_config_debug_wx</div>
<h4>Description</h4>
<p>Generate a warning if any W+X mappings are found at boot.
This configuration is available from kernel 5.8.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEBUG_WX</tt>, run the following command:
    <tt>grep CONFIG_DEBUG_WX /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is useful for discovering cases where the kernel is leaving W+X mappings after applying NX,
as such mappings are a security risk.
Note that even if the check fails, your kernel is possibly still fine, as W+X mappings are not
a security hole in themselves, what they do is that they make the exploitation of other unfixed
kernel bugs easier.</p>
</div>

<div id="kernel_config_default_mmap_min_addr" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Low Address Space To Protect From User Allocation</h3>
<div>kernel_config_default_mmap_min_addr</div>
<h4>Description</h4>
<p>This is the portion of low virtual memory which should be protected from userspace allocation.
This configuration is available from kernel 3.14, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
To check the configuration value for <tt>CONFIG_DEFAULT_MMAP_MIN_ADDR</tt>, run the following command:
<tt>grep CONFIG_DEFAULT_MMAP_MIN_ADDR /boot/config-*</tt>
For each kernel installed, a line with value should be returned.
If the system architecture is x86_64, the value should be 65536.
If the system architecture is aarch64, the value should be 32768.</p>
<h4>Rationale</h4>
<p>Keeping a user from writing to low pages can help reduce the impact of kernel NULL pointer bugs.</p>
</div>

<div id="kernel_config_devkmem" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable /dev/kmem virtual device support</h3>
<div>kernel_config_devkmem</div>
<h4>Description</h4>
<p>Disable support for the /dev/kmem device.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_DEVKMEM</tt>, run the following command:
    <tt>grep CONFIG_DEVKMEM /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>The /dev/kmem device is rarely used, but can be used for certain kind of kernel debugging
operations.</p>
</div>

<div id="kernel_config_fortify_source" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Harden common str/mem functions against buffer overflows</h3>
<div>kernel_config_fortify_source</div>
<h4>Description</h4>
<p>Detect overflows of buffers in common string and memory functions where the compiler can
determine and validate the buffer sizes.
This configuration is available from kernel 4.13, but may be available if backported by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_FORTIFY_SOURCE</tt>, run the following command:
    <tt>grep CONFIG_FORTIFY_SOURCE /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This features helps reduce likelihood of memory corruption of kernel structures.</p>
</div>

<div id="kernel_config_gcc_plugin_latent_entropy" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Generate some entropy during boot and runtime</h3>
<div>kernel_config_gcc_plugin_latent_entropy</div>
<h4>Description</h4>
<p>Instrument some kernel code to extract some entropy from both original and artificially created
program state. This will help especially embedded systems where there is little 'natural' source
of entropy normally.

This configuration is available from kernel 4.9, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_GCC_PLUGIN_LATENT_ENTROPY</tt>, run the following command:
    <tt>grep CONFIG_GCC_PLUGIN_LATENT_ENTROPY /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This helps generate entropy during startup and is particularly relevant for devices with
inappropriate entropy sources.</p>
</div>

<div id="kernel_config_gcc_plugin_randstruct" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Randomize layout of sensitive kernel structures</h3>
<div>kernel_config_gcc_plugin_randstruct</div>
<h4>Description</h4>
<p>Randomize at compile-time the layouts of structures that are entirely function pointers
(and have not been manually annotated with __no_randomize_layout), or structures that have
been explicitly marked with __randomize_layout.
This configuration is available from kernel 4.13, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_GCC_PLUGIN_RANDSTRUCT</tt>, run the following command:
    <tt>grep CONFIG_GCC_PLUGIN_RANDSTRUCT /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Randomizing the layout of kernel data structures make it more difficult for an attacker to
know the location of sensitive data.</p>
</div>

<div id="kernel_config_gcc_plugin_stackleak" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Poison kernel stack before returning from syscalls</h3>
<div>kernel_config_gcc_plugin_stackleak</div>
<h4>Description</h4>
<p>This option makes the kernel erase the kernel stack before returning from system calls.
This has the effect of leaving the stack initialized to the poison value, which both reduces
the lifetime of any sensitive stack contents and reduces potential for uninitialized stack
variable exploits or information exposures (it does not cover functions reaching the same
stack depth as prior functions during the same syscall).

This configuration is available from kernel 4.20, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_GCC_PLUGIN_STACKLEAK</tt>, run the following command:
    <tt>grep CONFIG_GCC_PLUGIN_STACKLEAK /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This blocks most uninitialized stack variable attacks, with the performance impact being
driven by the depth of the stack usage, rather than the function calling complexity.</p>
</div>

<div id="kernel_config_gcc_plugin_structleak" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Force initialization of variables containing userspace addresses</h3>
<div>kernel_config_gcc_plugin_structleak</div>
<h4>Description</h4>
<p>While the kernel is built with warnings enabled for any missed stack variable initializations,
this warning is silenced for anything passed by reference to another function, under the
occasionally misguided assumption that the function will do the initialization. As this
regularly leads to exploitable flaws, this plugin is available to identify and zero-initialize
such variables, depending on the chosen level of coverage.
This configuration is available from kernel 4.11, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_GCC_PLUGIN_STRUCTLEAK</tt>, run the following command:
    <tt>grep CONFIG_GCC_PLUGIN_STRUCTLEAK /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Initializing structures from userspace can prevent some classes of information exposure.</p>
</div>

<div id="kernel_config_gcc_plugin_structleak_byref_all" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>zero-init everything passed by reference</h3>
<div>kernel_config_gcc_plugin_structleak_byref_all</div>
<h4>Description</h4>
<p>Zero-initialize any stack variables that may be passed by reference and had not already been explicitly initialized.
This configuration is available from kernel 4.14, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_GCC_PLUGIN_STRUCTLEAK_BYREF_ALL</tt>, run the following command:
    <tt>grep CONFIG_GCC_PLUGIN_STRUCTLEAK_BYREF_ALL /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This eliminates all classes of uninitialized stack variable exploits and information exposures.</p>
</div>

<div id="kernel_config_hardened_usercopy" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Harden memory copies between kernel and userspace</h3>
<div>kernel_config_hardened_usercopy</div>
<h4>Description</h4>
<p>This option checks for obviously wrong memory regions when copying memory to/from the kernel
(via copy_to_user() and copy_from_user() functions) by rejecting memory ranges that are larger
than the specified heap object, span multiple separately allocated pages, are not on the
process stack, or are part of the kernel text.
This configuration is available from kernel 4.8, and may be available if backported by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_HARDENED_USERCOPY</tt>, run the following command:
    <tt>grep CONFIG_HARDENED_USERCOPY /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This config prevents entire classes of heap overflow exploits and similar kernel memory exposures.
</p>
</div>

<div id="kernel_config_hardened_usercopy_fallback" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Do not allow usercopy whitelist violations to fallback to object size</h3>
<div>kernel_config_hardened_usercopy_fallback</div>
<h4>Description</h4>
<p>This is a temporary option that allows missing usercopy whitelists to be discovered via a WARN()
to the kernel log, instead of rejecting the copy, falling back to non-whitelisted hardened
usercopy that checks the slab allocation size instead of the whitelist size.
This configuration is available from kernel 4.16.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_HARDENED_USERCOPY_FALLBACK</tt>, run the following command:
    <tt>grep CONFIG_HARDENED_USERCOPY_FALLBACK /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>This config prevents entire classes of heap overflow exploits and similar kernel memory exposures.</p>
</div>

<div id="kernel_config_hibernation" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable hibernation</h3>
<div>kernel_config_hibernation</div>
<h4>Description</h4>
<p>Enable the suspend to disk (STD) functionality, which is usually called "hibernation" in user
interfaces. STD checkpoints the system and powers it off; and restores that checkpoint on
reboot.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_HIBERNATION</tt>, run the following command:
    <tt>grep CONFIG_HIBERNATION /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Suspending to disk allows one to replace the running kernel.</p>
</div>

<div id="kernel_config_ia32_emulation" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable IA32 emulation</h3>
<div>kernel_config_ia32_emulation</div>
<h4>Description</h4>
<p>Disables support for legacy 32-bit programs under a 64-bit kernel.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_IA32_EMULATION</tt>, run the following command:
    <tt>grep CONFIG_IA32_EMULATION /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Disabling 32-bit backwards compatibility helps reduce the attack surface.</p>
</div>

<div id="kernel_config_ipv6" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the IPv6 protocol</h3>
<div>kernel_config_ipv6</div>
<h4>Description</h4>
<p>Disable support for IP version 6 (IPv6).

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_IPV6</tt>, run the following command:
    <tt>grep CONFIG_IPV6 /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Any unnecessary network stacks, including IPv6, should be disabled to reduce
the vulnerability to exploitation.</p>
</div>

<div id="kernel_config_kexec" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable kexec system call</h3>
<div>kernel_config_kexec</div>
<h4>Description</h4>
<p><tt>kexec</tt> is a system call that implements the ability to shutdown your current kernel,
and to start another kernel. It is like a reboot but it is independent of the system firmware.
And like a reboot you can start any kernel with it, not just Linux.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_KEXEC</tt>, run the following command:
    <tt>grep CONFIG_KEXEC /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Prohibits the execution of a new kernel image after reboot.</p>
</div>

<div id="kernel_config_legacy_ptys" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable legacy (BSD) PTY support</h3>
<div>kernel_config_legacy_ptys</div>
<h4>Description</h4>
<p>Disable the Linux traditional BSD-like terminal names /dev/ptyxx for masters and /dev/ttyxx for
slaves of pseudo terminals, and use only the modern ptys (devpts) interface.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_LEGACY_PTYS</tt>, run the following command:
    <tt>grep CONFIG_LEGACY_PTYS /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>The legacy scheme has a number of security problems.</p>
</div>

<div id="kernel_config_legacy_vsyscall_emulate" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable vsyscall emulation</h3>
<div>kernel_config_legacy_vsyscall_emulate</div>
<h4>Description</h4>
<p>The kernel traps and emulates calls into the fixed vsyscall address mapping.
This configuration is available from kernel 5.3, but may be available if backported by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_LEGACY_VSYSCALL_EMULATE</tt>, run the following command:
    <tt>grep CONFIG_LEGACY_VSYSCALL_EMULATE /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>The mapping is non-executable, but it still contains known contents, which could be
used in certain rare security vulnerability exploits.</p>
</div>

<div id="kernel_config_legacy_vsyscall_none" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable vsyscall mapping</h3>
<div>kernel_config_legacy_vsyscall_none</div>
<h4>Description</h4>
<p>This config disables the vsyscall mapping at all. Attempts to use the vsyscalls will be reported to
dmesg, so that either old or malicious userspace programs can be identified.
This configuration is available from kernel 4.4.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_LEGACY_VSYSCALL_NONE</tt>, run the following command:
    <tt>grep CONFIG_LEGACY_VSYSCALL_NONE /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This will eliminate any risk of ASLR bypass due to the vsyscall fixed address mapping.</p>
</div>

<div id="kernel_config_legacy_vsyscall_xonly" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable vsyscall emulate execution only</h3>
<div>kernel_config_legacy_vsyscall_xonly</div>
<h4>Description</h4>
<p>The kernel traps and emulates calls into the fixed vsyscall address mapping and does not allow
reads.
This configuration is available from kernel 5.3.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_LEGACY_VSYSCALL_XONLY</tt>, run the following command:
    <tt>grep CONFIG_LEGACY_VSYSCALL_XONLY /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Disabling this mitigates certain uses of the vsyscall area as an ASLR-bypassing buffer.</p>
</div>

<div id="kernel_config_modify_ldt_syscall" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the LDT (local descriptor table)</h3>
<div>kernel_config_modify_ldt_syscall</div>
<h4>Description</h4>
<p>Linux can allow user programs to install a per-process x86 Local Descriptor Table (LDT) using
the modify_ldt(2) system call. This is required to run 16-bit or segmented code such as DOSEMU
or some Wine programs. It is also used by some very old threading libraries.
This configuration is available from kernel 4.3, but may be available if backported
by distros.

Disable LDT if 16-bit program emulation is not necessary.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODIFY_LDT_SYSCALL</tt>, run the following command:
    <tt>grep CONFIG_MODIFY_LDT_SYSCALL /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Disabling support for unnecessary code reduces attack surface.</p>
</div>

<div id="kernel_config_module_sig" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable module signature verification</h3>
<div>kernel_config_module_sig</div>
<h4>Description</h4>
<p>Check modules for valid signatures upon load.
Note that this option adds the OpenSSL development packages as a kernel build dependency so
that the signing tool can use its crypto library.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Loaded modules must be signed.</p>
</div>

<div id="kernel_config_module_sig_all" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable automatic signing of all modules</h3>
<div>kernel_config_module_sig_all</div>
<h4>Description</h4>
<p>Sign all modules during make modules_install. Without this option, modules must be signed
manually, using the scripts/sign-file tool.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG_ALL</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG_ALL /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This ensures the modules are signed during install process.</p>
</div>

<div id="kernel_config_module_sig_force" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Require modules to be validly signed</h3>
<div>kernel_config_module_sig_force</div>
<h4>Description</h4>
<p>Reject unsigned modules or signed modules with an unknown key.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG_FORCE</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG_FORCE /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Prevent loading modules that are unsigned or signed with an unknown key.</p>
</div>

<div id="kernel_config_module_sig_hash" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Specify the hash to use when signing modules</h3>
<div>kernel_config_module_sig_hash</div>
<h4>Description</h4>
<p>This configures the kernel to build and sign modules using
<tt>$var_kernel_config_module_sig_hash</tt> as the hash function.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG_HASH</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG_HASH /boot/config-*</tt>
    
    For each kernel installed, a line with value "<tt>$var_kernel_config_module_sig_hash</tt>" should be returned.
    </p>
<h4>Rationale</h4>
<p>Use of strong hash function is important to secure the module against counterfeit signatures.</p>
</div>

<div id="kernel_config_module_sig_key" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Specify module signing key to use</h3>
<div>kernel_config_module_sig_key</div>
<h4>Description</h4>
<p>Setting this option to something other than its default of <tt>certs/signing_key.pem</tt> will
disable the autogeneration of signing keys and allow the kernel modules to be signed with a key
of your choosing.

The string provided should identify a file containing both a private key and
its corresponding X.509 certificate in PEM form, or — on systems where the OpenSSL ENGINE_pkcs11
is functional — a PKCS#11 URI as defined by RFC7512. In the latter case, the PKCS#11 URI should
reference both a certificate and a private key.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG_KEY</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG_KEY /boot/config-*</tt>
    
    For each kernel installed, a line with value "<tt>$var_kernel_config_module_sig_key</tt>" should be returned.
    </p>
<h4>Rationale</h4>
<p>A key and certificate is required to sign the built modules.</p>
</div>

<div id="kernel_config_module_sig_sha512" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Sign kernel modules with SHA-512</h3>
<div>kernel_config_module_sig_sha512</div>
<h4>Description</h4>
<p>This configures the kernel to build and sign modules using SHA512 as the hash function.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_MODULE_SIG_SHA512</tt>, run the following command:
    <tt>grep CONFIG_MODULE_SIG_SHA512 /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Use of strong hash function is important to secure the module against counterfeit signatures.</p>
</div>

<div id="kernel_config_page_poisoning" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable poison of pages after freeing</h3>
<div>kernel_config_page_poisoning</div>
<h4>Description</h4>
<p>Fill the pages with poison patterns after free_pages() and verify the patterns before
alloc_pages. This does have a potential performance impact if enabled with the "page_poison=1"
kernel boot option.
This configuration is available from kernel 4.6.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PAGE_POISONING</tt>, run the following command:
    <tt>grep CONFIG_PAGE_POISONING /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>The filling of the memory helps reduce the risk of information leaks from freed data.</p>
</div>

<div id="kernel_config_page_poisoning_no_sanity" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable poison without sanity check</h3>
<div>kernel_config_page_poisoning_no_sanity</div>
<h4>Description</h4>
<p>Skip the sanity checking on alloc, only fill the pages with poison on free. This reduces some
of the overhead of the poisoning feature.
This configuration is available from kernel 4.6.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PAGE_POISONING_NO_SANITY</tt>, run the following command:
    <tt>grep CONFIG_PAGE_POISONING_NO_SANITY /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This configuration helps alleviates the performance impact of poisonining.</p>
</div>

<div id="kernel_config_page_poisoning_zero" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Use zero for poisoning instead of debugging value</h3>
<div>kernel_config_page_poisoning_zero</div>
<h4>Description</h4>
<p>Instead of using the existing poison value, fill the pages with zeros. This makes it harder to
detect when errors are occurring due to sanitization but the zeroing at free means that it is
no longer necessary to write zeros when GFP_ZERO is used on allocation.
This configuration is available from kernel 4.19.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PAGE_POISONING_ZERO</tt>, run the following command:
    <tt>grep CONFIG_PAGE_POISONING_ZERO /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This configuration helps alleviates the performance impact of poisonining.</p>
</div>

<div id="kernel_config_page_table_isolation" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Remove the kernel mapping in user mode</h3>
<div>kernel_config_page_table_isolation</div>
<h4>Description</h4>
<p>This feature reduces the number of hardware side channels by ensuring that the majority of
kernel addresses are not mapped into userspace.
This configuration is available from kernel 4.15, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PAGE_TABLE_ISOLATION</tt>, run the following command:
    <tt>grep CONFIG_PAGE_TABLE_ISOLATION /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is a countermeasure to the Meltdown attack.</p>
</div>

<div id="kernel_config_panic_on_oops" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Kernel panic oops</h3>
<div>kernel_config_panic_on_oops</div>
<h4>Description</h4>
<p>Enable the kernel to panic when it oopses.
This has the same effect as setting oops=panic on the kernel command line.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PANIC_ON_OOPS</tt>, run the following command:
    <tt>grep CONFIG_PANIC_ON_OOPS /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This feature ensures that the kernel does not do anything erroneous after an oops which
could result in data corruption or other issues.</p>
</div>

<div id="kernel_config_panic_timeout" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Kernel panic timeout</h3>
<div>kernel_config_panic_timeout</div>
<h4>Description</h4>
<p>Set the timeout value (in seconds) until a reboot occurs when the kernel panics.
A timeout of 0 configures the system to wait forever. With a timeout value greater than 0,
the system will wait the specified amount of seconds before rebooting. While a timeout value
less than 0 makes the system reboot immediately.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PANIC_TIMEOUT</tt>, run the following command:
    <tt>grep CONFIG_PANIC_TIMEOUT /boot/config-*</tt>
    
    For each kernel installed, a line with value "<tt>$var_kernel_config_panic_timeout</tt>" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is required to enable protection against Spectre v2.</p>
</div>

<div id="kernel_config_proc_kcore" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable support for /proc/kkcore</h3>
<div>kernel_config_proc_kcore</div>
<h4>Description</h4>
<p>Provides a virtual ELF core file of the live kernel.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_PROC_KCORE</tt>, run the following command:
    <tt>grep CONFIG_PROC_KCORE /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>This feature exposes the memory to the userspace and can assist an attacker in discovering
attack vectors.</p>
</div>

<div id="kernel_config_randomize_base" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Randomize the address of the kernel image (KASLR)</h3>
<div>kernel_config_randomize_base</div>
<h4>Description</h4>
<p>In support of Kernel Address Space Layout Randomization (KASLR), this randomizes the physical
address at which the kernel image is decompressed and the virtual address where the kernel
image is mapped.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_RANDOMIZE_BASE</tt>, run the following command:
    <tt>grep CONFIG_RANDOMIZE_BASE /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>An unpredictable kernel address makes it more difficult to succeed with exploits that rely on
knowledge of the location of kernel code internals.</p>
</div>

<div id="kernel_config_randomize_memory" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Randomize the kernel memory sections</h3>
<div>kernel_config_randomize_memory</div>
<h4>Description</h4>
<p>Randomizes the base virtual address of kernel memory sections (physical memory mapping,
vmalloc &amp; vmemmap).
This configuration is available from kernel 4.8, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_RANDOMIZE_MEMORY</tt>, run the following command:
    <tt>grep CONFIG_RANDOMIZE_MEMORY /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This security feature makes exploits relying on predictable memory locations less reliable.</p>
</div>

<div id="kernel_config_refcount_full" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Perform full reference count validation</h3>
<div>kernel_config_refcount_full</div>
<h4>Description</h4>
<p>Enabling this switches the refcounting infrastructure from a fast unchecked atomic_t
implementation to a fully state checked implementation, which can have a slight
impact in performance.
This configuration is available from kernel 4.13, but may be available if backported
by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_REFCOUNT_FULL</tt>, run the following command:
    <tt>grep CONFIG_REFCOUNT_FULL /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Refcounting provides protections against various use-after-free conditions that can be
used in security flaw exploits.</p>
</div>

<div id="kernel_config_retpoline" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Avoid speculative indirect branches in kernel</h3>
<div>kernel_config_retpoline</div>
<h4>Description</h4>
<p>Compile kernel with the retpoline compiler options to guard against kernel-to-user data leaks
by avoiding speculative indirect branches.
Requires a compiler with -mindirect-branch=thunk-extern support for full protection.
The kernel may run slower.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_RETPOLINE</tt>, run the following command:
    <tt>grep CONFIG_RETPOLINE /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is required to enable protection against Spectre v2.</p>
</div>

<div id="kernel_config_sched_stack_end_check" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Detect stack corruption on calls to schedule()</h3>
<div>kernel_config_sched_stack_end_check</div>
<h4>Description</h4>
<p>This option checks for a stack overrun on calls to schedule(). If the stack end location is
found to be overwritten always panic as the content of the corrupted region can no longer
be trusted.
This configuration is available from kernel 3.18.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SCHED_STACK_END_CHECK</tt>, run the following command:
    <tt>grep CONFIG_SCHED_STACK_END_CHECK /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This ensures no erroneous behaviour occurs which could result in data corruption or a
sporadic crash at a later stage once the region is examined.</p>
</div>

<div id="kernel_config_seccomp" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable seccomp to safely compute untrusted bytecode</h3>
<div>kernel_config_seccomp</div>
<h4>Description</h4>
<p>This kernel feature is useful for number crunching applications that may need to compute
untrusted bytecode during their execution. By using pipes or other transports made available
to the process as file descriptors supporting the read/write syscalls, it's possible to isolate
those applications in their own address space using seccomp.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECCOMP</tt>, run the following command:
    <tt>grep CONFIG_SECCOMP /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p><tt>seccomp</tt> enables the ability to filter system calls made by an application, effectively
isolating the system's resources from it.</p>
</div>

<div id="kernel_config_seccomp_filter" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable use of Berkeley Packet Filter with seccomp</h3>
<div>kernel_config_seccomp_filter</div>
<h4>Description</h4>
<p>Enable tasks to build secure computing environments defined in terms of Berkeley Packet Filter
programs which implement task-defined system call filtering polices.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECCOMP_FILTER</tt>, run the following command:
    <tt>grep CONFIG_SECCOMP_FILTER /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Use of BPF filters allows for expressive filtering of system calls using a filter program
language with a long history of being exposed to userland.</p>
</div>

<div id="kernel_config_security" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable different security models</h3>
<div>kernel_config_security</div>
<h4>Description</h4>
<p>This allows you to choose different security modules to be configured into your kernel.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECURITY</tt>, run the following command:
    <tt>grep CONFIG_SECURITY /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is enables kernel security primitives required by the LSM framework.</p>
</div>

<div id="kernel_config_security_dmesg_restrict" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict unprivileged access to the kernel syslog</h3>
<div>kernel_config_security_dmesg_restrict</div>
<h4>Description</h4>
<p>Enforce restrictions on unprivileged users reading the kernel syslog via dmesg(8).

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECURITY_DMESG_RESTRICT</tt>, run the following command:
    <tt>grep CONFIG_SECURITY_DMESG_RESTRICT /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Prevents unprivileged users from retrieving kernel addresses with dmesg.</p>
</div>

<div id="kernel_config_security_writable_hooks" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable mutable hooks</h3>
<div>kernel_config_security_writable_hooks</div>
<h4>Description</h4>
<p>Ensure kernel structures associated with LSMs are always mapped as read-only after system boot.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECURITY_WRITABLE_HOOKS</tt>, run the following command:
    <tt>grep CONFIG_SECURITY_WRITABLE_HOOKS /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>If CONFIG_SECURITY_WRITABLE_HOOKS is enabled, then hooks can be loaded at runtime and
being able to manipulate hooks is a way to bypass all LSMs.</p>
</div>

<div id="kernel_config_security_yama" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Yama support</h3>
<div>kernel_config_security_yama</div>
<h4>Description</h4>
<p>This enables support for LSM module Yama, which extends DAC support with additional system-wide
security settings beyond regular Linux discretionary access controls. The module will limit the
use of the system call <tt>ptrace()</tt>.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SECURITY_YAMA</tt>, run the following command:
    <tt>grep CONFIG_SECURITY_YAMA /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Unrestricted usage of ptrace allows compromised binaries to run ptrace
on another processes of the user.</p>
</div>

<div id="kernel_config_slab_freelist_hardened" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Harden slab freelist metadata</h3>
<div>kernel_config_slab_freelist_hardened</div>
<h4>Description</h4>
<p>This feature protects integrity of the allocator's metadata.
This configuration is available from kernel 4.14.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SLAB_FREELIST_HARDENED</tt>, run the following command:
    <tt>grep CONFIG_SLAB_FREELIST_HARDENED /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>Many kernel heap attacks try to target slab cache metadata and other infrastructure.
This options makes minor performance sacrifices to harden the kernel slab allocator against
common freelist exploit methods.</p>
</div>

<div id="kernel_config_slab_freelist_random" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Randomize slab freelist</h3>
<div>kernel_config_slab_freelist_random</div>
<h4>Description</h4>
<p>Randomizes the freelist order used on creating new pages.
This configuration is available from kernel 5.9, but may be available if backported by distros.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SLAB_FREELIST_RANDOM</tt>, run the following command:
    <tt>grep CONFIG_SLAB_FREELIST_RANDOM /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This security feature reduces the predictability of the kernel slab allocator against heap overflows.</p>
</div>

<div id="kernel_config_slab_merge_default" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disallow merge of slab caches</h3>
<div>kernel_config_slab_merge_default</div>
<h4>Description</h4>
<p>For reduced kernel memory fragmentation, slab caches can be merged when they share the same
size and other characteristics. This carries a risk of kernel heap overflows being able to
overwrite objects from merged caches (and more easily control cache layout), which makes such
heap attacks easier to exploit by attackers.
This configuration is available from kernel 4.13.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SLAB_MERGE_DEFAULT</tt>, run the following command:
    <tt>grep CONFIG_SLAB_MERGE_DEFAULT /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>Disabling the merge of slabs of similar sizes prevents the kernel from
merging a seemingly useless but vulnerable slab with a useful and valuable slab.
This increase the risk that a heap overflow could overwrite objects from merged caches,
with unmerged caches the heap overflow would only affect the objects in the same cache.
Overall, this reduces the kernel attack surface area by isolating slabs from each other.</p>
</div>

<div id="kernel_config_slub_debug" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable SLUB debugging support</h3>
<div>kernel_config_slub_debug</div>
<h4>Description</h4>
<p>SLUB has extensive debug support features and this allows the allocator validation checking to
be enabled.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SLUB_DEBUG</tt>, run the following command:
    <tt>grep CONFIG_SLUB_DEBUG /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This activates the checking of the memory allocator structures and resets to zero the zones
allocated when they are released.</p>
</div>

<div id="kernel_config_stackprotector" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Stack Protector buffer overflow detection</h3>
<div>kernel_config_stackprotector</div>
<h4>Description</h4>
<p>This feature puts, at the beginning of functions, a canary value on the stack just before the
return address, and validates the value just before actually returning.
This configuration is available from kernel 4.18.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_STACKPROTECTOR</tt>, run the following command:
    <tt>grep CONFIG_STACKPROTECTOR /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This halts the program when a stack overflow is detected, potentially reducing the impact of
exploits.</p>
</div>

<div id="kernel_config_stackprotector_strong" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Strong Stack Protector</h3>
<div>kernel_config_stackprotector_strong</div>
<h4>Description</h4>
<p>This features adds canary logic protection to more kinds of vulnerable functions than
CONFIG_STACKPROTECTOR, but not to all functions so that performance is not severily impacted.
This configuration is available from kernel 4.18.
This config requires gcc version 4.9 or above, or a distribution gcc with the feature
backported ("-fstack-protector-strong").

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_STACKPROTECTOR_STRONG</tt>, run the following command:
    <tt>grep CONFIG_STACKPROTECTOR_STRONG /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This provides a mechanism that protects more vulnerable functions than CONFIG_STACKPROTECTOR,
balancing between security and performance.</p>
</div>

<div id="kernel_config_strict_kernel_rwx" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Make the kernel text and rodata read-only</h3>
<div>kernel_config_strict_kernel_rwx</div>
<h4>Description</h4>
<p>When set, kernel text and rodata memory will be made read-only, and non-text memory will be made non-executable.
This configuration is available from kernel 4.11.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_STRICT_KERNEL_RWX</tt>, run the following command:
    <tt>grep CONFIG_STRICT_KERNEL_RWX /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This provides protection against certain security exploits (e.g. executing the heap or modifying text)</p>
</div>

<div id="kernel_config_strict_module_rwx" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Make the module text and rodata read-only</h3>
<div>kernel_config_strict_module_rwx</div>
<h4>Description</h4>
<p>When set, module text and rodata memory will be made read-only, and non-text memory will be made non-executable.
This configuration is available from kernel 4.11.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_STRICT_MODULE_RWX</tt>, run the following command:
    <tt>grep CONFIG_STRICT_MODULE_RWX /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This provides protection against certain security exploits (e.g. executing the heap or modifying text)</p>
</div>

<div id="kernel_config_syn_cookies" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable TCP/IP syncookie support</h3>
<div>kernel_config_syn_cookies</div>
<h4>Description</h4>
<p>Normal TCP/IP networking is open to an attack known as SYN flooding.
It is denial-of-service attack that prevents legitimate remote users from being able to connect
to your computer during an ongoing attack.

When enabled the TCP/IP stack will use a cryptographic challenge protocol known as SYN cookies
to enable legitimate users to continue to connect, even when your machine is under attack.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_SYN_COOKIES</tt>, run the following command:
    <tt>grep CONFIG_SYN_COOKIES /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>SYN cookies provide protection against SYN flooding attacks.</p>
</div>

<div id="kernel_config_unmap_kernel_at_el0" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Unmap kernel when running in userspace (aka KAISER)</h3>
<div>kernel_config_unmap_kernel_at_el0</div>
<h4>Description</h4>
<p>Speculation attacks against some high-performance processors can be used to bypass MMU
permission checks and leak kernel data to userspace. This can be defended against by unmapping
the kernel when running in userspace, mapping it back in on exception entry via a trampoline
page in the vector table.
This configuration is available from kernel 4.16, but may be available if backported
by distros.
The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_UNMAP_KERNEL_AT_EL0</tt>, run the following command:
    <tt>grep CONFIG_UNMAP_KERNEL_AT_EL0 /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This is a countermeasure to the Meltdown attack.</p>
</div>

<div id="kernel_config_vmap_stack" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>User a virtually-mapped stack</h3>
<div>kernel_config_vmap_stack</div>
<h4>Description</h4>
<p>Enable this to use virtually-mapped kernel stacks with guard pages.
This configuration is available from kernel 4.9.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_VMAP_STACK</tt>, run the following command:
    <tt>grep CONFIG_VMAP_STACK /boot/config-*</tt>
    
    For each kernel installed, a line with value "y" should be returned.
    </p>
<h4>Rationale</h4>
<p>This causes kernel stack overflows to be caught immediately rather than causing difficult-to-diagnose corruption.</p>
</div>

<div id="kernel_config_x86_vsyscall_emulation" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable x86 vsyscall emulation</h3>
<div>kernel_config_x86_vsyscall_emulation</div>
<h4>Description</h4>
<p>Disabling it is roughly equivalent to booting with vsyscall=none, except that it will also
disable the helpful warning if a program tries to use a vsyscall. With this option set to N,
offending programs will just segfault, citing addresses of the form 0xffffffffff600?00.
This configuration is available from kernel 3.19.

The configuration that was used to build kernel is available at <tt>/boot/config-*</tt>.
    To check the configuration value for <tt>CONFIG_X86_VSYSCALL_EMULATION</tt>, run the following command:
    <tt>grep CONFIG_X86_VSYSCALL_EMULATION /boot/config-*</tt>
    
    Configs with value 'n' are not explicitly set in the file, so either commented lines or no
    lines should be returned.
    </p>
<h4>Rationale</h4>
<p>The vsyscall table is no longer required and is a potential source of ROP gadgets.</p>
</div>

<div id="kernel_disable_entropy_contribution_for_solid_state_drives" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure Solid State Drives Do Not Contribute To Random-Number Entropy Pool</h3>
<div>kernel_disable_entropy_contribution_for_solid_state_drives</div>
<h4>Description</h4>
<p>For each solid-state drive on the system, run:
<pre> # echo 0 &gt; /sys/block/DRIVE/queue/add_random</pre></p>
<h4>Rationale</h4>
<p>In contrast to traditional electromechanical magnetic disks, containing
spinning disks and / or movable read / write heads, the solid-state storage
devices (SSDs) do not contain moving / mechanical components. Therefore the
I/O operation completion times are much more predictable for them.</p>
</div>

<div id="kernel_module_atm_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable ATM Support</h3>
<div>kernel_module_atm_disabled</div>
<h4>Description</h4>
<p>The Asynchronous Transfer Mode (ATM) is a protocol operating on
network, data link, and physical layers, based on virtual circuits
and virtual paths.

To configure the system to prevent the <code>atm</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/atm.conf</code>:
<pre>install atm /bin/false</pre>
This entry will cause a non-zero return value during a <code>atm</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install atm /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling ATM protects the system against exploitation of any
flaws in its implementation.</p>
</div>

<div id="kernel_module_bluetooth_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Bluetooth Kernel Module</h3>
<div>kernel_module_bluetooth_disabled</div>
<h4>Description</h4>
<p>The kernel's module loading system can be configured to prevent
loading of the Bluetooth module. Add the following to
the appropriate <tt>/etc/modprobe.d</tt> configuration file
to prevent the loading of the Bluetooth module:
<pre>install bluetooth /bin/true</pre></p>
<h4>Rationale</h4>
<p>If Bluetooth functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.</p>
</div>

<div id="kernel_module_can_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable CAN Support</h3>
<div>kernel_module_can_disabled</div>
<h4>Description</h4>
<p>The Controller Area Network (CAN) is a serial communications
protocol which was initially developed for automotive and
is now also used in marine, industrial, and medical applications.

To configure the system to prevent the <code>can</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/can.conf</code>:
<pre>install can /bin/false</pre>
This entry will cause a non-zero return value during a <code>can</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install can /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling CAN protects the system against exploitation of any
flaws in its implementation.</p>
</div>

<div id="kernel_module_cfg80211_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel cfg80211 Module</h3>
<div>kernel_module_cfg80211_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>cfg80211</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/cfg80211.conf</code>:
<pre>install cfg80211 /bin/false</pre>
This entry will cause a non-zero return value during a <code>cfg80211</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install cfg80211 /bin/true</pre></p>
<h4>Rationale</h4>
<p>If Wireless functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.</p>
</div>

<div id="kernel_module_cramfs_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of cramfs</h3>
<div>kernel_module_cramfs_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>cramfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/cramfs.conf</code>:
<pre>install cramfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>cramfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install cramfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <tt>cramfs</tt> filesystem type is a compressed read-only
Linux filesystem embedded in small footprint systems. A
<tt>cramfs</tt> image can be used without having to first
decompress the image.</p>
<h4>Rationale</h4>
<p>Removing support for unneeded filesystem types reduces the local attack surface
of the server.</p>
</div>

<div id="kernel_module_dccp_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable DCCP Support</h3>
<div>kernel_module_dccp_disabled</div>
<h4>Description</h4>
<p>The Datagram Congestion Control Protocol (DCCP) is a
relatively new transport layer protocol, designed to support
streaming media and telephony.

To configure the system to prevent the <code>dccp</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/dccp.conf</code>:
<pre>install dccp /bin/false</pre>
This entry will cause a non-zero return value during a <code>dccp</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install dccp /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling DCCP protects
the system against exploitation of any flaws in its implementation.</p>
</div>

<div id="kernel_module_firewire-core_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable IEEE 1394 (FireWire) Support</h3>
<div>kernel_module_firewire-core_disabled</div>
<h4>Description</h4>
<p>The IEEE 1394 (FireWire) is a serial bus standard for
high-speed real-time communication.

To configure the system to prevent the <code>firewire-core</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/firewire-core.conf</code>:
<pre>install firewire-core /bin/false</pre>
This entry will cause a non-zero return value during a <code>firewire-core</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install firewire-core /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling FireWire protects the system against exploitation of any
flaws in its implementation.</p>
</div>

<div id="kernel_module_freevxfs_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of freevxfs</h3>
<div>kernel_module_freevxfs_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>freevxfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/freevxfs.conf</code>:
<pre>install freevxfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>freevxfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install freevxfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</p>
<h4>Rationale</h4>
<p>Linux kernel modules which implement filesystems that are not needed by the
local system should be disabled.</p>
</div>

<div id="kernel_module_hfs_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of hfs</h3>
<div>kernel_module_hfs_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>hfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/hfs.conf</code>:
<pre>install hfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>hfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install hfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</p>
<h4>Rationale</h4>
<p>Linux kernel modules which implement filesystems that are not needed by the
local system should be disabled.</p>
</div>

<div id="kernel_module_hfsplus_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of hfsplus</h3>
<div>kernel_module_hfsplus_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>hfsplus</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/hfsplus.conf</code>:
<pre>install hfsplus /bin/false</pre>
This entry will cause a non-zero return value during a <code>hfsplus</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install hfsplus /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</p>
<h4>Rationale</h4>
<p>Linux kernel modules which implement filesystems that are not needed by the
local system should be disabled.</p>
</div>

<div id="kernel_module_ipv6_option_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable IPv6 Networking Support Automatic Loading</h3>
<div>kernel_module_ipv6_option_disabled</div>
<h4>Description</h4>
<p>To prevent the IPv6 kernel module (<tt>ipv6</tt>) from binding to the
IPv6 networking stack, add the following line to
<tt>/etc/modprobe.d/disabled.conf</tt> (or another file in
<tt>/etc/modprobe.d</tt>):
<pre>options ipv6 disable=1</pre>
This permits the IPv6 module to be loaded (and thus satisfy other modules that
depend on it), while disabling support for the IPv6 protocol.</p>
<h4>Rationale</h4>
<p>Any unnecessary network stacks - including IPv6 - should be disabled, to reduce
the vulnerability to exploitation.</p>
</div>

<div id="kernel_module_iwlmvm_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel iwlmvm Module</h3>
<div>kernel_module_iwlmvm_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>iwlmvm</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/iwlmvm.conf</code>:
<pre>install iwlmvm /bin/false</pre>
This entry will cause a non-zero return value during a <code>iwlmvm</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install iwlmvm /bin/true</pre></p>
<h4>Rationale</h4>
<p>If Wireless functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.</p>
</div>

<div id="kernel_module_iwlwifi_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel iwlwifi Module</h3>
<div>kernel_module_iwlwifi_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>iwlwifi</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/iwlwifi.conf</code>:
<pre>install iwlwifi /bin/false</pre>
This entry will cause a non-zero return value during a <code>iwlwifi</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install iwlwifi /bin/true</pre></p>
<h4>Rationale</h4>
<p>If Wireless functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.</p>
</div>

<div id="kernel_module_jffs2_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of jffs2</h3>
<div>kernel_module_jffs2_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>jffs2</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/jffs2.conf</code>:
<pre>install jffs2 /bin/false</pre>
This entry will cause a non-zero return value during a <code>jffs2</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install jffs2 /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.</p>
<h4>Rationale</h4>
<p>Linux kernel modules which implement filesystems that are not needed by the
local system should be disabled.</p>
</div>

<div id="kernel_module_mac80211_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel mac80211 Module</h3>
<div>kernel_module_mac80211_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>mac80211</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/mac80211.conf</code>:
<pre>install mac80211 /bin/false</pre>
This entry will cause a non-zero return value during a <code>mac80211</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install mac80211 /bin/true</pre></p>
<h4>Rationale</h4>
<p>If Wireless functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.</p>
</div>

<div id="kernel_module_overlayfs_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure overlayfs kernel module is not available</h3>
<div>kernel_module_overlayfs_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>overlayfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/overlayfs.conf</code>:
<pre>install overlayfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>overlayfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install overlayfs /bin/true</pre>

overlayfs is a Linux filesystem that layers multiple filesystems to create a single
unified view which allows a user to "merge" several mount points into a unified
filesystem.</p>
<h4>Rationale</h4>
<p>The overlayfs has known CVE's. Disabling the overlayfs reduces the local attack 
surface by removing support for unnecessary filesystem types and mitigates potential
risks associated with unauthorized execution of setuid files, enhancing the overall
system security.</p>
</div>

<div id="kernel_module_rds_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable RDS Support</h3>
<div>kernel_module_rds_disabled</div>
<h4>Description</h4>
<p>The Reliable Datagram Sockets (RDS) protocol is a transport
layer protocol designed to provide reliable high-bandwidth,
low-latency communications between nodes in a cluster.

To configure the system to prevent the <code>rds</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/rds.conf</code>:
<pre>install rds /bin/false</pre>
This entry will cause a non-zero return value during a <code>rds</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install rds /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling RDS protects
the system against exploitation of any flaws in its implementation.</p>
</div>

<div id="kernel_module_sctp_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable SCTP Support</h3>
<div>kernel_module_sctp_disabled</div>
<h4>Description</h4>
<p>The Stream Control Transmission Protocol (SCTP) is a
transport layer protocol, designed to support the idea of
message-oriented communication, with several streams of messages
within one connection.

To configure the system to prevent the <code>sctp</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/sctp.conf</code>:
<pre>install sctp /bin/false</pre>
This entry will cause a non-zero return value during a <code>sctp</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install sctp /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling SCTP protects
the system against exploitation of any flaws in its implementation.</p>
</div>

<div id="kernel_module_squashfs_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of squashfs</h3>
<div>kernel_module_squashfs_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>squashfs</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/squashfs.conf</code>:
<pre>install squashfs /bin/false</pre>
This entry will cause a non-zero return value during a <code>squashfs</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install squashfs /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <tt>squashfs</tt> filesystem type is a compressed read-only Linux
filesystem embedded in small footprint systems (similar to
<tt>cramfs</tt>). A <tt>squashfs</tt> image can be used without having
to first decompress the image.</p>
<h4>Rationale</h4>
<p>Removing support for unneeded filesystem types reduces the local attack
surface of the system.</p>
</div>

<div id="kernel_module_tipc_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable TIPC Support</h3>
<div>kernel_module_tipc_disabled</div>
<h4>Description</h4>
<p>The Transparent Inter-Process Communication (TIPC) protocol
is designed to provide communications between nodes in a
cluster.

To configure the system to prevent the <code>tipc</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/tipc.conf</code>:
<pre>install tipc /bin/false</pre>
This entry will cause a non-zero return value during a <code>tipc</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install tipc /bin/true</pre></p>
<h4>Rationale</h4>
<p>Disabling TIPC protects
the system against exploitation of any flaws in its implementation.</p>
</div>

<div id="kernel_module_udf_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of udf</h3>
<div>kernel_module_udf_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>udf</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/udf.conf</code>:
<pre>install udf /bin/false</pre>
This entry will cause a non-zero return value during a <code>udf</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install udf /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <tt>udf</tt> filesystem type is the universal disk format
used to implement the ISO/IEC 13346 and ECMA-167 specifications.
This is an open vendor filesystem type for data storage on a broad
range of media. This filesystem type is necessary to support
writing DVDs and newer optical disc formats.</p>
<h4>Rationale</h4>
<p>Removing support for unneeded filesystem types reduces the local
attack surface of the system.</p>
</div>

<div id="kernel_module_usb-storage_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Modprobe Loading of USB Storage Driver</h3>
<div>kernel_module_usb-storage_disabled</div>
<h4>Description</h4>
<p>To prevent USB storage devices from being used, configure the kernel module loading system
to prevent automatic loading of the USB storage driver.

To configure the system to prevent the <code>usb-storage</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/usb-storage.conf</code>:
<pre>install usb-storage /bin/false</pre>
This entry will cause a non-zero return value during a <code>usb-storage</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install usb-storage /bin/true</pre>

This will prevent the <tt>modprobe</tt> program from loading the <tt>usb-storage</tt>
module, but will not prevent an administrator (or another program) from using the
<tt>insmod</tt> program to load the module manually.</p>
<h4>Rationale</h4>
<p>USB storage devices such as thumb drives can be used to introduce
malicious software.</p>
</div>

<div id="kernel_module_uvcvideo_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the uvcvideo module</h3>
<div>kernel_module_uvcvideo_disabled</div>
<h4>Description</h4>
<p>If the device contains a camera it should be covered or disabled when not in use.</p>
<h4>Rationale</h4>
<p>Failing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information.
Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure participants actually carry out the disconnect activity without having to go through complex and tedious procedures.</p>
</div>

<div id="kernel_module_vfat_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Mounting of vFAT filesystems</h3>
<div>kernel_module_vfat_disabled</div>
<h4>Description</h4>
<p>
To configure the system to prevent the <code>vfat</code>
kernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/vfat.conf</code>:
<pre>install vfat /bin/false</pre>
This entry will cause a non-zero return value during a <code>vfat</code> module installation
and additionally convey the meaning of the entry to the user in form of an error message.
If you would like to omit a non-zero return value and an error message, you may want to add a different line instead
(both <code>/bin/true</code> and <code>/bin/false</code> are allowed by OVAL and will be accepted by the scan):
<pre>install vfat /bin/true</pre>

This effectively prevents usage of this uncommon filesystem.

The <tt>vFAT</tt> filesystem format is primarily used on older
windows systems and portable USB drives or flash modules. It comes
in three types <tt>FAT12</tt>, <tt>FAT16</tt>, and <tt>FAT32</tt>
all of which are supported by the <tt>vfat</tt> kernel module.</p>
<h4>Rationale</h4>
<p>Removing support for unneeded filesystems reduces the local attack
surface of the system.</p>
</div>

<div id="network_ipv6_default_gateway" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Manually Assign IPv6 Router Address</h3>
<div>network_ipv6_default_gateway</div>
<h4>Description</h4>
<p>Edit the file
<tt>/etc/sysconfig/network-scripts/ifcfg-<i>interface</i></tt>, and add or correct
the following line (substituting your gateway IP as appropriate):
<pre>IPV6_DEFAULTGW=2001:0DB8::0001</pre>
Router addresses should be manually set and not accepted via any
auto-configuration or router advertisement.</p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="network_ipv6_disable_interfaces" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Interface Usage of IPv6</h3>
<div>network_ipv6_disable_interfaces</div>
<h4>Description</h4>
<p>To disable interface usage of IPv6, add or correct the following lines in <tt>/etc/sysconfig/network</tt>:
<pre>NETWORKING_IPV6=no
IPV6INIT=no</pre></p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="network_ipv6_disable_rpc" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Support for RPC IPv6</h3>
<div>network_ipv6_disable_rpc</div>
<h4>Description</h4>
<p>RPC services for NFSv4 try to load transport modules for
<tt>udp6</tt> and <tt>tcp6</tt> by default, even if IPv6 has been disabled in
<tt>/etc/modprobe.d</tt>. To prevent RPC services such as <tt>rpc.mountd</tt>
from attempting to start IPv6 network listeners, remove or comment out the
following two lines in <tt>/etc/netconfig</tt>:
<pre>udp6       tpi_clts      v     inet6    udp     -       -
tcp6       tpi_cots_ord  v     inet6    tcp     -       -</pre></p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="network_ipv6_privacy_extensions" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Use Privacy Extensions for Address</h3>
<div>network_ipv6_privacy_extensions</div>
<h4>Description</h4>
<p>To introduce randomness into the automatic generation of IPv6
addresses, add or correct the following line in
<tt>/etc/sysconfig/network-scripts/ifcfg-<i>interface</i></tt>:
<pre>IPV6_PRIVACY=rfc3041</pre>
Automatically-generated IPv6 addresses are based on the underlying hardware
(e.g. Ethernet) address, and so it becomes possible to track a piece of
hardware over its lifetime using its traffic. If it is important for a system's
IP address to not trivially reveal its hardware address, this setting should be
applied.</p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="network_ipv6_static_address" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Manually Assign Global IPv6 Address</h3>
<div>network_ipv6_static_address</div>
<h4>Description</h4>
<p>To manually assign an IP address for an interface, edit the
file <tt>/etc/sysconfig/network-scripts/ifcfg-<i>interface</i></tt>. Add or correct the
following line (substituting the correct IPv6 address):
<pre>IPV6ADDR=2001:0DB8::ABCD/64</pre>
Manually assigning an IP address is preferable to accepting one from routers or
from the network otherwise. The example address here is an IPv6 address
reserved for documentation purposes, as defined by RFC3849.</p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="package_abrt-addon-kerneloops_removed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Uninstall abrt-addon-kerneloops Package</h3>
<div>package_abrt-addon-kerneloops_removed</div>
<h4>Description</h4>
<p>The <code>abrt-addon-kerneloops</code> package can be removed with the following command:
<pre>
$ sudo dnf remove abrt-addon-kerneloops</pre></p>
<h4>Rationale</h4>
<p><tt>abrt-addon-kerneloops</tt> contains plugins for collecting kernel crash information and
reporter plugin which sends this information to a specified server, usually to kerneloops.org.</p>
</div>

<div id="package_iptables-nft_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install iptables-nft Package</h3>
<div>package_iptables-nft_installed</div>
<h4>Description</h4>
<p>The <code>iptables-nft</code> package can be installed with the following command:
<pre>
$ sudo dnf install iptables-nft</pre></p>
<h4>Rationale</h4>
<p><tt>iptables-nft</tt> controls the Linux kernel network packet filtering
code. <tt>iptables-nft</tt> allows system operators to set up firewalls and IP
masquerading, etc.</p>
</div>

<div id="package_nfs-kernel-server_removed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Uninstall nfs-kernel-server Package</h3>
<div>package_nfs-kernel-server_removed</div>
<h4>Description</h4>
<p>The <code>nfs-kernel-server</code> package can be removed with the following command:
<pre>
$ sudo dnf remove nfs-kernel-server</pre></p>
<h4>Rationale</h4>
<p>If the system does not export NFS shares or act as an NFS client, it is
recommended that these services be removed to reduce the remote attack
surface.</p>
</div>

<div id="sebool_domain_kernel_load_modules" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the domain_kernel_load_modules SELinux Boolean</h3>
<div>sebool_domain_kernel_load_modules</div>
<h4>Description</h4>
<p>By default, the SELinux boolean <tt>domain_kernel_load_modules</tt> is disabled.
If this setting is enabled, it should be disabled.

To disable the <code>domain_kernel_load_modules</code> SELinux boolean, run the following command:
<pre>$ sudo setsebool -P domain_kernel_load_modules off</pre></p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="sysctl_fs_protected_fifos" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Enforce DAC on FIFOs</h3>
<div>sysctl_fs_protected_fifos</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>fs.protected_fifos</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_fifos=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_fifos = 2</pre></p>
<h4>Rationale</h4>
<p>This parameter is available since Linux Kernel 4.19 and allows to prohibit opening
FIFOs that are not owned by the user in world and group writeable sticky directories.
It avoids unintentional writes to an attacker-controlled FIFO where a program expects
to create the regular file.</p>
</div>

<div id="sysctl_fs_protected_hardlinks" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Enforce DAC on Hardlinks</h3>
<div>sysctl_fs_protected_hardlinks</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>fs.protected_hardlinks</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_hardlinks=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_hardlinks = 1</pre></p>
<h4>Rationale</h4>
<p>By enabling this kernel parameter, users can no longer create soft or hard links to
files which they do not own. Disallowing such hardlinks mitigate vulnerabilities
based on insecure file system accessed by privileged programs, avoiding an
exploitation vector exploiting unsafe use of <tt>open()</tt> or <tt>creat()</tt>.</p>
</div>

<div id="sysctl_fs_protected_regular" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Enforce DAC on Regular files</h3>
<div>sysctl_fs_protected_regular</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>fs.protected_regular</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_regular=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_regular = 2</pre></p>
<h4>Rationale</h4>
<p>This parameter is available since Linux Kernel 4.19 and allows to prohibit opening
"regular" files that are not owned by the user in world and group writeable sticky
directories. It avoids writes to an attacker-controlled regular file, for example,
when a program expects to create the regular file.</p>
</div>

<div id="sysctl_fs_protected_symlinks" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Enforce DAC on Symlinks</h3>
<div>sysctl_fs_protected_symlinks</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>fs.protected_symlinks</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_symlinks=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_symlinks = 1</pre></p>
<h4>Rationale</h4>
<p>By enabling this kernel parameter, symbolic links are permitted to be followed
only when outside a sticky world-writable directory, or when the UID of the
link and follower match, or when the directory owner matches the symlink's owner.
Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system
accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of
<tt>open()</tt> or <tt>creat()</tt>.</p>
</div>

<div id="sysctl_fs_suid_dumpable" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Core Dumps for SUID programs</h3>
<div>sysctl_fs_suid_dumpable</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>fs.suid_dumpable</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.suid_dumpable=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.suid_dumpable = 0</pre></p>
<h4>Rationale</h4>
<p>The core dump of a setuid program is more likely to contain
sensitive data, as the program itself runs with greater privileges than the
user who initiated execution of the program.  Disabling the ability for any
setuid program to write a core file decreases the risk of unauthorized access
of such data.</p>
</div>

<div id="sysctl_kernel_core_pattern" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable storing core dumps</h3>
<div>sysctl_kernel_core_pattern</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.core_pattern</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.core_pattern=|/bin/false</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.core_pattern = |/bin/false</pre></p>
<h4>Rationale</h4>
<p>A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.</p>
</div>

<div id="sysctl_kernel_core_pattern_empty_string" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable storing core dumps</h3>
<div>sysctl_kernel_core_pattern_empty_string</div>
<h4>Description</h4>
<p>The <tt>kernel.core_pattern</tt> option specifies the core dumpfile pattern
name. It can be set to an empty string. In this case, the kernel
behaves differently based on another related option. If
<tt>kernel.core_uses_pid</tt> is set to <tt>1</tt>, then a file named as
<tt>.PID</tt> (where <tt>PID</tt> is process ID of the crashed process) is
created in the working directory. If <tt>kernel.core_uses_pid</tt> is set to
<tt>0</tt>, no coredump is saved.
To set the runtime status of the <code>kernel.core_pattern</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w kernel.core_pattern=</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>kernel.core_pattern = </pre></p>
<h4>Rationale</h4>
<p>A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.</p>
</div>

<div id="sysctl_kernel_core_uses_pid" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure file name of core dumps</h3>
<div>sysctl_kernel_core_uses_pid</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.core_uses_pid</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.core_uses_pid=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.core_uses_pid = 0</pre></p>
<h4>Rationale</h4>
<p>The default coredump filename is <tt>core</tt>. By setting
<tt>core_uses_pid</tt> to <tt>1</tt>, the coredump filename becomes
<tt>core.PID</tt>. If <tt>core_pattern</tt> does not include
<tt>%p</tt> (default does not) and <tt>core_uses_pid</tt> is set, then
<tt>.PID</tt> will be appended to the filename.
When combined with <tt>kernel.core_pattern = ""</tt> configuration, it
is ensured that no core dumps are generated and also no confusing error
messages are printed by a shell.</p>
</div>

<div id="sysctl_kernel_dmesg_restrict" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict Access to Kernel Message Buffer</h3>
<div>sysctl_kernel_dmesg_restrict</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.dmesg_restrict</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.dmesg_restrict=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.dmesg_restrict = 1</pre></p>
<h4>Rationale</h4>
<p>Unprivileged access to the kernel syslog can expose sensitive kernel
address information.</p>
</div>

<div id="sysctl_kernel_exec_shield" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable ExecShield via sysctl</h3>
<div>sysctl_kernel_exec_shield</div>
<h4>Description</h4>
<p>By default on Red Hat Enterprise Linux 9 64-bit systems, ExecShield is
enabled and can only be disabled if the hardware does not support
ExecShield or is disabled in <tt>/etc/default/grub</tt>.</p>
<h4>Rationale</h4>
<p>ExecShield uses the segmentation feature on all x86 systems to prevent
execution in memory higher than a certain address. It writes an address as
a limit in the code segment descriptor, to control where code can be
executed, on a per-process basis. When the kernel places a process's memory
regions such as the stack and heap higher than this address, the hardware
prevents execution in that address range. This is enabled by default on the
latest Red Hat and Fedora systems if supported by the hardware.</p>
</div>

<div id="sysctl_kernel_kexec_load_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Image Loading</h3>
<div>sysctl_kernel_kexec_load_disabled</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.kexec_load_disabled</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.kexec_load_disabled=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.kexec_load_disabled = 1</pre></p>
<h4>Rationale</h4>
<p>Disabling kexec_load allows greater control of the kernel memory.
It makes it impossible to load another kernel image after it has been disabled.
</p>
</div>

<div id="sysctl_kernel_kptr_restrict" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict Exposed Kernel Pointer Addresses Access</h3>
<div>sysctl_kernel_kptr_restrict</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.kptr_restrict</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.kptr_restrict=<tt>$sysctl_kernel_kptr_restrict_value</tt></pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.kptr_restrict = <tt>$sysctl_kernel_kptr_restrict_value</tt></pre></p>
<h4>Rationale</h4>
<p>Exposing kernel pointers (through procfs or <tt>seq_printf()</tt>) exposes kernel
writeable structures which may contain functions pointers. If a write vulnerability
occurs in the kernel, allowing write access to any of this structure, the kernel can
be compromised. This option disallow any program without the CAP_SYSLOG capability
to get the addresses of kernel pointers by replacing them with 0.</p>
</div>

<div id="sysctl_kernel_modules_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable loading and unloading of kernel modules</h3>
<div>sysctl_kernel_modules_disabled</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.modules_disabled</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.modules_disabled=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.modules_disabled = 1</pre></p>
<h4>Rationale</h4>
<p>Malicious kernel modules can have a significant impact on system security and
availability. Disabling loading of kernel modules prevents this threat. Note
that once this option has been set, it cannot be reverted without doing a
system reboot. Make sure that all needed kernel modules are loaded before
setting this option.</p>
</div>

<div id="sysctl_kernel_panic_on_oops" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Kernel panic on oops</h3>
<div>sysctl_kernel_panic_on_oops</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.panic_on_oops</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.panic_on_oops=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.panic_on_oops = 1</pre></p>
<h4>Rationale</h4>
<p>An attacker trying to exploit the kernel may trigger kernel OOPSes,
panicking the system will impede them from continuing.</p>
</div>

<div id="sysctl_kernel_perf_cpu_time_max_percent" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit CPU consumption of the Perf system</h3>
<div>sysctl_kernel_perf_cpu_time_max_percent</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.perf_cpu_time_max_percent</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.perf_cpu_time_max_percent=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.perf_cpu_time_max_percent = 1</pre></p>
<h4>Rationale</h4>
<p>The <tt>kernel.perf_cpu_time_max_percent</tt> configures a threshold of
maximum percentile of CPU that can be used by Perf system. Restricting usage
of <tt>Perf</tt> system decreases risk of potential availability problems.</p>
</div>

<div id="sysctl_kernel_perf_event_max_sample_rate" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit sampling frequency of the Perf system</h3>
<div>sysctl_kernel_perf_event_max_sample_rate</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.perf_event_max_sample_rate</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.perf_event_max_sample_rate=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.perf_event_max_sample_rate = 1</pre></p>
<h4>Rationale</h4>
<p>The <tt>kernel.perf_event_max_sample_rate</tt> parameter configures maximum
frequency of collecting of samples for the Perf system. It is expressed in
samples per second. Restricting usage of <tt>Perf</tt> system decreases risk
of potential availability problems.</p>
</div>

<div id="sysctl_kernel_perf_event_paranoid" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disallow kernel profiling by unprivileged users</h3>
<div>sysctl_kernel_perf_event_paranoid</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.perf_event_paranoid</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.perf_event_paranoid=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.perf_event_paranoid = 2</pre></p>
<h4>Rationale</h4>
<p>Kernel profiling can reveal sensitive information about kernel behaviour.</p>
</div>

<div id="sysctl_kernel_pid_max" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure maximum number of process identifiers</h3>
<div>sysctl_kernel_pid_max</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.pid_max</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.pid_max=65536</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.pid_max = 65536</pre></p>
<h4>Rationale</h4>
<p>The <tt>kernel.pid_max</tt> parameter configures upper limit on process
identifiers (PID). If this number is not high enough, it might happen that
forking of new processes is not possible, because all available PIDs are
exhausted. Increasing this number enhances availability.</p>
</div>

<div id="sysctl_kernel_randomize_va_space" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Randomized Layout of Virtual Address Space</h3>
<div>sysctl_kernel_randomize_va_space</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.randomize_va_space</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.randomize_va_space=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.randomize_va_space = 2</pre></p>
<h4>Rationale</h4>
<p>Address space layout randomization (ASLR) makes it more difficult for an
attacker to predict the location of attack code they have introduced into a
process's address space during an attempt at exploitation. Additionally,
ASLR makes it more difficult for an attacker to know the location of
existing code in order to re-purpose it using return oriented programming
(ROP) techniques.</p>
</div>

<div id="sysctl_kernel_sysrq" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disallow magic SysRq key</h3>
<div>sysctl_kernel_sysrq</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.sysrq</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.sysrq=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.sysrq = 0</pre></p>
<h4>Rationale</h4>
<p>The Magic SysRq key allows sending certain commands directly to the running
kernel. It can dump various system and process information, potentially
revealing sensitive information. It can also reboot or shutdown the machine,
disturbing its availability.</p>
</div>

<div id="sysctl_kernel_unprivileged_bpf_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Access to Network bpf() Syscall From Unprivileged Processes</h3>
<div>sysctl_kernel_unprivileged_bpf_disabled</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.unprivileged_bpf_disabled</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.unprivileged_bpf_disabled=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.unprivileged_bpf_disabled = 1</pre></p>
<h4>Rationale</h4>
<p>Loading and accessing the packet filters programs and maps using the bpf()
syscall has the potential of revealing sensitive information about the kernel state.</p>
</div>

<div id="sysctl_kernel_unprivileged_bpf_disabled_accept_default" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Access to Network bpf() Syscall From Unprivileged Processes</h3>
<div>sysctl_kernel_unprivileged_bpf_disabled_accept_default</div>
<h4>Description</h4>
<p>To prevent unprivileged processes from using the <code>bpf()</code> syscall
the <code>kernel.unprivileged_bpf_disabled</code> kernel parameter must
be set to <code>1</code> or <code>2</code>.

Writing <code>1</code> to this entry will disable unprivileged calls to <code>bpf()</code>; once
disabled, calling <code>bpf()</code> without <code>CAP_SYS_ADMIN</code> or <code>CAP_BPF</code> will return <code>-EPERM</code>.
Once set to <code>1</code>, this can't be cleared from the running kernel anymore.

To set the runtime status of the <code>kernel.unprivileged_bpf_disabled</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w kernel.unprivileged_bpf_disabled=1</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>kernel.unprivileged_bpf_disabled = 1</pre>

Writing <code>2</code> to this entry will also disable unprivileged calls to <code>bpf()</code>,
however, an admin can still change this setting later on, if needed, by
writing <code>0</code> or <code>1</code> to this entry.

To set the runtime status of the <code>kernel.unprivileged_bpf_disabled</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w kernel.unprivileged_bpf_disabled=2</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>kernel.unprivileged_bpf_disabled = 2</pre></p>
<h4>Rationale</h4>
<p>Loading and accessing the packet filters programs and maps using the bpf()
syscall has the potential of revealing sensitive information about the kernel state.</p>
</div>

<div id="sysctl_kernel_yama_ptrace_scope" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict usage of ptrace to descendant processes</h3>
<div>sysctl_kernel_yama_ptrace_scope</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>kernel.yama.ptrace_scope</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.yama.ptrace_scope=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.yama.ptrace_scope = 1</pre></p>
<h4>Rationale</h4>
<p>Unrestricted usage of ptrace allows compromised binaries to run ptrace
on another processes of the user. Like this, the attacker can steal
sensitive information from the target processes (e.g. SSH sessions, web browser, ...)
without any additional assistance from the user (i.e. without resorting to phishing).
</p>
</div>

<div id="sysctl_net_core_bpf_jit_harden" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Harden the operation of the BPF just-in-time compiler</h3>
<div>sysctl_net_core_bpf_jit_harden</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.core.bpf_jit_harden</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.core.bpf_jit_harden=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.core.bpf_jit_harden = 2</pre></p>
<h4>Rationale</h4>
<p>When hardened, the extended Berkeley Packet Filter just-in-time compiler
will randomize any kernel addresses in the BPF programs and maps,
and will not expose the JIT addresses in <tt>/proc/kallsyms</tt>.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_accept_local" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Accepting Packets Routed Between Local Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_accept_local</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.accept_local</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_local=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_local = 0</pre></p>
<h4>Rationale</h4>
<p>Configure <tt>net.ipv4.conf.all.accept_local=0</tt> to consider as invalid the packets
received from outside whose source is the 127.0.0.0/8 address block.
In combination with suitable routing, this can be used to direct packets between two
local interfaces over the wire and have them accepted properly.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_accept_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Accepting ICMP Redirects for All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_accept_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />
This feature of the IPv4 protocol has few legitimate uses. It should be
disabled unless absolutely required."</p>
</div>

<div id="sysctl_net_ipv4_conf_all_accept_source_route" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_accept_source_route</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_source_route = 0</pre></p>
<h4>Rationale</h4>
<p>Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures. This requirement
applies only to the forwarding of source-routerd traffic, such as when IPv4
forwarding is enabled and the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_arp_filter" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure ARP filtering for All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_arp_filter</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.arp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.arp_filter=<tt>$sysctl_net_ipv4_conf_all_arp_filter_value</tt></pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.arp_filter = <tt>$sysctl_net_ipv4_conf_all_arp_filter_value</tt></pre></p>
<h4>Rationale</h4>
<p>Prevents the Linux Kernel from handling the ARP table globally.
By default, the kernel may respond to an ARP request from a certain interface with information
from another interface.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_arp_ignore" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Response Mode of ARP Requests for All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_arp_ignore</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.arp_ignore</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.arp_ignore=<tt>$sysctl_net_ipv4_conf_all_arp_ignore_value</tt></pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.arp_ignore = <tt>$sysctl_net_ipv4_conf_all_arp_ignore_value</tt></pre></p>
<h4>Rationale</h4>
<p>Avoids ARP Flux on system that have more than one interface on the same subnet.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_drop_gratuitous_arp" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Drop Gratuitous ARP frames on All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_drop_gratuitous_arp</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.drop_gratuitous_arp</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.drop_gratuitous_arp=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.drop_gratuitous_arp = 1</pre></p>
<h4>Rationale</h4>
<p>Drop Gratuitous ARP frames to prevent ARP poisoning.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_forwarding" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for IPv4 Forwarding on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_forwarding</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.forwarding = 0</pre></p>
<h4>Rationale</h4>
<p>IP forwarding permits the kernel to forward packets from one network
interface to another. The ability to forward packets between two networks is
only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_log_martians" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_log_martians</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.log_martians = 1</pre></p>
<h4>Rationale</h4>
<p>The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_route_localnet" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Prevent Routing External Traffic to Local Loopback on All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_route_localnet</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.route_localnet</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.route_localnet=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.route_localnet = 0</pre></p>
<h4>Rationale</h4>
<p>Refuse the routing of packets whose source or destination address is the local loopback.
This prohibits the use of network 127/8 for local routing purposes.
Enabling <tt>route_localnet</tt> can expose applications listening on localhost to external traffic.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_rp_filter" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_rp_filter</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.rp_filter = 1</pre></p>
<h4>Rationale</h4>
<p>Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_secure_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_secure_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.secure_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_send_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_send_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.send_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv4_conf_all_shared_media" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Sending and Accepting Shared Media Redirects for All IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_all_shared_media</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.all.shared_media</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.shared_media=<tt>$sysctl_net_ipv4_conf_all_shared_media_value</tt></pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.shared_media = <tt>$sysctl_net_ipv4_conf_all_shared_media_value</tt></pre></p>
<h4>Rationale</h4>
<p>This setting should be aligned with <tt>net.ipv4.conf.all.secure_redirects</tt> because it overrides it.
If <tt>shared_media</tt> is enabled for an interface <tt>secure_redirects</tt> will be enabled too.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_accept_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_conf_default_accept_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />This feature of the IPv4 protocol has few legitimate uses. It should
be disabled unless absolutely required.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_accept_source_route" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default</h3>
<div>sysctl_net_ipv4_conf_default_accept_source_route</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_source_route = 0</pre></p>
<h4>Rationale</h4>
<p>Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures.
<br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required, such as when
IPv4 forwarding is enabled and the system is legitimately functioning as a
router.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_forwarding" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for IPv4 Forwarding By Default</h3>
<div>sysctl_net_ipv4_conf_default_forwarding</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.forwarding = 0</pre></p>
<h4>Rationale</h4>
<p>IP forwarding permits the kernel to forward packets from one network
interface to another. The ability to forward packets between two networks is
only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_log_martians" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces by Default</h3>
<div>sysctl_net_ipv4_conf_default_log_martians</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.log_martians = 1</pre></p>
<h4>Rationale</h4>
<p>The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_rp_filter" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default</h3>
<div>sysctl_net_ipv4_conf_default_rp_filter</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.rp_filter = 1</pre></p>
<h4>Rationale</h4>
<p>Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_secure_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Kernel Parameter for Accepting Secure Redirects By Default</h3>
<div>sysctl_net_ipv4_conf_default_secure_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.secure_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_send_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default</h3>
<div>sysctl_net_ipv4_conf_default_send_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.send_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv4_conf_default_shared_media" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Sending and Accepting Shared Media Redirects by Default</h3>
<div>sysctl_net_ipv4_conf_default_shared_media</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.conf.default.shared_media</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.shared_media=<tt>$sysctl_net_ipv4_conf_default_shared_media_value</tt></pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.shared_media = <tt>$sysctl_net_ipv4_conf_default_shared_media_value</tt></pre></p>
<h4>Rationale</h4>
<p>This setting should be aligned with <tt>net.ipv4.conf.default.secure_redirects</tt> because it overrides it.
If <tt>shared_media</tt> is enabled for an interface <tt>secure_redirects</tt> will be enabled too.</p>
</div>

<div id="sysctl_net_ipv4_icmp_echo_ignore_broadcasts" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_icmp_echo_ignore_broadcasts</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.icmp_echo_ignore_broadcasts</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_echo_ignore_broadcasts = 1</pre></p>
<h4>Rationale</h4>
<p>Responding to broadcast (ICMP) echoes facilitates network mapping
and provides a vector for amplification attacks.
<br />
Ignoring ICMP echo requests (pings) sent to broadcast or multicast
addresses makes the system slightly more difficult to enumerate on the network.</p>
</div>

<div id="sysctl_net_ipv4_icmp_ignore_bogus_error_responses" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_icmp_ignore_bogus_error_responses</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.icmp_ignore_bogus_error_responses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_ignore_bogus_error_responses = 1</pre></p>
<h4>Rationale</h4>
<p>Ignoring bogus ICMP error responses reduces
log size, although some activity would not be logged.</p>
</div>

<div id="sysctl_net_ipv4_ip_forward" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_ip_forward</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.ip_forward</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.ip_forward=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.ip_forward = 0</pre></p>
<h4>Rationale</h4>
<p>Routing protocol daemons are typically used on routers to exchange
network topology information with other routers. If this capability is used when
not required, system network information may be unnecessarily transmitted across
the network.</p>
</div>

<div id="sysctl_net_ipv4_ip_local_port_range" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Kernel Parameter to Increase Local Port Range</h3>
<div>sysctl_net_ipv4_ip_local_port_range</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.ip_local_port_range</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.ip_local_port_range=32768 65535</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.ip_local_port_range = 32768 65535</pre></p>
<h4>Rationale</h4>
<p>This setting defines the local port range that is used by TCP and UDP to
choose the local port. The first number is the first, the second the last
local port number.</p>
</div>

<div id="sysctl_net_ipv4_tcp_invalid_ratelimit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Kernel to Rate Limit Sending of Duplicate TCP Acknowledgments</h3>
<div>sysctl_net_ipv4_tcp_invalid_ratelimit</div>
<h4>Description</h4>
<p>Make sure that the system is configured to limit the maximal rate for sending
duplicate acknowledgments in response to incoming TCP packets that are for
an existing connection but that are invalid due to any of these reasons:

(a) out-of-window sequence number, (b) out-of-window acknowledgment number,
or (c) PAWS (Protection Against Wrapped Sequence numbers) check failure
This measure protects against or limits effects of DoS attacks against the system.
Set the system to implement rate-limiting measures by adding the following line to
<tt>/etc/sysctl.conf</tt> or a configuration file in the <tt>/etc/sysctl.d/</tt> directory
(or modify the line to have the required value):
<pre>net.ipv4.tcp_invalid_ratelimit = <tt>$sysctl_net_ipv4_tcp_invalid_ratelimit_value</tt></pre>
Issue the following command to make the changes take effect:
<pre># sysctl --system</pre></p>
<h4>Rationale</h4>
<p>Denial of Service (DoS) is a condition when a resource is not available for legitimate users. When
this occurs, the organization either cannot accomplish its mission or must
operate at degraded capacity.
<br /><br />
This can help mitigate simple “ack loop” DoS attacks, wherein a buggy or
malicious middlebox or man-in-the-middle can rewrite TCP header fields in
manner that causes each endpoint to think that the other is sending invalid
TCP segments, thus causing each side to send an unterminating stream of
duplicate acknowledgments for invalid segments.</p>
</div>

<div id="sysctl_net_ipv4_tcp_rfc1337" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Use TCP RFC 1337 on IPv4 Interfaces</h3>
<div>sysctl_net_ipv4_tcp_rfc1337</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.tcp_rfc1337</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_rfc1337=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.tcp_rfc1337 = 1</pre></p>
<h4>Rationale</h4>
<p>Enable TCP behavior conformant with RFC 1337. When disabled, if a RST is
received in TIME_WAIT state, we close the socket immediately without waiting
for the end of the TIME_WAIT period.</p>
</div>

<div id="sysctl_net_ipv4_tcp_syncookies" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Kernel Parameter to Use TCP Syncookies on Network Interfaces</h3>
<div>sysctl_net_ipv4_tcp_syncookies</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv4.tcp_syncookies</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_syncookies=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.tcp_syncookies = 1</pre></p>
<h4>Rationale</h4>
<p>A TCP SYN flood attack can cause a denial of service by filling a
system's TCP connection table with connections in the SYN_RCVD state.
Syncookies can be used to track a connection when a subsequent ACK is received,
verifying the initiator is attempting a valid connection and is not a flood
source. This feature is activated when a flood condition is detected, and
enables the system to continue servicing valid connection requests.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_ra" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Router Advertisements on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_ra</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_ra_defrtr" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Default Router in Router Advertisements on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_ra_defrtr</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_ra_defrtr</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra_defrtr=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra_defrtr = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_ra_pinfo" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Prefix Information in Router Advertisements on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_ra_pinfo</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_ra_pinfo</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra_pinfo=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra_pinfo = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_ra_rtr_pref" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Router Preference in Router Advertisements on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_ra_rtr_pref</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_ra_rtr_pref</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra_rtr_pref=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra_rtr_pref = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Accepting ICMP Redirects for All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit ICMP redirect message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_accept_source_route" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_accept_source_route</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_source_route = 0</pre></p>
<h4>Rationale</h4>
<p>Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_autoconf" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Auto Configuration on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_autoconf</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.autoconf</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.autoconf=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.autoconf = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_disable_ipv6" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable IPv6 Addressing on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_disable_ipv6</div>
<h4>Description</h4>
<p>To disable support for (<tt>ipv6</tt>) addressing on all interface add the following line to
<tt>/etc/sysctl.d/ipv6.conf</tt> (or another file in <tt>/etc/sysctl.d</tt>):
<pre>net.ipv6.conf.all.disable_ipv6 = 1</pre>
This disables IPv6 on all network interfaces as other services and system
functionality require the IPv6 stack loaded to work.</p>
<h4>Rationale</h4>
<p>Any unnecessary network stacks - including IPv6 - should be disabled, to reduce
the vulnerability to exploitation.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_forwarding" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for IPv6 Forwarding</h3>
<div>sysctl_net_ipv6_conf_all_forwarding</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.forwarding = 0</pre></p>
<h4>Rationale</h4>
<p>IP forwarding permits the kernel to forward packets from one network
interface to another. The ability to forward packets between two networks is
only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_max_addresses" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Maximum Number of Autoconfigured Addresses on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_max_addresses</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.max_addresses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.max_addresses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.max_addresses = 1</pre></p>
<h4>Rationale</h4>
<p>The number of global unicast IPv6 addresses for each interface should be limited exactly to the number of statically configured addresses.</p>
</div>

<div id="sysctl_net_ipv6_conf_all_router_solicitations" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Denying Router Solicitations on All IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_all_router_solicitations</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.all.router_solicitations</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.router_solicitations=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.router_solicitations = 0</pre></p>
<h4>Rationale</h4>
<p>To prevent discovery of the system by other systems, router solicitation requests should be denied.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_ra" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Accepting Router Advertisements on all IPv6 Interfaces by Default</h3>
<div>sysctl_net_ipv6_conf_default_accept_ra</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_ra_defrtr" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Default Router in Router Advertisements on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_accept_ra_defrtr</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_ra_defrtr</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra_defrtr=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra_defrtr = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_ra_pinfo" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Prefix Information in Router Advertisements on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_accept_ra_pinfo</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_ra_pinfo</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra_pinfo=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra_pinfo = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_ra_rtr_pref" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Accepting Router Preference in Router Advertisements on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_accept_ra_rtr_pref</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_ra_rtr_pref</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra_rtr_pref=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra_rtr_pref = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_redirects" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces</h3>
<div>sysctl_net_ipv6_conf_default_accept_redirects</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_redirects = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit ICMP redirect message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_accept_source_route" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default</h3>
<div>sysctl_net_ipv6_conf_default_accept_source_route</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_source_route = 0</pre></p>
<h4>Rationale</h4>
<p>Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.

Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_autoconf" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Auto Configuration on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_autoconf</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.autoconf</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.autoconf=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.autoconf = 0</pre></p>
<h4>Rationale</h4>
<p>An illicit router advertisement message could result in a man-in-the-middle attack.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_disable_ipv6" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable IPv6 Addressing on IPv6 Interfaces by Default</h3>
<div>sysctl_net_ipv6_conf_default_disable_ipv6</div>
<h4>Description</h4>
<p>To disable support for (<tt>ipv6</tt>) addressing on interfaces by default add the following line to
<tt>/etc/sysctl.d/ipv6.conf</tt> (or another file in <tt>/etc/sysctl.d</tt>):
<pre>net.ipv6.conf.default.disable_ipv6 = 1</pre>
This disables IPv6 on network interfaces by default as other services and system
functionality require the IPv6 stack loaded to work.</p>
<h4>Rationale</h4>
<p>Any unnecessary network stacks - including IPv6 - should be disabled, to reduce
the vulnerability to exploitation.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_forwarding" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Kernel Parameter for IPv6 Forwarding by default</h3>
<div>sysctl_net_ipv6_conf_default_forwarding</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.forwarding = 0</pre></p>
<h4>Rationale</h4>
<p>IP forwarding permits the kernel to forward packets from one network
interface to another. The ability to forward packets between two networks is
only appropriate for systems acting as routers.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_max_addresses" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Maximum Number of Autoconfigured Addresses on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_max_addresses</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.max_addresses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.max_addresses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.max_addresses = 1</pre></p>
<h4>Rationale</h4>
<p>The number of global unicast IPv6 addresses for each interface should be limited exactly to the number of statically configured addresses.</p>
</div>

<div id="sysctl_net_ipv6_conf_default_router_solicitations" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Denying Router Solicitations on All IPv6 Interfaces By Default</h3>
<div>sysctl_net_ipv6_conf_default_router_solicitations</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>net.ipv6.conf.default.router_solicitations</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.router_solicitations=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.router_solicitations = 0</pre></p>
<h4>Rationale</h4>
<p>To prevent discovery of the system by other systems, router solicitation requests should be denied.</p>
</div>

<div id="sysctl_user_max_user_namespaces" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the use of user namespaces</h3>
<div>sysctl_user_max_user_namespaces</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>user.max_user_namespaces</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w user.max_user_namespaces=0</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>user.max_user_namespaces = 0</pre>
When containers are deployed on the machine, the value should be set
to large non-zero value.</p>
<h4>Rationale</h4>
<p>It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or system objectives.
These unnecessary capabilities or services are often overlooked and therefore may remain unsecured.
They increase the risk to the platform by providing additional attack vectors.
User namespaces are used primarily for Linux containers. The value 0
disallows the use of user namespaces.</p>
</div>

<div id="sysctl_user_max_user_namespaces_no_remediation" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the use of user namespaces</h3>
<div>sysctl_user_max_user_namespaces_no_remediation</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>user.max_user_namespaces</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w user.max_user_namespaces=0</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>user.max_user_namespaces = 0</pre>
When containers are deployed on the machine, the value should be set
to large non-zero value.</p>
<h4>Rationale</h4>
<p>It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or system objectives.
These unnecessary capabilities or services are often overlooked and therefore may remain unsecured.
They increase the risk to the platform by providing additional attack vectors.
User namespaces are used primarily for Linux containers. The value 0
disallows the use of user namespaces.</p>
</div>

<div id="sysctl_vm_mmap_min_addr" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Prevent applications from mapping low portion of virtual memory</h3>
<div>sysctl_vm_mmap_min_addr</div>
<h4>Description</h4>
<p>To set the runtime status of the <code>vm.mmap_min_addr</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w vm.mmap_min_addr=65536</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>vm.mmap_min_addr = 65536</pre></p>
<h4>Rationale</h4>
<p>The <tt>vm.mmap_min_addr</tt> parameter specifies the minimum virtual
address that a process is allowed to mmap. Allowing a process to mmap low
portion of virtual memory can have security implications such as such as
heightened risk of kernel null pointer dereference defects.</p>
</div>




</body>
</html>