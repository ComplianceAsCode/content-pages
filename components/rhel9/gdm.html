<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8"/>
  <title>Rules Related To 'gdm'</title>
  
<style>
</style>
</head>
<body>



<h1>Rules Related To 'gdm'</h1>





<h2>Component overview</h2>

<h3>Relevant packages:</h3>

<ul>

<li>gdm</li>

</ul>


<h3>Relevant groups:</h3>

<ul>

<li>gui_login_banner</li>

</ul>


<h3>Changelog:</h3>

<div>No changes recorded.</div>


<h3>Relevant rules:</h3>

<ul>

<li><a href="#banner_etc_gdm_banner">banner_etc_gdm_banner</a></li>

<li><a href="#dconf_gnome_banner_enabled">dconf_gnome_banner_enabled</a></li>

<li><a href="#dconf_gnome_login_banner_text">dconf_gnome_login_banner_text</a></li>

<li><a href="#gui_login_dod_acknowledgement">gui_login_dod_acknowledgement</a></li>

<li><a href="#package_gdm_removed">package_gdm_removed</a></li>

<li><a href="#xwayland_disabled">xwayland_disabled</a></li>

</ul>



<h2>Rule details</h2>


<div id="banner_etc_gdm_banner" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Modify the System GUI Login Banner</h3>
<div>banner_etc_gdm_banner</div>
<h4>Description</h4>
<p>To configure the GUI system login banner edit <tt>/etc/gdm/banner</tt>.
Replace the default text with a message compliant with the local site
policy or a legal disclaimer.

The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.</p>
</div>

<div id="dconf_gnome_banner_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable GNOME3 Login Warning Banner</h3>
<div>dconf_gnome_banner_enabled</div>
<h4>Description</h4>
<p>In the default graphical environment, displaying a login warning banner
in the GNOME Display Manager's login screen can be enabled on the login
screen by setting <tt>banner-message-enable</tt> to <tt>true</tt>.
<br /><br />
To enable, add or edit <tt>banner-message-enable</tt> to
<tt>/etc/dconf/db/distro.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
banner-message-enable=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/distro.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/banner-message-enable</pre>
After the settings have been set, run <tt>dconf update</tt>.
The banner text must also be set.</p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting access to the operating system
ensures privacy and security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.
<br /><br />
For U.S. Government systems, system use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not exist.</p>
</div>

<div id="dconf_gnome_login_banner_text" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set the GNOME3 Login Warning Banner Text</h3>
<div>dconf_gnome_login_banner_text</div>
<h4>Description</h4>
<p>In the default graphical environment, configuring the login warning banner text
in the GNOME Display Manager's login screen can be configured on the login
screen by setting <tt>banner-message-text</tt> to <tt>'<i>APPROVED_BANNER</i>'</tt>
where <i>APPROVED_BANNER</i> is the approved banner for your environment.
<br /><br />
To enable, add or edit <tt>banner-message-text</tt> to

<tt>/etc/dconf/db/distro.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
banner-message-text='<i>APPROVED_BANNER</i>'</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/distro.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/banner-message-text</pre>

After the settings have been set, run <tt>dconf update</tt>.
When entering a warning banner that spans several lines, remember
to begin and end the string with <tt>'</tt> and use <tt>\n</tt> for new lines.</p>
<h4>Rationale</h4>
<p>An appropriate warning message reinforces policy awareness during the logon
process and facilitates possible legal action against attackers.</p>
</div>

<div id="gui_login_dod_acknowledgement" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Display the Standard Mandatory DoD Notice and Consent Banner until Explicit Acknowledgement</h3>
<div>gui_login_dod_acknowledgement</div>
<h4>Description</h4>
<p>Display of a standardized and approved use notification before granting access to the SUSE operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.<br/><br/>

The banner must be acknowledged by the user prior to allowing the user access to the SUSE operating system. This provides assurance that the user has seen the message and accepted the conditions for access. If the consent banner is not acknowledged by the user, DoD will not be in compliance with system use notifications required by law.<br/><br/>

System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.<br/><br/>

The banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for the SUSE operating system:

<pre>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</pre>

Check the configuration by running the following command:

<pre># more /etc/gdm/Xsession</pre>

The beginning of the file must contain the following text immediately after <tt>#!/bin/sh</tt>:

<pre>if ! zenity --text-info \
--title "Consent" \
--filename=/etc/gdm/banner \
--no-markup \
--checkbox="Accept." 10 10; then
sleep 1;
exit 1;
fi</pre></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting access to the operating system
ensures privacy and security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.
<br /><br />
For U.S. Government systems, system use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not exist.</p>
</div>

<div id="package_gdm_removed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Remove the GDM Package Group</h3>
<div>package_gdm_removed</div>
<h4>Description</h4>
<p>
By removing the <tt>gdm</tt> package, the system no longer has GNOME installed.

If X Windows is not installed then the system cannot boot into graphical user mode.
This prevents the system from being accidentally or maliciously booted into a <tt>graphical.target</tt>
mode. To do so, run the following command:

<pre>$ sudo yum remove gdm</pre></p>
<h4>Rationale</h4>
<p>Unnecessary service packages must not be installed to decrease the attack surface of the system.
A graphical environment is unnecessary for certain types of systems including a virtualization
hypervisor.</p>
</div>

<div id="xwayland_disabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable XWayland</h3>
<div>xwayland_disabled</div>
<h4>Description</h4>
<p>Edit the file <tt>/etc/gdm/custom.conf</tt> and add or modify the following line in the
<tt>[daemon]</tt> block:
<pre>
[daemon]
WaylandEnable=false
</pre>
<p>
This will disable XWayland support in GDM.
</p></p>
<h4>Rationale</h4>
<p>XWayland is a compatibility layer for running X11 applications on Wayland.
It is not secure and should be disabled. Wayland's security benefits from not relying on X11's network listener. Without X11,
there's no network listener, making it harder for malicious actors to exploit vulnerabilities
in X11. However, enabling Xwayland (running X11 applications on Wayland) introduces
X11's security concerns.
All X vulnerabilities apply to Xwayland, including keylogging, but they only affect X
windows and interactions with them.
Malware can potentially exploit Xwayland vulnerabilities to keylog or intercept other
input events.</p>
</div>




</body>
</html>