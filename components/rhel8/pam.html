<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8"/>
  <title>Rules Related To 'pam'</title>
  
<style>
</style>
</head>
<body>



<h1>Rules Related To 'pam'</h1>





<h2>Component overview</h2>

<h3>Relevant packages:</h3>

<ul>

<li>pam</li>

<li>pam_apparmor</li>

<li>libnss-sss</li>

<li>libpam-runtime</li>

<li>libpam-modules</li>

<li>libpam-sss</li>

</ul>


<h3>Relevant groups:</h3>

<ul>

<li>account_expiration</li>

<li>accounts</li>

<li>accounts-banners</li>

<li>password_expiration</li>

<li>password_quality</li>

<li>password_quality_pamcracklib</li>

</ul>


<h3>Changelog:</h3>

<div>No changes recorded.</div>


<h3>Relevant rules:</h3>

<ul>

<li><a href="#account_disable_inactivity_password_auth">account_disable_inactivity_password_auth</a></li>

<li><a href="#account_disable_inactivity_system_auth">account_disable_inactivity_system_auth</a></li>

<li><a href="#account_disable_post_pw_expiration">account_disable_post_pw_expiration</a></li>

<li><a href="#account_emergency_admin">account_emergency_admin</a></li>

<li><a href="#account_emergency_expire_date">account_emergency_expire_date</a></li>

<li><a href="#account_password_pam_faillock_password_auth">account_password_pam_faillock_password_auth</a></li>

<li><a href="#account_password_pam_faillock_system_auth">account_password_pam_faillock_system_auth</a></li>

<li><a href="#account_password_selinux_faillock_dir">account_password_selinux_faillock_dir</a></li>

<li><a href="#account_passwords_pam_faillock_audit">account_passwords_pam_faillock_audit</a></li>

<li><a href="#account_passwords_pam_faillock_dir">account_passwords_pam_faillock_dir</a></li>

<li><a href="#accounts_passwords_pam_tally2_file">accounts_passwords_pam_tally2_file</a></li>

<li><a href="#accounts_passwords_pam_tally2_file_selinux">accounts_passwords_pam_tally2_file_selinux</a></li>

<li><a href="#account_temp_expire_date">account_temp_expire_date</a></li>

<li><a href="#account_unique_id">account_unique_id</a></li>

<li><a href="#account_unique_name">account_unique_name</a></li>

<li><a href="#account_use_centralized_automated_auth">account_use_centralized_automated_auth</a></li>

<li><a href="#accounts_logon_fail_delay">accounts_logon_fail_delay</a></li>

<li><a href="#accounts_max_concurrent_login_sessions">accounts_max_concurrent_login_sessions</a></li>

<li><a href="#accounts_maximum_age_login_defs">accounts_maximum_age_login_defs</a></li>

<li><a href="#accounts_minimum_age_login_defs">accounts_minimum_age_login_defs</a></li>

<li><a href="#accounts_no_uid_except_zero">accounts_no_uid_except_zero</a></li>

<li><a href="#accounts_password_all_shadowed">accounts_password_all_shadowed</a></li>

<li><a href="#accounts_password_all_shadowed_sha512">accounts_password_all_shadowed_sha512</a></li>

<li><a href="#accounts_password_last_change_is_in_past">accounts_password_last_change_is_in_past</a></li>

<li><a href="#accounts_password_minlen_login_defs">accounts_password_minlen_login_defs</a></li>

<li><a href="#accounts_password_pam_pwhistory_enabled">accounts_password_pam_pwhistory_enabled</a></li>

<li><a href="#accounts_password_pam_pwhistory_enforce_root">accounts_password_pam_pwhistory_enforce_root</a></li>

<li><a href="#accounts_password_pam_pwhistory_remember">accounts_password_pam_pwhistory_remember</a></li>

<li><a href="#accounts_password_pam_pwhistory_remember_password_auth">accounts_password_pam_pwhistory_remember_password_auth</a></li>

<li><a href="#accounts_password_pam_pwhistory_remember_system_auth">accounts_password_pam_pwhistory_remember_system_auth</a></li>

<li><a href="#accounts_password_pam_pwhistory_use_authtok">accounts_password_pam_pwhistory_use_authtok</a></li>

<li><a href="#accounts_password_pam_pwquality_retry">accounts_password_pam_pwquality_retry</a></li>

<li><a href="#accounts_password_pam_pwquality_enabled">accounts_password_pam_pwquality_enabled</a></li>

<li><a href="#accounts_password_pam_unix_enabled">accounts_password_pam_unix_enabled</a></li>

<li><a href="#accounts_password_pam_unix_no_remember">accounts_password_pam_unix_no_remember</a></li>

<li><a href="#accounts_password_pam_unix_authtok">accounts_password_pam_unix_authtok</a></li>

<li><a href="#accounts_password_pam_unix_rounds_password_auth">accounts_password_pam_unix_rounds_password_auth</a></li>

<li><a href="#accounts_password_pam_unix_rounds_system_auth">accounts_password_pam_unix_rounds_system_auth</a></li>

<li><a href="#accounts_password_set_max_life_existing">accounts_password_set_max_life_existing</a></li>

<li><a href="#accounts_password_set_max_life_root">accounts_password_set_max_life_root</a></li>

<li><a href="#accounts_password_set_min_life_existing">accounts_password_set_min_life_existing</a></li>

<li><a href="#accounts_password_set_warn_age_existing">accounts_password_set_warn_age_existing</a></li>

<li><a href="#accounts_password_warn_age_login_defs">accounts_password_warn_age_login_defs</a></li>

<li><a href="#accounts_passwords_pam_faildelay_delay">accounts_passwords_pam_faildelay_delay</a></li>

<li><a href="#accounts_passwords_pam_faillock_audit">accounts_passwords_pam_faillock_audit</a></li>

<li><a href="#accounts_passwords_pam_faillock_deny">accounts_passwords_pam_faillock_deny</a></li>

<li><a href="#accounts_passwords_pam_faillock_deny_root">accounts_passwords_pam_faillock_deny_root</a></li>

<li><a href="#accounts_passwords_pam_faillock_dir">accounts_passwords_pam_faillock_dir</a></li>

<li><a href="#accounts_passwords_pam_faillock_enforce_local">accounts_passwords_pam_faillock_enforce_local</a></li>

<li><a href="#accounts_passwords_pam_faillock_interval">accounts_passwords_pam_faillock_interval</a></li>

<li><a href="#accounts_passwords_pam_faillock_silent">accounts_passwords_pam_faillock_silent</a></li>

<li><a href="#accounts_passwords_pam_faillock_root_unlock_time">accounts_passwords_pam_faillock_root_unlock_time</a></li>

<li><a href="#accounts_passwords_pam_faillock_unlock_time">accounts_passwords_pam_faillock_unlock_time</a></li>

<li><a href="#accounts_passwords_pam_faillock_enabled">accounts_passwords_pam_faillock_enabled</a></li>

<li><a href="#accounts_passwords_pam_tally2">accounts_passwords_pam_tally2</a></li>

<li><a href="#accounts_passwords_pam_tally2_deny_root">accounts_passwords_pam_tally2_deny_root</a></li>

<li><a href="#accounts_passwords_pam_tally2_unlock_time">accounts_passwords_pam_tally2_unlock_time</a></li>

<li><a href="#accounts_polyinstantiated_tmp">accounts_polyinstantiated_tmp</a></li>

<li><a href="#accounts_polyinstantiated_var_tmp">accounts_polyinstantiated_var_tmp</a></li>

<li><a href="#accounts_root_gid_zero">accounts_root_gid_zero</a></li>

<li><a href="#accounts_root_path_dirs_no_write">accounts_root_path_dirs_no_write</a></li>

<li><a href="#accounts_set_post_pw_existing">accounts_set_post_pw_existing</a></li>

<li><a href="#accounts_umask_etc_login_defs">accounts_umask_etc_login_defs</a></li>

<li><a href="#accounts_umask_interactive_users">accounts_umask_interactive_users</a></li>

<li><a href="#accounts_umask_root">accounts_umask_root</a></li>

<li><a href="#accounts_users_netrc_file_permissions">accounts_users_netrc_file_permissions</a></li>

<li><a href="#accounts_users_own_home_directories">accounts_users_own_home_directories</a></li>

<li><a href="#audit_rules_privileged_commands_pam_timestamp_check">audit_rules_privileged_commands_pam_timestamp_check</a></li>

<li><a href="#authconfig_config_files_symlinks">authconfig_config_files_symlinks</a></li>

<li><a href="#banner_etc_gdm_banner">banner_etc_gdm_banner</a></li>

<li><a href="#banner_etc_issue">banner_etc_issue</a></li>

<li><a href="#banner_etc_issue_cis">banner_etc_issue_cis</a></li>

<li><a href="#banner_etc_issue_net">banner_etc_issue_net</a></li>

<li><a href="#banner_etc_issue_net_cis">banner_etc_issue_net_cis</a></li>

<li><a href="#banner_etc_motd">banner_etc_motd</a></li>

<li><a href="#banner_etc_motd_cis">banner_etc_motd_cis</a></li>

<li><a href="#banner_etc_profiled_ssh_confirm">banner_etc_profiled_ssh_confirm</a></li>

<li><a href="#coreos_disable_interactive_boot">coreos_disable_interactive_boot</a></li>

<li><a href="#cracklib_accounts_password_pam_dcredit">cracklib_accounts_password_pam_dcredit</a></li>

<li><a href="#cracklib_accounts_password_pam_difok">cracklib_accounts_password_pam_difok</a></li>

<li><a href="#cracklib_accounts_password_pam_lcredit">cracklib_accounts_password_pam_lcredit</a></li>

<li><a href="#cracklib_accounts_password_pam_minlen">cracklib_accounts_password_pam_minlen</a></li>

<li><a href="#cracklib_accounts_password_pam_ocredit">cracklib_accounts_password_pam_ocredit</a></li>

<li><a href="#cracklib_accounts_password_pam_retry">cracklib_accounts_password_pam_retry</a></li>

<li><a href="#cracklib_accounts_password_pam_ucredit">cracklib_accounts_password_pam_ucredit</a></li>

<li><a href="#disable_users_coredumps">disable_users_coredumps</a></li>

<li><a href="#disallow_bypass_password_sudo">disallow_bypass_password_sudo</a></li>

<li><a href="#display_login_attempts">display_login_attempts</a></li>

<li><a href="#enable_authselect">enable_authselect</a></li>

<li><a href="#enable_pam_namespace">enable_pam_namespace</a></li>

<li><a href="#ensure_pam_wheel_group_empty">ensure_pam_wheel_group_empty</a></li>

<li><a href="#ensure_root_access_controlled">ensure_root_access_controlled</a></li>

<li><a href="#ensure_root_password_configured">ensure_root_password_configured</a></li>

<li><a href="#ensure_shadow_group_empty">ensure_shadow_group_empty</a></li>

<li><a href="#ensure_sudo_group_restricted">ensure_sudo_group_restricted</a></li>

<li><a href="#file_groupowner_etc_issue">file_groupowner_etc_issue</a></li>

<li><a href="#file_groupowner_etc_issue_net">file_groupowner_etc_issue_net</a></li>

<li><a href="#file_groupowner_etc_motd">file_groupowner_etc_motd</a></li>

<li><a href="#file_groupownership_lastlog">file_groupownership_lastlog</a></li>

<li><a href="#file_owner_etc_issue">file_owner_etc_issue</a></li>

<li><a href="#file_owner_etc_issue_net">file_owner_etc_issue_net</a></li>

<li><a href="#file_owner_etc_motd">file_owner_etc_motd</a></li>

<li><a href="#file_ownership_home_directories">file_ownership_home_directories</a></li>

<li><a href="#file_ownership_lastlog">file_ownership_lastlog</a></li>

<li><a href="#file_permission_user_bash_history">file_permission_user_bash_history</a></li>

<li><a href="#file_permissions_etc_issue">file_permissions_etc_issue</a></li>

<li><a href="#file_permissions_etc_issue_net">file_permissions_etc_issue_net</a></li>

<li><a href="#file_permissions_etc_motd">file_permissions_etc_motd</a></li>

<li><a href="#file_permissions_lastlog">file_permissions_lastlog</a></li>

<li><a href="#group_unique_id">group_unique_id</a></li>

<li><a href="#group_unique_name">group_unique_name</a></li>

<li><a href="#groups_no_zero_gid_except_root">groups_no_zero_gid_except_root</a></li>

<li><a href="#gui_login_dod_acknowledgement">gui_login_dod_acknowledgement</a></li>

<li><a href="#install_smartcard_packages">install_smartcard_packages</a></li>

<li><a href="#no_direct_root_logins">no_direct_root_logins</a></li>

<li><a href="#no_dirs_unowned_by_root">no_dirs_unowned_by_root</a></li>

<li><a href="#no_duplicate_uids">no_duplicate_uids</a></li>

<li><a href="#no_empty_passwords">no_empty_passwords</a></li>

<li><a href="#no_empty_passwords_unix">no_empty_passwords_unix</a></li>

<li><a href="#no_invalid_shell_accounts_unlocked">no_invalid_shell_accounts_unlocked</a></li>

<li><a href="#no_legacy_plus_entries_etc_group">no_legacy_plus_entries_etc_group</a></li>

<li><a href="#no_legacy_plus_entries_etc_passwd">no_legacy_plus_entries_etc_passwd</a></li>

<li><a href="#no_legacy_plus_entries_etc_shadow">no_legacy_plus_entries_etc_shadow</a></li>

<li><a href="#no_netrc_files">no_netrc_files</a></li>

<li><a href="#no_nologin_in_shells">no_nologin_in_shells</a></li>

<li><a href="#no_password_auth_for_systemaccounts">no_password_auth_for_systemaccounts</a></li>

<li><a href="#no_rhost_files">no_rhost_files</a></li>

<li><a href="#no_root_webbrowsing">no_root_webbrowsing</a></li>

<li><a href="#no_shelllogin_for_systemaccounts">no_shelllogin_for_systemaccounts</a></li>

<li><a href="#package_nss_sss_installed">package_nss_sss_installed</a></li>

<li><a href="#package_pam_apparmor_installed">package_pam_apparmor_installed</a></li>

<li><a href="#package_pam_modules_installed">package_pam_modules_installed</a></li>

<li><a href="#package_pam_pwquality_installed">package_pam_pwquality_installed</a></li>

<li><a href="#package_pam_runtime_installed">package_pam_runtime_installed</a></li>

<li><a href="#package_pam_sss_installed">package_pam_sss_installed</a></li>

<li><a href="#package_pcsc-lite_installed">package_pcsc-lite_installed</a></li>

<li><a href="#package_screen_installed">package_screen_installed</a></li>

<li><a href="#pam_disable_automatic_configuration">pam_disable_automatic_configuration</a></li>

<li><a href="#passwd_system-auth_substack">passwd_system-auth_substack</a></li>

<li><a href="#policy_temp_passwords_immediate_change">policy_temp_passwords_immediate_change</a></li>

<li><a href="#prevent_direct_root_logins">prevent_direct_root_logins</a></li>

<li><a href="#require_singleuser_auth">require_singleuser_auth</a></li>

<li><a href="#restrict_serial_port_logins">restrict_serial_port_logins</a></li>

<li><a href="#root_path_all_dirs">root_path_all_dirs</a></li>

<li><a href="#root_path_default">root_path_default</a></li>

<li><a href="#sebool_httpd_mod_auth_pam">sebool_httpd_mod_auth_pam</a></li>

<li><a href="#securetty_root_login_console_only">securetty_root_login_console_only</a></li>

<li><a href="#service_pcscd_enabled">service_pcscd_enabled</a></li>

<li><a href="#set_password_hashing_algorithm_auth_stig">set_password_hashing_algorithm_auth_stig</a></li>

<li><a href="#set_password_hashing_algorithm_commonauth">set_password_hashing_algorithm_commonauth</a></li>

<li><a href="#set_password_hashing_algorithm_logindefs">set_password_hashing_algorithm_logindefs</a></li>

<li><a href="#set_password_hashing_algorithm_passwordauth">set_password_hashing_algorithm_passwordauth</a></li>

<li><a href="#set_password_hashing_algorithm_systemauth">set_password_hashing_algorithm_systemauth</a></li>

<li><a href="#set_password_hashing_min_rounds_logindefs">set_password_hashing_min_rounds_logindefs</a></li>

<li><a href="#set_password_hashing_yescrypt_cost_factor_logindefs">set_password_hashing_yescrypt_cost_factor_logindefs</a></li>

<li><a href="#smartcard_auth">smartcard_auth</a></li>

<li><a href="#smartcard_configure_ca">smartcard_configure_ca</a></li>

<li><a href="#smartcard_configure_cert_checking">smartcard_configure_cert_checking</a></li>

<li><a href="#smartcard_configure_crl">smartcard_configure_crl</a></li>

<li><a href="#smartcard_pam_enabled">smartcard_pam_enabled</a></li>

<li><a href="#sshd_enable_pam">sshd_enable_pam</a></li>

<li><a href="#sssd_enable_pam_services">sssd_enable_pam_services</a></li>

<li><a href="#use_pam_wheel_for_su">use_pam_wheel_for_su</a></li>

<li><a href="#use_pam_wheel_group_for_su">use_pam_wheel_group_for_su</a></li>

<li><a href="#verify_use_mappers">verify_use_mappers</a></li>

<li><a href="#vlock_installed">vlock_installed</a></li>

</ul>



<h2>Rule details</h2>


<div id="account_disable_inactivity_password_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Account Expiration Following Inactivity in password-auth</h3>
<div>account_disable_inactivity_password_auth</div>
<h4>Description</h4>
<p>Verify the account identifiers (individuals, groups, roles, and devices) are disabled after
<tt>$var_account_disable_inactivity</tt> or less days of inactivity by
checking the account inactivity value with the following command:
<pre>grep 'inactive\|pam_unix' /etc/pam.d/password-auth | grep -w auth

auth required pam_lastlog.so inactive=35
auth sufficient pam_unix.so</pre>
The line with the inactive parameter should be placed before <tt>pam_unix.so</tt> module as in
the example output.</p>
<h4>Rationale</h4>
<p>Inactive identifiers pose a risk to systems and applications because attackers may exploit an
inactive identifier and potentially obtain undetected access to the system. Owners of inactive
accounts will not notice if unauthorized access to their user account has been obtained.</p>
</div>

<div id="account_disable_inactivity_system_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Account Expiration Following Inactivity in system-auth</h3>
<div>account_disable_inactivity_system_auth</div>
<h4>Description</h4>
<p>Verify the account identifiers (individuals, groups, roles, and devices) are disabled after
<tt>$var_account_disable_inactivity</tt> or less days of inactivity by
checking the account inactivity value with the following command:
<pre>grep 'inactive\|pam_unix' /etc/pam.d/password-auth | grep -w auth

auth required pam_lastlog.so inactive=35
auth sufficient pam_unix.so</pre>
The line with the inactive parameter should be placed before <tt>pam_unix.so</tt> module as in
the example output.</p>
<h4>Rationale</h4>
<p>Inactive identifiers pose a risk to systems and applications because attackers may exploit an
inactive identifier and potentially obtain undetected access to the system. Owners of inactive
accounts will not notice if unauthorized access to their user account has been obtained.</p>
</div>

<div id="account_disable_post_pw_expiration" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Account Expiration Following Inactivity</h3>
<div>account_disable_post_pw_expiration</div>
<h4>Description</h4>
<p>To specify the number of days after a password expires (which
signifies inactivity) until an account is permanently disabled, add or correct
the following line in <tt>/etc/default/useradd</tt>:
<pre>INACTIVE=<i><tt>$var_account_disable_post_pw_expiration</tt></i></pre>
If a password is currently on the verge of expiration, then
<tt><tt>$var_account_disable_post_pw_expiration</tt></tt>
day(s) remain(s) until the account is automatically
disabled. However, if the password will not expire for another 60 days, then 60
days plus <tt><tt>$var_account_disable_post_pw_expiration</tt></tt> day(s) could
elapse until the account would be automatically disabled. See the
<tt>useradd</tt> man page for more information.</p>
<h4>Rationale</h4>
<p>Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system.
Disabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials.
Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.</p>
</div>

<div id="account_emergency_admin" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Never Automatically Remove or Disable Emergency Administrator Accounts</h3>
<div>account_emergency_admin</div>
<h4>Description</h4>
<p>Emergency accounts are privileged accounts that are established in response
to crisis situations where the need for rapid account activation is
required. Therefore, emergency account activation may bypass normal account
authorization processes. If these accounts are automatically disabled,
system maintenance during emergencies may not be possible, thus adversely
affecting system availability.

Check to see if an emergency administrator account password or account expires with the following command:

<pre># sudo chage -l [Emergency_Administrator]

Password expires:never</pre>

If <tt>Password expires</tt> or <tt>Account expires</tt> is set to anything other than <tt>never</tt>, this is a finding.</p>
<h4>Rationale</h4>
<p>Emergency accounts are different from infrequently used accounts (i.e.,
local logon accounts used by the organization's system administrators when
network or normal logon/access is not available). Infrequently used
accounts are not subject to automatic termination dates. Emergency accounts
are accounts created in response to crisis situations, usually for use by
maintenance personnel. The automatic expiration or disabling time period
may be extended as needed until the crisis is resolved; however, it must
not be extended indefinitely. A permanent account should be established for
privileged users who need long-term maintenance accounts.

To address access requirements the SUSE operating system can be integrated
with enterprise-level authentication/access mechanisms that meet or exceed
access control policy requirements.</p>
</div>

<div id="account_emergency_expire_date" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Assign Expiration Date to Emergency Accounts</h3>
<div>account_emergency_expire_date</div>
<h4>Description</h4>
<p>Emergency accounts are privileged accounts established in response to
crisis situations where the need for rapid account activation is required.
In the event emergency accounts are required, configure the system to
terminate them after a documented time period. For every emergency account,
run the following command to set an expiration date on it, substituting
<tt><i>ACCOUNT_NAME</i></tt> and <tt><i>YYYY-MM-DD</i></tt>
appropriately:
<pre>$ sudo chage -E <i>YYYY-MM-DD ACCOUNT_NAME</i></pre>
<tt><i>YYYY-MM-DD</i></tt> indicates the documented expiration date for the
account. For U.S. Government systems, the operating system must be
configured to automatically terminate these types of accounts after a
period of 72 hours.</p>
<h4>Rationale</h4>
<p>If emergency user accounts remain active when no longer needed or for
an excessive period, these accounts may be used to gain unauthorized access.
To mitigate this risk, automated termination of all emergency accounts
must be set upon account creation.
<br /></p>
</div>

<div id="account_password_pam_faillock_password_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth File.</h3>
<div>account_password_pam_faillock_password_auth</div>
<h4>Description</h4>
<p>The pam_faillock.so module must be loaded in preauth in /etc/pam.d/password-auth.</p>
<h4>Rationale</h4>
<p>If the pam_faillock.so module is not loaded the system will not correctly lockout accounts to prevent
password guessing attacks.</p>
</div>

<div id="account_password_pam_faillock_system_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth File.</h3>
<div>account_password_pam_faillock_system_auth</div>
<h4>Description</h4>
<p>The pam_faillock.so module must be loaded in preauth in /etc/pam.d/system-auth.</p>
<h4>Rationale</h4>
<p>If the pam_faillock.so module is not loaded the system will not correctly lockout accounts to prevent
password guessing attacks.</p>
</div>

<div id="account_password_selinux_faillock_dir" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>An SELinux Context must be configured for the pam_faillock.so records directory</h3>
<div>account_password_selinux_faillock_dir</div>
<h4>Description</h4>
<p>The <tt>dir</tt> configuration option in PAM pam_faillock.so module defines where the lockout
records is stored. The configured directory must have the correct SELinux context.</p>
<h4>Rationale</h4>
<p>Not having the correct SELinux context on the pam_faillock.so records directory may lead to
unauthorized access to the directory.</p>
</div>

<div id="account_passwords_pam_faillock_audit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Account Lockouts Must Be Logged</h3>
<div>account_passwords_pam_faillock_audit</div>
<h4>Description</h4>
<p>PAM faillock locks an account due to excessive password failures, this event must be logged.</p>
<h4>Rationale</h4>
<p>Without auditing of these events it may be harder or impossible to identify what an attacker did after an attack.</p>
</div>

<div id="account_passwords_pam_faillock_dir" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Account Lockouts Must Persist</h3>
<div>account_passwords_pam_faillock_dir</div>
<h4>Description</h4>
<p>By setting a `dir` in the faillock configuration account lockouts will persist across reboots.</p>
<h4>Rationale</h4>
<p>Having lockouts persist across reboots ensures that account is only unlocked by an administrator.
If the lockouts did not persist across reboots an attack could simply reboot the system to continue brute force attacks against the accounts on the system.
</p>
</div>

<div id="accounts_passwords_pam_tally2_file" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>SLEM 5 must use the default pam_tally2 tally directory.</h3>
<div>accounts_passwords_pam_tally2_file</div>
<h4>Description</h4>
<p>This rule configures the system to use default pam_tally2 tally directory</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized
system access via user password guessing, otherwise known as
brute-force attacks, is reduced. Limits are imposed by locking the account.</p>
</div>

<div id="accounts_passwords_pam_tally2_file_selinux" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>An SELinux Context must be configured for default pam_tally2 file option</h3>
<div>accounts_passwords_pam_tally2_file_selinux</div>
<h4>Description</h4>
<p>The <tt>file</tt> configuration option in PAM pam_tally2.so module defines where to keep counts.
Default is /var/log/tallylog. The configured directory must have the correct SELinux context.</p>
<h4>Rationale</h4>
<p>Not having the correct SELinux context on the pam_tally2.so file may lead to
unauthorized access to the directory.</p>
</div>

<div id="account_temp_expire_date" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Assign Expiration Date to Temporary Accounts</h3>
<div>account_temp_expire_date</div>
<h4>Description</h4>
<p>Temporary accounts are established as part of normal account activation
procedures when there is a need for short-term accounts. In the event
temporary accounts are required, configure the system to
terminate them after a documented time period. For every temporary account, run the following command to set an expiration date on
it, substituting <tt><i>USER</i></tt> and <tt><i>YYYY-MM-DD</i></tt>
appropriately:
<pre>$ sudo chage -E <i>YYYY-MM-DD USER</i></pre>
<tt><i>YYYY-MM-DD</i></tt> indicates the documented expiration date for the
account. For U.S. Government systems, the operating system must be
configured to automatically terminate these types of accounts after a
period of 72 hours.</p>
<h4>Rationale</h4>
<p>If temporary user accounts remain active when no longer needed or for
an excessive period, these accounts may be used to gain unauthorized access.
To mitigate this risk, automated termination of all temporary accounts
must be set upon account creation.
<br /></p>
</div>

<div id="account_unique_id" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure All Accounts on the System Have Unique User IDs</h3>
<div>account_unique_id</div>
<h4>Description</h4>
<p>Change user IDs (UIDs), or delete accounts, so each has a unique name.</p>
<h4>Rationale</h4>
<p>To assure accountability and prevent unauthenticated access, interactive users must be identified and authenticated to prevent potential misuse and compromise of the system.</p>
</div>

<div id="account_unique_name" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure All Accounts on the System Have Unique Names</h3>
<div>account_unique_name</div>
<h4>Description</h4>
<p>Ensure accounts on the system have unique names.

To ensure all accounts have unique names, run the following command:
<pre>$ sudo getent passwd | awk -F: '{ print $1}' | uniq -d</pre>
If a username is returned, change or delete the username.</p>
<h4>Rationale</h4>
<p>Unique usernames allow for accountability on the system.</p>
</div>

<div id="account_use_centralized_automated_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Use Centralized and Automated Authentication</h3>
<div>account_use_centralized_automated_auth</div>
<h4>Description</h4>
<p>Implement an automated system for managing user accounts that minimizes the
risk of errors, either intentional or deliberate. This system
should integrate with an existing enterprise user management system, such as
one based on Identity Management tools such as Active Directory, Kerberos,
Directory Server, etc.</p>
<h4>Rationale</h4>
<p>A comprehensive account management process that includes automation helps to
ensure the accounts designated as requiring attention are consistently and
promptly addressed. Enterprise environments make user account management
challenging and complex. A user management process requiring administrators to
manually address account management functions adds risk of potential
oversight.</p>
</div>

<div id="accounts_logon_fail_delay" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure the Logon Failure Delay is Set Correctly in login.defs</h3>
<div>accounts_logon_fail_delay</div>
<h4>Description</h4>
<p>To ensure the logon failure delay controlled by <tt>/etc/login.defs</tt> is set properly,
add or correct the <tt>FAIL_DELAY</tt> setting in <tt>/etc/login.defs</tt> to read as follows:
<pre>FAIL_DELAY <tt>$var_accounts_fail_delay</tt></pre></p>
<h4>Rationale</h4>
<p>Increasing the time between a failed authentication attempt and re-prompting to
enter credentials helps to slow a single-threaded brute force attack.</p>
</div>

<div id="accounts_max_concurrent_login_sessions" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit the Number of Concurrent Login Sessions Allowed Per User</h3>
<div>accounts_max_concurrent_login_sessions</div>
<h4>Description</h4>
<p>Limiting the number of allowed users and sessions per user can limit risks related to Denial of
Service attacks. This addresses concurrent sessions for a single account and does not address
concurrent sessions by a single user via multiple accounts. To set the number of concurrent
sessions per user add the following line in <tt>/etc/security/limits.conf</tt> or
a file under <tt>/etc/security/limits.d/</tt>:
<pre>* hard maxlogins <tt>$var_accounts_max_concurrent_login_sessions</tt></pre></p>
<h4>Rationale</h4>
<p>Limiting simultaneous user logins can insulate the system from denial of service
problems caused by excessive logins. Automated login processes operating improperly or
maliciously may result in an exceptional number of simultaneous login sessions.</p>
</div>

<div id="accounts_maximum_age_login_defs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Maximum Age</h3>
<div>accounts_maximum_age_login_defs</div>
<h4>Description</h4>
<p>To specify password maximum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MAX_DAYS <tt>$var_accounts_maximum_age_login_defs</tt></pre>
The profile requirement is <tt><tt>$var_accounts_maximum_age_login_defs</tt></tt>.</p>
<h4>Rationale</h4>
<p>Any password, no matter how complex, can eventually be cracked. Therefore, passwords
need to be changed periodically. If the operating system does not limit the lifetime
of passwords and force users to change their passwords, there is the risk that the
operating system passwords could be compromised.
<br /><br />
Setting the password maximum age ensures users are required to
periodically change their passwords. Requiring shorter password lifetimes
increases the risk of users writing down the password in a convenient
location subject to physical compromise.</p>
</div>

<div id="accounts_minimum_age_login_defs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Minimum Age</h3>
<div>accounts_minimum_age_login_defs</div>
<h4>Description</h4>
<p>To specify password minimum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MIN_DAYS <tt>$var_accounts_minimum_age_login_defs</tt></pre>
A value of 1 day is considered sufficient for many
environments.
The profile requirement is <tt><tt>$var_accounts_minimum_age_login_defs</tt></tt>.</p>
<h4>Rationale</h4>
<p>Enforcing a minimum password lifetime helps to prevent repeated password
changes to defeat the password reuse or history enforcement requirement. If
users are allowed to immediately and continually change their password,
then the password could be repeatedly changed in a short period of time to
defeat the organization's policy regarding password reuse.
<br /><br />
Setting the minimum password age protects against users cycling back to a
favorite password after satisfying the password reuse requirement.</p>
</div>

<div id="accounts_no_uid_except_zero" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Only Root Has UID 0</h3>
<div>accounts_no_uid_except_zero</div>
<h4>Description</h4>
<p>If any account other than root has a UID of 0, this misconfiguration should
be investigated and the accounts other than root should be removed or have
their UID changed.
<br />
If the account is associated with system commands or applications the UID
should be changed to one greater than "0" but less than "1000."
Otherwise assign a UID greater than "1000" that has not already been
assigned.</p>
<h4>Rationale</h4>
<p>An account has root authority if it has a UID of 0. Multiple accounts
with a UID of 0 afford more opportunity for potential intruders to
guess a password for a privileged account. Proper configuration of
sudo is recommended to afford multiple system administrators
access to root privileges in an accountable manner.</p>
</div>

<div id="accounts_password_all_shadowed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify All Account Password Hashes are Shadowed</h3>
<div>accounts_password_all_shadowed</div>
<h4>Description</h4>
<p>If any password hashes are stored in <tt>/etc/passwd</tt> (in the second field,
instead of an <tt>x</tt> or <tt>*</tt>), the cause of this misconfiguration should be
investigated. The account should have its password reset and the hash should be
properly stored, or the account should be deleted entirely.</p>
<h4>Rationale</h4>
<p>The hashes for all user account passwords should be stored in
the file <tt>/etc/shadow</tt> and never in <tt>/etc/passwd</tt>,
which is readable by all users.</p>
</div>

<div id="accounts_password_all_shadowed_sha512" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify All Account Password Hashes are Shadowed with SHA512</h3>
<div>accounts_password_all_shadowed_sha512</div>
<h4>Description</h4>
<p>Verify the operating system requires the shadow password suite
configuration be set to encrypt interactive user passwords using a strong
cryptographic hash.
Check that the interactive user account passwords are using a strong
password hash with the following command:
<pre>$ sudo cut -d: -f2 /etc/shadow
$6$kcOnRq/5$NUEYPuyL.wghQwWssXRcLRFiiru7f5JPV6GaJhNC2aK5F3PZpE/BCCtwrxRc/AInKMNX3CdMw11m9STiql12f/</pre>
Password hashes <tt>!</tt> or <tt>*</tt> indicate inactive accounts not
available for logon and are not evaluated.
If any interactive user password hash does not begin with <tt>$6</tt>,
this is a finding.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and encryption is the standard method for
protecting passwords. If passwords are not encrypted, they can be plainly read
(i.e., clear text) and easily compromised.</p>
</div>

<div id="accounts_password_last_change_is_in_past" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure all users last password change date is in the past</h3>
<div>accounts_password_last_change_is_in_past</div>
<h4>Description</h4>
<p>All users should have a password change date in the past.</p>
<h4>Rationale</h4>
<p>If a user recorded password change date is in the future then they could
bypass any set password expiration.</p>
</div>

<div id="accounts_password_minlen_login_defs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Minimum Length in login.defs</h3>
<div>accounts_password_minlen_login_defs</div>
<h4>Description</h4>
<p>To specify password length requirements for new accounts, edit the file
<tt>/etc/login.defs</tt> and add or correct the following line:
<pre>PASS_MIN_LEN <tt>$var_accounts_password_minlen_login_defs</tt></pre>
<br /><br />
The profile requirement is
<tt><tt>$var_accounts_password_minlen_login_defs</tt></tt>.
If a program consults <tt>/etc/login.defs</tt> and also another PAM module
(such as <tt>pam_pwquality</tt>) during a password change operation, then
the most restrictive must be satisfied. See PAM section for more
information about enforcing password quality requirements.</p>
<h4>Rationale</h4>
<p>Requiring a minimum password length makes password
cracking attacks more difficult by ensuring a larger
search space. However, any security benefit from an onerous requirement
must be carefully weighed against usability problems, support costs, or counterproductive
behavior that may result.</p>
</div>

<div id="accounts_password_pam_pwhistory_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify pam_pwhistory module is activated</h3>
<div>accounts_password_pam_pwhistory_enabled</div>
<h4>Description</h4>
<p>The <tt>pam_pwhistory.so</tt> module is part of the Pluggable Authentication Modules (PAM) 
framework designed to increase password security. It works by storing a history of previously 
used passwords for each user, ensuring users cannot alternate between the same passwords too frequently.
<br /><br />
This module is incompatible with Kerberos. Furthermore, its usage with <tt>NIS</tt> or <tt>LDAP</tt> is 
generally impractical, as other machines can not access local password histories.</p>
<h4>Rationale</h4>
<p>Enforcing strong passwords increases the difficulty and resources required 
for password compromise.</p>
</div>

<div id="accounts_password_pam_pwhistory_enforce_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit Password Reuse</h3>
<div>accounts_password_pam_pwhistory_enforce_root</div>
<h4>Description</h4>
<p>Do not allow root to reuse recent passwords. This can be
accomplished by using the <tt>enforce_for_root</tt> option for the
<tt>pam_pwhistory</tt> PAM modules.
<br /><br />
In the file <tt>/etc/pam.d/common-password</tt>, make sure the parameters
<tt>enforce_for_root</tt> is present.</p>
<h4>Rationale</h4>
<p>Preventing reuse of previous passwords helps ensure that a compromised password is not reused by a user.</p>
</div>

<div id="accounts_password_pam_pwhistory_remember" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit Password Reuse</h3>
<div>accounts_password_pam_pwhistory_remember</div>
<h4>Description</h4>
<p>Do not allow users to reuse recent passwords. This can be
accomplished by using the <tt>remember</tt> option for the
<tt>pam_pwhistory</tt> PAM modules.
<br /><br />
In the file <tt>/etc/pam.d/common-password</tt>, make sure the parameters
<tt>remember</tt> and <tt>use_authtok</tt> are present, and that the value
for the <tt>remember</tt> parameter is <tt>$var_password_pam_remember</tt> or greater. For example:
<pre>password requisite pam_pwhistory.so <i>...existing_options...</i> remember=<tt>$var_password_pam_remember</tt> use_authtok</pre>
The profile requirement is <tt>$var_password_pam_remember</tt> passwords.</p>
<h4>Rationale</h4>
<p>Preventing reuse of previous passwords helps ensure that a compromised password is not reused by a user.</p>
</div>

<div id="accounts_password_pam_pwhistory_remember_password_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit Password Reuse: password-auth</h3>
<div>accounts_password_pam_pwhistory_remember_password_auth</div>
<h4>Description</h4>
<p>Do not allow users to reuse recent passwords. This can be accomplished by using the
<tt>remember</tt> option for the <tt>pam_pwhistory</tt> PAM module.
<br/><br/>

On systems with newer versions of <tt>authselect</tt>, the <tt>pam_pwhistory</tt> PAM module
can be enabled via authselect feature:
<pre>authselect enable-feature with-pwhistory</pre>

Otherwise, it should be enabled using an authselect custom profile.
<br/><br/>
Newer systems also have the <tt>/etc/security/pwhistory.conf</tt> file for setting
<tt>pam_pwhistory</tt> module options. This file should be used whenever available.
Otherwise, the <tt>pam_pwhistory</tt> module options can be set in PAM files.
<br/><br/>
The value for <tt>remember</tt> option must be equal or greater than
<tt>$var_password_pam_remember</tt></p>
<h4>Rationale</h4>
<p>Preventing reuse of previous passwords helps ensure that a compromised password is not
reused by a user.</p>
</div>

<div id="accounts_password_pam_pwhistory_remember_system_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Limit Password Reuse: system-auth</h3>
<div>accounts_password_pam_pwhistory_remember_system_auth</div>
<h4>Description</h4>
<p>Do not allow users to reuse recent passwords. This can be accomplished by using the
<tt>remember</tt> option for the <tt>pam_pwhistory</tt> PAM module.
<br/><br/>

On systems with newer versions of <tt>authselect</tt>, the <tt>pam_pwhistory</tt> PAM module
can be enabled via authselect feature:
<pre>authselect enable-feature with-pwhistory</pre>

Otherwise, it should be enabled using an authselect custom profile.
<br/><br/>
Newer systems also have the <tt>/etc/security/pwhistory.conf</tt> file for setting
<tt>pam_pwhistory</tt> module options. This file should be used whenever available.
Otherwise, the <tt>pam_pwhistory</tt> module options can be set in PAM files.
<br/><br/>
The value for <tt>remember</tt> option must be equal or greater than
<tt>$var_password_pam_remember</tt></p>
<h4>Rationale</h4>
<p>Preventing reuse of previous passwords helps ensure that a compromised password is not
reused by a user.</p>
</div>

<div id="accounts_password_pam_pwhistory_use_authtok" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enforce Password History with use_authtok</h3>
<div>accounts_password_pam_pwhistory_use_authtok</div>
<h4>Description</h4>
<p>The <tt>use_authtok</tt> option ensures the pam_pwhistory module uses the new
password provided by a previously stacked PAM module during password
changes, rather than prompting the user again.</p>
<h4>Rationale</h4>
<p>The <tt>use_authtok</tt> option allows multiple PAM modules to validate the new
password before it is accepted, ensuring it meets all security requirements
without requiring the user to re-enter it multiple times.</p>
</div>

<div id="accounts_password_pam_pwquality_retry" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session in /etc/security/pwquality.conf</h3>
<div>accounts_password_pam_pwquality_retry</div>
<h4>Description</h4>
<p>To configure the number of retry prompts that are permitted per-session:
Edit the <tt>/etc/security/pwquality.conf</tt> to include
<tt>retry=<tt>$var_password_pam_retry</tt></tt>, or a lower value if site
policy is more restrictive. The profile requirement is a maximum of <tt>retry=<tt>$var_password_pam_retry</tt></tt> prompts
per session.</p>
<h4>Rationale</h4>
<p>Setting the password retry prompts that are permitted on a per-session basis to a low value
requires some software, such as SSH, to re-connect. This can slow down and
draw additional attention to some types of password-guessing attacks. Note that this
is different from account lockout, which is provided by the pam_faillock module.</p>
</div>

<div id="accounts_password_pam_pwquality_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify pam_pwquality module is activated</h3>
<div>accounts_password_pam_pwquality_enabled</div>
<h4>Description</h4>
<p>The <tt>pam_pwquality.so</tt> module ensures password quality by evaluating user-created passwords 
against a system dictionary and a set of rules designed to detect weak choices. Originally derived 
from the pam_cracklib module, this module is backward-compatible with options of pam_cracklib.
<br /><br />
The module's process includes prompting the user for a password, checking its strength, and if it 
meets the criteria requesting the password again for confirmation. If both entries match, the 
password is passed to subsequent modules to be set as the new authentication token.</p>
<h4>Rationale</h4>
<p>Strong passwords significantly increase the time and effort required for unauthorized access, 
increasing overall system security.</p>
</div>

<div id="accounts_password_pam_unix_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify pam_unix module is activated</h3>
<div>accounts_password_pam_unix_enabled</div>
<h4>Description</h4>
<p><tt>pam_unix</tt> is the standard Unix authentication module. It uses standard calls from the
system's libraries to retrieve and set account information as well as authentication.
Usually this is obtained from the <tt>/etc/passwd</tt> and if shadow is enabled, the
<tt>/etc/shadow</tt> file as well.
<br /><br />
The account component performs the task of establishing the status of the user's
account and password based on the following shadow elements: <tt>expire,
last_change, max_change, min_change, warn_change</tt>. In the case of the latter, it may
offer advice to the user on changing their password or, through the
<tt>PAM_AUTHTOKEN_REQD</tt> return, delay giving service to the user until they have
established a new password. The entries listed above are documented in the shadow(5)
manual page. Should the user's record not contain one or more of these entries, the
corresponding shadow check is not performed.
<br /><br />
The authentication component performs the task of checking the users credentials
(password). The default action of this module is to not permit the user access to a
service if their official password is blank.</p>
<h4>Rationale</h4>
<p>The system should only provide access after performing authentication of a user.</p>
</div>

<div id="accounts_password_pam_unix_no_remember" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Avoid using remember in pam_unix module</h3>
<div>accounts_password_pam_unix_no_remember</div>
<h4>Description</h4>
<p>The <tt>remember</tt> option stores the last n passwords for each user in <tt>/etc/security/opasswd</tt>,
enforcing password history and preventing users from reusing the same passwords. However, this feature
relies on the MD5 password hash algorithm, which is less secure. Instead, the <tt>pam_pwhistory</tt>
module should be used. This module also stores the last n passwords in <tt>/etc/security/opasswd</tt>
and it uses the password hash algorithm configured in the pam_unix module, such as yescrypt or SHA512,
offering enhanced security.</p>
<h4>Rationale</h4>
<p>Removing the <tt>remember</tt> argument ensures the use of a stronger password hashing algorithm.
A more robust hash algorithm increases the difficulty for attackers to crack stored
passwords in <tt>/etc/security/opasswd</tt>, thereby improving system security and
protecting user credentials. </p>
</div>

<div id="accounts_password_pam_unix_authtok" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Require use_authtok for pam_unix.so</h3>
<div>accounts_password_pam_unix_authtok</div>
<h4>Description</h4>
<p>When password changing enforce the module to set the new password to the one
provided by a previously stacked password module</p>
<h4>Rationale</h4>
<p>Require use_authtok in pam_unix.so configuration</p>
</div>

<div id="accounts_password_pam_unix_rounds_password_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set number of Password Hashing Rounds - password-auth</h3>
<div>accounts_password_pam_unix_rounds_password_auth</div>
<h4>Description</h4>
<p>Configure the number or rounds for the password hashing algorithm. This can be
accomplished by using the <tt>rounds</tt> option for the <tt>pam_unix</tt> PAM module.
<br /><br />
In file <tt>/etc/pam.d/password-auth</tt> append <tt>rounds=<tt>$var_password_pam_unix_rounds</tt></tt>
to the <tt>pam_unix.so</tt> entry, as shown below:

<pre>password sufficient pam_unix.so <i>...existing_options...</i> rounds=<tt>$var_password_pam_unix_rounds</tt></pre>

The system's default number of rounds is 5000.</p>
<h4>Rationale</h4>
<p>Using a higher number of rounds makes password cracking attacks more difficult.</p>
</div>

<div id="accounts_password_pam_unix_rounds_system_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set number of Password Hashing Rounds - system-auth</h3>
<div>accounts_password_pam_unix_rounds_system_auth</div>
<h4>Description</h4>
<p>Configure the number or rounds for the password hashing algorithm. This can be
accomplished by using the <tt>rounds</tt> option for the <tt>pam_unix</tt> PAM module.
<br /><br />
In file <tt>/etc/pam.d/system-auth</tt> append <tt>rounds=<tt>$var_password_pam_unix_rounds</tt></tt>
to the <tt>pam_unix.so</tt> entry, as shown below:
<pre>password sufficient pam_unix.so <i>...existing_options...</i> rounds=<tt>$var_password_pam_unix_rounds</tt></pre>
The system's default number of rounds is 5000.</p>
<h4>Rationale</h4>
<p>Using a higher number of rounds makes password cracking attacks more difficult.</p>
</div>

<div id="accounts_password_set_max_life_existing" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Existing Passwords Maximum Age</h3>
<div>accounts_password_set_max_life_existing</div>
<h4>Description</h4>
<p>Configure non-compliant accounts to enforce a <tt>$var_accounts_maximum_age_login_defs</tt>-day maximum password lifetime
restriction by running the following command:
<pre>$ sudo chage -M <tt>$var_accounts_maximum_age_login_defs</tt> <i>USER</i></pre></p>
<h4>Rationale</h4>
<p>Any password, no matter how complex, can eventually be cracked. Therefore,
passwords need to be changed periodically. If the operating system does
not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.</p>
</div>

<div id="accounts_password_set_max_life_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Root Account Password Maximum Age</h3>
<div>accounts_password_set_max_life_root</div>
<h4>Description</h4>
<p>Configure the root account to enforce a <tt>$var_accounts_maximum_age_root</tt>-day maximum password lifetime restriction by running the following command:
<pre>$ sudo chage -M <tt>$var_accounts_maximum_age_root</tt> root</pre></p>
<h4>Rationale</h4>
<p>Any password, no matter how complex, can eventually be cracked. Therefore,
passwords need to be changed periodically. If the operating system does
not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.</p>
</div>

<div id="accounts_password_set_min_life_existing" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Existing Passwords Minimum Age</h3>
<div>accounts_password_set_min_life_existing</div>
<h4>Description</h4>
<p>Configure non-compliant accounts to enforce a 24 hours/1 day minimum password
lifetime by running the following command:
<pre>$ sudo chage -m 1 <i>USER</i></pre></p>
<h4>Rationale</h4>
<p>Enforcing a minimum password lifetime helps to prevent repeated password
changes to defeat the password reuse or history enforcement requirement. If
users are allowed to immediately and continually change their password, the
password could be repeatedly changed in a short period of time to defeat the
organization's policy regarding password reuse.</p>
</div>

<div id="accounts_password_set_warn_age_existing" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Existing Passwords Warning Age</h3>
<div>accounts_password_set_warn_age_existing</div>
<h4>Description</h4>
<p>To configure how many days prior to password expiration that a warning will be issued to
users, run the command:
<pre>$ sudo chage --warndays <tt>$var_accounts_password_warn_age_login_defs</tt> <i>USER</i></pre>
This profile requirement is <tt><tt>$var_accounts_password_warn_age_login_defs</tt></tt>.</p>
<h4>Rationale</h4>
<p>Providing an advance warning that a password will be expiring gives users
time to think of a secure password. Users caught unaware may choose a simple
password or write it down where it may be discovered.</p>
</div>

<div id="accounts_password_warn_age_login_defs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Warning Age</h3>
<div>accounts_password_warn_age_login_defs</div>
<h4>Description</h4>
<p>To specify how many days prior to password
expiration that a warning will be issued to users,
edit the file <tt>/etc/login.defs</tt> and add or correct
 the following line:
<pre>PASS_WARN_AGE <tt>$var_accounts_password_warn_age_login_defs</tt></pre>
The profile requirement is <tt><tt>$var_accounts_password_warn_age_login_defs</tt></tt>.</p>
<h4>Rationale</h4>
<p>Setting the password warning age enables users to
make the change at a practical time.</p>
</div>

<div id="accounts_passwords_pam_faildelay_delay" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enforce Delay After Failed Logon Attempts</h3>
<div>accounts_passwords_pam_faildelay_delay</div>
<h4>Description</h4>
<p>To configure the system to introduce a delay after failed logon attempts,
add or correct the <tt>pam_faildelay</tt> settings in
<tt>/etc/pam.d/common-auth</tt> to make sure its <tt>delay</tt> parameter
is at least <tt>$var_password_pam_delay</tt> or greater. For example:
<pre>auth required pam_faildelay.so delay=<tt>$var_password_pam_delay</tt></pre></p>
<h4>Rationale</h4>
<p>Limiting the number of logon attempts over a certain time interval reduces
the chances that an unauthorized user may gain access to an account.</p>
</div>

<div id="accounts_passwords_pam_faillock_audit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Account Lockouts Must Be Logged</h3>
<div>accounts_passwords_pam_faillock_audit</div>
<h4>Description</h4>
<p>PAM faillock locks an account due to excessive password failures, this event must be logged.</p>
<h4>Rationale</h4>
<p>Without auditing of these events it may be harder or impossible to identify what an attacker did after an attack.</p>
</div>

<div id="accounts_passwords_pam_faillock_deny" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Lock Accounts After Failed Password Attempts</h3>
<div>accounts_passwords_pam_faillock_deny</div>
<h4>Description</h4>
<p>This rule configures the system to lock out accounts after a number of incorrect login attempts
using <tt>pam_faillock.so</tt>.
pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected.
Ensure that the file <tt>/etc/security/faillock.conf</tt> contains the following entry:
<tt>deny = &lt;count&gt;</tt>
Where count should be less than or equal to
<tt>$var_accounts_passwords_pam_faillock_deny</tt> and greater than 0.

In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized system access via
user password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking
the account.</p>
</div>

<div id="accounts_passwords_pam_faillock_deny_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure the root Account for Failed Password Attempts</h3>
<div>accounts_passwords_pam_faillock_deny_root</div>
<h4>Description</h4>
<p>This rule configures the system to lock out the <tt>root</tt> account after a number of
incorrect login attempts using <tt>pam_faillock.so</tt>.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized system access via
user password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking
the account.</p>
</div>

<div id="accounts_passwords_pam_faillock_dir" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Lock Accounts Must Persist</h3>
<div>accounts_passwords_pam_faillock_dir</div>
<h4>Description</h4>
<p>This rule ensures that the system lock out accounts using <tt>pam_faillock.so</tt> persist
after system reboot. From "pam_faillock" man pages:
<pre>Note that the default directory that "pam_faillock" uses is usually cleared on system
boot so the access will be re-enabled after system reboot. If that is undesirable, a different
tally directory must be set with the "dir" option.</pre>

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.

The chosen profile expects the directory to be <tt><tt>$var_accounts_passwords_pam_faillock_dir</tt></tt>.

To configure the tally directory, add the following line to <tt>/etc/security/faillock.conf</tt>:
<pre>dir = <tt>$var_accounts_passwords_pam_faillock_dir</tt></pre></p>
<h4>Rationale</h4>
<p>Locking out user accounts after a number of incorrect attempts prevents direct password
guessing attacks. In combination with the <tt>silent</tt> option, user enumeration attacks
are also mitigated.</p>
</div>

<div id="accounts_passwords_pam_faillock_enforce_local" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enforce pam_faillock for Local Accounts Only</h3>
<div>accounts_passwords_pam_faillock_enforce_local</div>
<h4>Description</h4>
<p>The pam_faillock module's <tt>local_users_only</tt> parameter controls requirements for
enforcing failed lockout attempts only for local user accounts and ignoring centralized user
account management failed attempt configurations.</p>
<h4>Rationale</h4>
<p>The operating system must provide automated mechanisms for supporting account management
functions. Enterprise environments make application account management challenging and
complex. A manual process for account management functions adds the risk of a potential
oversight or other error. Locking out remote accounts may cause unintentional DoS.</p>
</div>

<div id="accounts_passwords_pam_faillock_interval" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Interval For Counting Failed Password Attempts</h3>
<div>accounts_passwords_pam_faillock_interval</div>
<h4>Description</h4>
<p>Utilizing <tt>pam_faillock.so</tt>, the <tt>fail_interval</tt> directive configures the system
to lock out an account after a number of incorrect login attempts within a specified time
period.

Ensure that the file <tt>/etc/security/faillock.conf</tt> contains the following entry:
<tt>fail_interval = &lt;interval-in-seconds&gt;</tt> where <tt>interval-in-seconds</tt> is <tt><tt>$var_accounts_passwords_pam_faillock_fail_interval</tt></tt> or greater.


In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts the risk of unauthorized system
access via user password guessing, otherwise known as brute-forcing, is reduced.
Limits are imposed by locking the account.</p>
</div>

<div id="accounts_passwords_pam_faillock_silent" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Do Not Show System Messages When Unsuccessful Logon Attempts Occur</h3>
<div>accounts_passwords_pam_faillock_silent</div>
<h4>Description</h4>
<p>This rule ensures the system prevents informative messages from being presented to the user
pertaining to logon information after a number of incorrect login attempts using
<tt>pam_faillock.so</tt>.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid errors when manually editing these files, it is
recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.</p>
<h4>Rationale</h4>
<p>The pam_faillock module without the silent option will leak information about the existence or
non-existence of a user account in the system because the failures are not recorded for unknown
users. The message about the user account being locked is never displayed for non-existing user
accounts allowing the adversary to infer that a particular account exists or not on the system.</p>
</div>

<div id="accounts_passwords_pam_faillock_root_unlock_time" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Root Lockout Time for Failed Password Attempts</h3>
<div>accounts_passwords_pam_faillock_root_unlock_time</div>
<h4>Description</h4>
<p>This rule configures the system to lock out root during a specified time period after a
number of incorrect login attempts using <tt>pam_faillock.so</tt>.

Ensure that the file <tt>/etc/security/faillock.conf</tt> contains the following entry:
<tt>root_unlock_time=&lt;interval-in-seconds&gt;</tt> where
<tt>interval-in-seconds</tt> is <tt><tt>$var_accounts_passwords_pam_faillock_root_unlock_time</tt></tt> or greater.

If <tt>root_unlock_time</tt> is set to <tt>0</tt>, it may enable attacker to
apply denial of service to legitimate users.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts the risk of unauthorized root
access via password guessing, otherwise known as brute-forcing, is reduced.
Limits are imposed by locking the account.</p>
</div>

<div id="accounts_passwords_pam_faillock_unlock_time" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Lockout Time for Failed Password Attempts</h3>
<div>accounts_passwords_pam_faillock_unlock_time</div>
<h4>Description</h4>
<p>This rule configures the system to lock out accounts during a specified time period after a
number of incorrect login attempts using <tt>pam_faillock.so</tt>.

Ensure that the file <tt>/etc/security/faillock.conf</tt> contains the following entry:
<tt>unlock_time=&lt;interval-in-seconds&gt;</tt> where
<tt>interval-in-seconds</tt> is <tt><tt>$var_accounts_passwords_pam_faillock_unlock_time</tt></tt> or greater.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid any errors when manually editing these files,
it is recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.

If <tt>unlock_time</tt> is set to <tt>0</tt>, manual intervention by an administrator is required
to unlock a user. This should be done using the <tt>faillock</tt> tool.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts the risk of unauthorized system
access via user password guessing, otherwise known as brute-forcing, is reduced.
Limits are imposed by locking the account.</p>
</div>

<div id="accounts_passwords_pam_faillock_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure pam_faillock module is enabled</h3>
<div>accounts_passwords_pam_faillock_enabled</div>
<h4>Description</h4>
<p>The <tt>pam_faillock.so</tt> module maintains a list of failed authentication attempts per
user during a specified interval and locks the account in case there were more than the
configured number of consecutive failed authentications (this is defined by the <tt>deny</tt>
parameter in the faillock configuration). It stores the failure records into per-user files in
the tally directory.</p>
<h4>Rationale</h4>
<p>Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute
force password attacks against your systems.</p>
</div>

<div id="accounts_passwords_pam_tally2" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Deny For Failed Password Attempts</h3>
<div>accounts_passwords_pam_tally2</div>
<h4>Description</h4>
<p>The Red Hat Enterprise Linux 8 operating system must lock an account after - at most - <tt>$var_password_pam_tally2</tt>
consecutive invalid access attempts.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized
system access via user password guessing, otherwise known as brute-force
attacks, is reduced. Limits are imposed by locking the account.

To configure the operating system to lock an account after three
unsuccessful consecutive access attempts using <tt>pam_tally2.so</tt>,
modify the content of both <tt>/etc/pam.d/common-auth</tt> and
<tt>/etc/pam.d/common-account</tt> as follows:
<br /><br />
<ul>
<li> add or modify the <tt>pam_tally2.so</tt> module line in
<tt>/etc/pam.d/common-auth</tt> to ensure both <tt>onerr=fail</tt> and
<tt>deny=<tt>$var_password_pam_tally2</tt></tt> are present. For example:
<pre>auth required pam_tally2.so onerr=fail silent audit deny=<tt>$var_password_pam_tally2</tt></pre></li>
<li> add or modify the following line in <tt>/etc/pam.d/common-account</tt>:
<pre>account required pam_tally2.so</pre></li>
</ul></p>
</div>

<div id="accounts_passwords_pam_tally2_deny_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure the root Account lock for Failed Password Attempts via pam_tally2</h3>
<div>accounts_passwords_pam_tally2_deny_root</div>
<h4>Description</h4>
<p>This rule configures the system to lock out the <tt>root</tt> account after a number of
incorrect login attempts using <tt>pam_tally2.so</tt>.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized system access via
user password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking
the account.</p>
</div>

<div id="accounts_passwords_pam_tally2_unlock_time" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Lockout Time for Failed Password Attempts using pam_tally2</h3>
<div>accounts_passwords_pam_tally2_unlock_time</div>
<h4>Description</h4>
<p>This rule configures the system to lock out accounts during a specified time period after a
number of incorrect login attempts using <tt>pam_tally2.so</tt>.</p>
<h4>Rationale</h4>
<p>By limiting the number of failed logon attempts, the risk of unauthorized system access via
user password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking
the account.</p>
</div>

<div id="accounts_polyinstantiated_tmp" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Polyinstantiation of /tmp Directories</h3>
<div>accounts_polyinstantiated_tmp</div>
<h4>Description</h4>
<p>To configure polyinstantiated /tmp directories, first create the parent directories
which will hold the polyinstantiation child directories. Use the following command:
<pre>$ sudo mkdir --mode 000 /tmp/tmp-inst</pre>
Then, add the following entry to <tt>/etc/security/namespace.conf</tt>:
<pre>/tmp     /tmp/tmp-inst/            level      root,adm</pre></p>
<h4>Rationale</h4>
<p>Polyinstantiation of temporary directories is a proactive security measure
which reduces chances of attacks that are made possible by /tmp
directories being world-writable.</p>
</div>

<div id="accounts_polyinstantiated_var_tmp" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Polyinstantiation of /var/tmp Directories</h3>
<div>accounts_polyinstantiated_var_tmp</div>
<h4>Description</h4>
<p>To configure polyinstantiated /tmp directories, first create the parent directories
which will hold the polyinstantiation child directories. Use the following command:
<pre>$ sudo mkdir --mode 000 /var/tmp/tmp-inst</pre>
Then, add the following entry to <tt>/etc/security/namespace.conf</tt>:
<pre>/var/tmp /var/tmp/tmp-inst/    level      root,adm</pre></p>
<h4>Rationale</h4>
<p>Polyinstantiation of temporary directories is a proactive security measure
which reduces chances of attacks that are made possible by /var/tmp
directories being world-writable.</p>
</div>

<div id="accounts_root_gid_zero" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Root Has A Primary GID 0</h3>
<div>accounts_root_gid_zero</div>
<h4>Description</h4>
<p>The <tt>root</tt> user should have a primary group of 0.</p>
<h4>Rationale</h4>
<p>To help ensure that root-owned files are not inadvertently exposed to other users.</p>
</div>

<div id="accounts_root_path_dirs_no_write" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure that Root's Path Does Not Include World or Group-Writable Directories</h3>
<div>accounts_root_path_dirs_no_write</div>
<h4>Description</h4>
<p>For each element in root's path, run:
<pre># ls -ld <i>DIR</i></pre>
and ensure that write permissions are disabled for group and
other.</p>
<h4>Rationale</h4>
<p>Such entries increase the risk that root could
execute code provided by unprivileged users,
and potentially malicious code.</p>
</div>

<div id="accounts_set_post_pw_existing" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set existing passwords a period of inactivity before they been locked</h3>
<div>accounts_set_post_pw_existing</div>
<h4>Description</h4>
<p>Configure user accounts that have been inactive for over a given period of time
to be automatically disabled by running the following command:
<pre>$ sudo chage --inactive 30 USER</pre></p>
<h4>Rationale</h4>
<p>Inactive accounts pose a threat to system security since the users are not logging in to
notice failed login attempts or other anomalies.</p>
</div>

<div id="accounts_umask_etc_login_defs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure the Default Umask is Set Correctly in login.defs</h3>
<div>accounts_umask_etc_login_defs</div>
<h4>Description</h4>
<p>To ensure the default umask controlled by <tt>/etc/login.defs</tt> is set properly,
add or correct the <tt>UMASK</tt> setting in <tt>/etc/login.defs</tt> to read as follows:
<pre>UMASK <tt>$var_accounts_user_umask</tt></pre></p>
<h4>Rationale</h4>
<p>The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read and
written to by unauthorized users.</p>
</div>

<div id="accounts_umask_interactive_users" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure the Default Umask is Set Correctly For Interactive Users</h3>
<div>accounts_umask_interactive_users</div>
<h4>Description</h4>
<p>Remove the <tt>UMASK</tt> environment variable from all interactive users initialization files.</p>
<h4>Rationale</h4>
<p>The umask controls the default access mode assigned to newly created files. A
umask of 077 limits new files to mode 700 or less permissive. Although umask can
be represented as a four-digit number, the first digit representing special
access modes is typically ignored or required to be 0. This requirement
applies to the globally configured system defaults and the local interactive
user defaults for each account on the system.</p>
</div>

<div id="accounts_umask_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure the Root Bash Umask is Set Correctly</h3>
<div>accounts_umask_root</div>
<h4>Description</h4>
<p>To ensure the root user's umask of the Bash shell is set properly,
add or correct the <tt>umask</tt> setting in <tt>/root/.bashrc</tt>
or <tt>/root/.profile</tt> to read as follows:
<pre>umask 0027</pre></p>
<h4>Rationale</h4>
<p>The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.</p>
</div>

<div id="accounts_users_netrc_file_permissions" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure users' .netrc Files are not group or world accessible</h3>
<div>accounts_users_netrc_file_permissions</div>
<h4>Description</h4>
<p>While the system administrator can establish secure permissions for users' .netrc files, the
users can easily override these.

This rule ensures every .netrc file or directory under the home directory related
to an interactive user is not group or world accessible</p>
<h4>Rationale</h4>
<p>.netrc files may contain unencrypted passwords that may be used to attack other systems.
Note: While the complete removal of .netrc files is recommended, if any are required on the
      system, secure permissions must be applied.</p>
</div>

<div id="accounts_users_own_home_directories" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure users own their home directories</h3>
<div>accounts_users_own_home_directories</div>
<h4>Description</h4>
<p>The user home directory is space defined for the particular user to set local
environment variables and to store personal files. Since the user is
accountable for files stored in the user home directory, the user must be
the owner of the directory.</p>
<h4>Rationale</h4>
<p>Since the user is accountable for files stored in the user home directory,
the user must be the owner of the directory.</p>
</div>

<div id="audit_rules_privileged_commands_pam_timestamp_check" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure auditd Collects Information on the Use of Privileged Commands - pam_timestamp_check</h3>
<div>audit_rules_privileged_commands_pam_timestamp_check</div>
<h4>Description</h4>
<p>


At a minimum, the audit system should collect the execution of privileged
commands for all users and root.

If the <tt>auditd</tt> daemon is configured to use the <tt>augenrules</tt>
program to read audit rules during daemon startup (the default), add
a line of the following form to a file with suffix <tt>.rules</tt>
in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add a line of the
following form to <tt>/etc/audit/audit.rules</tt>:
<pre>-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre></p>
<h4>Rationale</h4>
<p>Misuse of privileged functions, either intentionally or unintentionally by
authorized users, or by unauthorized external entities that have compromised system accounts,
is a serious and ongoing concern and can have significant adverse impacts on organizations.
Auditing the use of privileged functions is one way to detect such misuse and identify
the risk from insider and advanced persistent threats.
<br /><br />
Privileged programs are subject to escalation-of-privilege attacks,
which attempt to subvert their normal role of providing some necessary but
limited capability. As such, motivation exists to monitor these programs for
unusual activity.</p>
</div>

<div id="authconfig_config_files_symlinks" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure system-auth and password-auth files are symbolic links pointing
to system-auth-local and password-auth-local</h3>
<div>authconfig_config_files_symlinks</div>
<h4>Description</h4>
<p>Red Hat Enterprise Linux 8 must be configured to prevent overwriting of custom authentication
configuration settings by the authconfig utility.
This can be avoided by creating new local configuration files and creating new or moving
existing symbolic links to them. The authconfig utility will recognize the local configuration
files and not overwrite them, while writing its own settings to the original configuration
files.</p>
<h4>Rationale</h4>
<p>When using the authconfig utility to modify authentication configuration settings,
the "system-auth" and "password-auth" files and any custom settings that they may
contain are overwritten.</p>
</div>

<div id="banner_etc_gdm_banner" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Modify the System GUI Login Banner</h3>
<div>banner_etc_gdm_banner</div>
<h4>Description</h4>
<p>To configure the GUI system login banner edit <tt>/etc/gdm/banner</tt>.
Replace the default text with a message compliant with the local site
policy or a legal disclaimer.

The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.</p>
</div>

<div id="banner_etc_issue" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Modify the System Login Banner</h3>
<div>banner_etc_issue</div>
<h4>Description</h4>
<p>
To configure the system login banner edit <tt>/etc/issue</tt>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.


The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.</p>
</div>

<div id="banner_etc_issue_cis" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure Local Login Warning Banner Is Configured Properly</h3>
<div>banner_etc_issue_cis</div>
<h4>Description</h4>
<p>To configure the system local login warning banner edit the <tt>/etc/issue</tt> file.
The contents of this file is displayed to users prior to login to local terminals.
Replace the default text with a message compliant with the local site policy.
The message should not contain information about operating system version,
release, kernel version or patch level.

The recommended banner text can be tailored in the XCCDF Value <tt>xccdf_org.ssgproject.content_value_cis_banner_text</tt>:
<pre>
<tt>$cis_banner_text</tt>
</pre></p>
<h4>Rationale</h4>
<p>Warning messages inform users who are attempting to login to the system of their legal
status regarding the system and must include the name of the organization that owns
the system and any monitoring policies that are in place. Displaying OS and patch level
information in login banners also has the side effect of providing detailed system
information to attackers attempting to target specific exploits of a system. Authorized
users can easily get this information by running the <tt>uname -a</tt> command once they
have logged in.</p>
</div>

<div id="banner_etc_issue_net" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Modify the System Login Banner for Remote Connections</h3>
<div>banner_etc_issue_net</div>
<h4>Description</h4>
<p>To configure the system login banner edit <tt>/etc/issue.net</tt>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.

The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.</p>
</div>

<div id="banner_etc_issue_net_cis" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure Remote Login Warning Banner Is Configured Properly</h3>
<div>banner_etc_issue_net_cis</div>
<h4>Description</h4>
<p>To configure the system remote login warning banner edit the <tt>/etc/issue.net</tt> file.
The contents of this file is displayed to users prior to login from remote connections.
Replace the default text with a message compliant with the local site policy.
The message should not contain information about operating system version,
release, kernel version or patch level.

The recommended banner text can be tailored in the XCCDF Value <tt>xccdf_org.ssgproject.content_value_cis_banner_text</tt>:
<pre>
<tt>$cis_banner_text</tt>
</pre></p>
<h4>Rationale</h4>
<p>Warning messages inform users who are attempting to login to the system of their legal
status regarding the system and must include the name of the organization that owns
the system and any monitoring policies that are in place. Displaying OS and patch level
information in login banners also has the side effect of providing detailed system
information to attackers attempting to target specific exploits of a system. Authorized
users can easily get this information by running the <tt>uname -a</tt> command once they
have logged in.</p>
</div>

<div id="banner_etc_motd" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Modify the System Message of the Day Banner</h3>
<div>banner_etc_motd</div>
<h4>Description</h4>
<p>To configure the system message banner edit <tt>/etc/motd</tt>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.

The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.</p>
</div>

<div id="banner_etc_motd_cis" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure Message Of The Day Is Configured Properly</h3>
<div>banner_etc_motd_cis</div>
<h4>Description</h4>
<p>To configure the system message of the day banner edit the <tt>/etc/motd</tt> file.
Replace the default text with a message compliant with the local site policy.
The message should not contain information about operating system version,
release, kernel version or patch level.

The recommended banner text can be tailored in the XCCDF Value <tt>xccdf_org.ssgproject.content_value_cis_banner_text</tt>:
<pre>
<tt>$cis_banner_text</tt>
</pre></p>
<h4>Rationale</h4>
<p>Warning messages inform users who are attempting to login to the system of their legal
status regarding the system and must include the name of the organization that owns
the system and any monitoring policies that are in place. Displaying OS and patch level
information in login banners also has the side effect of providing detailed system
information to attackers attempting to target specific exploits of a system. Authorized
users can easily get this information by running the <tt>uname -a</tt> command once they
have logged in.</p>
</div>

<div id="banner_etc_profiled_ssh_confirm" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable the SSH login confirmation banner</h3>
<div>banner_etc_profiled_ssh_confirm</div>
<h4>Description</h4>
<p>This rule verifies that that the SSH login confirmation banner is set 
correctly.

The DoD required text is:
<br /><br />
<tt>if [ -n "$SSH_CLIENT" ] || [ -n "$SSH_TTY" ]; then<br/>
        while true; do<br/>
            read -p "<br/>
You are accessing a U.S. Government (USG) Information System (IS) that is provided for
USG-authorized use only.<br/>
By using this IS (which includes any device attached to this IS), you consent to the
following conditions:<br/>
-The USG routinely intercepts and monitors communications on this IS for purposes
including, but not limited to, penetration testing, COMSEC monitoring, network
operations and defense, personnel misconduct (PM), law enforcement (LE), and
counterintelligence (CI) investigations.<br/>
-At any time, the USG may inspect and seize data stored on this IS.<br/>
-Communications using, or data stored on, this IS are not private, are subject to routine
monitoring, interception, and search, and may be disclosed or used for any USG-
authorized purpose.<br/>
-This IS includes security measures (e.g., authentication and access controls) to protect
USG interests--not for your personal benefit or privacy.<br/>
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI
investigative searching or monitoring of the content of privileged communications, or
work product, related to personal representation or services by attorneys,
psychotherapists, or clergy, and their assistants. Such communications and work product
are private and confidential. See User Agreement for details.<br/>
Do you agree? [y/N] " yn<br/>
            case $yn in
                [Yy]* ) break ;;<br/>
                [Nn]* ) exit 1 ;;<br/>
            esac<br/>
        done<br/>
    fi<br/>
</tt></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.</p>
</div>

<div id="coreos_disable_interactive_boot" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify that Interactive Boot is Disabled</h3>
<div>coreos_disable_interactive_boot</div>
<h4>Description</h4>
<p>Red Hat Enterprise Linux 8 systems support an "interactive boot" option that can
be used to prevent services from being started. On a Red Hat Enterprise Linux 8
system, interactive boot can be enabled by providing a <tt>1</tt>,
<tt>yes</tt>, <tt>true</tt>, or <tt>on</tt> value to the
<tt>systemd.confirm_spawn</tt> kernel argument.</p>
<h4>Rationale</h4>
<p>Using interactive boot, the console user could disable auditing, firewalls,
or other services, weakening system security.</p>
</div>

<div id="cracklib_accounts_password_pam_dcredit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Strength Minimum Digit Characters</h3>
<div>cracklib_accounts_password_pam_dcredit</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>dcredit</tt> parameter controls requirements
for usage of digits in a password. When set to a negative number, any
password will be required to contain that many digits. When set to a
positive number, pam_cracklib will grant +1 additional length credit for
each digit. Add <tt>dcredit=-1</tt> after pam_cracklib.so to require use of
a digit in passwords.</p>
<h4>Rationale</h4>
<p>Requiring digits makes password guessing attacks more difficult by ensuring
a larger search space.</p>
</div>

<div id="cracklib_accounts_password_pam_difok" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Strength Minimum Different Characters</h3>
<div>cracklib_accounts_password_pam_difok</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>difok</tt> parameter controls requirements for
usage of different characters during a password change. The number of
changed characters refers to the number of changes required with respect to
the total number of positions in the current password. In other words,
characters may be the same within the two passwords; however, the positions
of the like characters must be different.
Make sure the <tt>difok</tt> parameter for the pam_cracklib module is
configured to greater than or equal to <tt><tt>$var_password_pam_difok</tt></tt>.</p>
<h4>Rationale</h4>
<p>Requiring a minimum number of different characters during password changes
ensures that newly changed passwords should not resemble previously
compromised ones. Note that passwords which are changed on compromised
systems will still be compromised, however.</p>
</div>

<div id="cracklib_accounts_password_pam_lcredit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Strength Minimum Lowercase Characters</h3>
<div>cracklib_accounts_password_pam_lcredit</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>lcredit=</tt> parameter controls requirements
for usage of lowercase letters in a password. When set to a negative
number, any password will be required to contain that many lowercase
characters. When set to a positive number, pam_cracklib will grant +1
additional length credit for each lowercase character.
Add <tt>lcredit=-1</tt> after pam_cracklib.so to require use of a
lowercase character in passwords.</p>
<h4>Rationale</h4>
<p>Requiring a minimum number of lowercase characters makes password guessing
attacks more difficult by ensuring a larger search space.</p>
</div>

<div id="cracklib_accounts_password_pam_minlen" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Minimum Length</h3>
<div>cracklib_accounts_password_pam_minlen</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>minlen</tt> parameter controls requirements for
minimum characters required in a password. Add <tt>minlen=<tt>$var_password_pam_minlen</tt></tt>
 to set minimum password length requirements.</p>
<h4>Rationale</h4>
<p>Password length is one factor of several that helps to determine
strength and how long it takes to crack a password. Use of more characters in
a password helps to exponentially increase the time and/or resources
required to compromise the password.</p>
</div>

<div id="cracklib_accounts_password_pam_ocredit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Strength Minimum Special Characters</h3>
<div>cracklib_accounts_password_pam_ocredit</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>ocredit=</tt> parameter controls requirements
for usage of special (or ``other'') characters in a password. When set to a
negative number, any password will be required to contain that many special
characters. When set to a positive number, pam_cracklib will grant +1
additional length credit for each special character.
Make sure the <tt>ocredit</tt> parameter for the pam_cracklib module is
set to less than or equal to <tt><tt>$var_password_pam_ocredit</tt></tt>. For example, <tt>ocredit=<tt>$var_password_pam_ocredit</tt></tt>.</p>
<h4>Rationale</h4>
<p>Requiring a minimum number of special characters makes password guessing
attacks more difficult by ensuring a larger search space.</p>
</div>

<div id="cracklib_accounts_password_pam_retry" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Retry Limit</h3>
<div>cracklib_accounts_password_pam_retry</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>retry</tt> parameter controls the maximum
number of times to prompt the user for the password before returning
with error. Make sure it is configured with a value that is no more than
<tt>$var_password_pam_retry</tt>. For example, <tt>retry=1</tt>.</p>
<h4>Rationale</h4>
<p>To reduce opportunities for successful guesses and brute-force attacks.</p>
</div>

<div id="cracklib_accounts_password_pam_ucredit" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Strength Minimum Uppercase Characters</h3>
<div>cracklib_accounts_password_pam_ucredit</div>
<h4>Description</h4>
<p>The pam_cracklib module's <tt>ucredit=</tt> parameter controls requirements
for usage of uppercase letters in a password. When set to a negative
number, any password will be required to contain that many uppercase
characters. When set to a positive number, pam_cracklib will grant +1
additional length credit for each uppercase character.
Add <tt>ucredit=-1</tt> after pam_cracklib.so to require use of an upper
case character in passwords.</p>
<h4>Rationale</h4>
<p>Requiring a minimum number of uppercase characters makes password guessing
attacks more difficult by ensuring a larger search space.</p>
</div>

<div id="disable_users_coredumps" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable Core Dumps for All Users</h3>
<div>disable_users_coredumps</div>
<h4>Description</h4>
<p>To disable core dumps for all users, add the following line to
<tt>/etc/security/limits.conf</tt>, or to a file within the
<tt>/etc/security/limits.d/</tt> directory:
<pre>*     hard   core    0</pre></p>
<h4>Rationale</h4>
<p>A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.</p>
</div>

<div id="disallow_bypass_password_sudo" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disallow Configuration to Bypass Password Requirements for Privilege Escalation</h3>
<div>disallow_bypass_password_sudo</div>
<h4>Description</h4>
<p>Verify the operating system is not configured to bypass password requirements for privilege
escalation. Check the configuration of the "/etc/pam.d/sudo" file with the following command:
<pre>$ sudo grep pam_succeed_if /etc/pam.d/sudo</pre>
If any occurrences of "pam_succeed_if" is returned from the command, this is a finding.</p>
<h4>Rationale</h4>
<p>Without re-authentication, users may access resources or perform tasks for which they do not
have authorization. When operating systems provide the capability to escalate a functional
capability, it is critical the user re-authenticate.</p>
</div>

<div id="display_login_attempts" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure PAM Displays Last Logon/Access Notification</h3>
<div>display_login_attempts</div>
<h4>Description</h4>
<p>To configure the system to notify users of last logon/access using <tt>pam_lastlog</tt>,
add or correct the <tt>pam_lastlog</tt> settings in <tt>/etc/pam.d/postlogin</tt>
to include <tt>showfailed</tt> option, such as:
<pre>session     [default=1]    pam_lastlog.so showfailed</pre>
And make sure that the <tt>silent</tt> option is not set for this specific line.</p>
<h4>Rationale</h4>
<p>Users need to be aware of activity that occurs regarding their account. Providing users with
information regarding the number of unsuccessful attempts that were made to login to their
account allows the user to determine if any unauthorized activity has occurred and gives them
an opportunity to notify administrators.</p>
</div>

<div id="enable_authselect" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable authselect</h3>
<div>enable_authselect</div>
<h4>Description</h4>
<p>Configure user authentication setup to use the <tt>authselect</tt> tool.
If authselect profile is selected, the rule will enable the <tt>$var_authselect_profile</tt> profile.</p>
<h4>Rationale</h4>
<p>Authselect is a successor to authconfig.
It is a tool to select system authentication and identity sources from a list of supported
profiles instead of letting the administrator manually build the PAM stack.

That way, it avoids potential breakage of configuration, as it ships several tested profiles
that are well tested and supported to solve different use-cases.</p>
</div>

<div id="enable_pam_namespace" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Up a Private Namespace in PAM Configuration</h3>
<div>enable_pam_namespace</div>
<h4>Description</h4>
<p>To setup a private namespace add the following line to <tt>/etc/pam.d/login</tt>:
<pre>session    required     pam_namespace.so</pre></p>
<h4>Rationale</h4>
<p>The pam_namespace PAM module sets up a private namespace for a
session with polyinstantiated directories. A polyinstantiated directory
provides a different instance of itself based on user name, or when using
SELinux, user name, security context or both. The polyinstatied directories
can be used to dedicate separate temporary directories to each account.</p>
</div>

<div id="ensure_pam_wheel_group_empty" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure the Group Used by pam_wheel.so Module Exists on System and is Empty</h3>
<div>ensure_pam_wheel_group_empty</div>
<h4>Description</h4>
<p>Ensure that the group <tt><tt>$var_pam_wheel_group_for_su</tt></tt> referenced by
<tt>var_pam_wheel_group_for_su</tt> variable and used as value for the <tt>pam_wheel.so</tt>
<tt>group</tt> option exists and has no members. This empty group used by
<tt>pam_wheel.so</tt> in <tt>/etc/pam.d/su</tt> ensures that no user can run commands with
altered privileges through the <tt>su</tt> command.</p>
<h4>Rationale</h4>
<p>The <tt>su</tt> program allows to run commands with a substitute user and group ID.
It is commonly used to run commands as the root user.
Limiting access to such command is considered a good security practice.</p>
</div>

<div id="ensure_root_access_controlled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure root account access is controlled</h3>
<div>ensure_root_access_controlled</div>
<h4>Description</h4>
<p>There are a number of methods to access the root account directly.
Without a password set any user would be able to gain access and
thus control over the entire system.</p>
<h4>Rationale</h4>
<p>Access to root should be secured at all times.</p>
</div>

<div id="ensure_root_password_configured" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure Authentication Required for Single User Mode</h3>
<div>ensure_root_password_configured</div>
<h4>Description</h4>
<p>Single user mode is used for recovery when the system detects an
issue during boot or by manual selection from the bootloader.</p>
<h4>Rationale</h4>
<p>Requiring authentication in single user mode prevents an unauthorized
user from rebooting the system into single user to gain root privileges
without credentials.</p>
</div>

<div id="ensure_shadow_group_empty" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure shadow Group is Empty</h3>
<div>ensure_shadow_group_empty</div>
<h4>Description</h4>
<p>The shadow group allows system programs which require access the ability
to read the /etc/shadow file. No users should be assigned to the shadow group.</p>
<h4>Rationale</h4>
<p>Any users assigned to the shadow group would be granted read access to the
/etc/shadow file. If attackers can gain read access to the /etc/shadow file,
they can easily run a password cracking program against the hashed passwords
to break them. Other security information that is stored in the /etc/shadow
file (such as expiration) could also be useful to subvert additional user
accounts.</p>
</div>

<div id="ensure_sudo_group_restricted" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure sudo group has only necessary members</h3>
<div>ensure_sudo_group_restricted</div>
<h4>Description</h4>
<p>Developers and implementers can increase the assurance in security
functions by employing well-defined security policy models; structured,
disciplined, and rigorous hardware and software development techniques;
and sound system/security engineering principles. Implementation may
include isolation of memory space and libraries.

The Ubuntu operating system restricts access to security functions
through the use of access control mechanisms and by implementing least
privilege capabilities.</p>
<h4>Rationale</h4>
<p>Any users assigned to the sudo group would be granted administrator
access to the system.</p>
</div>

<div id="file_groupowner_etc_issue" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Group Ownership of System Login Banner</h3>
<div>file_groupowner_etc_issue</div>
<h4>Description</h4>
<p>
To properly set the group owner of <code>/etc/issue</code>, run the command:

  <pre>$ sudo chgrp root /etc/issue</pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper group ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_groupowner_etc_issue_net" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Group Ownership of System Login Banner for Remote Connections</h3>
<div>file_groupowner_etc_issue_net</div>
<h4>Description</h4>
<p>
To properly set the group owner of <code>/etc/issue.net</code>, run the command:

  <pre>$ sudo chgrp root /etc/issue.net</pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper group ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_groupowner_etc_motd" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Group Ownership of Message of the Day Banner</h3>
<div>file_groupowner_etc_motd</div>
<h4>Description</h4>
<p>
To properly set the group owner of <code>/etc/motd</code>, run the command:

  <pre>$ sudo chgrp root /etc/motd</pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper group ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_groupownership_lastlog" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Group Who Owns lastlog Command</h3>
<div>file_groupownership_lastlog</div>
<h4>Description</h4>
<p>
To properly set the group owner of <code>/var/log/lastlog</code>, run the command:

  <pre>$ sudo chgrp root /var/log/lastlog</pre>
  </p>
<h4>Rationale</h4>
<p>Unauthorized disclosure of the contents of the /var/log/lastlog file can reveal system data to
attackers, thus compromising its confidentiality.</p>
</div>

<div id="file_owner_etc_issue" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify ownership of System Login Banner</h3>
<div>file_owner_etc_issue</div>
<h4>Description</h4>
<p>
To properly set the owner of <code>/etc/issue</code>, run the command:

  <pre>$ sudo chown root /etc/issue </pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_owner_etc_issue_net" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify ownership of System Login Banner for Remote Connections</h3>
<div>file_owner_etc_issue_net</div>
<h4>Description</h4>
<p>
To properly set the owner of <code>/etc/issue.net</code>, run the command:

  <pre>$ sudo chown root /etc/issue.net </pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_owner_etc_motd" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify ownership of Message of the Day Banner</h3>
<div>file_owner_etc_motd</div>
<h4>Description</h4>
<p>
To properly set the owner of <code>/etc/motd</code>, run the command:

  <pre>$ sudo chown root /etc/motd </pre>
  </p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper ownership will ensure that only root user can modify the banner.</p>
</div>

<div id="file_ownership_home_directories" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>All Interactive User Home Directories Must Be Owned By The Primary User</h3>
<div>file_ownership_home_directories</div>
<h4>Description</h4>
<p>Change the owner of interactive users home directories to that correct
owner. To change the owner of a interactive users home directory, use
the following command:
<pre>$ sudo chown <i>USER</i> /home/<i>USER</i></pre>

This rule ensures every home directory related to an interactive user is
owned by an interactive user. It also ensures that interactive users are
owners of one and only one home directory.</p>
<h4>Rationale</h4>
<p>If a local interactive user does not own their home directory, unauthorized
users could access or modify the user's files, and the users may not be able to
access their own files.</p>
</div>

<div id="file_ownership_lastlog" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Owner on lastlog Command</h3>
<div>file_ownership_lastlog</div>
<h4>Description</h4>
<p>
To properly set the owner of <code>/usr/bin/lastlog</code>, run the command:

  <pre>$ sudo chown root /usr/bin/lastlog </pre>
  </p>
<h4>Rationale</h4>
<p>Unauthorized disclosure of the contents of the /var/log/lastlog file can reveal system data to
attackers, thus compromising its confidentiality.</p>
</div>

<div id="file_permission_user_bash_history" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure User Bash History File Has Correct Permissions</h3>
<div>file_permission_user_bash_history</div>
<h4>Description</h4>
<p>Set the mode of the bash history file to <tt>0600</tt> with the
following command:
<pre>$ sudo chmod 0600 /home/<i>USER</i>/.bash_history</pre></p>
<h4>Rationale</h4>
<p>Incorrect permissions may enable malicious users to recover
other users' command history.</p>
</div>

<div id="file_permissions_etc_issue" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify permissions on System Login Banner</h3>
<div>file_permissions_etc_issue</div>
<h4>Description</h4>
<p>
To properly set the permissions of <code>/etc/issue</code>, run the command:
<pre>$ sudo chmod 0644 /etc/issue</pre></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper permissions will ensure that only root user can modify the banner.</p>
</div>

<div id="file_permissions_etc_issue_net" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify permissions on System Login Banner for Remote Connections</h3>
<div>file_permissions_etc_issue_net</div>
<h4>Description</h4>
<p>
To properly set the permissions of <code>/etc/issue.net</code>, run the command:
<pre>$ sudo chmod 0644 /etc/issue.net</pre></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper permissions will ensure that only root user can modify the banner.</p>
</div>

<div id="file_permissions_etc_motd" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify permissions on Message of the Day Banner</h3>
<div>file_permissions_etc_motd</div>
<h4>Description</h4>
<p>
To properly set the permissions of <code>/etc/motd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/motd</pre></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper permissions will ensure that only root user can modify the banner.</p>
</div>

<div id="file_permissions_lastlog" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Permissions on lastlog Command</h3>
<div>file_permissions_lastlog</div>
<h4>Description</h4>
<p>
To properly set the permissions of <code>/usr/bin/lastlog</code>, run the command:
<pre>$ sudo chmod 0750 /usr/bin/lastlog</pre></p>
<h4>Rationale</h4>
<p>Unauthorized disclosure of the contents of the /var/log/lastlog file can reveal system data to
attackers, thus compromising its confidentiality.</p>
</div>

<div id="group_unique_id" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure All Groups on the System Have Unique Group ID</h3>
<div>group_unique_id</div>
<h4>Description</h4>
<p>Change the group name or delete groups, so each has a unique id.</p>
<h4>Rationale</h4>
<p>To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.</p>
</div>

<div id="group_unique_name" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure All Groups on the System Have Unique Group Names</h3>
<div>group_unique_name</div>
<h4>Description</h4>
<p>Change the group name or delete groups, so each has a unique name.</p>
<h4>Rationale</h4>
<p>To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.</p>
</div>

<div id="groups_no_zero_gid_except_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Only Group Root Has GID 0</h3>
<div>groups_no_zero_gid_except_root</div>
<h4>Description</h4>
<p>If any group other than root has a GID of 0, this misconfiguration should
be investigated and the groups other than root should be removed or have
their GID changed.</p>
<h4>Rationale</h4>
<p>Ensuring that only the <tt>root</tt> group has a GID of 0 helps prevent
root group owned files from becoming accidentally accessible to
non-privileged users.</p>
</div>

<div id="gui_login_dod_acknowledgement" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Display the Standard Mandatory DoD Notice and Consent Banner until Explicit Acknowledgement</h3>
<div>gui_login_dod_acknowledgement</div>
<h4>Description</h4>
<p>Display of a standardized and approved use notification before granting access to the SUSE operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.<br/><br/>

The banner must be acknowledged by the user prior to allowing the user access to the SUSE operating system. This provides assurance that the user has seen the message and accepted the conditions for access. If the consent banner is not acknowledged by the user, DoD will not be in compliance with system use notifications required by law.<br/><br/>

System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.<br/><br/>

The banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for the SUSE operating system:

<pre>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</pre>

Check the configuration by running the following command:

<pre># more /etc/gdm/Xsession</pre>

The beginning of the file must contain the following text immediately after <tt>#!/bin/sh</tt>:

<pre>if ! zenity --text-info \
--title "Consent" \
--filename=/etc/gdm/banner \
--no-markup \
--checkbox="Accept." 10 10; then
sleep 1;
exit 1;
fi</pre></p>
<h4>Rationale</h4>
<p>Display of a standardized and approved use notification before granting access to the operating system
ensures privacy and security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.
<br /><br />
For U.S. Government systems, system use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not exist.</p>
</div>

<div id="install_smartcard_packages" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install Smart Card Packages For Multifactor Authentication</h3>
<div>install_smartcard_packages</div>
<h4>Description</h4>
<p>Configure the operating system to implement multifactor authentication by
installing the required package with the following command:

The <code>openssl-pkcs11</code> package can be installed with the following command:
<pre>
$ sudo yum install openssl-pkcs11</pre></p>
<h4>Rationale</h4>
<p>Using an authentication device, such as a CAC or token that is separate from
the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.
<br /><br />
Multifactor solutions that require devices separate from
information systems gaining access include, for example, hardware tokens
providing time-based or challenge-response authenticators and smart cards
or similar secure authentication devices issued by an organization or identity provider.</p>
</div>

<div id="no_direct_root_logins" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Direct root Logins Not Allowed</h3>
<div>no_direct_root_logins</div>
<h4>Description</h4>
<p>To further limit access to the <tt>root</tt> account, administrators
can disable root logins at the console by editing the <tt>/etc/securetty</tt> file.
This file lists all devices the root user is allowed to login to. If the file does
not exist at all, the root user can login through any communication device on the
system, whether via the console or via a raw network interface. This is dangerous
as user can login to the system as root via Telnet, which sends the password in
plain text over the network. By default, Red Hat Enterprise Linux 8's
<tt>/etc/securetty</tt> file only allows the root user to login at the console
physically attached to the system. To prevent root from logging in, remove the
contents of this file. To prevent direct root logins, remove the contents of this
file by typing the following command:
<pre>
$ sudo echo &gt; /etc/securetty
</pre></p>
<h4>Rationale</h4>
<p>Disabling direct root logins ensures proper accountability and multifactor
authentication to privileged accounts. Users will first login, then escalate
to privileged (root) access via su / sudo. This is required for FISMA Low
and FISMA Moderate systems.</p>
</div>

<div id="no_dirs_unowned_by_root" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure that All Root's Path Directories Are Owned by Root</h3>
<div>no_dirs_unowned_by_root</div>
<h4>Description</h4>
<p>For each element in root's path, run:
<pre># ls -ld <i>DIR</i></pre>
and ensure that the directory is owned by the root user.</p>
<h4>Rationale</h4>
<p>Directories in root's path that are not owned by root could allow
unprivileged users to manipulate the execution environment of root,
potentially leading to privilege escalation or execution of malicious code.</p>
</div>

<div id="no_duplicate_uids" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure no duplicate UIDs exist</h3>
<div>no_duplicate_uids</div>
<h4>Description</h4>
<p>Although the useradd program will not let you create a duplicate User ID (UID),
it is possible for an administrator to manually edit the /etc/passwd file
and change the UID field. Users must be assigned unique UIDs for
accountability and to ensure appropriate access protections.</p>
<h4>Rationale</h4>
<p>Users must be assigned unique UIDs for accountability and to ensure
appropriate access protections.</p>
</div>

<div id="no_empty_passwords" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Prevent Login to Accounts With Empty Password</h3>
<div>no_empty_passwords</div>
<h4>Description</h4>
<p>If an account is configured for password authentication
but does not have an assigned password, it may be possible to log
into the account without authentication. Remove any instances of the
<tt>nullok</tt> in

<tt>/etc/pam.d/system-auth</tt> and
<tt>/etc/pam.d/password-auth</tt>

to prevent logins with empty passwords.</p>
<h4>Rationale</h4>
<p>If an account has an empty password, anyone could log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational environments.</p>
</div>

<div id="no_empty_passwords_unix" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Prevent Login to Accounts With Empty Password</h3>
<div>no_empty_passwords_unix</div>
<h4>Description</h4>
<p>If an account is configured for password authentication
but does not have an assigned password, it may be possible to log
into the account without authentication. Remove any instances of the
<tt>nullok</tt> in
<tt>/etc/pam.d/common-{password,auth,account,session,session-noninteractive}</tt>
to prevent logins with empty passwords.</p>
<h4>Rationale</h4>
<p>If an account has an empty password, anyone could log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational environments.</p>
</div>

<div id="no_invalid_shell_accounts_unlocked" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify Non-Interactive Accounts Are Locked</h3>
<div>no_invalid_shell_accounts_unlocked</div>
<h4>Description</h4>
<p>Accounts meant for non-interactive purposes should be locked to prevent
unauthorized access. Accounts with non-standard shells (those not defined in
<tt>/etc/shells</tt>) should be locked using <tt>usermod -L</tt>.</p>
<h4>Rationale</h4>
<p>Locking non-interactive accounts improves security by preventing potential
misuse. While many systems configure these accounts with invalid strings,
setting the shell field to <tt>nologin</tt> is also suggested</p>
</div>

<div id="no_legacy_plus_entries_etc_group" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure there are no legacy + NIS entries in /etc/group</h3>
<div>no_legacy_plus_entries_etc_group</div>
<h4>Description</h4>
<p>The <tt>+</tt> character in <tt>/etc/group</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.</p>
<h4>Rationale</h4>
<p>Using this method to include entries into <tt>/etc/group</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.</p>
</div>

<div id="no_legacy_plus_entries_etc_passwd" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure there are no legacy + NIS entries in /etc/passwd</h3>
<div>no_legacy_plus_entries_etc_passwd</div>
<h4>Description</h4>
<p>The <tt>+</tt> character in <tt>/etc/passwd</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.</p>
<h4>Rationale</h4>
<p>Using this method to include entries into <tt>/etc/passwd</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.</p>
</div>

<div id="no_legacy_plus_entries_etc_shadow" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure there are no legacy + NIS entries in /etc/shadow</h3>
<div>no_legacy_plus_entries_etc_shadow</div>
<h4>Description</h4>
<p>The <tt>+</tt> character in <tt>/etc/shadow</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.</p>
<h4>Rationale</h4>
<p>Using this method to include entries into <tt>/etc/shadow</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.</p>
</div>

<div id="no_netrc_files" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify No netrc Files Exist</h3>
<div>no_netrc_files</div>
<h4>Description</h4>
<p>The <tt>.netrc</tt> files contain login information
used to auto-login into FTP servers and reside in the user's home
directory. These files may contain unencrypted passwords to
remote FTP servers making them susceptible to access by unauthorized
users and should not be used.  Any <tt>.netrc</tt> files should be removed.</p>
<h4>Rationale</h4>
<p>Unencrypted passwords for remote FTP servers may be stored in <tt>.netrc</tt>
files.</p>
</div>

<div id="no_nologin_in_shells" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure nologin Shell is Not Listed in /etc/shells</h3>
<div>no_nologin_in_shells</div>
<h4>Description</h4>
<p>The <tt>/sbin/nologin</tt> shell is used to restrict accounts from having login access
and should not be listed as a valid login shell in <tt>/etc/shells</tt>.
To verify that nologin is not listed in /etc/shells, run:
<pre>$ grep nologin /etc/shells</pre>
The command should return no output.</p>
<h4>Rationale</h4>
<p>The <tt>/etc/shells</tt> is consulted by various programs to evaluate
whether the user is somehow restricted. For example, the chsh utility will
consult the file to determine if the user is allowed to change their shell. </p>
</div>

<div id="no_password_auth_for_systemaccounts" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure that System Accounts Are Locked</h3>
<div>no_password_auth_for_systemaccounts</div>
<h4>Description</h4>
<p>Some accounts are not associated with a human user of the system, and exist to perform some
administrative functions. An attacker should not be able to log into these accounts.
<br/><br/>
System accounts are those user accounts with a user ID less than <tt>1000</tt>.
If any system account other than <tt>root</tt>, <tt>halt</tt>, <tt>sync</tt>, <tt>shutdown</tt>
and <tt>nfsnobody</tt> has an unlocked password, disable it with the command:
<pre>$ sudo usermod -L <i>account</i></pre></p>
<h4>Rationale</h4>
<p>Disabling authentication for default system accounts makes it more difficult for attackers
to make use of them to compromise a system.</p>
</div>

<div id="no_rhost_files" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify No .rhost Files Exist</h3>
<div>no_rhost_files</div>
<h4>Description</h4>
<p>Local system users should not have a <tt>.rhost</tt> file in their home directory.</p>
<h4>Rationale</h4>
<p>User configuration files with excessive or incorrect access may enable malicious users
to steal or modify other users' data or to gain another user's system privileges.
The <tt>.rhost</tt> file provides the "remote authentication" database for the rcp, rlogin, and
rsh commands and the rcmd() function. These files bypass the standard
password-based user authentication mechanism. They specify remote hosts and
users that are considered trusted (i.e. are allowed to access the local system
without supplying a password).</p>
</div>

<div id="no_root_webbrowsing" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict Web Browser Use for Administrative Accounts</h3>
<div>no_root_webbrowsing</div>
<h4>Description</h4>
<p>Enforce policy requiring administrative accounts use web browsers only for
local service administration.</p>
<h4>Rationale</h4>
<p>If a browser vulnerability is exploited while running with administrative privileges,
the entire system could be compromised. Specific exceptions for local service
administration should be documented in site-defined policy.</p>
</div>

<div id="no_shelllogin_for_systemaccounts" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure that System Accounts Do Not Run a Shell Upon Login</h3>
<div>no_shelllogin_for_systemaccounts</div>
<h4>Description</h4>
<p>Some accounts are not associated with a human user of the system, and exist to perform some
administrative functions. Should an attacker be able to log into these accounts, they should
not be granted access to a shell.
<br/><br/>
The login shell for each local account is stored in the last field of each line in
<tt>/etc/passwd</tt>. System accounts are those user accounts with a user ID less than
<tt>1000</tt>. The user ID is stored in the third field. If any system account
other than <tt>root</tt> has a login shell, disable it with the command:
<pre>$ sudo usermod -s /sbin/nologin <i>account</i></pre></p>
<h4>Rationale</h4>
<p>Ensuring shells are not given to system accounts upon login makes it more difficult for
attackers to make use of system accounts.</p>
</div>

<div id="package_nss_sss_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install nss-sss Package</h3>
<div>package_nss_sss_installed</div>
<h4>Description</h4>
<p>The <code>libnss-sss</code> package can be installed with the following command:
<pre>
$ sudo yum install libnss-sss</pre></p>
<h4>Rationale</h4>
<p>libnss-sss contains library that is needed
by SSSD (System Security Services Daemon)..</p>
</div>

<div id="package_pam_apparmor_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install the pam_apparmor Package</h3>
<div>package_pam_apparmor_installed</div>
<h4>Description</h4>
<p>The <code>pam_apparmor</code> package can be installed with the following command:
<pre>
$ sudo yum install pam_apparmor</pre></p>
<h4>Rationale</h4>
<p>Protection of system integrity using AppArmor depends on this package being
installed.</p>
</div>

<div id="package_pam_modules_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install pam-modules Package</h3>
<div>package_pam_modules_installed</div>
<h4>Description</h4>
<p>The <code>libpam-modules</code> package can be installed with the following command:
<pre>
$ sudo yum install libpam-modules</pre></p>
<h4>Rationale</h4>
<p>libpam-modules contains PAM modules that are needed
by other rules when configuring PAM options.</p>
</div>

<div id="package_pam_pwquality_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install pam_pwquality Package</h3>
<div>package_pam_pwquality_installed</div>
<h4>Description</h4>
<p>
The <code>libpwquality</code> package can be installed with the following command:
<pre>
$ sudo yum install libpwquality</pre></p>
<h4>Rationale</h4>
<p>Use of a complex password helps to increase the time and resources required
to compromise the password. Password complexity, or strength, is a measure
of the effectiveness of a password in resisting attempts at guessing and
brute-force attacks. "pwquality" enforces complex password construction
configuration and has the ability to limit brute-force attacks on the system.</p>
</div>

<div id="package_pam_runtime_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install pam-runtime Package</h3>
<div>package_pam_runtime_installed</div>
<h4>Description</h4>
<p>The <code>libpam-runtime</code> package can be installed with the following command:
<pre>
$ sudo yum install libpam-runtime</pre></p>
<h4>Rationale</h4>
<p>libpam-runtime contains configuration that is needed
by other rules when configuring PAM options.</p>
</div>

<div id="package_pam_sss_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install pam-sss Package</h3>
<div>package_pam_sss_installed</div>
<h4>Description</h4>
<p>The <code>libpam-sss</code> package can be installed with the following command:
<pre>
$ sudo yum install libpam-sss</pre></p>
<h4>Rationale</h4>
<p>libpam-sss has pam module for the SSSD
(System Security Services Daemon).</p>
</div>

<div id="package_pcsc-lite_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install the pcsc-lite package</h3>
<div>package_pcsc-lite_installed</div>
<h4>Description</h4>
<p>The <code>pcsc-lite</code> package can be installed with the following command:
<pre>
$ sudo yum install pcsc-lite</pre></p>
<h4>Rationale</h4>
<p>The pcsc-lite package must be installed if it is to be available for
multifactor authentication using smartcards.</p>
</div>

<div id="package_screen_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Install the screen Package</h3>
<div>package_screen_installed</div>
<h4>Description</h4>
<p>To enable console screen locking, install the <tt>screen</tt> package.
The <code>screen</code> package can be installed with the following command:
<pre>
$ sudo yum install screen</pre>
Instruct users to begin new terminal sessions with the following command:
<pre>$ screen</pre>
The console can now be locked with the following key combination:
<pre>ctrl+a x</pre></p>
<h4>Rationale</h4>
<p>A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate
physical vicinity of the information system but does not logout because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operation system session prior to vacating the vicinity,
operating systems need to be able to identify when a user's session has idled and take action to initiate the
session lock.
<br /><br />
The <tt>screen</tt> package allows for a session lock to be implemented and configured.</p>
</div>

<div id="pam_disable_automatic_configuration" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>The PAM configuration should not be changed automatically</h3>
<div>pam_disable_automatic_configuration</div>
<h4>Description</h4>
<p>Verify the SUSE operating system is configured to not overwrite Pluggable
Authentication Modules (PAM) configuration on package changes.</p>
<h4>Rationale</h4>
<p><tt>pam-config</tt> is a command line utility that automatically generates
a system PAM configuration as packages are installed, updated or removed
from the system. <tt>pam-config</tt> removes configurations for PAM modules
and parameters that it does not know about. It may render ineffective PAM
configuration by the system administrator and thus impact system security.</p>
</div>

<div id="passwd_system-auth_substack" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure PAMs passwd Module To Implement system-auth Substack When Changing Passwords</h3>
<div>passwd_system-auth_substack</div>
<h4>Description</h4>
<p>Verify that pam is configured to use <tt>/etc/pam.d/system-auth</tt>
when changing passwords. Look for the following line in <tt>/etc/pam.d/passwd</tt>:
<pre>password substack system-auth</pre></p>
<h4>Rationale</h4>
<p>Including system-auth from the passwd module ensures that the user must pass through
the PAM configuration for system authentication as found in /etc/pam.d/system-auth
when changing passwords.</p>
</div>

<div id="policy_temp_passwords_immediate_change" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Policy Requires Immediate Change of Temporary Passwords</h3>
<div>policy_temp_passwords_immediate_change</div>
<h4>Description</h4>
<p>Temporary passwords for Red Hat Enterprise Linux 8 operating system logons must
require an immediate change to a permanent password.

Verify that a policy exists that ensures when a user is created, it is
creating using a method that forces a user to change their password upon
their next login.</p>
<h4>Rationale</h4>
<p>Without providing this capability, an account may be created without a
password. Nonrepudiation cannot be guaranteed once an account is created if
a user is not forced to change the temporary password upon initial logon.

Temporary passwords are typically used to allow access when new accounts
are created or passwords are changed. It is common practice for
administrators to create temporary passwords for user accounts that allow
the users to log on, yet force them to change the password once they have
successfully authenticated.</p>
</div>

<div id="prevent_direct_root_logins" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Direct root Logins Are Not Allowed</h3>
<div>prevent_direct_root_logins</div>
<h4>Description</h4>
<p>Configure the operating system to prevent direct logins to the
<tt>root</tt> account by performing the following operations:
<pre>$ sudo passwd -l root</pre></p>
<h4>Rationale</h4>
<p>Disabling direct root logins ensures proper accountability and
multifactor authentication to privileged accounts.</p>
</div>

<div id="require_singleuser_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Require Authentication for Single User Mode</h3>
<div>require_singleuser_auth</div>
<h4>Description</h4>
<p>Single-user mode is intended as a system recovery
method, providing a single user root access to the system by
providing a boot option at startup.
<br /><br />
By default, single-user mode is protected by requiring a password and is set
in <tt>/usr/lib/systemd/system/rescue.service</tt>.</p>
<h4>Rationale</h4>
<p>This prevents attackers with physical access from trivially bypassing security
on the machine and gaining root access. Such accesses are further prevented
by configuring the bootloader password.</p>
</div>

<div id="restrict_serial_port_logins" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict Serial Port Root Logins</h3>
<div>restrict_serial_port_logins</div>
<h4>Description</h4>
<p>To restrict root logins on serial ports,
ensure lines of this form do not appear in <tt>/etc/securetty</tt>:
<pre>ttyS0
ttyS1</pre></p>
<h4>Rationale</h4>
<p>Preventing direct root login to serial port interfaces
helps ensure accountability for actions taken on the systems
using the root account.</p>
</div>

<div id="root_path_all_dirs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Ensure that All Entries in The Path of Root Are Directories</h3>
<div>root_path_all_dirs</div>
<h4>Description</h4>
<p>For each element in root's path, run:
<pre># ls -ld <i>DIR</i></pre>
and ensure that the entry is a directory.</p>
<h4>Rationale</h4>
<p>Locations in root's path that are not directories could cause unexpected behavior,
such as executing scripts from unintended locations. Ensuring that all locations in
root's path are directories helps maintain a secure environment for root.</p>
</div>

<div id="root_path_default" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Root Path Must Be Vendor Default</h3>
<div>root_path_default</div>
<h4>Description</h4>
<p>Assuming root shell is bash, edit the following files:
<pre>~/.profile</pre>
<pre>~/.bashrc</pre>
Change any <tt>PATH</tt> variables to the vendor default for root and remove any
empty <tt>PATH</tt> entries or references to relative paths.</p>
<h4>Rationale</h4>
<p>The root account's executable search path must be the vendor default, and must
contain only absolute paths.</p>
</div>

<div id="sebool_httpd_mod_auth_pam" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Disable the httpd_mod_auth_pam SELinux Boolean</h3>
<div>sebool_httpd_mod_auth_pam</div>
<h4>Description</h4>
<p>By default, the SELinux boolean <tt>httpd_mod_auth_pam</tt> is disabled.
If this setting is enabled, it should be disabled.

To disable the <code>httpd_mod_auth_pam</code> SELinux boolean, run the following command:
<pre>$ sudo setsebool -P httpd_mod_auth_pam off</pre></p>
<h4>Rationale</h4>
<p></p>
</div>

<div id="securetty_root_login_console_only" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Restrict Virtual Console Root Logins</h3>
<div>securetty_root_login_console_only</div>
<h4>Description</h4>
<p>To restrict root logins through the (deprecated) virtual console devices,
ensure lines of this form do not appear in <tt>/etc/securetty</tt>:
<pre>vc/1
vc/2
vc/3
vc/4</pre></p>
<h4>Rationale</h4>
<p>Preventing direct root login to virtual console devices
helps ensure accountability for actions taken on the system
using the root account.</p>
</div>

<div id="service_pcscd_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable the pcscd Service</h3>
<div>service_pcscd_enabled</div>
<h4>Description</h4>
<p>
The <code>pcscd</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable pcscd.service</pre></p>
<h4>Rationale</h4>
<p>Using an authentication device, such as a CAC or token that is separate from
the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.
<br /><br />
Multifactor solutions that require devices separate from
information systems gaining access include, for example, hardware tokens
providing time-based or challenge-response authenticators and smart cards
or similar secure authentication devices issued by an organization or identity provider.</p>
</div>

<div id="set_password_hashing_algorithm_auth_stig" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Hashing Algorithm for PAM</h3>
<div>set_password_hashing_algorithm_auth_stig</div>
<h4>Description</h4>
<p>The PAM system service can be configured to only store encrypted representations of passwords.
In "/etc/pam.d/common-password", the <tt>password</tt> section of the file controls which
PAM modules to execute during a password change.

Set the <tt>pam_unix.so</tt> module in the <tt>password</tt> section to include the option
<tt>sha512</tt> and no other hashing algorithms as shown below:
<br />
<pre>password    [success=1 default=ignore]   pam_unix.so sha512 <i>other arguments...</i></pre>
<br />
This will help ensure that new passwords for local users will be stored using the sha512 algorithm.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and encryption is the standard method for
protecting passwords. If passwords are not encrypted, they can be plainly read
(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm
are no more protected than if they are kept in plain text.
<br /><br />
This setting ensures user and group account administration utilities are configured to store
only encrypted representations of passwords.</p>
</div>

<div id="set_password_hashing_algorithm_commonauth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set PAM's Common Authentication Hashing Algorithm</h3>
<div>set_password_hashing_algorithm_commonauth</div>
<h4>Description</h4>
<p>The PAM system service can be configured to only store encrypted
representations of passwords. In
<tt>/etc/pam.d/common-auth</tt>,
the
<tt>auth</tt> section of the file controls which PAM modules execute
during a password change. Set the <tt>pam_unix.so</tt> module in the
<tt>auth</tt> section to include the argument <tt>sha512</tt>, as shown
below:
<br />
<pre>auth   required    pam_unix.so sha512 <i>other arguments...</i></pre>
<br />
This will help ensure when local users change their authentication method,
hashes for the new authentications will be generated using the SHA-512
algorithm. This is the default.</p>
<h4>Rationale</h4>
<p>Unapproved mechanisms used for authentication to the cryptographic module
are not verified and therefore cannot be relied on to provide
confidentiality or integrity, and data may be compromised.
This setting ensures user and group account administration utilities are
configured to store only encrypted representations of passwords.
Additionally, the <tt>crypt_style</tt> configuration option ensures the use
of a strong hashing algorithm that makes password cracking attacks more
difficult.</p>
</div>

<div id="set_password_hashing_algorithm_logindefs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Hashing Algorithm in /etc/login.defs</h3>
<div>set_password_hashing_algorithm_logindefs</div>
<h4>Description</h4>
<p>In <tt>/etc/login.defs</tt>, add or update the following line to ensure the system will use
<tt>$var_password_hashing_algorithm</tt> as the hashing algorithm:
<pre>ENCRYPT_METHOD <tt>$var_password_hashing_algorithm</tt></pre></p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and encryption is the standard method for
protecting passwords. If passwords are not encrypted, they can be plainly read
(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm
are no more protected than if they are kept in plain text.
<br /><br />
Using a stronger hashing algorithm makes password cracking attacks more difficult.</p>
</div>

<div id="set_password_hashing_algorithm_passwordauth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set PAM''s Password Hashing Algorithm - password-auth</h3>
<div>set_password_hashing_algorithm_passwordauth</div>
<h4>Description</h4>
<p>The PAM system service can be configured to only store encrypted representations of passwords.
In <tt>/etc/pam.d/password-auth</tt>, the <tt>password</tt> section of the file controls which
PAM modules to execute during a password change.

Set the <tt>pam_unix.so</tt> module in the <tt>password</tt> section to include the option
<tt><tt>$var_password_hashing_algorithm_pam</tt></tt> and no other hashing
algorithms as shown below:
<br />
<pre>password    sufficient    pam_unix.so <tt>$var_password_hashing_algorithm_pam</tt> <i>other arguments...</i></pre>
<br />
This will help ensure that new passwords for local users will be stored using the
<tt>$var_password_hashing_algorithm_pam</tt> algorithm.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and encryption is the standard method for
protecting passwords. If passwords are not encrypted, they can be plainly read
(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm
are no more protected than if they are kept in plain text.
<br /><br />
This setting ensures user and group account administration utilities are configured to store
only encrypted representations of passwords. Additionally, the <tt>crypt_style</tt>
configuration option in <tt>/etc/libuser.conf</tt> ensures the use of a strong hashing
algorithm that makes password cracking attacks more difficult.</p>
</div>

<div id="set_password_hashing_algorithm_systemauth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set PAM''s Password Hashing Algorithm</h3>
<div>set_password_hashing_algorithm_systemauth</div>
<h4>Description</h4>
<p>The PAM system service can be configured to only store encrypted representations of passwords.
In "/etc/pam.d/system-auth", the <tt>password</tt> section of the file controls which
PAM modules to execute during a password change.

Set the <tt>pam_unix.so</tt> module in the <tt>password</tt> section to include the option
<tt><tt>$var_password_hashing_algorithm_pam</tt></tt> and no other hashing
algorithms as shown below:
<br />

<pre>password    sufficient    pam_unix.so <tt>$var_password_hashing_algorithm_pam</tt> <i>other arguments...</i></pre>

<br />
This will help ensure that new passwords for local users will be stored using the
<tt>$var_password_hashing_algorithm_pam</tt> algorithm.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and encryption is the standard method for
protecting passwords. If passwords are not encrypted, they can be plainly read
(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm
are no more protected than if they are kept in plain text.
<br /><br />
This setting ensures user and group account administration utilities are configured to store
only encrypted representations of passwords. Additionally, the <tt>crypt_style</tt>
configuration option in <tt>/etc/libuser.conf</tt> ensures the use of a strong hashing
algorithm that makes password cracking attacks more difficult.</p>
</div>

<div id="set_password_hashing_min_rounds_logindefs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set Password Hashing Rounds in /etc/login.defs</h3>
<div>set_password_hashing_min_rounds_logindefs</div>
<h4>Description</h4>
<p>In <tt>/etc/login.defs</tt>, ensure <tt>SHA_CRYPT_MIN_ROUNDS</tt> and
<tt>SHA_CRYPT_MAX_ROUNDS</tt> has the minimum value of <tt><tt>$var_password_hashing_min_rounds_login_defs</tt></tt>.
For example:
<pre>SHA_CRYPT_MIN_ROUNDS <tt>$var_password_hashing_min_rounds_login_defs</tt>
SHA_CRYPT_MAX_ROUNDS <tt>$var_password_hashing_min_rounds_login_defs</tt></pre>
Notice that if neither are set, they already have the default value of 5000.
If either is set, they must have the minimum value of <tt>$var_password_hashing_min_rounds_login_defs</tt>.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and hashing is the standard
method for protecting passwords. If passwords are not hashed, they can
be plainly read (i.e., clear text) and easily compromised. Passwords
that are hashed with a weak algorithm are no more protected than if
they are kept in plain text.
<br /><br />
Using more hashing rounds makes password cracking attacks more difficult.</p>
</div>

<div id="set_password_hashing_yescrypt_cost_factor_logindefs" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Set yescrypt Cost Factor in /etc/login.defs</h3>
<div>set_password_hashing_yescrypt_cost_factor_logindefs</div>
<h4>Description</h4>
<p>In <tt>/etc/login.defs</tt>, ensure <tt>YESCRYPT_COST_FACTOR</tt> has the minimum value of <tt><tt>$var_password_yescrypt_cost_factor_login_defs</tt></tt>.
For example:
<pre>YESCRYPT_COST_FACTOR <tt>$var_password_yescrypt_cost_factor_login_defs</tt>
YESCRYPT_COST_FACTOR <tt>$var_password_yescrypt_cost_factor_login_defs</tt></pre>
Notice that if is not set, it already has the default value of 5.
If it is set, it must have the minimum value of <tt>$var_password_yescrypt_cost_factor_login_defs</tt>.</p>
<h4>Rationale</h4>
<p>Passwords need to be protected at all times, and hashing is the standard
method for protecting passwords. If passwords are not hashed, they can
be plainly read (i.e., clear text) and easily compromised. Passwords
that are hashed with a weak algorithm are no more protected than if
they are kept in plain text.
<br /><br />
Using a higher cost factor makes password cracking attacks more difficult.</p>
</div>

<div id="smartcard_auth" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Smart Card Login</h3>
<div>smartcard_auth</div>
<h4>Description</h4>
<p>To enable smart card authentication, consult the documentation at:
<ul>

</ul>


For guidance on enabling SSH to authenticate against a Common Access Card (CAC), consult documentation at:
<ul>
<li><b>
    <a xmlns='http://www.w3.org/1999/xhtml' href='https://access.redhat.com/solutions/82273'>https://access.redhat.com/solutions/82273</a></b></li>
</ul></p>
<h4>Rationale</h4>
<p>Smart card login provides two-factor authentication stronger than
that provided by a username and password combination. Smart cards leverage PKI
(public key infrastructure) in order to provide and verify credentials.</p>
</div>

<div id="smartcard_configure_ca" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Smart Card Certificate Authority Validation</h3>
<div>smartcard_configure_ca</div>
<h4>Description</h4>
<p>Configure the operating system to do certificate status checking for PKI
authentication. Modify all of the <tt>cert_policy</tt> lines in
<tt>/etc/pam_pkcs11/pam_pkcs11.conf</tt> to include <tt>ca</tt> like so:
<pre>cert_policy = ca, ocsp_on, signature;</pre></p>
<h4>Rationale</h4>
<p>Using an authentication device, such as a CAC or token that is separate from
the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.
<br /><br />
Multifactor solutions that require devices separate from
information systems gaining access include, for example, hardware tokens
providing time-based or challenge-response authenticators and smart cards
or similar secure authentication devices issued by an organization or identity provider.</p>
</div>

<div id="smartcard_configure_cert_checking" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Smart Card Certificate Status Checking</h3>
<div>smartcard_configure_cert_checking</div>
<h4>Description</h4>
<p>Configure the operating system to do certificate status checking for PKI
authentication. Modify all of the <tt>cert_policy</tt> lines in
<tt>/etc/pam_pkcs11/pam_pkcs11.conf</tt> to include <tt>ocsp_on</tt> like so:
<pre>cert_policy = ca, ocsp_on, signature;</pre></p>
<h4>Rationale</h4>
<p>Using an authentication device, such as a CAC or token that is separate from
the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.
<br /><br />
Multifactor solutions that require devices separate from
information systems gaining access include, for example, hardware tokens
providing time-based or challenge-response authenticators and smart cards
or similar secure authentication devices issued by an organization or identity provider.</p>
</div>

<div id="smartcard_configure_crl" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure Smart Card Local Cache of Revocation Data</h3>
<div>smartcard_configure_crl</div>
<h4>Description</h4>
<p>Configure the operating system for PKI-based authentication to use
local revocation data when unable to access the network to obtain it
remotely. Modify all of the <tt>cert_policy</tt> lines in
<tt>/etc/pam_pkcs11/pam_pkcs11.conf</tt> to include <tt>crl_auto</tt>
or <tt>crl_offline</tt> like so:
<pre>cert_policy = ca,signature,ocsp_on,crl_auto;</pre></p>
<h4>Rationale</h4>
<p>Without configuring a local cache of revocation data, there is the
potential to allow access to users who are no longer authorized
(users with revoked certificates).</p>
</div>

<div id="smartcard_pam_enabled" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable Smart Card Logins in PAM</h3>
<div>smartcard_pam_enabled</div>
<h4>Description</h4>
<p>This requirement only applies to components where this is specific to the
function of the device or has the concept of an organizational user (e.g.,
VPN, proxy capability). This does not apply to authentication for the
purpose of configuring the device itself (management).


Check that the <tt>pam_pkcs11.so</tt> option is configured in the
<tt>etc/pam.d/common-auth</tt> file with the following command:

<pre># grep pam_pkcs11.so /etc/pam.d/common-auth

auth sufficient pam_pkcs11.so</pre>


For general information about enabling smart card authentication, consult
the documentation at:

<ul>
<li><b>
    <a xmlns='http://www.w3.org/1999/xhtml' href='https://www.suse.com/c/configuring-smart-card-authentication-suse-linux-enterprise/'>https://www.suse.com/c/configuring-smart-card-authentication-suse-linux-enterprise/</a></b></li>
</ul></p>
<h4>Rationale</h4>
<p>Smart card login provides two-factor authentication stronger than
that provided by a username and password combination. Smart cards leverage PKI
(public key infrastructure) in order to provide and verify credentials.

Using an authentication device, such as a CAC or token that is separate
from the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.

Multifactor solutions that require devices separate from information
systems gaining access include, for example, hardware tokens providing
time-based or challenge-response authenticators and smart cards
or similar secure authentication devices issued by an organization or identity provider.</p>
</div>

<div id="sshd_enable_pam" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enable PAM</h3>
<div>sshd_enable_pam</div>
<h4>Description</h4>
<p>UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will
enable PAM authentication using ChallengeResponseAuthentication and
PasswordAuthentication in addition to PAM account and session module processing for all
authentication types.

To enable PAM authentication, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>UsePAM yes</pre></p>
<h4>Rationale</h4>
<p>When UsePAM is set to yes, PAM runs through account and session types properly. This is
important if you want to restrict access to services based off of IP, time or other factors of
the account. Additionally, you can make sure users inherit certain environment variables
on login or disallow access to the server.</p>
</div>

<div id="sssd_enable_pam_services" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Configure PAM in SSSD Services</h3>
<div>sssd_enable_pam_services</div>
<h4>Description</h4>
<p>SSSD should be configured to run SSSD <tt>pam</tt> services.
To configure SSSD to known SSH hosts, add <tt>pam</tt>
to <tt>services</tt> under the <tt>[sssd]</tt> section in
<tt>/etc/sssd/sssd.conf</tt>. For example:
<pre>[sssd]
services = sudo, autofs, pam
</pre></p>
<h4>Rationale</h4>
<p>Using an authentication device, such as a CAC or token that is separate from
the information system, ensures that even if the information system is
compromised, that compromise will not affect credentials stored on the
authentication device.</p>
</div>

<div id="use_pam_wheel_for_su" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enforce usage of pam_wheel for su authentication</h3>
<div>use_pam_wheel_for_su</div>
<h4>Description</h4>
<p>To ensure that only users who are members of the <tt>wheel</tt> group can
run commands with altered privileges through the <tt>su</tt> command, make
sure that the following line exists in the file <tt>/etc/pam.d/su</tt>:
<pre>auth required pam_wheel.so use_uid</pre></p>
<h4>Rationale</h4>
<p>The <tt>su</tt> program allows to run commands with a substitute user and
group ID. It is commonly used to run commands as the root user. Limiting
access to such command is considered a good security practice.</p>
</div>

<div id="use_pam_wheel_group_for_su" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Enforce Usage of pam_wheel with Group Parameter for su Authentication</h3>
<div>use_pam_wheel_group_for_su</div>
<h4>Description</h4>
<p>To ensure that only users who are members of the group set in the <tt>group</tt> option of
<tt>pam_wheel.so</tt> module can run commands with altered privileges through the <tt>su</tt>
command, make sure that the following line exists in the file <tt>/etc/pam.d/su</tt>:
<pre>auth required pam_wheel.so use_uid group=<tt>$var_pam_wheel_group_for_su</tt></pre></p>
<h4>Rationale</h4>
<p>The <tt>su</tt> program allows to run commands with a substitute user and group ID.
It is commonly used to run commands as the root user.
Limiting access to such command is considered a good security practice.</p>
</div>

<div id="verify_use_mappers" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Verify that 'use_mappers' is set to 'pwent' in PAM</h3>
<div>verify_use_mappers</div>
<h4>Description</h4>
<p>The operating system must map the authenticated identity to the user or
group account for PKI-based authentication.

Verify that <tt>use_mappers</tt> is set to <tt>pwent</tt> in
<tt>/etc/pam_pkcs11/pam_pkcs11.conf</tt> file with the following command:

<pre>$ grep ^use_mappers /etc/pam_pkcs11/pam_pkcs11.conf

use_mappers = pwent</pre></p>
<h4>Rationale</h4>
<p>Without mapping the certificate used to authenticate to the user account,
the ability to determine the identity of the individual user or group will
not be available for forensic analysis.</p>
</div>

<div id="vlock_installed" class="rule" style="border-bottom: 2px solid; margin-bottom: 1cm; padding-bottom: 1cm;">
<h3>Check that vlock is installed to allow session locking</h3>
<div>vlock_installed</div>
<h4>Description</h4>
<p>The Red Hat Enterprise Linux 8 operating system must have vlock installed to allow for session locking.


The <code>kbd</code> package can be installed with the following command:
<pre>
$ sudo yum install kbd</pre></p>
<h4>Rationale</h4>
<p>A session lock is a temporary action taken when a user stops work and
moves away from the immediate physical vicinity of the information
system but does not want to log out because of the temporary nature of
the absence.

The session lock is implemented at the point where session activity can
be determined.

Regardless of where the session lock is determined and implemented,
once invoked, the session lock must remain in place until the user
reauthenticates. No other activity aside from reauthentication must
unlock the system.</p>
</div>




</body>
</html>