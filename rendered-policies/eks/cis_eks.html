<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8"/>
  <title>Definition of Configuration Recommendations of an EKS System for eks</title>
  
<style>
</style>
</head>
<body>



<h1>Definition of Configuration Recommendations of an EKS System for eks</h1>



based on <a href="https://www.cisecurity.org/cis-benchmarks/">https://www.cisecurity.org/cis-benchmarks/</a>


<div class="all_controls">
<div class="one_control">
  <h2>1: 1 Control Plane Components</h2>
  <p>Description: Security is a shared responsibility between AWS and the Amazon EKS customer. The shared responsibility model describes this as security of the cloud and security in the cloud:

Security of the cloud – AWS is responsible for protecting the infrastructure that runs AWS services in the AWS Cloud. For Amazon EKS, AWS is responsible for the Kubernetes control plane, which includes the control plane nodes and etcd database. Third-party auditors regularly test and verify the effectiveness of our security as part of the AWS compliance programs. To learn about the compliance programs that apply to Amazon EKS, see AWS Services in Scope by Compliance Program.

Security in the cloud – Your responsibility includes the following areas.

    - The security configuration of the data plane, including the configuration of the security groups that allow traffic to pass from the Amazon EKS control plane into the customer VPC

    - The configuration of the worker nodes and the containers themselves

    - The worker node guest operating system (including updates and security patches)
        - Amazon EKS follows the shared responsibility model for CVEs and security patches on managed node groups. Because managed nodes run the Amazon
          EKS-optimized AMIs, Amazon EKS is responsible for building patched versions of these AMIs when bugs or issues are reported and we are able to publish a fix. However, customers are responsible for deploying these patched AMI versions to your managed node groups.

    - Other associated application software:

      - Setting up and managing network controls, such as firewall rules

      - Managing platform-level identity and access management, either with or in addition to IAM

    - The sensitivity of your data, your company’s requirements, and applicable laws and regulations

AWS is responsible for securing the control plane, though you might be able to configure certain options based on your requirements.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>2.1.1: 2.1.1 Enable audit Logs</h2>
  <p>Description: Description:

The audit logs are part of the EKS managed Kubernetes control plane logs that are managed
by Amazon EKS. Amazon EKS is integrated with AWS CloudTrail, a service that provides a
record of actions taken by a user, role, or an AWS service in Amazon EKS. CloudTrail
captures all API calls for Amazon EKS as events. The calls captured include calls from the
Amazon EKS console and code calls to the Amazon EKS API operations.

Rationale:

Exporting logs and metrics to a dedicated, persistent datastore such as CloudTrail ensures
availability of audit data following a cluster security event, and provides a central location
for analysis of log and metric data collated from multiple sources.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/logging/audit_logging/rule.yml"> audit_logging</a>: Ensure Audit Logging is Enabled
      <ul><li>CCE-87445-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>2.1: 2.1 Logging</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/logging/audit_logging/rule.yml"> audit_logging</a>: Ensure Audit Logging is Enabled
      <ul><li>CCE-87445-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>2: 2 Control Plane Configuration</h2>
  <p>Description: This section contains recommendations for Amazon EKS control plane logging
configuration. Customers are able to configure logging for control plane in
Amazon EKS.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/logging/audit_logging/rule.yml"> audit_logging</a>: Ensure Audit Logging is Enabled
      <ul><li>CCE-87445-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.1.1: 3.1.1 Ensure that the kubeconfig file permissions are set to 644 or more restrictive</h2>
  <p>Description: Description:

If kubelet is running, and if it is using a file-based kubeconfig file, ensure that the proxy
kubeconfig file has permissions of 644 or more restrictive.

Rationale:

The kubelet kubeconfig file controls various parameters of the kubelet service in the
worker node. You should restrict its file permissions to maintain the integrity of the file.
The file should be writable by only the administrators on the system.
It is possible to run kubelet with the kubeconfig parameters configured as a Kubernetes
ConfigMap instead of a file. In this case, there is no proxy kubeconfig file.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_worker_kubeconfig/rule.yml"> file_permissions_worker_kubeconfig</a>: Verify Permissions on the Worker Kubeconfig File
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.1.2: 3.1.2 Ensure that the kubelet kubeconfig file ownership is set to root:root</h2>
  <p>Description: Description:

If kubelet is running, ensure that the file ownership of its kubeconfig file is set to
root:root.

Rationale:

The kubeconfig file for kubelet controls various parameters for the kubelet service in the
worker node. You should set its file ownership to maintain the integrity of the file. The file
should be owned by root:root.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_worker_kubeconfig/rule.yml"> file_groupowner_worker_kubeconfig</a>: Verify Group Who Owns The Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_worker_kubeconfig/rule.yml"> file_owner_worker_kubeconfig</a>: Verify User Who Owns The Worker Kubeconfig File
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.1.3: 3.1.3 Ensure that the kubelet configuration file has permissions set to 644 or more restrictive</h2>
  <p>Description: Description:

Ensure that if the kubelet refers to a configuration file with the --config argument, that file
has permissions of 644 or more restrictive.

Rationale:

The kubelet reads various parameters, including security settings, from a config file
specified by the --config argument. If this file is specified you should restrict its file
permissions to maintain the integrity of the file. The file should be writable by only the
administrators on the system.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_kubelet_conf/rule.yml"> file_permissions_kubelet_conf</a>: Verify Permissions on The Kubelet Configuration File
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.1.4: 3.1.4 Ensure that the kubelet configuration file ownership is set to root:root</h2>
  <p>Description: Description:
Ensure that if the kubelet refers to a configuration file with the --config argument, that file
is owned by root:root.

Rationale:

The kubelet reads various parameters, including security settings, from a config file
specified by the --config argument. If this file is specified you should restrict its file
permissions to maintain the integrity of the file. The file should be writable by only the
administrators on the system.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_kubelet_conf/rule.yml"> file_groupowner_kubelet_conf</a>: Verify Group Who Owns The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_kubelet_conf/rule.yml"> file_owner_kubelet_conf</a>: Verify User Who Owns The Kubelet Configuration File
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.1: 3.1 Worker Node Configuration Files</h2>
  <p>Description: This section covers recommendations for configuration files on Amazon EKS worker nodes.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_kubelet_conf/rule.yml"> file_groupowner_kubelet_conf</a>: Verify Group Who Owns The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_worker_kubeconfig/rule.yml"> file_groupowner_worker_kubeconfig</a>: Verify Group Who Owns The Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_kubelet_conf/rule.yml"> file_owner_kubelet_conf</a>: Verify User Who Owns The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_worker_kubeconfig/rule.yml"> file_owner_worker_kubeconfig</a>: Verify User Who Owns The Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_kubelet_conf/rule.yml"> file_permissions_kubelet_conf</a>: Verify Permissions on The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_worker_kubeconfig/rule.yml"> file_permissions_worker_kubeconfig</a>: Verify Permissions on the Worker Kubeconfig File
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.1: 3.2.1 Ensure that the --anonymous-auth argument is set to false</h2>
  <p>Description: Description:

Disable anonymous requests to the Kubelet server.

Rationale:

When enabled, requests that are not rejected by other configured authentication methods
are treated as anonymous requests. These requests are then served by the Kubelet server.
You should rely on authentication to authorize access and disallow anonymous requests.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_anonymous_auth/rule.yml"> kubelet_anonymous_auth</a>: Disable Anonymous Authentication to the Kubelet
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.2: 3.2.2 Ensure that the --authorization-mode argument is not set to AlwaysAllow</h2>
  <p>Description: Description:

Do not allow all requests. Enable explicit authorization.

Rationale:

Kubelets, by default, allow all authenticated requests (even anonymous ones) without
needing explicit authorization checks from the apiserver. You should restrict this behavior
and only allow explicitly authorized requests.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_authorization_mode/rule.yml"> kubelet_authorization_mode</a>: Ensure authorization is set to Webhook
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.3: 3.2.3 Ensure that the --client-ca-file argument is set as appropriate</h2>
  <p>Description: Description:

Enable Kubelet authentication using certificates.

Rationale:

The connections from the apiserver to the kubelet are used for fetching logs for pods,
attaching (through kubectl) to running pods, and using the kubelet’s port-forwarding
functionality. These connections terminate at the kubelet’s HTTPS endpoint. By default, the
apiserver does not verify the kubelet’s serving certificate, which makes the connection
subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public
networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_configure_client_ca/rule.yml"> kubelet_configure_client_ca</a>: kubelet - Configure the Client CA Certificate
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.4: 3.2.4 Ensure that the --read-only-port is secured</h2>
  <p>Description: Description:

Disable the read-only port.

Rationale:

The Kubelet process provides a read-only API in addition to the main Kubelet API.
Unauthenticated access is provided to this read-only API which could possibly retrieve
potentially sensitive information about the cluster.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_read_only_port_secured/rule.yml"> kubelet_read_only_port_secured</a>: kubelet - Ensure that the --read-only-port is secured
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.5: 3.2.5 Ensure that the --streaming-connection-idle-timeout argument is not set to 0</h2>
  <p>Description: Description:

Do not disable timeouts on streaming connections.

Rationale:

Setting idle timeouts ensures that you are protected against Denial-of-Service attacks,
inactive connections and running out of ephemeral ports.
Note: By default, --streaming-connection-idle-timeout is set to 4 hours which might be
too high for your environment. Setting this as appropriate would additionally ensure that
such streaming connections are timed out after serving legitimate use cases.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_streaming_connections/rule.yml"> kubelet_enable_streaming_connections</a>: kubelet - Do Not Disable Streaming Timeouts
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.6: 3.2.6 Ensure that the --protect-kernel-defaults argument is set to true</h2>
  <p>Description: Description:

Protect tuned kernel parameters from overriding kubelet default kernel parameter values.

Rationale:

Kernel parameters are usually tuned and hardened by the system administrators before
putting the systems into production. These parameters protect the kernel and the system.
Your kubelet kernel defaults that rely on such parameters should be appropriately set to
match the desired secured system state. Ignoring this could potentially lead to running
pods with undesired kernel behavior.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_protect_kernel_defaults/rule.yml"> kubelet_enable_protect_kernel_defaults</a>: kubelet - Enable Protect Kernel Defaults
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.7: 3.2.7 Ensure that the --make-iptables-util-chains argument is set to true</h2>
  <p>Description: Description:

Allow Kubelet to manage iptables.

Rationale:

Kubelets can automatically manage the required changes to iptables based on how you
choose your networking options for the pods. It is recommended to let kubelets manage
the changes to iptables. This ensures that the iptables configuration remains in sync with
pods networking configuration. Manually configuring iptables with dynamic pod network
configuration changes might hamper the communication between pods/containers and to
the outside world. You might have iptables rules too restrictive or too open.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_iptables_util_chains/rule.yml"> kubelet_enable_iptables_util_chains</a>: kubelet - Allow Automatic Firewall Configuration
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.8: 3.2.8 Ensure that the --hostname-override argument is not set</h2>
  <p>Description: Description:

Do not override node hostnames.

Rationale:

Overriding hostnames could potentially break TLS setup between the kubelet and the
apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to
associate logs with a particular node and process them for security analytics. Hence, you
should setup your kubelet nodes with resolvable FQDNs and avoid overriding the
hostnames with IPs.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_disable_hostname_override/rule.yml"> kubelet_disable_hostname_override</a>: kubelet - Hostname Override handling
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.9: 3.2.9 Ensure that the --eventRecordQPS argument is set to 0 or a level which ensures appropriate event capture</h2>
  <p>Description: Description:

Security relevant information should be captured. The --eventRecordQPS flag on the
Kubelet can be used to limit the rate at which events are gathered. Setting this too low
could result in relevant events not being logged, however the unlimited setting of 0 could
result in a denial of service on the kubelet.

Rationale:

It is important to capture all events and not restrict event creation. Events are an important
source of security information and analytics that ensure that your environment is
consistently monitored using the event data.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>3.2.10: 3.2.10 Ensure that the --rotate-certificates argument is not set to false</h2>
  <p>Description: Description:

Enable kubelet client certificate rotation.

Rationale:

The --rotate-certificates setting causes the kubelet to rotate its client certificates by
creating new CSRs as its existing credentials expire. This automated periodic rotation
ensures that the there is no downtime due to expired certificates and thus addressing
availability in the CIA security triad.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_cert_rotation/rule.yml"> kubelet_enable_cert_rotation</a>: kubelet - Enable Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_client_cert_rotation/rule.yml"> kubelet_enable_client_cert_rotation</a>: kubelet - Enable Client Certificate Rotation
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2.11: 3.2.11 Ensure that the RotateKubeletServerCertificate argument is set to true</h2>
  <p>Description: Description:

Enable kubelet server certificate rotation.

Rationale:

RotateKubeletServerCertificate causes the kubelet to both request a serving certificate
after bootstrapping its client credentials and rotate the certificate as its existing credentials
expire. This automated periodic rotation ensures that the there are no downtimes due to
expired certificates and thus addressing availability in the CIA security triad.

Note: This recommendation only applies if you let kubelets get their certificates from the
API server. In case your kubelet certificates come from an outside authority/tool (e.g.
Vault) then you need to take care of rotation yourself.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_server_cert_rotation/rule.yml"> kubelet_enable_server_cert_rotation</a>: kubelet - Enable Server Certificate Rotation
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3.2: 3.2 Kubelet</h2>
  <p>Description: This section contains recommendations for kubelet configuration.

Kubelet settings may be configured using arguments on the running kubelet executable, or
they may be taken from a Kubelet config file. If both are specified, the executable argument
takes precedence.

To find the Kubelet config file, run the following command:

    ps -ef | grep kubelet | grep config

If the --config argument is present, this gives the location of the Kubelet config file. This
config file could be in JSON or YAML format depending on your distribution.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_anonymous_auth/rule.yml"> kubelet_anonymous_auth</a>: Disable Anonymous Authentication to the Kubelet
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_authorization_mode/rule.yml"> kubelet_authorization_mode</a>: Ensure authorization is set to Webhook
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_configure_client_ca/rule.yml"> kubelet_configure_client_ca</a>: kubelet - Configure the Client CA Certificate
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_disable_hostname_override/rule.yml"> kubelet_disable_hostname_override</a>: kubelet - Hostname Override handling
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_cert_rotation/rule.yml"> kubelet_enable_cert_rotation</a>: kubelet - Enable Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_client_cert_rotation/rule.yml"> kubelet_enable_client_cert_rotation</a>: kubelet - Enable Client Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_iptables_util_chains/rule.yml"> kubelet_enable_iptables_util_chains</a>: kubelet - Allow Automatic Firewall Configuration
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_protect_kernel_defaults/rule.yml"> kubelet_enable_protect_kernel_defaults</a>: kubelet - Enable Protect Kernel Defaults
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_server_cert_rotation/rule.yml"> kubelet_enable_server_cert_rotation</a>: kubelet - Enable Server Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_streaming_connections/rule.yml"> kubelet_enable_streaming_connections</a>: kubelet - Do Not Disable Streaming Timeouts
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_read_only_port_secured/rule.yml"> kubelet_read_only_port_secured</a>: kubelet - Ensure that the --read-only-port is secured
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>3: 3 Worker Nodes</h2>
  <p>Description: This section consists of security recommendations for the components that run on Amazon
EKS worker nodes.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_kubelet_conf/rule.yml"> file_groupowner_kubelet_conf</a>: Verify Group Who Owns The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_groupowner_worker_kubeconfig/rule.yml"> file_groupowner_worker_kubeconfig</a>: Verify Group Who Owns The Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_kubelet_conf/rule.yml"> file_owner_kubelet_conf</a>: Verify User Who Owns The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_owner_worker_kubeconfig/rule.yml"> file_owner_worker_kubeconfig</a>: Verify User Who Owns The Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_kubelet_conf/rule.yml"> file_permissions_kubelet_conf</a>: Verify Permissions on The Kubelet Configuration File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/worker/file_permissions_worker_kubeconfig/rule.yml"> file_permissions_worker_kubeconfig</a>: Verify Permissions on the Worker Kubeconfig File
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_anonymous_auth/rule.yml"> kubelet_anonymous_auth</a>: Disable Anonymous Authentication to the Kubelet
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_authorization_mode/rule.yml"> kubelet_authorization_mode</a>: Ensure authorization is set to Webhook
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_configure_client_ca/rule.yml"> kubelet_configure_client_ca</a>: kubelet - Configure the Client CA Certificate
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_disable_hostname_override/rule.yml"> kubelet_disable_hostname_override</a>: kubelet - Hostname Override handling
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_cert_rotation/rule.yml"> kubelet_enable_cert_rotation</a>: kubelet - Enable Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_client_cert_rotation/rule.yml"> kubelet_enable_client_cert_rotation</a>: kubelet - Enable Client Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_iptables_util_chains/rule.yml"> kubelet_enable_iptables_util_chains</a>: kubelet - Allow Automatic Firewall Configuration
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_protect_kernel_defaults/rule.yml"> kubelet_enable_protect_kernel_defaults</a>: kubelet - Enable Protect Kernel Defaults
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_server_cert_rotation/rule.yml"> kubelet_enable_server_cert_rotation</a>: kubelet - Enable Server Certificate Rotation
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_enable_streaming_connections/rule.yml"> kubelet_enable_streaming_connections</a>: kubelet - Do Not Disable Streaming Timeouts
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/kubelet/kubelet_read_only_port_secured/rule.yml"> kubelet_read_only_port_secured</a>: kubelet - Ensure that the --read-only-port is secured
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>4.1.1: 4.1.1 Ensure that the cluster-admin role is only used where required</h2>
  <p>Description: Description:

  The RBAC role cluster-admin provides wide-ranging powers over the
  environment and should be used only where and when needed.

Rationale:

  Kubernetes provides a set of default roles where RBAC is used. Some
  of these roles such as cluster-admin provide wide-ranging privileges
  which should only be applied where absolutely necessary. Roles such
  as cluster-admin allow super-user access to perform any action on any
  resource. When used in a ClusterRoleBinding, it gives full control
  over every resource in the cluster and in all namespaces. When used
  in a RoleBinding, it gives full control over every resource in the
  rolebinding's namespace, including the namespace itself.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1.2: 4.1.2 Minimize access to secrets</h2>
  <p>Description: Description:

  The Kubernetes API stores secrets, which may be service account
  tokens for the Kubernetes API or credentials used by workloads in the
  cluster. Access to these secrets should be restricted to the smallest
  possible group of users to reduce the risk of privilege escalation.

Rationale:

  Inappropriate access to secrets stored within the Kubernetes cluster
  can allow for an attacker to gain additional access to the Kubernetes
  cluster or external resources whose credentials are stored as
  secrets.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1.3: 4.1.3 Minimize wildcard use in Roles and ClusterRoles</h2>
  <p>Description: Description:

  Kubernetes Roles and ClusterRoles provide access to resources based
  on sets of objects and actions that can be taken on those objects. It
  is possible to set either of these to be the wildcard "*" which
  matches all items. Use of wildcards is not optimal from a security
  perspective as it may allow for inadvertent access to be granted when
  new resources are added to the Kubernetes API either as CRDs or in
  later versions of the product.

Rationale:

  The principle of least privilege recommends that users are provided
  only the access required for their role and nothing more. The use of
  wildcard rights grants is likely to provide excessive rights to the
  Kubernetes API.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1.4: 4.1.4 Minimize access to create pods</h2>
  <p>Description: Description:

  The ability to create pods in a namespace can provide a number of
  opportunities for privilege escalation, such as assigning privileged
  service accounts to these pods or mounting hostPaths with access to
  sensitive data (unless Pod Security Policies are implemented to
  restrict this access) As such, access to create new pods should be
  restricted to the smallest possible group of users.

Rationale:

  The ability to create pods in a cluster opens up possibilities for
  privilege escalation and should be restricted, where possible.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1.5: 4.1.5 Ensure that default service accounts are not actively used.</h2>
  <p>Description: Description:

  The default service account should not be used to ensure that rights
  granted to applications can be more easily audited and reviewed.

Rationale:

  Kubernetes provides a default service account which is used by
  cluster workloads where no specific service account is assigned to
  the pod. Where access to the Kubernetes API from a pod is required, a
  specific service account should be created for that pod, and rights
  granted to that service account. The default service account should
  be configured such that it does not provide a service account token
  and does not have any explicit rights assignments.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1.6: 4.1.6 Ensure that Service Account Tokens are only mounted where necessary</h2>
  <p>Description: Description:

  Service accounts tokens should not be mounted in pods except where
  the workload running in the pod explicitly needs to communicate with
  the API server

Rationale:

  Mounting service account tokens inside pods can provide an avenue for
  privilege escalation attacks where an attacker is able to compromise
  a single pod in the cluster. Avoiding mounting these tokens removes
  this attack avenue.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.1: 4.1 RBAC and Service Accounts</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.1: 4.2.1 Minimize the admission of privileged containers</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.2: 4.2.2 Minimize the admission of containers wishing to share the host process ID namespace</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.3: 4.2.3 Minimize the admission of containers wishing to share the host IPC namespace</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.4: 4.2.4 Minimize the admission of containers wishing to share the host network namespace</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.5: 4.2.5 Minimize the admission of containers with allowPrivilegeEscalation</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.6: 4.2.6 Minimize the admission of root containers</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.7: 4.2.7 Minimize the admission of containers with the NET_RAW capability</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.8: 4.2.8 Minimize the admission of containers with added capabilities</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2.9: 4.2.9 Minimize the admission of containers with capabilities assigned</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.2: 4.2 Pod Security Policies</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.3.1: 4.3.1 Ensure latest CNI version is used</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.3.2: 4.3.2 Ensure that all Namespaces have Network Policies defined</h2>
  <p>Description: Description:

Use network policies to isolate traffic in your cluster network.

Rationale:

Running different applications on the same Kubernetes cluster creates a risk of one
compromised application attacking a neighboring application. Network segmentation is
important to ensure that containers can communicate only with those they are supposed
to. A network policy is a specification of how selections of pods are allowed to
communicate with each other and other network endpoints.

Network Policies are namespace scoped. When a network policy is introduced to a given
namespace, all traffic not allowed by the policy is denied. However, if there are no network
policies in a namespace all traffic will be allowed into and out of the pods in that
namespace.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: yes</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policies_namespaces/rule.yml"> configure_network_policies_namespaces</a>: Ensure that application Namespaces have Network Policies defined.
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>4.3: 4.3 CNI Plugin</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policies_namespaces/rule.yml"> configure_network_policies_namespaces</a>: Ensure that application Namespaces have Network Policies defined.
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>4.4.1: 4.4.1 Prefer using secrets as files over secrets as environment variables</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.4.2: 4.4.2 Consider external secret storage</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.4: 4.4 Secrets Management</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.5.1: 4.5.1 Configure Image Provenance using ImagePolicyWebhook admission controller</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.5: 4.5 Extensible Admission Control</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.6.1: 4.6.1 Create administrative boundaries between resources using namespaces</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.6.2: 4.6.2 Apply Security Context to Your Pods and Containers</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.6.3: 4.6.3 The default namespace should not be used</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4.6: 4.6 General Policies</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  <p>
  <strong>No rules selected</strong>
  </p>
</div>  
<div class="one_control">
  <h2>4: 4 Policies</h2>
  <p>Description: This section contains recommendations for various Kubernetes policies which
are important to the security of Amazon EKS customer environment.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policies_namespaces/rule.yml"> configure_network_policies_namespaces</a>: Ensure that application Namespaces have Network Policies defined.
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.1.1: 5.1.1 Ensure Image Vulnerability Scanning using Amazon ECR image scanning or a third party provider</h2>
  <p>Description: Description:

Scan images being deployed to Amazon EKS for vulnerabilities.

Rationale:

Vulnerabilities in software packages can be exploited by hackers or
malicious users to obtain unauthorized access to local cloud resources.
Amazon ECR and other third party products allow images to be scanned
for known vulnerabilities.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/image_scanning/rule.yml"> image_scanning</a>: Ensure Image Vulnerability Scanning
      <ul><li>CCE-88990-7</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.1.2: 5.1.2 Minimize user access to Amazon ECR</h2>
  <p>Description: Description:

Restrict user access to Amazon ECR, limiting interaction with build
images to only authorized personnel and service accounts.

Rationale:

Weak access control to Amazon ECR may allow malicious users to replace
built images with vulnerable containers.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/registry_access/rule.yml"> registry_access</a>: Minimize user access to Amazon ECR
      <ul><li>CCE-89643-1</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.1.3: 5.1.3 Minimize cluster access to read-only for Amazon ECR</h2>
  <p>Description: Description:

  Configure the Cluster Service Account with Storage Object Viewer Role
  to only allow read- only access to Amazon ECR.

Rationale:

  The Cluster Service Account does not require administrative access to
  Amazon ECR, only requiring pull access to containers to deploy onto
  Amazon EKS. Restricting permissions follows the principles of least
  privilege and prevents credentials from being abused beyond the
  required role.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/read_only_registry_access/rule.yml"> read_only_registry_access</a>: Ensure Cluster Service Account with read-only access to Amazon ECR
      <ul><li>CCE-86681-4</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.1.4: 5.1.4 Minimize Container Registries to only those approved</h2>
  <p>Description: Description:
  Use approved container registries.

Rationale:

  Allowing unrestricted access to external container registries
  provides the opportunity for malicious or unapproved containers to be
  deployed into the cluster. Allowlisting only approved container
  registries reduces this risk.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/approved_registries/rule.yml"> approved_registries</a>: Only use approved container registries
      <ul><li>CCE-86901-6</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.1: 5.1 Image Registry and Image Scanning</h2>
  <p>Description: This section contains recommendations relating to container image
registries and securing images in those registries, such as Amazon
Elastic Container Registry (ECR).</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/approved_registries/rule.yml"> approved_registries</a>: Only use approved container registries
      <ul><li>CCE-86901-6</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/image_scanning/rule.yml"> image_scanning</a>: Ensure Image Vulnerability Scanning
      <ul><li>CCE-88990-7</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/read_only_registry_access/rule.yml"> read_only_registry_access</a>: Ensure Cluster Service Account with read-only access to Amazon ECR
      <ul><li>CCE-86681-4</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/registry_access/rule.yml"> registry_access</a>: Minimize user access to Amazon ECR
      <ul><li>CCE-89643-1</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.2.1: 5.2.1 Prefer using dedicated EKS Service Accounts</h2>
  <p>Description: Description:

  Kubernetes workloads should not use cluster node service accounts to
  authenticate to Amazon EKS APIs. Each Kubernetes workload that needs
  to authenticate to other AWS services using AWS IAM should be
  provisioned with a dedicated Service account.

Rationale:

  Manual approaches for authenticating Kubernetes workloads running on
  Amazon EKS against AWS APIs are: storing service account keys as a
  Kubernetes secret (which introduces manual key rotation and potential
  for key compromise); or use of the underlying nodes' IAM Service
  account, which violates the principle of least privilege on a
  multi-tenanted node, when one pod needs to have access to a service,
  but every other pod on the node that uses the Service account does
  not.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/accounts/dedicated_service_accounts/rule.yml"> dedicated_service_accounts</a>: Use Dedicated Service Accounts
      <ul><li>CCE-87818-1</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.2: 5.2 Identity and Access Management (IAM)</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/accounts/dedicated_service_accounts/rule.yml"> dedicated_service_accounts</a>: Use Dedicated Service Accounts
      <ul><li>CCE-87818-1</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.3.1: 5.3.1 Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs) managed in AWS KMS</h2>
  <p>Description: Description:

  Encrypt Kubernetes secrets, stored in etcd, using secrets encryption
  feature during Amazon EKS cluster creation.

Rationale:

  Kubernetes can store secrets that pods can access via a mounted
  volume. Today, Kubernetes secrets are stored with Base64 encoding,
  but encrypting is the recommended approach. Amazon EKS clusters
  version 1.13 and higher support the capability of encrypting your
  Kubernetes secrets using AWS Key Management Service (KMS) Customer
  Managed Keys (CMK). The only requirement is to enable the encryption
  provider support during EKS cluster creation. Use AWS Key Management
  Service (KMS) keys to provide envelope encryption of Kubernetes
  secrets stored in Amazon EKS. Implementing envelope encryption is
  considered a security best practice for applications that store
  sensitive data and is part of a defense in depth security strategy.
  Application-layer Secrets Encryption provides an additional layer of
  security for sensitive data, such as user defined Secrets and Secrets
  required for the operation of the cluster, such as service account
  keys, which are all stored in etcd. Using this functionality, you can
  use a key, that you manage in AWS KMS, to encrypt data at the
  application layer. This protects against attackers in the event that
  they manage to gain access to etcd.
</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/secrets/secret_encryption/rule.yml"> secret_encryption</a>: Ensure Kubernetes Secrets are Encrypted
      <ul><li>CCE-90708-9</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.3: 5.3 AWS Key Management Service (KMS)</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/secrets/secret_encryption/rule.yml"> secret_encryption</a>: Ensure Kubernetes Secrets are Encrypted
      <ul><li>CCE-90708-9</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4.1: 5.4.1 Restrict Access to the Control Plane Endpoint</h2>
  <p>Description: Description:

  Enable Endpoint Private Access to restrict access to the cluster's
  control plane to only an allowlist of authorized IPs.

Rationale:

  Authorized networks are a way of specifying a restricted range of IP
  addresses that are permitted to access your cluster's control plane.
  Kubernetes Engine uses both Transport Layer Security (TLS) and
  authentication to provide secure access to your cluster's control
  plane from the public internet. This provides you the flexibility to
  administer your cluster from anywhere; however, you might want to
  further restrict access to a set of IP addresses that you control.
  You can set this restriction by specifying an authorized network.
  Restricting access to an authorized network can provide additional
  security benefits for
  your container cluster, including:
    * Better protection from outsider attacks: Authorized networks
      provide an additional layer of security by limiting external
      access to a specific set of addresses you designate, such as
      those that originate from your premises. This helps protect
      access to your cluster in the case of a vulnerability in the
      cluster's authentication or authorization mechanism.
    * Better protection from insider attacks: Authorized networks help
      protect your cluster from accidental leaks of master certificates
      from your company's premises. Leaked certificates used from
      outside Amazon EC2 and outside the authorized IP ranges (for
      example, from addresses outside your company) are still denied
      access.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/control_plane_access/rule.yml"> control_plane_access</a>: Restrict Access to the Control Plane Endpoint
      <ul><li>CCE-86182-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4.2: 5.4.2 Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</h2>
  <p>Description: Description:

  Disable access to the Kubernetes API from outside the node network if
  it is not required.

Rationale:

  In a private cluster, the master node has two endpoints, a private
  and public endpoint. The private endpoint is the internal IP address
  of the master, behind an internal load balancer in the master's VPC
  network. Nodes communicate with the master using the private
  endpoint. The public endpoint enables the Kubernetes API to be
  accessed from outside the master's VPC network. Although Kubernetes
  API requires an authorized token to perform sensitive actions, a
  vulnerability could potentially expose the Kubernetes publicly with
  unrestricted access. Additionally, an attacker may be able to
  identify the current cluster and Kubernetes API version and determine
  whether it is vulnerable to an attack. Unless required, disabling
  public endpoint will help prevent such threats, and require the
  attacker to be on the master's VPC network to perform any attack on
  the Kubernetes API.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/endpoint_configuration/rule.yml"> endpoint_configuration</a>: Ensure Private Endpoint Access
      <ul><li>CCE-88813-1</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4.3: 5.4.3 Ensure clusters are created with Private Nodes</h2>
  <p>Description: Description:

  Disable public IP addresses for cluster nodes, so that they only have
  private IP addresses. Private Nodes are nodes with no public IP
  addresses.

Rationale:

  Disabling public IP addresses on cluster nodes restricts access to
  only internal networks, forcing attackers to obtain local network
  access before attempting to compromise the underlying Kubernetes
  hosts.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/private_nodes/rule.yml"> private_nodes</a>: Ensure Cluster Private Nodes
      <ul><li>CCE-88669-7</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4.4: 5.4.4 Ensure Network Policy is Enabled and set as appropriate</h2>
  <p>Description: Description:

  Use Network Policy to restrict pod to pod traffic within a cluster
  and segregate workloads.

Rationale:

  By default, all pod to pod traffic within a cluster is allowed.
  Network Policy creates a pod-level firewall that can be used to
  restrict traffic between sources. Pod traffic is restricted by having
  a Network Policy that selects it (through the use of labels). Once
  there is any Network Policy in a namespace selecting a particular
  pod, that pod will reject any connections that are not allowed by any
  Network Policy. Other pods in the namespace that are not selected by
  any Network Policy will continue to accept all traffic. Network
  Policies are managed via the Kubernetes Network Policy API and
  enforced by a network plugin, simply creating the resource without a
  compatible network plugin to implement it will have no effect. EKS
  supports Network Policy enforcement through the use of Calico.</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policy/rule.yml"> configure_network_policy</a>: Ensure Network Policy is Enabled
      <ul><li>CCE-88207-6</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4.5: 5.4.5 Encrypt traffic to HTTPS load balancers with TLS certificates</h2>
  <p>Description: Description:

  Encrypt traffic to HTTPS load balancers using TLS certificates.

Rationale:

  Encrypting traffic between users and your Kubernetes workload is
  fundamental to protecting data sent over the web.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_tls/rule.yml"> configure_tls</a>: Encrypt Traffic to Load Balancers and Workloads
      <ul><li>CCE-89133-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.4: 5.4 Cluster Networking</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policy/rule.yml"> configure_network_policy</a>: Ensure Network Policy is Enabled
      <ul><li>CCE-88207-6</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_tls/rule.yml"> configure_tls</a>: Encrypt Traffic to Load Balancers and Workloads
      <ul><li>CCE-89133-3</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/control_plane_access/rule.yml"> control_plane_access</a>: Restrict Access to the Control Plane Endpoint
      <ul><li>CCE-86182-3</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/endpoint_configuration/rule.yml"> endpoint_configuration</a>: Ensure Private Endpoint Access
      <ul><li>CCE-88813-1</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/private_nodes/rule.yml"> private_nodes</a>: Ensure Cluster Private Nodes
      <ul><li>CCE-88669-7</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.5.1: 5.5.1 Manage Kubernetes RBAC users with AWS IAM Authenticator for Kubernetes</h2>
  <p>Description: Description:

  Amazon EKS uses IAM to provide authentication to your Kubernetes
  cluster through the AWS IAM Authenticator for Kubernetes. You can
  configure the stock kubectl client to work with Amazon EKS by
  installing the AWS IAM Authenticator for Kubernetes and modifying
  your kubectl configuration file to use it for authentication.

Rationale:

  On- and off-boarding users is often difficult to automate and prone
  to error. Using a single source of truth for user permissions reduces
  the number of locations that an individual must be off-boarded from,
  and prevents users gaining unique permissions sets that increase the
  cost of audit.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/authentication/iam_integration/rule.yml"> iam_integration</a>: Manage Users with AWS IAM
      <ul><li>CCE-86301-9</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.5: 5.5 Authentication and Authorization</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/authentication/iam_integration/rule.yml"> iam_integration</a>: Manage Users with AWS IAM
      <ul><li>CCE-86301-9</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.6.1: 5.6.1 Consider Fargate for running untrusted workloads</h2>
  <p>Description: Description:

  It is Best Practice to restrict or fence untrusted workloads when
  running in a multi-tenant environment.

Rationale:

  AWS Fargate is a technology that provides on-demand, right-sized
  compute capacity for containers. With AWS Fargate, you no longer have
  to provision, configure, or scale groups of virtual machines to run
  containers. This removes the need to choose server types, decide when
  to scale your node groups, or optimize cluster packing. You can
  control which pods start on Fargate and how they run with Fargate
  profiles, which are defined as part of your Amazon EKS cluster.
  Amazon EKS integrates Kubernetes with AWS Fargate by using
  controllers that are built by AWS using the upstream, extensible
  model provided by Kubernetes. These controllers run as part of the
  Amazon EKS managed Kubernetes control plane and are responsible for
  scheduling native Kubernetes pods onto Fargate. The Fargate
  controllers include a new scheduler that runs alongside the default
  Kubernetes scheduler in addition to several mutating and validating
  admission controllers. When you start a pod that meets the criteria
  for running on Fargate, the Fargate controllers running in the
  cluster recognize, update, and schedule the pod onto Fargate. Each
  pod running on Fargate has its own isolation boundary and does not
  share the underlying kernel, CPU resources, memory resources, or
  elastic network interface with another pod.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/general/fargate/rule.yml"> fargate</a>: Consider Fargate for Untrusted Workloads
      <ul><li>CCE-89091-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5.6: 5.6 Other Cluster Configurations</h2>
  <p>Description: None</p>
  Levels: 
  <ul><li>level_1</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/general/fargate/rule.yml"> fargate</a>: Consider Fargate for Untrusted Workloads
      <ul><li>CCE-89091-3</li></ul>
    </li>
  </ul>
  
</div>  
<div class="one_control">
  <h2>5: 5 Managed services</h2>
  <p>Description: This section consists of security recommendations for the Amazon EKS. These
recommendations are applicable for configurations that Amazon EKS customers
own and manage.</p>
  Levels: 
  <ul><li>level_2</li>
  </ul>
  <p>Automated: no</p>
  Selections:
  <ul>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/approved_registries/rule.yml"> approved_registries</a>: Only use approved container registries
      <ul><li>CCE-86901-6</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_network_policy/rule.yml"> configure_network_policy</a>: Ensure Network Policy is Enabled
      <ul><li>CCE-88207-6</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/configure_tls/rule.yml"> configure_tls</a>: Encrypt Traffic to Load Balancers and Workloads
      <ul><li>CCE-89133-3</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/control_plane_access/rule.yml"> control_plane_access</a>: Restrict Access to the Control Plane Endpoint
      <ul><li>CCE-86182-3</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/accounts/dedicated_service_accounts/rule.yml"> dedicated_service_accounts</a>: Use Dedicated Service Accounts
      <ul><li>CCE-87818-1</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/endpoint_configuration/rule.yml"> endpoint_configuration</a>: Ensure Private Endpoint Access
      <ul><li>CCE-88813-1</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/general/fargate/rule.yml"> fargate</a>: Consider Fargate for Untrusted Workloads
      <ul><li>CCE-89091-3</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/authentication/iam_integration/rule.yml"> iam_integration</a>: Manage Users with AWS IAM
      <ul><li>CCE-86301-9</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/image_scanning/rule.yml"> image_scanning</a>: Ensure Image Vulnerability Scanning
      <ul><li>CCE-88990-7</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/networking/private_nodes/rule.yml"> private_nodes</a>: Ensure Cluster Private Nodes
      <ul><li>CCE-88669-7</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/read_only_registry_access/rule.yml"> read_only_registry_access</a>: Ensure Cluster Service Account with read-only access to Amazon ECR
      <ul><li>CCE-86681-4</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/registry/registry_access/rule.yml"> registry_access</a>: Minimize user access to Amazon ECR
      <ul><li>CCE-89643-1</li></ul>
    </li>
    <li><a href="https://github.com/ComplianceAsCode/content/tree/master//applications/openshift/secrets/secret_encryption/rule.yml"> secret_encryption</a>: Ensure Kubernetes Secrets are Encrypted
      <ul><li>CCE-90708-9</li></ul>
    </li>
  </ul>
  
</div>  
</div>  


</body>
</html>